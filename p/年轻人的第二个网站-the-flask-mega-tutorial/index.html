<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Êú¨Êñá‰∏∫ Flask Ê°ÜÊû∂Â≠¶‰π†Á¨îËÆ∞Ôºå‰∏ªË¶ÅÂèÇËÄÉ‰∫Ü The-Flask-Mega-Tutorial Âíå „ÄäFlask WebÂºÄÂèëÔºöÂü∫‰∫éPythonÁöÑWebÂ∫îÁî®ÂºÄÂèëÂÆûÊàò„Äã‰∏§Êú¨‰π¶ÔºåÂπ∂Âú®ÂéüÈ°πÁõÆÁöÑÂü∫Á°Ä‰∏äÊãìÂ±ï„ÄÇÔºà‰∏ãÊñáÁªüÁß∞'>
<title>Âπ¥ËΩª‰∫∫ÁöÑÁ¨¨‰∫å‰∏™ÁΩëÁ´ô - The Flask Mega Tutorial</title>

<link rel='canonical' href='https://lonelyuan.github.io/p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99-the-flask-mega-tutorial/'>

<link rel="stylesheet" href="/scss/style.min.24ef1cc321916467896e8c70c10c0ad7b98c2a8df14298032fb637216e397f50.css"><meta property='og:title' content='Âπ¥ËΩª‰∫∫ÁöÑÁ¨¨‰∫å‰∏™ÁΩëÁ´ô - The Flask Mega Tutorial'>
<meta property='og:description' content='Êú¨Êñá‰∏∫ Flask Ê°ÜÊû∂Â≠¶‰π†Á¨îËÆ∞Ôºå‰∏ªË¶ÅÂèÇËÄÉ‰∫Ü The-Flask-Mega-Tutorial Âíå „ÄäFlask WebÂºÄÂèëÔºöÂü∫‰∫éPythonÁöÑWebÂ∫îÁî®ÂºÄÂèëÂÆûÊàò„Äã‰∏§Êú¨‰π¶ÔºåÂπ∂Âú®ÂéüÈ°πÁõÆÁöÑÂü∫Á°Ä‰∏äÊãìÂ±ï„ÄÇÔºà‰∏ãÊñáÁªüÁß∞'>
<meta property='og:url' content='https://lonelyuan.github.io/p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99-the-flask-mega-tutorial/'>
<meta property='og:site_name' content='lonelyuan&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='flask' /><meta property='article:published_time' content='2021-09-09T20:18:56&#43;00:00'/><meta property='article:modified_time' content='2021-09-09T20:18:56&#43;00:00'/><meta property='og:image' content='https://lonelyuan.github.io/' />
<meta name="twitter:title" content="Âπ¥ËΩª‰∫∫ÁöÑÁ¨¨‰∫å‰∏™ÁΩëÁ´ô - The Flask Mega Tutorial">
<meta name="twitter:description" content="Êú¨Êñá‰∏∫ Flask Ê°ÜÊû∂Â≠¶‰π†Á¨îËÆ∞Ôºå‰∏ªË¶ÅÂèÇËÄÉ‰∫Ü The-Flask-Mega-Tutorial Âíå „ÄäFlask WebÂºÄÂèëÔºöÂü∫‰∫éPythonÁöÑWebÂ∫îÁî®ÂºÄÂèëÂÆûÊàò„Äã‰∏§Êú¨‰π¶ÔºåÂπ∂Âú®ÂéüÈ°πÁõÆÁöÑÂü∫Á°Ä‰∏äÊãìÂ±ï„ÄÇÔºà‰∏ãÊñáÁªüÁß∞"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://lonelyuan.github.io/' />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BLVC1PKZKD"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-BLVC1PKZKD', { 'anonymize_ip': false });
}
</script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-BLVC1PKZKD', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/rick_hubede16acaa63e012983e5eadbe210d5c_33168_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üë¥</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">lonelyuan&#39;s Blog</a></h1>
            <h2 class="site-description"> &gt;&gt; ‰∏çË¶ÅÊÅêÊÖå | Don&#39;t Panic </h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/lonelyuan'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com/FTrumpyeah'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about-me/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About Me</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/categories/cs/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                
                <span>CS</span>
            </a>
        </li>
        
        
        <li >
            <a href='/categories/ctf/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M9.828 9.172a4 4 0 1 0 0 5.656 a10 10 0 0 0 2.172 -2.828a10 10 0 0 1 2.172 -2.828 a4 4 0 1 1 0 5.656a10 10 0 0 1 -2.172 -2.828a10 10 0 0 0 -2.172 -2.828" />
</svg>



                
                <span>CTF</span>
            </a>
        </li>
        
        
        <li >
            <a href='/categories/sec/' >
                
                
                
                    <svg data-immersive-translate-effect="1" data-immersive_translate_walked="0b66fd33-9d65-4c0d-a958-cdfe41102bc1" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" data-immersive-translate-effect="1" data-immersive_translate_walked="0b66fd33-9d65-4c0d-a958-cdfe41102bc1"></path>
</svg>
                
                <span>Sec</span>
            </a>
        </li>
        
        
        <li >
            <a href='/todo/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                
                <span>TODO</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                <form action="/search/" class="search-form widget" >
        <p>
            <label>Search</label>
            <input name="keyword" required placeholder="Type something..." />
        
            <button title="Search">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



            </button>
        </p>
    </form>
            
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#0x00-Â§ßÂûãÈ°πÁõÆÁªìÊûÑ">0x00 Â§ßÂûãÈ°πÁõÆÁªìÊûÑ</a></li>
    <li><a href="#0x01-hello-worldÊ®°ÊùøÂíåËßÜÂõæ">0x01 Hello worldÔºöÊ®°ÊùøÂíåËßÜÂõæ</a>
      <ol>
        <li>
          <ol>
            <li><a href="#Ë∑ØÁî±ËßÜÂõæ">Ë∑ØÁî±/ËßÜÂõæ</a></li>
            <li><a href="#Ë°®Âçï">Ë°®Âçï</a></li>
            <li><a href="#flash-Èó™Áé∞Ê∂àÊÅØ">flash Èó™Áé∞Ê∂àÊÅØ</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#0x02-Êï∞ÊçÆÂ∫ì-orm">0x02 Êï∞ÊçÆÂ∫ì ORM</a>
      <ol>
        <li><a href="#sqlalchemymodelÂ±Ç">SQLalchemyÔºömodelÂ±Ç</a>
          <ol>
            <li><a href="#Ê®°ÂûãÂÆö‰πâ">Ê®°ÂûãÂÆö‰πâ</a></li>
            <li><a href="#curdÂü∫Êú¨Êìç‰Ωú">CURDÂü∫Êú¨Êìç‰Ωú</a></li>
          </ol>
        </li>
        <li><a href="#flask-migrate-Êï∞ÊçÆÂ∫ìËøÅÁßª">Flask-Migrate: Êï∞ÊçÆÂ∫ìËøÅÁßª</a></li>
      </ol>
    </li>
    <li><a href="#0x03-ÂºÄÂèëËåÉÂºèÁî®Êà∑Á≥ªÁªü">0x03 ÂºÄÂèëËåÉÂºèÔºöÁî®Êà∑Á≥ªÁªü</a>
      <ol>
        <li>
          <ol>
            <li><a href="#usermixinÁ±ª">UserMixinÁ±ª</a></li>
            <li><a href="#prg-Ê®°Âºè">PRG Ê®°Âºè</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#0x04-Ê∑±ÂÖ•Êï∞ÊçÆÂ∫ìÁ≤â‰∏ùÊú∫Âà∂">0x04 Ê∑±ÂÖ•Êï∞ÊçÆÂ∫ìÔºöÁ≤â‰∏ùÊú∫Âà∂</a>
      <ol>
        <li><a href="#Êï∞ÊçÆÂ∫ìÂÖ≥Á≥ª">Êï∞ÊçÆÂ∫ìÂÖ≥Á≥ª</a></li>
        <li><a href="#Á≤â‰∏ùÊú∫Âà∂">Á≤â‰∏ùÊú∫Âà∂</a>
          <ol>
            <li><a href="#Ê®°Âûã">Ê®°Âûã</a></li>
            <li><a href="#Â§çÊùÇÊü•ËØ¢">Â§çÊùÇÊü•ËØ¢</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#0x05-ÁΩëÁ´ôÁæéÂåñ">0x05 ÁΩëÁ´ôÁæéÂåñ</a>
      <ol>
        <li>
          <ol>
            <li><a href="#ÂØåÊñáÊú¨ÁºñËæëÂô®">ÂØåÊñáÊú¨ÁºñËæëÂô®</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#0x06-Ê®°ÂùóÂåñÂ∫îÁî®ÂäüËÉΩËß£ËÄ¶">0x06 Ê®°ÂùóÂåñÂ∫îÁî®ÔºöÂäüËÉΩËß£ËÄ¶</a>
      <ol>
        <li><a href="#blueprintÂåñ">BlueprintÂåñ</a></li>
        <li><a href="#Â∫îÁî®Â∑•ÂéÇÊ®°Âºè">Â∫îÁî®Â∑•ÂéÇÊ®°Âºè</a>
          <ol>
            <li><a href="#Â§öÁ∫øÁ®ã">Â§öÁ∫øÁ®ã</a></li>
            <li><a href="#pythonÊ¶ÇÂøµËæ®ÊûêÂåÖÂ∫ìÊèí‰ª∂">PythonÊ¶ÇÂøµËæ®ÊûêÔºöÂåÖÔºåÂ∫ìÔºåÊèí‰ª∂</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#0x07-ÂºÄÂèëÂ∏ÆÊâã">0x07 ÂºÄÂèëÂ∏ÆÊâã</a>
      <ol>
        <li>
          <ol>
            <li><a href="#Ë∞ÉËØï">Ë∞ÉËØï</a></li>
            <li><a href="#ÂçïÂÖÉÊµãËØï">ÂçïÂÖÉÊµãËØï</a></li>
            <li><a href="#ËÆ∞ÂΩïÊó•ÂøóÂà∞Êñá‰ª∂">ËÆ∞ÂΩïÊó•ÂøóÂà∞Êñá‰ª∂</a></li>
            <li><a href="#requirementtxt">requirement.txt</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#0x08-ÁΩëÁ´ô‰∏äÁ∫ø">0x08 ÁΩëÁ´ô‰∏äÁ∫ø</a>
      <ol>
        <li>
          <ol>
            <li><a href="#nativeÊ®°Âºè">nativeÊ®°Âºè</a></li>
            <li><a href="#ÂÆπÂô®ÂåñÊäÄÊúØdocker">ÂÆπÂô®ÂåñÊäÄÊúØÔºödocker</a></li>
            <li><a href="#‰∫ëÊäÄÊúØpaas">‰∫ëÊäÄÊúØÔºöPaaS</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
            
                <section class="widget tagCloud">
    <div class="widget-icon">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



    </div>
    <h2 class="widget-title section-title">Categories</h2>

    <div class="tagCloud-tags">
        
            <a href="/categories/cs/" class="font_size_9">
                CS
            </a>
        
            <a href="/categories/sec/" class="font_size_3">
                Sec
            </a>
        
            <a href="/categories/web/" class="font_size_3">
                Web
            </a>
        
            <a href="/categories/ctf/" class="font_size_1">
                CTF
            </a>
        
    </div>
</section>

            
        
            
                <section class="widget tagCloud">
    <div class="widget-icon">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11 3L20 12a1.5 1.5 0 0 1 0 2L14 20a1.5 1.5 0 0 1 -2 0L3 11v-4a4 4 0 0 1 4 -4h4" />
  <circle cx="9" cy="9" r="2" />
</svg>



    </div>
    <h2 class="widget-title section-title">Tags</h2>

    <div class="tagCloud-tags">
        
            <a href="/tags/csapp/" class="font_size_3">
                CSAPP
            </a>
        
            <a href="/tags/fuzz/" class="font_size_3">
                fuzz
            </a>
        
            <a href="/tags/fuzzing101/" class="font_size_3">
                fuzzing101
            </a>
        
            <a href="/tags/libafl/" class="font_size_3">
                Libafl
            </a>
        
            <a href="/tags/rust/" class="font_size_3">
                rust
            </a>
        
    </div>
</section>
            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/web/" >
                Web
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99-the-flask-mega-tutorial/">Âπ¥ËΩª‰∫∫ÁöÑÁ¨¨‰∫å‰∏™ÁΩëÁ´ô - The Flask Mega Tutorial</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2021-9-9&nbsp;published
                </time></time> 
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    11 minute read
                    <span class="post-word-count">, 5252 words</span> 
                </time>
            </div>
            
        

    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <blockquote>
<p>Êú¨Êñá‰∏∫ Flask Ê°ÜÊû∂Â≠¶‰π†Á¨îËÆ∞Ôºå‰∏ªË¶ÅÂèÇËÄÉ‰∫Ü <a class="link" href="https://luhuisicnu.gitbook.io/the-flask-mega-tutorial-zh"  target="_blank" rel="noopener"
    >The-Flask-Mega-Tutorial</a> Âíå „ÄäFlask WebÂºÄÂèëÔºöÂü∫‰∫éPythonÁöÑWebÂ∫îÁî®ÂºÄÂèëÂÆûÊàò„Äã‰∏§Êú¨‰π¶ÔºåÂπ∂Âú®ÂéüÈ°πÁõÆÁöÑÂü∫Á°Ä‰∏äÊãìÂ±ï„ÄÇÔºà‰∏ãÊñáÁªüÁß∞Ëøô‰∏§‰∏™ËµÑÊ∫ê‰∏∫‚ÄúÊú¨ÊïôÁ®ã‚ÄùÔºâ
‰∏çÁÜüÊÇâ Flask Ê°ÜÊû∂ËØ∑ÂÖàÈòÖËØª<a class="link" href="https://dormousehole.readthedocs.io/en/latest/quickstart.html"  target="_blank" rel="noopener"
    >Âø´ÈÄü‰∏äÊâã - flask ‰∏≠ÊñáÊñáÊ°£</a> „ÄÇ</p>
<p>Ëøô‰∏§Êú¨‰π¶ÁöÑ‰ΩúËÄÖÊòØÂêå‰∏Ä‰∏™‰∫∫ÔºåÂ∞±ÂÜÖÂÆπ‰∏äËØ¥ÂêéËÄÖÁÆóÊòØÂâçËÄÖÁöÑË±™ÂçéÁâà„ÄÇÊú¨ÊïôÁ®ãÁöÑ‰ºòÁÇπÊòØÂÜÖÂÆπÂÖ®Èù¢Ôºå‰ªéÂÖ•Èó®Âà∞ÈÉ®ÁΩ≤‰∏ÄÁ´ôÂºèÊúçÂä°ÔºõÁº∫ÁÇπÊòØ‰∏çÂ§üÊ∑±ÂÖ•Ôºå‰∏îÊúâ‰∫õËøáÊó∂Ôºå‰π¶‰∏≠‰∏æ‰æãÁöÑËØ∏Â§öÊèí‰ª∂Âùá‰∏∫‰ΩúËÄÖ‰∏∫‰∫ÜÊ≠§‰π¶ËÄåÂºÄÂèëÁöÑÔºåÂ∑≤ÁªèËÆ∏‰πÖ‰∏çÂÜçÁª¥Êä§ÔºåÂØºËá¥ÂæàÈöæÂú®ÂÖ∂Á§∫‰æãÈ°πÁõÆ‰∏äÊãìÂ±ï„ÄÇ‰∏ÄÁúãÊââÈ°µÔºå2015Âπ¥Âá∫ÁâàÔºåÈÇ£Ê≤°‰∫ã‰∫Ü„ÄÇ
Ëá≥‰∫éÁ¨¨‰∏Ä‰∏™ÁΩëÁ´ôÔºüÂèÇËßÅ<a class="link" href="#%e6%88%91%e8%bf%98%e6%b2%a1%e5%86%99%e5%91%a2" >#TODO:Âπ¥ËΩª‰∫∫ÁöÑÁ¨¨‰∏Ä‰∏™ÁΩëÁ´ô</a></p>
</blockquote>
<hr>
<h2 id="0x00-Â§ßÂûãÈ°πÁõÆÁªìÊûÑ">0x00 Â§ßÂûãÈ°πÁõÆÁªìÊûÑ</h2>
<p>Âú®Â§ßÈÉ®ÂàÜÈù¢ÂêëÂàùÂ≠¶ËÄÖÁöÑ demo ‰∏≠ÔºåÂ∫îÁî®‰ª•ÁÆÄÂçïÁöÑÈ°πÁõÆÁªìÊûÑÁîöËá≥ÂçïÊñá‰ª∂Ë°®Á§∫„ÄÇÂú®Â§ßÂûãÈ°πÁõÆ‰∏≠ÔºåÁΩëÁ´ôÁöÑ‰∏çÂêåÂäüËÉΩË¢´ÊãÜÂàÜÊàêÁã¨Á´ãÁöÑÊ®°ÂùóÔºå‰ª•Êñπ‰æøÊãìÂ±ïÂíåÁª¥Êä§„ÄÇ‰∏Ä‰∏™Êõ¥ÈÄöÁî®ÁöÑ Flask È°πÁõÆ‰ª£Á†ÅÊû∂ÊûÑÂ¶Ç‰∏ãÔºöÔºà‰ªÖËÄÉËôë‰∏öÂä°‰ª£Á†ÅÔºâ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">microblog/ # Ê†πÁõÆÂΩï
</span></span><span class="line"><span class="cl">  app/ # È°πÁõÆÊ∫êÁ†Å
</span></span><span class="line"><span class="cl">    __init__.py # È°πÁõÆÂàùÂßãÂåñÔºåÂΩìËØ•ÂåÖË¢´importÔºåÈ¶ñÂÖàÊâßË°å__init__.py
</span></span><span class="line"><span class="cl">    routes.py
</span></span><span class="line"><span class="cl">    forms.py
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">  main.py # Ê°ÜÊû∂ÂÖ•Âè£
</span></span><span class="line"><span class="cl">  config.py # ConfigÈÖçÁΩÆÁ±ª
</span></span><span class="line"><span class="cl">  .flaskenv
</span></span><span class="line"><span class="cl">  ...
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ê†πÁõÆÂΩï‰∏ãÁöÑÊñá‰ª∂ÊúâÔºö</p>
<ul>
<li><code>app/</code>ÊâÄÊúâÁΩëÁ´ôÊ∫ê‰ª£Á†ÅÁªü‰∏ÄÂΩíÂà∞appÁõÆÂΩï‰∏ã„ÄÇ
<ul>
<li>Âú®<code>app/</code>ÂÜÖÈÉ®Ôºå‰∏çÂêåÁöÑÂäüËÉΩÂèØËøõ‰∏ÄÊ≠•ÂàíÂàÜÊàêÁã¨Á´ãÊ®°ÂùóÔºåËØ¶ËßÅ[Ê®°ÂùóÂåñÂ∫îÁî®](#0x05 Ê®°ÂùóÂåñÂ∫îÁî®ÔºöÂäüËÉΩËß£ËÄ¶)‰∏ÄÁ´†„ÄÇ</li>
</ul>
</li>
<li><code>main.py</code>: ÂÖ•Âè£ËÑöÊú¨ÔºåÈÄöËøáËØ•Êñá‰ª∂ÂºïÂÖ•app‰∏≠ÁöÑ‰ª£Á†ÅÂπ∂ÁîüÊàêÂ∫îÁî®ÂÆû‰æãÔºàÂëΩÂêçÈöèÊÑèÔºâ</li>
<li><code>.flaskenv</code>: flaskÁéØÂ¢ÉÂèòÈáèÔºå‰ª•ÈÖçÂêàflaskÂëΩ‰ª§„ÄÇÂÖ•Âè£ËÑöÊú¨Ë¢´ÂÆö‰πâ‰∏∫<code>FLASK_APP</code>ÔºåÊâßË°å<code>flask run</code>Êó∂Â∞ÜÂêØÂä®ËØ•ËÑöÊú¨„ÄÇ</li>
<li><code>config.py</code>: ÈÖçÁΩÆËÑöÊú¨ÔºåÊï¥‰∏™È°πÁõÆÁöÑÈÖçÁΩÆ‰ø°ÊÅØÈÉΩÂÜôÂú®ConfigÁ±ªÈáå„ÄÇ‰∏éÁéØÂ¢ÉÂèòÈáèÁöÑÂå∫Âà´Âú®‰∫éÔºåÂõ†‰∏∫ÊòØpythonËÑöÊú¨ÔºåÂäüËÉΩÊõ¥Âº∫Â§ßÔºåÂèØË¢´‰ªª‰ΩïÂú∞ÊñπÁöÑ‰ª£Á†ÅÂºïÁî®„ÄÇ</li>
</ul>
<h2 id="0x01-hello-worldÊ®°ÊùøÂíåËßÜÂõæ">0x01 Hello worldÔºöÊ®°ÊùøÂíåËßÜÂõæ</h2>
<p>ÊúÄÂü∫Êú¨ÁöÑ web ÂäüËÉΩÔºåÊó†ÈùûÊé•ÂèóËØ∑Ê±Ç„ÄÅËøîÂõûÊï∞ÊçÆ„ÄÇÂÖ∂‰∏≠ÔºåË∑ØÁî± (route) Áî®Êù•Âå∫ÂàÜ‰∏çÂêåÁöÑËØ∑Ê±ÇÔºåÊ®°Êùø (templates) Áî®Êù•ÁîüÊàê‰∏çÂêåÁöÑÊï∞ÊçÆ„ÄÇ</p>
<h4 id="Ë∑ØÁî±ËßÜÂõæ">Ë∑ØÁî±/ËßÜÂõæ</h4>
<p>Âú®ÈùûÂâçÂêéÁ´ØÂàÜÁ¶ªÁöÑÈ°πÁõÆ‰∏≠ÔºåËßÜÂõæÂáΩÊï∞Áõ¥Êé•ËøîÂõûÊ∏≤ÊüìÂ•ΩÁöÑÁΩëÈ°µÔºåÁî±<code>@app.route()</code>‰øÆÈ•∞ÂêéÔºåËßÜÂõæÂíåË∑ØÁî±‰æøÁªëÂÆöÂú®‰∏ÄËµ∑„ÄÇ
Âú®mvcÊ®°Âûã‰∏≠Êõ¥ÂÉècontrollerÊéßÂà∂Âô®ÁöÑËßíËâ≤ÔºåÁÑ∂ËÄåÂú®flaskÁîüÊÄÅ‰∏≠Êõ¥ÂñúÊ¨¢Áß∞‰∏∫ËßÜÂõæÂáΩÊï∞„ÄÇ</p>
<ul>
<li><code>url_for()</code> ‰ΩøÁî®URLÂà∞ËßÜÂõæÂáΩÊï∞ÁöÑÂÜÖÈÉ®Êò†Â∞ÑÂÖ≥Á≥ªÊù•ÁîüÊàêURLÔºåÁî®Êù•ÊõøÊç¢Á°¨ÈìæÊé•„ÄÇÂú®‰∏öÂä°ÂäüËÉΩËß£ËÄ¶ÂêéÂøÖÈ°ª‰ΩøÁî®ËøôÁßçÊñπÂºè„ÄÇ
<ul>
<li>NOTEÔºöÂΩìË∑ØÁî±ÂíåËßÜÂõæÂáΩÊï∞Âêç‰∏ç‰∏ÄËá¥ÔºåËÆøÈóÆËØ•Ë∑ØÁî±ÂèØ‰ª•Ê≠£Á°ÆÂìçÂ∫îÔºå‰ΩÜÊòØ‰ΩøÁî®<code>url_for()</code>Ë∞ÉÁî®ËØ•ËßÜÂõæÊó∂‰ºöÊä•Èîô</li>
</ul>
</li>
<li><code>{% extends &quot;base.html&quot; %}</code> and <code>{% include &quot;_post.html&quot; %}</code> ‰ΩøÁî®Â≠êÊ®°ÊùøÊù•ÂÆûÁé∞ÁΩëÈ°µÂÖ¨Áî®ÁöÑÈÉ®ÂàÜ„ÄÇÂ¶ÇÔºöÈ°µÁúâÔºåÈ°µËÑöÔºåÂàóË°®È°πÁ≠â„ÄÇ
<ul>
<li>Ê®°ÊùøÂíå Python ‰ª£Á†ÅÁöÑÂÖ≥Á≥ªÊúâ‰∫õÁ±ª‰ºº‰∏é JSP Âíå Java ‰ª£Á†ÅÁöÑÂÖ≥Á≥ªÔºå‰ΩÜÊ®°ÊùøËØ≠Ê≥ïÂπ∂‰∏çÊòØÂÆåÊï¥ÁöÑËÑöÊú¨ËØ≠Ë®ÄÔºåÁõ∏ËæÉËÄåË®ÄÈôêÂà∂Êõ¥Â§öÔºåÂÆâÂÖ®ÊÄßÊõ¥Â•Ω„ÄÇ</li>
</ul>
</li>
</ul>
<h4 id="Ë°®Âçï">Ë°®Âçï</h4>
<blockquote>
<p>Âá†‰πéÊâÄÊúâÊàêÂäüÁöÑÊ°ÜÊû∂ÈÉΩÊúâ‰∏∞ÂØåÁöÑÊèí‰ª∂ÁîüÊÄÅ„ÄÇ‰∏ãÈù¢ÂºïÂÖ•Êñ∞ÂäüËÉΩÊó∂ÔºåÂ§ßÂ§öÂÄüÂä©Êèí‰ª∂Êù•Êñπ‰æøÁöÑÂÆûÁé∞„ÄÇÂ§ßÂ§öÊï∞FlaskÊèí‰ª∂‰ΩøÁî®<code>flask_&lt;name&gt;</code> ÂëΩÂêçÁ∫¶ÂÆö„ÄÇ</p>
</blockquote>
<p>Flask-WTFÊèí‰ª∂Êèê‰æõ‰∫ÜÂØπWebË°®ÂçïÁöÑÊäΩË±°ÔºåÂè™ÈúÄÂÆö‰πâË°®ÂçïÁ±ª‰ª•ÂèäËÆæÁΩÆÁ±ªÂ±ûÊÄßÂç≥ÂèØ„ÄÇ</p>
<p>Ê®°ÊùøËØ≠Ê≥ïÔºö</p>
<ul>
<li><code>{{ form.&lt;name&gt;.label }}</code>Ê∏≤ÊüìÊ†áÁ≠æ</li>
<li><code>{{ form.&lt;name&gt;() }}</code>Ëé∑ÂèñÂ±ûÊÄßÂÄº</li>
<li><code>form.hidden_tag()</code>Ê®°ÊùøÂèÇÊï∞ÁîüÊàê‰∫Ü‰∏Ä‰∏™ÈöêËóèÂ≠óÊÆµÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∏Ä‰∏™Áî®‰∫é‰øùÊä§Ë°®ÂçïÂÖçÂèóCSRFÊîªÂáªÁöÑtoken</li>
</ul>
<p>Â∞ÜË°®ÂçïÂºïÂÖ•Ê®°Êùø</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">form</span> <span class="o">=</span> <span class="n">LoginForm</span><span class="p">()</span> <span class="c1"># ÁîüÊàê‰∫Ü‰∏Ä‰∏™ÂÆû‰æã‰º†ÂÖ•Ê®°Êùø</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;login.html&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Sign In&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="flash-Èó™Áé∞Ê∂àÊÅØ">flash Èó™Áé∞Ê∂àÊÅØ</h4>
<p>flash ÈÄöËøá session ÂÇ®Â≠òÔºåÁî®‰∫éÊòæÁ§∫Âè™Âá∫Áé∞‰∏ÄÊ¨°ÁöÑÊèêÁ§∫Ê∂àÊÅØ„ÄÇÁî®Ê≥ïÔºö</p>
<ul>
<li>Âú®Ë∑ØÁî±‰∏≠‰ΩøÁî®<code>flash()</code>ÔºåËß¶ÂèëÊó∂Ê∂àÊÅØ‰æøÂÜôÂÖ• session ‰∏≠ÁöÑ message ÂàóË°®</li>
<li>Âú®Ê®°Êùø‰∏≠‰ΩøÁî®<code>get_flashed_messages()</code>Ôºå‰ªé session ‰∏≠ËØªÂèñ</li>
</ul>
<h2 id="0x02-Êï∞ÊçÆÂ∫ì-orm">0x02 Êï∞ÊçÆÂ∫ì ORM</h2>
<p>Âæà‰πÖÂæà‰πÖ‰ª•ÂâçÔºåwebÁΩëÁ´ôÂíåÊï∞ÊçÆÂ∫ì‰∫§‰∫íËøòÈúÄË¶ÅÂÜôÂæàÂ§öÂæàÁ°¨ÁöÑ SQL ËØ≠Âè•ÔºåÊïàÁéá‰Ωé‰∏îÂÆπÊòìÂá∫Áé∞Ê≥®ÂÖ•ÊºèÊ¥û(SQLi)„ÄÇÁé∞‰ª£webÂºÄÂèëÈÉΩ‰ΩøÁî® ORM Ê°ÜÊû∂ÁÆÄÂåñÊï∞ÊçÆÂ∫ì‰∫§‰∫íÔºå‰∏îÂü∫Êú¨ÊùúÁªù‰∫Ü SQLi ÊºèÊ¥û„ÄÇ</p>
<p>Êú¨È°πÁõÆ‰ΩøÁî®Â¶Ç‰∏ãÊèí‰ª∂ÊâìÈÄöÊï∞ÊçÆÂ∫ìÔºö</p>
<ul>
<li>Flask-SQLAlchemy: PythonÁîüÊÄÅÊúÄÁü•ÂêçÁöÑORMÊ°ÜÊû∂</li>
<li>Flask-Migrate: Êú¨ÊïôÁ®ã‰ΩúËÄÖÁºñÂÜôÁöÑÊï∞ÊçÆÂ∫ìËøÅÁßªÊ°ÜÊû∂</li>
</ul>
<blockquote>
<p>Êèí‰ª∂È¶ñÂÖàË¶ÅÊ≥®ÂÜå„ÄÇÁªü‰∏ÄÊµÅÁ®ã: ÂàùÂßãÂåñappÂÆû‰æãÔºå‰º†ÂÖ•Êèí‰ª∂Á±ª‰Ωú‰∏∫Êèí‰ª∂ÂÆû‰æãÁöÑÂèÇÊï∞</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># app/__init__.py</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span> <span class="c1"># flaskÂü∫Á±ª</span>
</span></span><span class="line"><span class="cl"><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">Config</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">db</span> <span class="o">=</span> <span class="n">SQLAlchemy</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">migrate</span> <span class="o">=</span> <span class="n">Migrate</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">db</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></blockquote>
<h3 id="sqlalchemymodelÂ±Ç">SQLalchemyÔºömodelÂ±Ç</h3>
<h4 id="Ê®°ÂûãÂÆö‰πâ">Ê®°ÂûãÂÆö‰πâ</h4>
<p>‰ΩøÁî®Á±ªÂíåÁ±ªÂ±ûÊÄß‰ª£Ë°® table Âíå colunm Ôºå‰æøÂèØËΩªÊùæÁºñÂÜôÊï∞ÊçÆÊ®°Âûã„ÄÇSQLalchemy ÁöÑÊ¶ÇÂøµÊäΩË±°Â¶Ç‰∏ãÂõæÔºö
<img src="/p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99-the-flask-mega-tutorial/1631793936306.png"
	width="760"
	height="229"
	srcset="/p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99-the-flask-mega-tutorial/1631793936306_hu7f25cecc8aefde770917be517cb2f54b_27444_480x0_resize_box_3.png 480w, /p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99-the-flask-mega-tutorial/1631793936306_hu7f25cecc8aefde770917be517cb2f54b_27444_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="331"
		data-flex-basis="796px"
	
></p>
<p>Flask-SQLAlchemy Ëá™Âä®ËÆæÁΩÆÁ±ªÂêç‰∏∫Â∞èÂÜôÊù•‰Ωú‰∏∫ÂØπÂ∫îË°®ÁöÑÂêçÁß∞Ôºå‰πüÂèØ‰ª•Áî®<code>__tablename__</code>Á±ªÂ±ûÊÄßÊù•ÂÆö‰πâ„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Post</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span> <span class="c1"># Ë°®</span>
</span></span><span class="line"><span class="cl">    <span class="nb">id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Âàó</span>
</span></span><span class="line"><span class="cl">    <span class="o">....</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="curdÂü∫Êú¨Êìç‰Ωú">CURDÂü∫Êú¨Êìç‰Ωú</h4>
<p>ORM Ê°ÜÊû∂ÈÄöÂ∏∏ÈõÜÊàê‰∫ÜÂ∏∏Áî®Êìç‰ΩúÔºå‰ΩÜ‰πüÊîØÊåÅÊõ¥Â∫ïÂ±ÇÁöÑÊï∞ÊçÆÂ∫ìÊé•Âè£„ÄÇ</p>
<blockquote>
<p>Âú® Springboot Jpa ‰∏≠ÔºåÊ†πÊçÆÊñπÊ≥ïÂêçÁöÑÊãºÂÜôÊù•ÂÜôËá™ÂÆö‰πâÊü•ËØ¢ÔºåËÄåÂú® SQLalchemy ‰∏≠ÔºåÊèê‰æõÁöÑÊé•Âè£ÈÄöËøáÈìæÂºèË∞ÉÁî®ÊãºÊé•„ÄÇ</p>
</blockquote>
<p>Âú® SQLalchemy ‰∏≠ÔºåÂü∫Êú¨Êìç‰ΩúÂ§ßÈÉΩÊúâÂü∫‰∫é‰∫ãÂä° (session) ÁöÑÂíåÂü∫‰∫éÊü•ËØ¢ (query) ÁöÑ‰∏§ÁßçÊñπÂºè„ÄÇ</p>
<ul>
<li>
<p>Êü•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>queryÊñπÊ≥ïÂè™ÊúâÊûÑÈÄ†‰∏Ä‰∏™Êü•ËØ¢ÔºåÂè™ÊúâÂú®<code>Query.get()</code>„ÄÅ<code>Query.all()</code>„ÄÅ<code>Query.one()</code>Á≠âÁªìÊùüÁ¨¶‰πãÂêéÊâç‰ºöÊâßË°åÊü•ËØ¢</p>
</li>
<li>
<p>Â¢ûÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Âà†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># or</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Êîπ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">query</span> <span class="o">=</span> <span class="p">(</span><span class="n">session</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="n">User</span><span class="o">.</span><span class="n">username</span> <span class="o">+</span> <span class="s2">&#34;a&#34;</span><span class="p">},</span> <span class="n">synchronize_session</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># or</span>
</span></span><span class="line"><span class="cl"><span class="n">user</span> <span class="o">=</span> <span class="p">(</span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">User</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">user</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="s2">&#34;zxcv&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="flask-migrate-Êï∞ÊçÆÂ∫ìËøÅÁßª">Flask-Migrate: Êï∞ÊçÆÂ∫ìËøÅÁßª</h3>
<p>ÈÖçÁΩÆÊï∞ÊçÆÂ∫ìÁöÑÂàùÂßãÊï∞ÊçÆÊ°ÜÊû∂Ôºå‰∏ÄËà¨ÂÜôÊàêSQLËÑöÊú¨ÂΩ¢Âºè„ÄÇ
migrate Ê°ÜÊû∂Áõ¥Êé•Ê†πÊçÆ model Â±ÇÁîüÊàêËøÅÁßªËÑöÊú¨ÔºåÂèØ‰ª•Êñπ‰æøÁöÑË∑üË∏™Êï∞ÊçÆÊ®°ÂûãÁöÑ‰øÆÊîπÂíåÊï∞ÊçÆÂ∫ìÁöÑÂàáÊç¢„ÄÇÔºàËøô‰∏™Ê°ÜÊû∂ËøòÊòØÊú¨ÊïôÁ®ã‰ΩúËÄÖËá™Â∑±ÂºÄÂèëÁöÑÔºåÂº∫Ôºâ</p>
<p>flask dbÂ≠êÂëΩ‰ª§</p>
<ul>
<li><code>flask db init</code>ÔºöÂàùÂßãÂåñÔºåÁîüÊàêmigrationsÁõÆÂΩï</li>
<li><code>flask db migrate</code>ÔºöÁîüÊàêËøÅÁßªËÑöÊú¨Ôºå‰øÆÊîπmodelÂêé‰ΩøÂÖ∂ÁîüÊïà
<ul>
<li><code>flask db migrate -m &quot;posts table&quot; </code></li>
</ul>
</li>
<li><code>flask db upgrade</code>ÔºöÂ∫îÁî®Êï∞ÊçÆÂ∫ì‰øÆÊîπÔºàÂºÄÂèëÈò∂ÊÆµÈªòËÆ§‰ΩøÁî®sqliteÊï∞ÊçÆÂ∫ì</li>
<li><code>flask db downgrade</code>ÔºöÂõûÊªö‰∏äÊ¨°ÁöÑËøÅÁßª</li>
</ul>
<h2 id="0x03-ÂºÄÂèëËåÉÂºèÁî®Êà∑Á≥ªÁªü">0x03 ÂºÄÂèëËåÉÂºèÔºöÁî®Êà∑Á≥ªÁªü</h2>
<blockquote>
<p>mixinÔºöÊ∑∑ÂÖ•ÔºåÂ§öÈáçÁªßÊâøÁöÑ‰∏ÄÁßçÂΩ¢Âºè</p>
</blockquote>
<p>Ë°®ÂçïÂíåÊï∞ÊçÆÂ∫ìÊîØÊåÅÂàÜÂà´Ëß£ÂÜ≥‰∫ÜÂâçÁ´ØÂíåÂêéÁ´ØÁöÑÂü∫Êú¨ÈúÄÊ±ÇÔºå‰∏ãÈù¢ÂèØ‰ª•‰∏äÁ∫ø‰∏Ä‰∏™Âü∫Êú¨ÂäüËÉΩ‰∫ÜÔºåÁî®Êà∑ÁôªÂΩï„ÄÇ
ÊâÄÈúÄÊèí‰ª∂ÔºöFlask-Login„ÄÇ</p>
<h4 id="usermixinÁ±ª">UserMixinÁ±ª</h4>
<p>UserMixinÁ±ªÈõÜÊàê‰∫ÜloginÊèí‰ª∂Ë¶ÅÊ±ÇÁöÑÁî®Êà∑Ê®°ÂûãÂ±ûÊÄßÔºåÂ∞ÜÂÖ∂Ê∑∑ÂÖ•Âà∞ User Ê®°Âûã‰∏≠ÔºåÂç≥ÂèØÁî®<code>@login_required </code>ÂÆûÁé∞ÊùÉÈôêÊéßÂà∂„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@app.route(&#39;/result/&#39;, methods=[&#39;POST&#39;]) # NOTEÔºöÊúâÈ°∫Â∫èÂÖ≥Á≥ªÔºåÂèç‰πãÂàô‰∏çÁîüÊïà
</span></span><span class="line"><span class="cl">@login_required 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Áî®Êà∑Á≥ªÁªüÔºåÂåÖÊã¨ÁôªÂΩï„ÄÅÁôªÂá∫„ÄÅÊ≥®ÂÜåÂá†‰∏™ÂäüËÉΩ„ÄÇÁºñÂÜôËøô‰∫õÂäüËÉΩÁöÑÊ≠•È™§ÂÖ∂ÂÆûÂæàÁ±ª‰ººÔºö</p>
<ul>
<li>ËÆæËÆ°Êï∞ÊçÆÂ∫ìÔºåÂú®model.py‰∏≠</li>
<li>ËÆæËÆ°Ë°®ÂçïÂØπË±°ÔºåÂú®form.py‰∏≠</li>
<li>ËÆæËÆ°È°µÈù¢ÔºåÂú®Ê®°Êùø.html‰∏≠</li>
<li>ËÆæËÆ°ËßÜÂõæÂáΩÊï∞ÔºåÂú®routes.py‰∏≠</li>
</ul>
<p>‰πüÂØπÂ∫î‰∫ÜmvcÊ°ÜÊû∂ÁöÑËÆæËÆ°ÁêÜÂøµÔºåÊØîÂ¶ÇËÆæËÆ°Ë°®ÂçïÂ∞±Êúâ‰∫õÂÉè javaweb ‰∏≠ÁöÑ DAO Â±Ç„ÄÇ‰ΩÜ‰πüÊúâÂå∫Âà´Ôºå Flask Ê°ÜÊû∂Êõ¥Â∏åÊúõ‰∏öÂä°ÈÄªËæëÂÜôÂú®Êï∞ÊçÆÂ∫ìÊ®°Âûã‰∏≠ÔºåËÄåËßÜÂõæÂáΩÊï∞Â∞ΩÈáè‰øùÊåÅÁÆÄÊ¥ÅÔºå‰ª•Êñπ‰æøÂçïÂÖÉÊµãËØï„ÄÇ</p>
<h4 id="prg-Ê®°Âºè">PRG Ê®°Âºè</h4>
<p>Âç≥‰∏∫ <code>Post/Redirect/Get</code>ÔºåÂÖ∂Ê†ºÂºèÂ§ßÊ¶ÇÂ¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@bp.route</span><span class="p">(</span><span class="s1">&#39;/some_form&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">some_form</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># prepare forms </span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">validate_on_submit</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># submit modification</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;main.some_form&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">elif</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    	<span class="c1"># GET data</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;some_form.html&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈªòËÆ§ÊÉÖÂÜµÔºåÊèê‰∫§ POST ËØ∑Ê±ÇÂêéÔºåÂ¶ÇÊûúÁõ¥Êé•Âà∑Êñ∞ÊµèËßàÂô®Ôºå‰ºöÈáçÊñ∞Âú® POST ‰∏ÄÊ¨°„ÄÇ‰ΩøÁî®PRGÊ®°ÂºèÂç≥ÂèØËß£ÂÜ≥ÈáçÂ§çÊèê‰∫§Ë°®ÂçïÁöÑÈóÆÈ¢ò„ÄÇ</p>
<h2 id="0x04-Ê∑±ÂÖ•Êï∞ÊçÆÂ∫ìÁ≤â‰∏ùÊú∫Âà∂">0x04 Ê∑±ÂÖ•Êï∞ÊçÆÂ∫ìÔºöÁ≤â‰∏ùÊú∫Âà∂</h2>
<h3 id="Êï∞ÊçÆÂ∫ìÂÖ≥Á≥ª">Êï∞ÊçÆÂ∫ìÂÖ≥Á≥ª</h3>
<p>Ë¶ÅÂÖ≥Ê≥®Âà´‰∫∫ÔºåÂ∞±Ë¶ÅËÆ©Êï∞ÊçÆÂ∫ìËÆ∞‰ΩèÊàëÂÖ≥Ê≥®ÁöÑ‰∫∫ÁöÑÂêçÂ≠óÔºåÂΩìÁÑ∂ÔºåÂè™ËÆ∞‰ΩèÂêçÂ≠óËÇØÂÆö‰∏çÂ§üÔºå‰∏á‰∏ÄÊîπÂêç‰∫ÜÂë¢„ÄÇÂõ†Ê≠§ÊØè‰∏™Áî®Êà∑ÈÉΩÈúÄË¶ÅÊúâÂîØ‰∏ÄÊúâÊïàÁöÑÊ†áËØÜÔºàÂÖ∂ÂÆûÊõ¥ÈáçË¶ÅÁöÑÊòØÊÄßËÉΩÂõ†Á¥†Ôºâ„ÄÇÊ≠£Âõ†Â¶ÇÊ≠§ÔºåÊï∞ÊçÆÂ∫ì‰∏≠ÊØè‰∏™Ë°®ÈÉΩË¶ÅÊúâ‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑÂàóÔºåÁß∞‰∏∫<strong>‰∏ªÈîÆ</strong>(primary key)„ÄÇÂΩì‰∏çÂêåË°®‰πãÈó¥Â≠òÂú®ÂÖ≥Á≥ªÔºå‰∏Ä‰∏™Ë°®Ë¶ÅÈÄöËøá‰∏ªÈîÆÂØªÊâæÂÖ∂‰ªñË°®È°πÔºåÂÖ∂‰ªñË°®ÁöÑ‰∏ªÈîÆÂÇ®Â≠òÂú®Êú¨Ë°®‰∏≠ÔºåÁß∞‰∏∫<strong>Â§ñÈîÆ</strong>(foreign key)„ÄÇÂ§ñÈîÆÂÖ≥ËÅîÊó¢ÂèØ‰ª•Ë°®Á§∫‰∏ÄÂØπ‰∏ÄÁöÑÂÖ≥Á≥ªÔºå‰πüÂèØ‰ª•‰∏ÄÂØπÂ§ö(1-&gt;n)„ÄÇ</p>
<p>SQLalchemy ÂØπÂÖ≥Á≥ªÁöÑÂÆö‰πâÂ¶Ç‰∏ãÔºö</p>
<ul>
<li>Â§ñÈîÆÔºö<code>db.ForeignKey('user.id')</code></li>
<li>ÂÖ≥Á≥ªÔºö<code>db.relationship('Post', backref='author', lazy='dynamic')</code>
<ul>
<li>ÂèÇÊï∞1ÔºöÊâÄÂÖ≥ËÅîÁöÑË°®(n in 1-&gt;n)ÔºåËøôÈáåÊòØÊ®°ÂûãÁöÑÂèòÈáèÂêç</li>
<li>ÂèÇÊï∞2ÔºöÁî± &ldquo;n&rdquo; ÂõûË∞É &ldquo;1&rdquo; ÁöÑËôöÊãüÂ≠óÊÆµÔºåÁî®Ê≥ïÔºö<code>post.author</code></li>
</ul>
</li>
</ul>
<h3 id="Á≤â‰∏ùÊú∫Âà∂">Á≤â‰∏ùÊú∫Âà∂</h3>
<p>ÁÑ∂ËÄåÔºåÁ≤â‰∏ùÊú∫Âà∂ÂåÖÊã¨ÂÖ≥Ê≥®ÂíåË¢´ÂÖ≥Ê≥®„ÄÇËøôÊòØ‰∏ÄÁßçÂ§öÂØπÂ§öÁöÑÂÖ≥Á≥ªÔºå‰∫éÊòØÈúÄË¶ÅÁî®Âê´Êúâ‰∏§‰∏™Â§ñÈîÆÁöÑ<strong>ÂÖ≥ËÅîË°®</strong>Ë°®Á§∫„ÄÇÂèàÂõ†‰∏∫ÂÖ≥Ê≥®ËÄÖÂíåË¢´ÂÖ≥Ê≥®ËÄÖÂú®‰∏Ä‰∏™Ë°®ÈáåÔºàUserÔºâÔºåËøôÁßçÂÖ≥Á≥ªÂèàÁß∞‰∏∫<strong>Ëá™ÂºïÁî®</strong>„ÄÇ</p>
<h4 id="Ê®°Âûã">Ê®°Âûã</h4>
<ul>
<li>
<p>ÂÖ≥ËÅîË°®Âè™ÊúâÂºïÁî®Á±ªÂûãÔºåÊïÖ‰∏çÈúÄË¶ÅÊ¥æÁîüÊ®°ÂûãÁ±ª</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">followers</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;followers&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;follower_id&#39;</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&#39;user.id&#39;</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">    <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="s1">&#39;followed_id&#39;</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">db</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s1">&#39;user.id&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>‰∏∫UserÊ∑ªÂä†ÂÖ≥Á≥ª</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">followed</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">relationship</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">,</span> <span class="c1"># Âè≥‰æßÂÆû‰Ωì</span>
</span></span><span class="line"><span class="cl">    <span class="n">secondary</span><span class="o">=</span><span class="n">followers</span><span class="p">,</span> <span class="c1"># ÊåáÂÆöÂÖ≥ËÅîË°®</span>
</span></span><span class="line"><span class="cl">    <span class="n">primaryjoin</span><span class="o">=</span><span class="p">(</span><span class="n">followers</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">follower_id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">),</span> <span class="c1"># ÊåáÂÆöÂ∑¶ÂÖ≥Á≥ª</span>
</span></span><span class="line"><span class="cl">    <span class="n">secondaryjoin</span><span class="o">=</span><span class="p">(</span><span class="n">followers</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">followed_id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">),</span> <span class="c1"># ÊåáÂÆöÂè≥ÂÖ≥Á≥ª</span>
</span></span><span class="line"><span class="cl">    <span class="n">backref</span><span class="o">=</span><span class="n">db</span><span class="o">.</span><span class="n">backref</span><span class="p">(</span><span class="s1">&#39;followers&#39;</span><span class="p">,</span> <span class="n">lazy</span><span class="o">=</span><span class="s1">&#39;dynamic&#39;</span><span class="p">),</span> <span class="n">lazy</span><span class="o">=</span><span class="s1">&#39;dynamic&#39;</span><span class="p">)</span> <span class="c1"># ÊåáÂÆöÂõûË∞É</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h4 id="Â§çÊùÇÊü•ËØ¢">Â§çÊùÇÊü•ËØ¢</h4>
<ul>
<li>
<p>Êü•ËØ¢Á≤â‰∏ùÂàóË°®</p>
<ul>
<li>
<p>SQL ËØ≠Âè•Ôºö<code>SELECT * FROM  user, followers  WHERE followers.follower_id = 3 AND followers.followed_id = user.id</code></p>
</li>
<li>
<p>SQLalchemy Êé•Âè£Ôºö<code>user.followers.all()</code></p>
</li>
<li>
<p>ÂÆûÈôÖÊâßË°åÁöÑ SQL ËØ≠Âè•ÔºöÔºàÊâìÂç∞ query ÂØπË±°ÂæóÂà∞Ôºâ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">SELECT ,,,  FROM user, followers 
</span></span><span class="line"><span class="cl">WHERE followers.followed_id = ? AND followers.follower_id = user.id
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>NOTEÔºöÂ¶ÇÊûúÊñπÊ≥ïÈõÜÊàêÂú®modelÈáåÔºåÊñπÊ≥ïÂêç‰∏çË¶ÅÂíåÂ≠óÊÆµÂêçÁõ∏ÂêåÔºåËá™Â∑±ÂÆö‰πâÁöÑÊñπÊ≥ï‰ºöË¶ÜÁõñËØ•Â≠óÊÆµ„ÄÇ</p>
</li>
</ul>
</li>
<li>
<p>Êü•ÁúãÂ∑≤ÂÖ≥Ê≥®Áî®Êà∑ÁöÑÂä®ÊÄÅ</p>
<ul>
<li>
<p>SQL ËØ≠Âè•Ôºö<code>SELECT * FROM post JOIN followers on followers.followed_id = post.user_id where followers.follower_id = 2</code></p>
</li>
<li>
<p>SQLalchemy Êé•Âè£Ôºö</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="n">Post</span><span class="p">.</span><span class="n">query</span><span class="p">.</span><span class="k">join</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">followers</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">followers</span><span class="p">.</span><span class="k">c</span><span class="p">.</span><span class="n">followed_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Post</span><span class="p">.</span><span class="n">user_id</span><span class="p">)).</span><span class="n">filter</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">followers</span><span class="p">.</span><span class="k">c</span><span class="p">.</span><span class="n">follower_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">self</span><span class="p">.</span><span class="n">id</span><span class="p">).</span><span class="n">order_by</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">Post</span><span class="p">.</span><span class="k">timestamp</span><span class="p">.</span><span class="k">desc</span><span class="p">())</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>ÂÆûÈôÖÊâßË°åÁöÑSQLËØ≠Âè•Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="p">,,,</span><span class="w"> </span><span class="k">FROM</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="p">,,,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">FROM</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">followers</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">followers</span><span class="p">.</span><span class="n">followed_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">post</span><span class="p">.</span><span class="n">user_id</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">WHERE</span><span class="w"> </span><span class="n">followers</span><span class="p">.</span><span class="n">follower_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">FROM</span><span class="w"> </span><span class="n">post</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="k">WHERE</span><span class="w"> </span><span class="n">post</span><span class="p">.</span><span class="n">user_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">AS</span><span class="w"> </span><span class="n">anon_1</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">anon_1</span><span class="p">.</span><span class="n">post_timestamp</span><span class="w"> </span><span class="k">DESC</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<p>Áî±‰∫épythonÁöÑÂº±Á±ªÂûãÁâπÂæÅÔºåÊúâÊó∂ÂÄôÂæàÈöæÊòéÁôΩÂáΩÊï∞‰πãÈó¥‰º†ÈÄíÁöÑÊòØ‰ªÄ‰πàÂØπË±°„ÄÇÊàë‰ª¨‰ªé‰∏äÂæÄ‰∏ãÊ¢≥ÁêÜ‰∏ÄÈÅçÔºö</p>
<ul>
<li>ËØ∑Ê±ÇÂà∞ËææË∑ØÁî±ÂáΩÊï∞ÔºåÂºÄÂßãÊâßË°åÊü•ËØ¢<code>Post.query.....</code>ÔºåÊ≠§Êó∂Âè™ÊòØÂú®ÊûÑÈÄ†Êü•ËØ¢ÔºåÂπ∂Êú™ÂèñÂæóÊï∞ÊçÆÔºåÊ≠§Êó∂ÁöÑÂØπË±°Á±ªÂûãÔºö<code>&lt;class 'sqlalchemy.orm.query.Query'&gt;</code></li>
<li>Áõ¥Âà∞<code>get()</code>,<code>all()</code>,<code>paginate().items</code>ÁªìÊùüÁ¨¶Á≠âÂá∫Áé∞ÔºåÊü•ËØ¢ÊâçË¢´ÊâßË°åÔºåËøîÂõûÊï∞ÊçÆÁ±ªÂûãÂÆû‰æãÔºåÂ¶ÇUser„ÄÇ</li>
<li>Êï∞ÊçÆÁ±ªÂÆû‰æã‰º†ÂÖ•Ê®°ÊùøÔºåÂπ∂Áî±<code>__str__</code>Á≠âÊñπÊ≥ïÂèÇ‰∏éÊ∏≤Êüì„ÄÇ</li>
</ul>
<h2 id="0x05-ÁΩëÁ´ôÁæéÂåñ">0x05 ÁΩëÁ´ôÁæéÂåñ</h2>
<p>Êú¨ÊïôÁ®ãÊèê‰æõÁöÑflask-bootstrapÊèí‰ª∂ÔºåËæÉ‰∏∫ÁÆÄÈôãÔºå‰∏îËØ•Êèí‰ª∂Âπ¥‰πÖÂ§±‰øÆÔºåÈÅÇÊõøÊç¢‰πã„ÄÇÂú®Ê≠§‰πãÂâçÔºåÂÖàÊêûÊòéÁôΩÁõÆÂâçÈ°πÁõÆÂâçÁ´ØÁöÑÊû∂ÊûÑ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/templates
</span></span><span class="line"><span class="cl">   auth/
</span></span><span class="line"><span class="cl">   errors/
</span></span><span class="line"><span class="cl">   base.html
</span></span><span class="line"><span class="cl">   _posts.html
</span></span><span class="line"><span class="cl">   index.html
</span></span><span class="line"><span class="cl">   ... 
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊâÄÊúâÊ®°ÊùøÈÉΩÊúâ‰∏Ä‰∏™Áà∂Ê®°ÁâàÔºö<code>base.html</code>ÔºåÂÖ∂ÁªìÊûÑÂ¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">{% extends &#39;bootstrap/base.html&#39; %}
</span></span><span class="line"><span class="cl">{% block title %}Hallo Wolrd{% endblock %}
</span></span><span class="line"><span class="cl">{% block head %} ... {% endblock %}
</span></span><span class="line"><span class="cl">{% block scripts %} ... {% endblock %}
</span></span><span class="line"><span class="cl">{% block navbar %} ... {% endblock %}
</span></span><span class="line"><span class="cl">{% block content %}
</span></span><span class="line"><span class="cl">    ...
</span></span><span class="line"><span class="cl">    {% block app_content %}{% endblock %}
</span></span><span class="line"><span class="cl">{% endblock %}
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>app_content</code>ÁïôÁ©∫ÔºåÂç≥ÂÖ∂‰ΩôÊ®°ÊùøÂùáÂú®<code>app_content</code>ÂÜÖÂ°´ÂÖÖ„ÄÇ</p>
<p>Ëøõ‰∏ÄÊ≠•ËøΩÊ∫Ø<code>bootstrap/base.html</code>ÁöÑÊ∫êÁ†ÅÔºåÂèëÁé∞ÂÖ∂ÂÆÉ block ËØ∏Â¶Ç<code>navbar</code>‰πüÈÉΩÁïôÁ©∫Êàñ‰ªÖ‰ªÖÈÖçÁΩÆ‰∫Ü Bootstrap ÁöÑ cdn„ÄÇ Áî±Ê≠§ÔºåÂè™ÈúÄÂ∞Ü<code>base.html</code>ËøÅÁßªÂç≥ÂèØ„ÄÇ</p>
<p>Âú®ÁΩë‰∏äÂØªÊâæÊñ∞ÁöÑUIÊ®°ÊùøÔºå‰∏çË¶ÅÂú®‰∏≠Êñá‰∫íËÅîÁΩëÊêúÁ¥¢Ôºåbasically garbage„ÄÇÊâæÂà∞‰∏Ä‰∏™ <a class="link" href="https://demos.creative-tim.com/material-kit/index.html"  target="_blank" rel="noopener"
    >Meterial Ê®°Êùø</a> ËøòÁÆóÈ°∫ÁúºÔºåÈÅÇÁî®‰πã„ÄÇ</p>
<p>‰∏çÁÜüÊÇâ Bootstrap Â∏ÉÂ±ÄÁöÑÂèØ‰ª•‰ΩøÁî®ÂèØËßÜÂåñÂ∑•ÂÖ∑Êù•ËÆæËÆ°ÂâçÁ´ØÔºåÂ¶ÇÔºöhttp://www.ibootstrap.cn/</p>
<p>ÂØπÁÖßÊ®°ÊùøÔºåÂ∞Ü<code>base.html</code>ÊéèÁ©∫ÔºåÊïàÊûúÂ¶Ç‰∏ãÔºö</p>
<p><img src="/post-images/1631795716824.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>ÈÅáÂà∞ÁöÑbugÊúâÔºö</p>
<ul>
<li>‰∏ãÊãâËèúÂçïÂ§±ÊïàÔºöÊü•ËØ¢ÂæóÁü•ÊúâÂèØËÉΩÊòØbootstrapÁâàÊú¨ÂÜ≤Á™Å
<ul>
<li>//ÁªìÊûúÂπ∂‰∏çÊòØÔºåÂè™ÊòØÂøòËÆ∞ÂºïÂÖ•jsÊñá‰ª∂ËÄåÂ∑≤ÔºåÊàëÊòØÂÇªÈÄº„ÄÇ</li>
</ul>
</li>
<li>Êñá‰ª∂‰∏ä‰º†ÊåâÈíÆÊ∂àÂ§±ÔºöÊú¨ÊïôÁ®ã‰∏≠ÔºåË°®ÂçïÊ∏≤ÊüìÈááÁî®<code>wtf.quick_form()</code>ÔºåËøôÁé©ÊÑèËøòÊòØÊù•Ëá™<code>bootstrap/wtf.html</code></li>
</ul>
<p>ÊúÄÂêéÂÜ≥ÂÆöÊï¥‰∏™üêè‰∫Ü Flask-Bootstrap Êèí‰ª∂„ÄÇ</p>
<h4 id="ÂØåÊñáÊú¨ÁºñËæëÂô®">ÂØåÊñáÊú¨ÁºñËæëÂô®</h4>
<p>Âú®„ÄäFlask WebÂºÄÂèëÔºöÂü∫‰∫éPythonÁöÑWebÂ∫îÁî®ÂºÄÂèëÂÆûÊàò„Äã‰∏≠ÊèêÂà∞‰∫ÜmarkdownÁºñËæëÂô®ÁöÑÂÆûÁé∞„ÄÇ</p>
<p>ÈúÄË¶ÅÁöÑÂåÖÔºö</p>
<ul>
<li>PageDown: JS Áâà Markdown Ê∏≤ÊüìÂô®ÔºåÁî®‰∫éÂÆ¢Êà∑Á´ØÈ¢ÑËßà„ÄÇ</li>
<li>Flask-PageDown: flask ÈõÜÊàêÊèí‰ª∂„ÄÇËØ•Êèí‰ª∂ÈúÄË¶ÅÊ≥®ÂÜå</li>
<li>Markdown: Python Áâà Markdown Ê∏≤ÊüìÂô®ÔºåÁî®‰∫éÊúçÂä°Á´ØÊ∏≤Êüì„ÄÇ</li>
<li>Bleach: HTML Ê∏ÖÁêÜÂô®Ôºå‰øùËØÅÂÆâÂÖ®ÊÄß</li>
</ul>
<p>‰∏∫‰∫ÜÂÖºÈ°æÂÆâÂÖ®ÂíåÊïàÁéáÔºåÂÅöÊ≥ïÊòØÂêåÊó∂‰øùÂ≠ò markdown Ê∫êÊñáÊú¨Âíå HTML Êñá‰ª∂„ÄÇÊ≠•È™§Â¶Ç‰∏ãÔºö</p>
<ul>
<li>Ë°®ÂçïÊîπ‰∏∫ <code>PageDownField</code></li>
<li>Ê®°ÊùøÂºïÂÖ• PageDown ÂÆèÔºå‰ª•ÂÆûÁé∞Âç≥Êó∂È¢ÑËßà</li>
<li>‰∏∫ Post Ê®°ÂûãÂ¢ûÂä†Â≠óÊÆµÔºåÂπ∂Ê∑ªÂä† markdown Ê∏≤ÊüìÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ï‰∏∫Á±ªÊñπÊ≥ïÔºåÈúÄË¶Å<code>@staticmethod</code>‰øÆÈ•∞</li>
<li>Âú®Ê®°ÂûãÂ§ñÈÉ®ÁõëÂê¨Êï∞ÊçÆÂ∫ì‰∫ã‰ª∂Ôºå‰ªÖÂΩì markdown ÊñáÊú¨Âá∫Áé∞ÂèòÂä®Êó∂Ë∞ÉÁî®Ê∏≤ÊüìÊñπÊ≥ï„ÄÇ</li>
<li>‰øÆÊîπÊ®°Êùø‰ª•ÊòæÁ§∫ÊúçÂä°Á´ØËøîÂõûÁöÑ html ÊñáÊú¨</li>
</ul>
<p>ÁÑ∂ËÄåÈ¢ÑËßàÂô®Ëøá‰∫éÁÆÄÈôãÔºå‰πüÂæàÈöæ‰øÆÊîπ„ÄÇÂú®github‰ªìÂ∫ì‰∏äÂèëÁé∞ËØ•Êèí‰ª∂‰πüÊòØÊú¨ÊïôÁ®ã‰ΩúËÄÖÂÜôÁöÑÔºåÂ∑≤ÁªèÂæà‰πÖÊ≤°ÊúâÁª¥Êä§„ÄÇÈ°øÊó∂ÂØπÊú¨‰π¶‰ΩúËÄÖÊúâ‰∫õ‰∏çÊª°„ÄÇ</p>
<h2 id="0x06-Ê®°ÂùóÂåñÂ∫îÁî®ÂäüËÉΩËß£ËÄ¶">0x06 Ê®°ÂùóÂåñÂ∫îÁî®ÔºöÂäüËÉΩËß£ËÄ¶</h2>
<p>‰øùÊåÅ app ‰Ωú‰∏∫ÂÖ®Â±ÄÂèòÈáèÁöÑÊ®°ÂºèÔºåÂèØËÉΩ‰ºöÁªôÂêéÁª≠ÂºïÂÖ•Êñ∞ÂäüËÉΩÂíåÂçïÂÖÉÊµãËØïÂ∏¶Êù•È∫ªÁÉ¶„ÄÇ
Ë¶ÅÈÄÇÂ∫îÂ§ßÂûãÈ°πÁõÆÈúÄÊ±ÇÔºåÈúÄË¶ÅÊääÁΩëÁ´ôÂäüËÉΩÊãÜÂàÜÊàêÁã¨Á´ãÁöÑÊ®°Âùó„ÄÇ</p>
<h3 id="blueprintÂåñ">BlueprintÂåñ</h3>
<p>Ë¶ÅÂÆûÁé∞Ëß£ËÄ¶Ôºå‰∏ÄÁßçÂäüËÉΩÁöÑÁõ∏ÂÖ≥‰ª£Á†ÅÂèØ‰ª•ÂÄüÂä©BlueprintÂΩíÁ±ªÂà∞‰∏Ä‰∏™ÂåÖÈáå„ÄÇÂÖ∂Êñá‰ª∂ÁªìÊûÑÂ§ßËá¥Â¶Ç‰∏ãÔºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">app/ 
</span></span><span class="line"><span class="cl">    some_fuction/                       &lt;-- blueprint package
</span></span><span class="line"><span class="cl">        __init__.py                     &lt;-- blueprint creation
</span></span><span class="line"><span class="cl">        ... other code ...
</span></span><span class="line"><span class="cl">    templates/
</span></span><span class="line"><span class="cl">        some_fuction/                   &lt;--  templates
</span></span><span class="line"><span class="cl">    __init__.py                         &lt;-- blueprint registration
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂàõÂª∫blueprint‰∏éÂàõÂª∫Â∫îÁî®ÈùûÂ∏∏Áõ∏‰ºº„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Blueprint</span>
</span></span><span class="line"><span class="cl"><span class="n">bp</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s1">&#39;func&#39;</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">app.func</span> <span class="kn">import</span> <span class="n">Func</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËÄåÊ∂àÁÅ≠‰∫Ü<code>app</code>ÔºåËìùÂõæÂÜÖÈÉ®ÁöÑÂºïÁî®Áªü‰∏ÄÂèòÊàê‰∫ÜËìùÂõæÂêç„ÄÇËÄåÂ§ñÈÉ®ËØ∏Â¶Ç<code>url_for</code>ÁöÑÂèÇÊï∞ÂàôÈúÄË¶ÅÂä†‰∏ä<code>ÂåÖÂêç.</code>ÂÅöÂâçÁºÄ„ÄÇ</p>
<h3 id="Â∫îÁî®Â∑•ÂéÇÊ®°Âºè">Â∫îÁî®Â∑•ÂéÇÊ®°Âºè</h3>
<p>Â∑•ÂéÇÂáΩÊï∞ÊòØ‰∏Ä‰∏™Â§ñÈÉ®ÂáΩÊï∞ÔºåÂú®Ëøô‰∏™ÂáΩÊï∞ÂÜÖÈÉ®ÊâßË°åÊèí‰ª∂Ê≥®ÂÜåÂíåÈÖçÁΩÆÂ∑•‰ΩúÔºåÂπ∂ÈÄöËøá‰ªñËøîÂõûÂ∫îÁî®ÂÆû‰æã„ÄÇ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># app/__init__.py</span>
</span></span><span class="line"><span class="cl"><span class="n">db</span> <span class="o">=</span> <span class="n">SQLAlchemy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ...</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">create_app</span><span class="p">(</span><span class="n">config_class</span><span class="o">=</span><span class="n">Config</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">config_class</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">db</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># ...</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ËøîÂõûÂêéÔºåflaskÊèê‰æõÁöÑ‰∏ä‰∏ãÊñáÂØπË±°<code>current_app</code>Â∞ÜÊåáÂêëÂ∫îÁî®ÂÆû‰æã„ÄÇËØ¶ËßÅÂÆòÊñπÊñáÊ°£Ôºö<a class="link" href="http://docs.jinkan.org/docs/flask/appcontext.html"  target="_blank" rel="noopener"
    >Â∫îÁî®‰∏ä‰∏ãÊñá</a></p>
<h4 id="Â§öÁ∫øÁ®ã">Â§öÁ∫øÁ®ã</h4>
<p><code>current_app</code>ÊòØÁ∫øÁ®ãÁªëÂÆöÁöÑÔºåËã•Ë¶ÅÂú®ËØ∏Â¶ÇÈÇÆ‰ª∂ÊúçÂä°ÁöÑ‰Ωç‰∫éÂÖ∂‰ªñÁ∫øÁ®ãÁöÑÂäüËÉΩË∞ÉÁî®‰ªñÔºåÂàô‰ºöÂèëÁé∞Ê≤°ÊúâËµãÂÄº„ÄÇ
ÈúÄË¶Å‰ΩøÁî®<code>current_app._get_current_object()</code>Ë°®ËææÂºè„ÄÇ</p>
<h4 id="pythonÊ¶ÇÂøµËæ®ÊûêÂåÖÂ∫ìÊèí‰ª∂">PythonÊ¶ÇÂøµËæ®ÊûêÔºöÂåÖÔºåÂ∫ìÔºåÊèí‰ª∂</h4>
<blockquote>
<p>ÂåÖ (package) ÊòØÊåá‰∏ÄÁßç‰ª£Á†ÅÁªìÊûÑÔºåÂè™Ë¶ÅÊúâÊñá‰ª∂Â§πÂíå <code>__init__.py</code> ÈÉΩÊòØÂåÖ„ÄÇ
Â∫ì (library) ÂíåÊèí‰ª∂ (plugin) ÈÉΩÊòØ‰ªéÂ§ñÈÉ®ÂºïÂÖ•ÁöÑÂåÖÔºåÂå∫Âà´Âú®‰∫éÔºåÊèí‰ª∂Ë¶ÅÈõÜÊàêËøõÂ∫îÁî®ÔºåÊâÄ‰ª•ÈúÄË¶ÅÊ≥®ÂÜåÁ≠âÊ≠•È™§ÔºõËÄåÂ∫ìÊõ¥Áã¨Á´ãÔºåÂèØ‰ª•ÈöèÊó∂ÈöèÂú∞Ë∞ÉÁî®</p>
</blockquote>
<h2 id="0x07-ÂºÄÂèëÂ∏ÆÊâã">0x07 ÂºÄÂèëÂ∏ÆÊâã</h2>
<p>Êú¨ËäÇËÆ≤Ëß£‰∏Ä‰∫õÊùÇÈ°π„ÄÇ</p>
<h4 id="Ë∞ÉËØï">Ë∞ÉËØï</h4>
<ul>
<li><code>flask shell</code>ÂëΩ‰ª§Ôºö‰∏∫ÈÅøÂÖçÊØèÊ¨°Ë∞ÉËØïÈÉΩË¶ÅÈáçÊñ∞import appÔºå‰ΩøÁî®‰∏ä‰∏ãÊñáË∞ÉÁî®Ëß£ÈáäÂô®ÔºåÁî®<code>@app.shell_context_processor</code>Ë£ÖÈ•∞‰∏ä‰∏ãÊñáÂáΩÊï∞</li>
</ul>
<h4 id="ÂçïÂÖÉÊµãËØï">ÂçïÂÖÉÊµãËØï</h4>
<p>unittest Â∫ìÔºåËØ¶ËßÅ<a class="link" href="" >‰∏ã‰∏ÄÁØá</a>„ÄÇ</p>
<h4 id="ËÆ∞ÂΩïÊó•ÂøóÂà∞Êñá‰ª∂">ËÆ∞ÂΩïÊó•ÂøóÂà∞Êñá‰ª∂</h4>
<p>logger Â∫ì</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">app</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;logs&#39;</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s1">&#39;logs&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">file_handler</span> <span class="o">=</span> <span class="n">RotatingFileHandler</span><span class="p">(</span><span class="s1">&#39;logs/microblog.log&#39;</span><span class="p">,</span> <span class="n">maxBytes</span><span class="o">=</span><span class="mi">10240</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                           <span class="n">backupCount</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> </span><span class="si">%(levelname)s</span><span class="s1">: </span><span class="si">%(message)s</span><span class="s1"> [in </span><span class="si">%(pathname)s</span><span class="s1">:</span><span class="si">%(lineno)d</span><span class="s1">]&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        <span class="n">file_handler</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Microblog startup&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="requirementtxt">requirement.txt</h4>
<p>Ë£ÖÁöÑÂ∫ìÂ§™Â§öÊÄé‰πàÂäûÔºüÂè™ÈúÄË¶Å‰∏§Êù°ÂëΩ‰ª§Ôºö</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pip freeze &gt; requirements.txt
</span></span><span class="line"><span class="cl">pip install -r requirements.txt
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="0x08-ÁΩëÁ´ô‰∏äÁ∫ø">0x08 ÁΩëÁ´ô‰∏äÁ∫ø</h2>
<p>ÊúÄÂêéÁÆÄÂçïÂàóÂá∫Âá†ÁßçÁΩëÁ´ôÈÉ®ÁΩ≤ÁöÑÊñπÊ≥ïÔºåËØ¶ÊÉÖÂèÇËÄÉÊú¨ÊïôÁ®ãÊàñËá™Ë°åÊêúÁ¥¢„ÄÇ</p>
<h4 id="nativeÊ®°Âºè">nativeÊ®°Âºè</h4>
<ul>
<li>‰π∞‰∏ªÊú∫
<ul>
<li>Ëøû‰∏ªÊú∫Ôºössh</li>
</ul>
</li>
<li>‰π∞ÂüüÂêç
<ul>
<li>ÈÖçÂüüÂêç</li>
</ul>
</li>
<li>ÈÖçÁéØÂ¢É
<ul>
<li>Êï∞ÊçÆÂ∫ì</li>
<li>ÊúçÂä°Âô®</li>
<li>ÂÖ∂‰ªñ‰æùËµñ</li>
</ul>
</li>
<li>ÊåÅÁª≠ËøêÁª¥</li>
</ul>
<h4 id="ÂÆπÂô®ÂåñÊäÄÊúØdocker">ÂÆπÂô®ÂåñÊäÄÊúØÔºödocker</h4>
<ul>
<li>ÂÜôdockerfile</li>
<li>docker-compose up &ndash;build -d</li>
</ul>
<h4 id="‰∫ëÊäÄÊúØpaas">‰∫ëÊäÄÊúØÔºöPaaS</h4>
<ul>
<li>Ê≥®ÂÜå‰∫ëÂπ≥Âè∞Ë¥¶Êà∑</li>
<li>ÂÜôProcfile</li>
<li>git push</li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/flask/">flask</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99%E4%BA%8C-flask-supreme-tutorial/">
        
        

        <div class="article-details">
            <h2 class="article-title">Âπ¥ËΩª‰∫∫ÁöÑÁ¨¨‰∫å‰∏™ÁΩëÁ´ôÔºà‰∫åÔºâ - flask-supreme-tutorial</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/%E9%97%B2%E6%9D%A5%E6%97%A0%E4%BA%8B%E5%80%92%E8%85%BE%E5%8D%9A%E5%AE%A2/">
        
        

        <div class="article-details">
            <h2 class="article-title">Èó≤Êù•Êó†‰∫ãÔºåÂÄíËÖæÂçöÂÆ¢</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="lonelyuan/giscus-comment"
    data-repo-id="R_kgDOK1hIpw"
    data-category="Announcements"
    data-category-id="DIC_kwDOK1hIp84Cbey0"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="zh-CN"
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark_dimmed');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2023 lonelyuan&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.20.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
