<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>lonelyuan's Blog</title><link>https://lonelyuan.github.io/</link><description>Recent content on lonelyuan's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Thu, 05 Oct 2023 00:00:03 +0000</lastBuildDate><atom:link href="https://lonelyuan.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>CSAPP - Proxylab</title><link>https://lonelyuan.github.io/p/csapp-proxylab/</link><pubDate>Thu, 05 Oct 2023 00:00:03 +0000</pubDate><guid>https://lonelyuan.github.io/p/csapp-proxylab/</guid><description>&lt;p>æŒ‚æ¢¯å­æ¯ä¸ªäººéƒ½çŽ©è¿‡ï¼Œä½†ä½ çŸ¥é“æ¢¯å­çš„åŽŸç†å—ã€‚æœ€åŽä¸€ä¸ªlabï¼Œå®žçŽ°ä¸€ä¸ªHTTPä»£ç†æœåŠ¡å™¨ã€‚æœ¬å®žéªŒéš¾åº¦ç›¸å¯¹å‰é¢ä¸¤ä¸ªlabæœ‰æ‰€ä¸‹é™ï¼Œä½†ç»¼åˆæ€§æ¯”è¾ƒå¼ºï¼Œæ¶‰åŠæ•™ææœ€åŽä¸‰ç« çš„æ‰€æœ‰å†…å®¹ä»¥åŠmallocå’Œcacheä¸¤ä¸ªlabã€‚&lt;/p>
&lt;h2 id="é¡¹ç›®ç»“æž„">é¡¹ç›®ç»“æž„&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- csapp.c /*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- csapp.h * è¿™ä¸‰ä¸ªæ–‡ä»¶æ˜¯é¡¹ç›®ä¸»ä½“ï¼Œå¯ä»¥éšæ„ä¿®æ”¹
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- proxy.c */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- driver.sh # æµ‹è¯„è„šæœ¬
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- free-port.sh /*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- nop-server.py * å·¥å…·è„šæœ¬
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- port-for-user.pl */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">`-- tiny
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |-- cgi-bin/ # åŠ¨æ€ç¨‹åº
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |-- static/ # é™æ€æ–‡ä»¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |-- csapp.c /*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |-- csapp.h * è¯¾æœ¬ä¸­æåˆ°çš„tinyå®žçŽ°ï¼Œå»ºè®®è¯¦ç»†é˜…è¯»
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> `-- tiny.c */
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="csappc">csapp.c&lt;/h3>
&lt;p>&lt;code>csapp.c&lt;/code>å’Œ&lt;code>csapp.h&lt;/code>æ˜¯è¯¾æœ¬åŽä¸‰ç« æåˆ°çš„å‡½æ•°ä»£ç å®žä¾‹ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å‡ ç»„å‡½æ•°å®žçŽ°ï¼š&lt;/p>
&lt;ul>
&lt;li>è¿›ç¨‹æŽ§åˆ¶ï¼š&lt;code>Fork()&lt;/code>,&lt;code>Execve()&lt;/code>,&lt;code>Wait()&lt;/code>,&lt;code>Kill()&lt;/code>,&lt;code>Sleep()&lt;/code>,&lt;code>Pause()&lt;/code>&amp;hellip;&lt;/li>
&lt;li>ä¿¡å·æŽ§åˆ¶ï¼š&lt;code>Signal()&lt;/code>,&lt;code>Sigprocmask()&lt;/code>,&lt;code>Sig***set()&lt;/code>&lt;/li>
&lt;li>I/Oæ“ä½œï¼š&lt;code>Open()&lt;/code>,&lt;code>Read()&lt;/code>,&lt;code>Write()&lt;/code>,&lt;code>Lseek()&lt;/code>,&lt;code>Close()&lt;/code>&amp;hellip;
&lt;ul>
&lt;li>Signal-safe I/O&lt;/li>
&lt;li>Standard I/O&lt;/li>
&lt;li>Robust I/O&lt;/li>
&lt;li>ç›®å½•æ“ä½œï¼š&lt;code>Opendir()&lt;/code>,&lt;code>Readdir()&lt;/code>,&lt;code>Closedir()&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åŠ¨æ€å†…å­˜åˆ†é…ï¼š&lt;code>Malloc()&lt;/code>,&lt;code>Realloc()&lt;/code>,&lt;code>Calloc()&lt;/code>,&lt;code>Free()&lt;/code>
&lt;ul>
&lt;li>å†…å­˜æ˜ å°„ï¼š&lt;code>Mmap()&lt;/code>,&lt;code>Nunmap()&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>SocketæŽ¥å£ï¼š&lt;code>Socket()&lt;/code>,&lt;code>Bind()&lt;/code>,&lt;code>Listen()&lt;/code>,&lt;code>Accept()&lt;/code>,&lt;code>Connect()&lt;/code>
&lt;ul>
&lt;li>ç½‘ç»œä¿¡æ¯ï¼š&lt;code>Getaddrinfo()&lt;/code>,&lt;code>Gethostbyname()&lt;/code>,&lt;code>Inet_ntop()&lt;/code>&amp;hellip;&lt;/li>
&lt;li>å¯é‡å…¥æŽ¥å£ï¼š&lt;code>Open_clientfd()&lt;/code>,&lt;code>Open_listenfd()&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Pthreadså¤šçº¿ç¨‹ï¼š&lt;code>create()&lt;/code>,&lt;code>join()&lt;/code>,&lt;code>cancel()&lt;/code>,&lt;code>detach()&lt;/code>,&lt;code>exit()&lt;/code>,&lt;code>self()&lt;/code>,&lt;code>once()&lt;/code>&lt;/li>
&lt;li>POSIXä¿¡å·é‡ï¼š&lt;code>Sem_init()&lt;/code>,&lt;code>P()&lt;/code>,&lt;code>V()&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>è¿™ä¹Ÿå¤ªå¤šäº†8ã€‚å®žé™…ä¸Šè¿™äº›éƒ½æ˜¯ç³»ç»Ÿå‡½æ•°çš„å°è£…ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦ç”¨åˆ°æ‰€æœ‰å‡½æ•°ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæœ¬å®žéªŒå°†åŽä¸‰ç« è®²è¿°çš„å†…å®¹å…¨éƒ¨æŠ›å‡ºï¼Œè®©æˆ‘ä»¬è‡ªå·±æ€è€ƒå¹¶é€‰ç”¨è¿™äº›å·¥å…·æ¥å®Œæˆç›®æ ‡ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥éšæ„ä¿®æ”¹è¿™äº›å°è£…æˆ–è€…ç›´æŽ¥ä½¿ç”¨ç³»ç»ŸæŽ¥å£ã€‚&lt;/p>
&lt;h3 id="tinyc">tiny.c&lt;/h3>
&lt;p>æ­¤å¤–ï¼Œtinyç›®å½•ä¸‹ä¹Ÿæœ‰ç›¸åŒçš„&lt;code>csapp.c&lt;/code>å’Œ&lt;code>csapp.h&lt;/code>ï¼Œè€Œ&lt;code>tiny.c&lt;/code>æ˜¯è¯¾æœ¬ä¸Šæåˆ°çš„ç®€æ˜“webæœåŠ¡å™¨å®žçŽ°ï¼ŒäºŽæ˜¯æˆ‘ä»¬å¯ä»¥å°†å…¶ä½œä¸ºproxyçš„åˆå§‹ä»£ç æ¡†æž¶ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">**&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">listenfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">connfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">hostname&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">socklen_t&lt;/span> &lt;span class="n">clientlen&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="n">sockaddr_storage&lt;/span> &lt;span class="n">clientaddr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">listenfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Open_listenfd&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientlen&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientaddr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">connfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">listenfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">SA&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientaddr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientlen&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Getnameinfo&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">SA&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientaddr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientlen&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">hostname&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Accepted from (%s, %s)&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">hostname&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">doit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">connfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">connfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>SocketæŽ¥å£æ˜¯ä¸€åˆ‡ç½‘ç»œç¨‹åºçš„åº•å±‚ï¼Œæœ‰å…³socketæ¨¡åž‹è¯·éšä¾¿æœç´¢é‚£ä¸€å¼ æµç¨‹å›¾å¹¶ç†Ÿè®°äºŽå¿ƒï¼ˆæˆ–è€…å‚è€ƒ&lt;a class="link" href="https://lonelyuan.github.io/p/%E4%BB%8Escapy%E5%92%8Cwireshark%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#guidelines" target="_blank" rel="noopener"
>ðŸ‘´çš„æ–‡ç« &lt;/a>ï¼‰ã€‚è¿™é‡Œç®€å•æ€»ç»“ä¸€ä¸‹è¦ç‚¹ï¼š&lt;/p>
&lt;ul>
&lt;li>åœ°å€æ ‡è®°ä¸»æœºï¼Œç«¯å£æ ‡è®°è¿›ç¨‹ã€‚&lt;/li>
&lt;li>å®¢æˆ·ç«¯æ‰§è¡Œ&lt;code>Connect()&lt;/code>ï¼ŒæœåŠ¡å™¨æ‰§è¡Œ&lt;code>Bind()&lt;/code>,&lt;code>Listen()&lt;/code>,&lt;code>Accept()&lt;/code>ã€‚&lt;/li>
&lt;li>unixç³»ç»Ÿä¸­ä¸€åˆ‡çš†æ–‡ä»¶ï¼Œæ‰“å¼€çš„æ–‡ä»¶é€šè¿‡æ–‡ä»¶æè¿°ç¬¦fdæ ‡è®°ã€‚&lt;/li>
&lt;li>ç½‘ç»œè¿žæŽ¥ä¹Ÿæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå³&lt;code>Socket()&lt;/code>ä¹Ÿè¿”å›žä¸€ä¸ªfdã€‚&lt;/li>
&lt;li>äºŽæ˜¯å¯¹è¯¥fdä½¿ç”¨ä¼ ç»ŸI/Oå‡½æ•°å³å¯è¿›è¡Œé€šä¿¡å†…å®¹çš„è¯»å†™ã€‚æœ¬è´¨ä¸Šå°±æ˜¯è¯»å†™Socketæä¾›çš„ç¼“å†²åŒº&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>äºŽæ˜¯æœåŠ¡å™¨éœ€è¦ç»´æŠ¤&lt;code>listenfd&lt;/code>,&lt;code>connfd&lt;/code>ä¸¤ä¸ªfdåˆ†åˆ«ä»£è¡¨ç›‘å¬ç«¯å£å’Œå®¢æˆ·ç«¯ç«¯å£ã€‚
è€ŒæœåŠ¡å™¨æ˜¯ä¸€ä¸ªéœ€è¦é•¿ä¹…è¿è¡Œçš„ç¨‹åºï¼Œå› æ­¤ä»–çš„æ ¸å¿ƒè¿›ç¨‹å¾€å¾€è¿è¡Œç€ä¸€ä¸ªæ­»å¾ªçŽ¯ï¼Œä¹Ÿç§°ä¸ºä¸»äº‹ä»¶å¾ªçŽ¯ã€‚
åœ¨å¾ªçŽ¯ä¸­æœåŠ¡å™¨ä¸æ–­æŽ¥å—ç€å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼ŒäºŽæ˜¯&lt;code>connfd&lt;/code>åœ¨å¾ªçŽ¯ä¸­ä¸æ–­åœ°åˆ›å»ºå’Œé”€æ¯ï¼Œè€Œ&lt;code>listenfd&lt;/code>ä¿æŒä¸å˜ã€‚
è€Œå…·ä½“åˆ°å•ä¸ªè¯·æ±‚çš„å¤„ç†ï¼Œtinyå°†å…¶äº¤ç»™äº†&lt;code>doit()&lt;/code>å‡½æ•°ã€‚å…¶åŠŸèƒ½åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š&lt;/p>
&lt;ul>
&lt;li>ä»Žç¼“å†²åŒºä¸­è¯»å–HTTPæŠ¥æ–‡
&lt;ul>
&lt;li>tinyåªé’ˆå¯¹GETè¯·æ±‚åšå‡ºå“åº”&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è¯»ç¬¬ä¸€è¡Œï¼Œåˆ¤æ–­HTTPæ–¹æ³•&lt;/li>
&lt;li>è¯»å–å¤„ç†å‰©ä½™çš„HTTPé¦–éƒ¨&lt;/li>
&lt;li>åˆ¤æ–­è¯·æ±‚çš„æ˜¯é™æ€æ–‡ä»¶è¿˜æ˜¯åŠ¨æ€ç¨‹åºï¼ˆcgi-binï¼‰
&lt;ul>
&lt;li>é™æ€è¯·æ±‚ï¼Œè¯»å–æ–‡ä»¶å†…å®¹&lt;/li>
&lt;li>åŠ¨æ€è¯·æ±‚ï¼Œè°ƒç”¨cgiç¨‹åº&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ­¤å¤–ï¼Œé¢å¯¹é”™è¯¯æƒ…å†µè¦è¿”å›žç›¸åº”çš„çŠ¶æ€ç ï¼Œè€ŒæœåŠ¡å™¨è¿›ç¨‹ä¸èƒ½ç»“æŸã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="å¾—åˆ†ç‚¹">&lt;strong>å¾—åˆ†ç‚¹&lt;/strong>&lt;/h3>
&lt;ul>
&lt;li>BasicCorrectness: 40 ï¼ˆåŸºæœ¬ä»£ç†ï¼‰&lt;/li>
&lt;li>Concurrency: 15 ï¼ˆå¹¶å‘æ€§ï¼‰&lt;/li>
&lt;li>Cache: 15 ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰&lt;/li>
&lt;/ul>
&lt;h2 id="part1-basic-proxy">Part1: Basic Proxy&lt;/h2>
&lt;p>proxyåœ¨clienté¢å‰æ‰®æ¼”æœåŠ¡å™¨ï¼Œåœ¨serveré¢å‰æ‰®æ¼”å®¢æˆ·ç«¯ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨proxyä¸­éœ€è¦åŒæ—¶å®žçŽ°è¿™ä¸¤ä¸ªåŠŸèƒ½ï¼Œè€Œtinyå·²ç»æœ‰äº†æœåŠ¡å™¨ç«¯çš„å®žçŽ°ï¼Œæ•…è€Œåªéœ€è¦è€ƒè™‘å®¢æˆ·ç«¯çš„å®žçŽ°å³å¯ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> â”Œâ”€â”€â”€â”€â”€â”€â” (2) â”Œâ”€â”€â”€â”€â”€â” (1) â”Œâ”€â”€â”€â”€â”€â”€â”
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚â—„â”€â”€â”€â”€â”€â”€â”¤ â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚Serverâ”‚ (3) â”‚Proxyâ”‚ (4) â”‚Clientâ”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”œâ”€â”€â”€â”€â”€â”€â–ºâ”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å…·ä½“æ¥è¯´ï¼Œåªéœ€è¦ä¿®æ”¹doitå‡½æ•°ã€‚é¦–å…ˆå»ºç«‹æœ€ç®€å•çš„æ¨¡åž‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// v0.1: score 16/40
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="nf">doit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">cfd&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">response&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (1) client -&amp;gt; proxy */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">read_req&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (2) proxy -&amp;gt; server */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Open_clientfd&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">request&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (3) server -&amp;gt; proxy */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">read_res&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">response&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (4) proxy -&amp;gt; client */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">response&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">response&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>read_req()&lt;/code>å’Œ&lt;code>read_res()&lt;/code>å°è£…äº†ä»ŽRioç¼“å†²åŒºè¯»å–æŠ¥æ–‡çš„ç»†èŠ‚ã€‚ä¸‹é¢è¯¦ç»†ä»‹ç»ï¼š&lt;/p>
&lt;h3 id="åœ¨clienté¢å‰æ‰®æ¼”server">åœ¨clienté¢å‰æ‰®æ¼”server&lt;/h3>
&lt;p>å¯¹äºŽè¯·æ±‚æŠ¥æ–‡ï¼Œé¦–å…ˆéœ€è¦è§£æžå‡ºåœ°å€å’Œç«¯å£ä»¥ä¾¿æ‰¾åˆ°ç›®çš„æœåŠ¡å™¨ï¼Œå…¶æ¬¡éœ€è¦æ³¨æ„&lt;code>curl --proxy&lt;/code>çš„ç¬¬ä¸€è¡Œå‘åŒ…ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">GET http://localhost:81/ HTTP/1.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œè·¯å¾„å˜æˆäº†æœåŠ¡å™¨çš„å®Œæ•´åœ°å€ï¼Œç›´æŽ¥ä¸¢ç»™tinyæ˜¯ä¼šæŠ¥404çš„ã€‚å› æ­¤ï¼ŒðŸ‘´ç›´æŽ¥å¯¹ç¬¬ä¸€è¡Œæå–host,port,pathã€‚ï¼ˆæ³¨æ„åˆ†æ¸…&lt;code>sscanf()&lt;/code>å’Œ&lt;code>sprintf()&lt;/code>ï¼‰&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">read_req&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">message&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">rio_t&lt;/span> &lt;span class="n">rio&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_readinitb&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">rio&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXBUF&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">host_port_path&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="n">host_port&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">path_line&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Receive: &amp;#34;GET http://host:port/path HTTP/1.1&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nf">Rio_readlineb&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">rio&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;GET %s HTTP/1.1&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host_port_path&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host_port_path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;http://%[^/]%s&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host_port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host_port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;%[^:]:%s&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;80&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Send: &amp;#34;GET /path HTTP/1.1&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nf">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path_line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;GET %s HTTP/1.1&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">strcat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path_line&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_readlineb&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">rio&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">strcat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="åœ¨serveré¢å‰æ‰®æ¼”client">åœ¨serveré¢å‰æ‰®æ¼”client&lt;/h3>
&lt;p>å¯¹äºŽå“åº”æŠ¥æ–‡ï¼Œåˆ™éœ€è¦è€ƒè™‘åŒ…ä½“é•¿åº¦é—®é¢˜ã€‚ä»£ç ä¸­è®¾ç½®äº†&lt;code>MAXBUF&lt;/code>å¸¸é‡ä¸º8192ï¼Œåœ¨æµ‹è¯„è„šæœ¬ä¸­æœ‰å‡ ä¸ªæ ·ä¾‹æ˜¯è¿œè¶…è¿‡è¿™ä¸ªæ•°å­—çš„ã€‚å› æ­¤éœ€è¦è€ƒè™‘æµå¼ä¼ è¾“ï¼Œä¸€è¾¹æŽ¥å—ä¸€è¾¹å‘é€ã€‚äºŽæ˜¯&lt;code>doit()&lt;/code>ä¹Ÿéœ€è¦è¿›è¡Œä¿®æ”¹&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// v0.2: score 40/40
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="nf">doit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">cfd&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">res_buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXBUF&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (1) client -&amp;gt; proxy */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">read_req&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (2) proxy -&amp;gt; server */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Open_clientfd&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">request&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (3) server -&amp;gt; proxy */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">n&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Rio_readn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">res_buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span> &lt;span class="n">res_buf&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (4) proxy -&amp;gt; client */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">res_buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="part2-concurrency">Part2: Concurrency&lt;/h2>
&lt;p>åœ¨å¹¶å‘æ€§æµ‹è¯•ä¸­ï¼Œæµ‹è¯„è„šæœ¬ä¼šè°ƒç”¨&lt;code>nop-server.py&lt;/code>ï¼Œå…¶æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-py" data-lang="py">&lt;span class="line">&lt;span class="cl">&lt;span class="n">serversocket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">channel&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">details&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">serversocket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">accept&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">continue&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œnop-serveråœ¨æŽ¥å—è¯·æ±‚ä¹‹åŽä¼šè¿›å…¥æ­»å¾ªçŽ¯ï¼Œä¹Ÿå°±æ˜¯è¯´è¿žæŽ¥è¢«æ°¸è¿œé˜»å¡žäº†ã€‚è¿™è¦æ±‚proxyèƒ½å¤ŸåŒæ—¶æŽ¥å—å¤šä¸ªè¿žæŽ¥ã€‚Pthreadåº“çš„å¤šçº¿ç¨‹æŽ¥å£è¾ƒä¸ºç®€å•ï¼Œåªéœ€è¦å°†ä¸»äº‹ä»¶å¾ªçŽ¯ä¸­æ’å…¥&lt;code>Pthread_create()&lt;/code>ï¼Œè€Œ&lt;code>doit()&lt;/code>åˆ™è¢«å°è£…è¿›çº¿ç¨‹çš„å…¥å£å‡½æ•°ä¸­ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// v0.3 55/70
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nf">Pthread_create&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">tid&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kr">thread&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">connfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">thread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Pthread_detach&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">pthread_self&lt;/span>&lt;span class="p">());&lt;/span> &lt;span class="c1">// è®¾ç½®ä¸ºå¯åˆ†ç¦»çŠ¶æ€ï¼Œè‡ªåŠ¨å›žæ”¶èµ„æº
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nf">doit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="part3-cache">Part3: Cache&lt;/h2>
&lt;p>åœ¨ç¼“å­˜æµ‹è¯•ä¸­ï¼Œæµ‹è¯„è„šæœ¬ä¼šåœ¨æ‰§è¡Œè¿‡ä¸€å®šçš„è¯·æ±‚ä¹‹åŽæ€æ­»tinyæœåŠ¡å™¨ï¼Œè¦æ±‚æœåŠ¡å™¨å¯¹ä¹‹å‰çš„è¯·æ±‚è¿›è¡Œä¿å­˜ã€‚ç»“åˆä¸Šä¸€æ­¥çš„å¤šçº¿ç¨‹ï¼Œè¿™é‡Œä¾¿å­˜åœ¨ç€å¹¶å‘è¯»å†™çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>è€Œç¼“å­˜çš„å®žçŽ°ç»†èŠ‚æœ‰éžå¸¸å¤šå¯è¯´çš„éƒ¨åˆ†ï¼Œè¿™é‡Œé¦–å…ˆæŠ½è±¡å‡ºæŽ¥å£ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// v0.4 70/70
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="nf">doit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">cfd&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">response&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (1) client -&amp;gt; proxy */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">read_req&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (1.1) proxy -&amp;gt; cache */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">read_cache&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (1.2) cache -&amp;gt; client */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (2) proxy -&amp;gt; server */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">n&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Open_clientfd&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">request&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (3) server -&amp;gt; proxy */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXBUF&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">res&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAX_CACHE_SIZE&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Rio_readn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (4) proxy -&amp;gt; client */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">strncat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (4.1) proxy -&amp;gt; cache */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">write_cache&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">res&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å…·ä½“åˆ°ç¼“å­˜è®¾è®¡è¿™é‡Œå¯ä»¥è‡ªç”±å‘æŒ¥ã€‚å¦‚æžœé¢å‘è¯„æµ‹è„šæœ¬ç¼–ç¨‹ï¼Œåªéœ€è¦ç¼“å­˜å®¹é‡ä¸º3ï¼Œè¿žç¼“å­˜åˆ é™¤çš„ç­–ç•¥éƒ½ä¸ç”¨å®žçŽ°å°±å¯ä»¥æ»¡åˆ†ã€‚ä¸è¿‡è€ƒè¯•å°±è€ƒè¿™ä¸ªLRUã€OPTå•¥çš„ï¼Œè¿˜æ˜¯å¾—ç†è§£ä¸€ä¸‹ã€‚&lt;/p>
&lt;p>ä¸‹é¢æ˜¯ðŸ‘´è®©gptå†™çš„åŸºäºŽå¾ªçŽ¯é“¾è¡¨çš„LRUç­–ç•¥çš„ç¼“å­˜ç³»ç»Ÿï¼š&lt;/p>
&lt;ul>
&lt;li>æ•°æ®ç»“æž„&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="k">typedef&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="n">CacheEntry&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">next&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">prev&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">typedef&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">size&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">capacity&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">head&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">tail&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">pthread_mutex_t&lt;/span> &lt;span class="n">lock&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span> &lt;span class="n">Cache&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>åˆå§‹åŒ–&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="n">Cache&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nf">createCache&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">capacity&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Cache&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">cache&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">Cache&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="nf">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Cache&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">capacity&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">capacity&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_init&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>è¯»ç¼“å­˜&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nf">read_cache&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Cache&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_lock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ç›¸åŒçš„ key
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">current&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">head&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">current&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_unlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">current&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">next&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_unlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>å†™ç¼“å­˜&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">write_cache&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Cache&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// åˆå§‹åŒ–Entry
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">entry&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="nf">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">CacheEntry&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">entry&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">key&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">strdup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">entry&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">strdup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">entry&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">next&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">entry&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">prev&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_lock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æŸ¥æ‰¾æ˜¯å¦å·²å­˜åœ¨ç›¸åŒçš„ key
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">current&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">head&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">current&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="c1">// æ›´æ–°å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nf">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">strdup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_unlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">current&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">next&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æ’å…¥æ–°èŠ‚ç‚¹åˆ°é“¾è¡¨å¤´éƒ¨
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">entry&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">next&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">head&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">head&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">head&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">prev&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">entry&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">tail&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">entry&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">head&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">entry&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å¦‚æžœè¶…è¿‡å®¹é‡é™åˆ¶ï¼Œåˆ é™¤å°¾éƒ¨èŠ‚ç‚¹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">size&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">capacity&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">tail&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">tail&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">tail&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">tail&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">prev&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">tail&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">next&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tail&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tail&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tail&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_unlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¯„ä»·ï¼šæœ€åŽä¸€ä¸ªå®žéªŒæ»¡åˆ†çš„è¦æ±‚è¿˜æ˜¯å¾ˆä½Žçš„ã€‚ç”±äºŽcè¯­è¨€ç¼–ç¨‹å®žåœ¨ç¹çï¼ŒðŸ‘´è¿™ä¸ªå®žéªŒè¿½æ±‚çš„æ˜¯æ»¡åˆ†å‰æä¸‹çš„ä»£ç æžç®€ä¸»ä¹‰ã€‚&lt;/p>
&lt;h2 id="ç»“æŸäº†å—">ç»“æŸäº†å—&lt;/h2>
&lt;p>å®žé™…ä¸Šï¼Œç”Ÿäº§çº§ä»£ç†æœåŠ¡å™¨éœ€è¦è€ƒè™‘çš„è¿œæ¯”æœ¬å®žéªŒå¤æ‚å‡ ä¸ªæ•°é‡çº§ï¼Œåœ¨æ­¤æå‡ºå‡ ä¸ªæ€è·¯ä»¥æŠ›ç –å¼•çŽ‰ï¼š&lt;/p>
&lt;ul>
&lt;li>å®Œå¤‡çš„åè®®æ”¯æŒï¼š
&lt;ul>
&lt;li>tinyä»…æ”¯æŒGETæ–¹æ³•ï¼Œä¸”ä¸æ”¯æŒè¯·æ±‚å¤´ï¼Œè¿™å®žé™…ä¸Šæ˜¯è¢«ç§°ä¸ºHTTP 0.9çš„ä¸€ä¸ªåŽ†å²ç‰ˆæœ¬ã€‚è€Œç›®å‰æœ€å¹¿æ³›ä½¿ç”¨çš„HTTP 1.1ï¼Œä¸ºäº†å®žçŽ°å¯¹å®ƒçš„å…¼å®¹ï¼Œéœ€è¦å®žçŽ°ä»¥ä¸‹ç‰¹æ€§ï¼š
&lt;ul>
&lt;li>å¢žåŠ HEADã€POSTæ–¹æ³•ï¼Œæ”¯æŒå¤´åŸŸï¼ˆHTTP 1.0ä¸­è¢«å¼•å…¥ï¼‰&lt;/li>
&lt;li>æ”¯æŒ&lt;code>Keep-Alive&lt;/code>å¤´ï¼Œæ»¡è¶³httpè¯·æ±‚é‡ç”¨tcpè¿žæŽ¥&lt;/li>
&lt;li>æ”¯æŒ&lt;code>Transfer-Encoding: chunked&lt;/code>å¤´ï¼Œå®žçŽ°åˆ†å—ä¼ è¾“ç¼–ç ï¼Œæ»¡è¶³å¤§æ–‡ä»¶è¯·æ±‚çš„éœ€æ±‚&lt;/li>
&lt;li>æ”¯æŒ&lt;code>Accept-Ranges&lt;/code>å¤´ï¼Œå®žçŽ°å­—èŠ‚èŒƒå›´è¯·æ±‚&lt;/li>
&lt;li>æ”¯æŒè¯·æ±‚æµæ°´çº¿ç­‰å…¶ä»–ç‰¹æ€§&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è™½ç„¶å®žçŽ°HTTPåè®®æ˜¯æœåŠ¡å™¨çš„ä»»åŠ¡ï¼Œä½†æ˜¯å¯¹ä»£ç†æœåŠ¡å™¨çš„ç¨³å¥æ€§æå‡ºäº†æ›´é«˜çš„è¦æ±‚ã€‚&lt;/li>
&lt;li>å¦å¤–ï¼Œæœ¬å®žéªŒå®žçŽ°çš„proxyåŸºæœ¬ä¸Šæ˜¯æ˜Žæ–‡httpä»£ç†ã€‚ç„¶è€Œåœ¨å®žé™…åº”ç”¨ä¸­httpsæ‰æ˜¯æ›´å¸¸ç”¨çš„åè®®ã€‚ä¸ºæ­¤ä»£ç†éœ€è¦å®žçŽ°å¯¹SSLçš„æ”¯æŒã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ›´é«˜çš„æ€§èƒ½
&lt;ul>
&lt;li>æˆ‘ä»¬å®Œå…¨å¯ä»¥è‡ªå·±ä¿®æ”¹è¯„åˆ†è„šæœ¬ï¼ŒæŠŠå¯¹ç¼“å­˜çš„è€ƒå¯Ÿä¸Šç‚¹å¼ºåº¦ã€‚ä¸ºäº†æ»¡è¶³æ›´é«˜çš„æ€§èƒ½ï¼Œéœ€è¦æ›´é«˜æ•ˆçš„æ•°æ®ç»“æž„ï¼Œå¦‚ï¼š
&lt;ul>
&lt;li>ä½¿ç”¨ä¿¡å·é‡ä»£æ›¿äº’æ–¥é”ï¼Œä½¿ç”¨è¯»è€…å†™è€…æ¨¡åž‹&lt;/li>
&lt;li>ä½¿ç”¨å“ˆå¸Œè¡¨ï¼Œçº¢é»‘æ ‘ç­‰é«˜çº§æ•°æ®ç»“æž„ï¼Œæé«˜æŸ¥è¯¢é€Ÿåº¦&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä»Žæ›´å®žé™…çš„å¼€å‘çš„è§’åº¦ï¼Œä¸å¿…å°†ç›®å…‰å±€é™äºŽcè¯­è¨€ã€‚æœ‰å¤§é‡çš„å…¶ä»–è¯­è¨€ç”Ÿæ€çš„é«˜æ€§èƒ½åº“ä¾›æˆ‘ä»¬æŒ‘é€‰ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åŠ å¯†ä¼ è¾“
&lt;ul>
&lt;li>ä¿å¯†æ€§ä¹Ÿæ˜¯ä¸€ä¸ªé‡è¦éœ€æ±‚ã€‚æ›´å¸¸è§çš„ä»£ç†æž¶æž„æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½è¿è¡Œç€ä»£ç†æœåŠ¡å™¨è¿›ç¨‹ï¼Œåœ¨æœ¬åœ°ä»£ç†å’Œè¿œç¨‹ä»£ç†ä¹‹é—´è¿è¡Œç€ç§æœ‰çš„åŠ å¯†é€šä¿¡åè®®ã€‚(Shadowsocks(R), VMess/VLess, Trojan&amp;hellip;)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è·¯ç”±è§„åˆ™
&lt;ul>
&lt;li>æœ¬åœ°ä»£ç†ç»Ÿç®¡ç€æ‰€æœ‰å‡ºç½‘æµé‡ï¼Œä½†å®¢æˆ·ç«¯ä¸å¸Œæœ›æ‰€æœ‰è¯·æ±‚éƒ½ç»è¿‡ä»£ç†ã€‚ä¸ºæ­¤éœ€è¦ä¸ºä¸åŒç›®æ ‡çš„æµé‡è®¾è®¡ä¸åŒçš„è·¯ç”±è§„åˆ™ã€‚&lt;/li>
&lt;li>å¦ä¸€æ–¹é¢ï¼Œå®¢æˆ·ç«¯è¿˜å¸Œæœ›ç®¡ç†å¤šä¸ªä»£ç†æœåŠ¡å™¨(clash)&lt;/li>
&lt;li>VPNå’Œä»£ç†æœåŠ¡å™¨åŽŸç†ä¸åŒï¼ŒVPNæ˜¯å¦‚ä½•å®žçŽ°è·¯ç”±çš„ï¼Ÿ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>çŒ«é¼ æ¸¸æˆ
&lt;ul>
&lt;li>æƒ³è±¡ä½ æ˜¯å±€åŸŸç½‘ç®¡ç†å‘˜ï¼Œä½ è§‚å¯Ÿåˆ°ç½‘ç»œä¸­æŸäº›IPçš„å¤§éƒ¨åˆ†æµé‡éƒ½é›†ä¸­è‡³ä¸€ä¸ªå¤–éƒ¨IPçš„ç‰¹å®šé«˜ä½ç«¯å£ï¼Œä½ èƒ½å¦åˆ¤æ–­è¿™äº›IPå­˜åœ¨å¼‚å¸¸è¡Œä¸ºï¼Ÿ&lt;/li>
&lt;li>ä½ è§‚å¯Ÿåˆ°æŸäº›IPçš„æµé‡ä¸å†é€šå¾€é«˜ä½ç«¯å£äº†ï¼Œåè€Œéƒ½æ˜¯é€šå¾€443ç«¯å£çš„httpsæµé‡ï¼Œè¯¥å¤–éƒ¨IPè¿è¡Œç€ä¸€ä¸ªç®€å•çš„ç½‘ç«™ï¼Œå¦‚ä½•åˆ¤æ–­ï¼Ÿ&lt;/li>
&lt;li>è¯¦æƒ…è‡ªè¡Œæœç´¢ç›¸å…³è®ºæ–‡ã€‚&lt;del>å…³é”®è¯ï¼šGFW&lt;/del>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>libAFLé€Ÿé€šFuzzing101 (3)</title><link>https://lonelyuan.github.io/p/libafl-fuzzing101-3/</link><pubDate>Wed, 02 Aug 2023 02:00:36 +0800</pubDate><guid>https://lonelyuan.github.io/p/libafl-fuzzing101-3/</guid><description>&lt;blockquote>
&lt;p>æœ¬ç³»åˆ—æ˜¯å­¦ä¹ &lt;a class="link" href="https://epi052.gitlab.io/notes-to-self/blog/2021-11-01-fuzzing-101-with-libafl/" target="_blank" rel="noopener"
>ã€ŠFuzzing101 with LibAFLã€‹&lt;/a>ç³»åˆ—åšå®¢ï¼ˆåŽæ–‡ç»Ÿç§°ï¼šåŽŸåšå®¢ï¼‰çš„ç¬”è®°åˆ†äº«ï¼Œåœ¨å­¦ä¹ ä»‹ç» LibAFL ç”¨æ³•çš„åŒæ—¶æ€»ç»“ Rust çŸ¥è¯†ç‚¹ã€‚&lt;br>
&lt;strong>å‰ç½®çŸ¥è¯†&lt;/strong>ï¼š fuzzåŸºæœ¬æ¦‚å¿µã€AFLåŸºæœ¬ä½¿ç”¨ &lt;br>
&lt;strong>æœ¬ç¯‡è¦ç‚¹&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>LibAFL
&lt;ul>
&lt;li>Forkserveræ¨¡å¼: Sugar API&lt;/li>
&lt;li>AFL toolsï¼šafl-cminã€optminã€afl-tminã€afl-cov&lt;/li>
&lt;li>å­—æ®µå›ºå®š&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Rust
&lt;ul>
&lt;li>Builder&lt;/li>
&lt;li>clap&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h2 id="execise-3">Execise-3&lt;/h2>
&lt;h3 id="source--corpus">source &amp;amp; corpus&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># tcpdump&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://github.com/the-tcpdump-group/tcpdump/archive/refs/tags/tcpdump-4.9.1.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar -xzvf tcpdump-4.9.1.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv tcpdump-tcpdump-4.9.1 tcpdump
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm tcpdump-4.9.1.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># tcpdumpçš„ä¾èµ–pcap&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://github.com/the-tcpdump-group/libpcap/archive/refs/tags/libpcap-1.8.0.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar -xzvf libpcap-1.8.0.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv libpcap-libpcap-1.8.0/ libpcap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm libpcap-1.8.0.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç”¨scapyç”Ÿæˆcorpus&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## åŽŸæ–‡ä½¿ç”¨poetry,ç›´æŽ¥pipä¹Ÿå¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pip install scapy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">python create-bootp.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æœ¬ç¯‡æ²¡ç”¨åˆ°qemuï¼Œä½†ä¾ç„¶éœ€è¦è¿™ä¸ªä¾èµ–&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt-get install -y ninja-build
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="makefiletoml">Makefile.toml&lt;/h3>
&lt;p>è¿˜æ˜¯ç†Ÿæ‚‰çš„é…æ–¹ï¼Œè¿˜æ˜¯ç†Ÿæ‚‰çš„&lt;code>cargo make build&lt;/code>ã€‚è¿˜æ˜¯ä¸ç†Ÿæ‚‰çš„bugã€‚ã€‚ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">dependencies&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;build-cargo&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;copy-project-to-build&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;build-libpcap&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;build-tcpdump&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-cargo&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">command&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;cargo&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">args&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;build&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;--release&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">copy-project-to-build&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">script&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">mkdir -p build/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">cp ../target/release/exercise-3 build/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">sudo setcap cap_sys_admin+epi build/exercise-3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-libpcap&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">env&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="s2">&amp;#34;CC&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;afl-clang-lto&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;LLVM_CONFIG&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;llvm-config-15&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;AFL_MAP_SIZE&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;86217&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;AFL_USE_ASAN&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cwd&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;libpcap&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">script&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">./configure --enable-shared=no --prefix=&amp;#34;&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">CARGO_MAKE_WORKING_DIRECTORY&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="nx">build&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="s2">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make install
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-tcpdump&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cwd&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;tcpdump&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">script&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">./configure --prefix=&amp;#34;&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">CARGO_MAKE_WORKING_DIRECTORY&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="nx">build&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="s2">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make install
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">sudo setcap cap_sys_admin+epi ../build/sbin/tcpdump
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">mkdir -p ../solutions
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-tcpdump&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">env&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;CC&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;afl-clang-lto&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;LLVM_CONFIG&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;llvm-config-15&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;AFL_USE_ASAN&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;AFL_MAP_SIZE&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;86217&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;CFLAGS&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;-I${CARGO_MAKE_WORKING_DIRECTORY}/../build/include/&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;LDFLAGS&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;-L${CARGO_MAKE_WORKING_DIRECTORY}/../build/lib/&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="è¡¥å……linuxä¸­çš„capabilityæœºåˆ¶">è¡¥å……ï¼šLinuxä¸­çš„Capabilityæœºåˆ¶&lt;/h5>
&lt;p>åªæœ‰rootå’Œæ™®é€šè¿›ç¨‹çš„æƒé™ç®¡ç†ä¸å¤Ÿçµæ´»ï¼Œæ™®é€šè¿›ç¨‹è¦ä¹ˆä»€ä¹ˆéƒ½ä¸èƒ½åšï¼Œè¦ä¹ˆsudoä»€ä¹ˆéƒ½èƒ½åšã€‚äºŽæ˜¯å°†rootç‰¹æƒåˆ†å‰²æˆè¯¸å¤šèƒ½åŠ›Capabilityã€‚&lt;/p>
&lt;p>è¿›ç¨‹æ‹¥æœ‰ä¸‰ç»„èƒ½åŠ›é›†ï¼š&lt;/p>
&lt;ul>
&lt;li>cap_effectiveï¼šå¯ç”¨èƒ½åŠ›é›†&lt;/li>
&lt;li>cap_inheritableï¼šå¯ç»§æ‰¿èƒ½åŠ›é›†&lt;/li>
&lt;li>cap_permittedï¼šæœ€å¤§èƒ½åŠ›é›†&lt;/li>
&lt;/ul>
&lt;p>å¯æ‰§è¡Œæ–‡ä»¶ä¹Ÿæœ‰ä¸‰ç»„èƒ½åŠ›é›†ï¼Œä¸Žè¿›ç¨‹å¯¹åº”ï¼š&lt;/p>
&lt;ul>
&lt;li>cap_effectiveï¼š&lt;/li>
&lt;li>cap_allowedï¼šå¯ç»§æ‰¿çš„èƒ½åŠ›é›†&lt;/li>
&lt;li>cap_forcedï¼šå¿…é¡»æ‹¥æœ‰æ‰èƒ½æ‰§è¡Œçš„èƒ½åŠ›é›†&lt;/li>
&lt;/ul>
&lt;p>å‡å¯ç®€è®°ä¸ºeipã€‚setcapæ˜¯é…ç½®Capabilityçš„å·¥å…·ï¼Œå…¶æ“ä½œç±»ä¼¼chmodã€‚&lt;/p>
&lt;h4 id="debug-build-libpcap">Debug: build-libpcap&lt;/h4>
&lt;h5 id="å•¥å«--ldw">å•¥å« -ldw&lt;/h5>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">= note: /usr/bin/ld: cannot find -ldw: No such file or directory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> collect2: error: ld returned 1 exit status
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>-ldw&lt;/code>ä»£è¡¨&lt;code>libdw.so&lt;/code>ï¼Œaptå®‰è£…å³å¯&lt;/li>
&lt;/ul>
&lt;h5 id="æˆ‘afl-clang-ltoå‘¢">æˆ‘afl-clang-ltoå‘¢&lt;/h5>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">configure:2853: afl-clang-lto --version &amp;gt;&amp;amp;5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./configure: line 2855: afl-clang-lto: command not found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configure:2864: $? = 127
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>è®©CCæŒ‡å‘AFLpulsplusé‡Œé¢çš„afl-clang-ltoã€‚åˆ‡è®°è¦ç»å¯¹è·¯å¾„&lt;/li>
&lt;/ul>
&lt;h5 id="ä½ æ ¹æœ¬ä¸åœ¨bpfnet">ä½ æ ¹æœ¬ä¸åœ¨bpf/net&lt;/h5>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">$ make --debug
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Reading makefiles...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Updating makefiles....
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Updating goal targets....
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &amp;#39;all&amp;#39; does not exist.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &amp;#39;libpcap.a&amp;#39; does not exist.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Prerequisite &amp;#39;grammar.c&amp;#39; is newer than target &amp;#39;grammar.h&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Must remake target &amp;#39;grammar.h&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Successfully remade target file &amp;#39;grammar.h&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &amp;#39;bpf_filter.o&amp;#39; does not exist.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &amp;#39;bpf_filter.c&amp;#39; does not exist.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &amp;#39;bpf/net/bpf_filter.c&amp;#39; does not exist.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Must remake target &amp;#39;bpf/net/bpf_filter.c&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make: *** No rule to make target &amp;#39;bpf/net/bpf_filter.c&amp;#39;, needed by &amp;#39;bpf_filter.c&amp;#39;. Stop.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¥½ç†Ÿæ‚‰çš„bugï¼ŒðŸ‘´æ¨¡ç³Šçš„è®°å¾—ä¹‹å‰æ£é¼“åˆ«çš„fuzzerçš„æ—¶å€™å¥½åƒä¹Ÿé‡åˆ°è¿‡ï¼Œä½†æ˜¯ðŸ‘´æ¸…æ¥šçš„è®°å¾—å½“æ—¶æˆ‘æ²¡è§£å†³ã€‚&lt;/p>
&lt;p>äºŽæ˜¯ï¼ŒðŸ‘´å¼€å§‹æŽ’æŸ¥æ˜¯å¦æœ‰ä¾èµ–ç¼ºå¤±ï¼Œ&lt;code>sudo apt-get install libpcap-dev&lt;/code>ï¼Œæ²¡ç”¨ã€‚æ€»ä¸èƒ½æ˜¯ WSL å†…æ ¸å°±å°‘ç‚¹ä¸œè¥¿å§ï¼Œæˆ‘éƒ½WSL2äº†ã€‚&lt;/p>
&lt;p>åˆå›žå¤´çœ‹äº†çœ‹æºç ï¼Œå‘çŽ° libpcap çš„ Github ä¸Šæœ‰ä¸€ä»½&lt;code>bpf_filter.c&lt;/code>ï¼Œè€Œä½œè€…ç»™çš„&lt;code>fuzzing-101-solution&lt;/code>é‡Œé¢æ²¡æœ‰ã€‚ðŸ‘´ç›´æŽ¥ä¸Šlibpacpä»“åº“å¤åˆ¶ï¼Œæ²¡ç”¨ã€‚&lt;/p>
&lt;p>å†çœ‹çœ‹ fuzzing-101 ä»“åº“ï¼Œä»–ç”¨çš„æ˜¯ libpacp1.80 ç‰ˆæœ¬ï¼ŒðŸ‘´åŽ»ç¿»ä»“åº“çš„æ ‡ç­¾ï¼Œæžœç„¶1.8ç‰ˆæœ¬æœ‰&lt;code>bpf/net/bpf_filter.c&lt;/code>ã€‚ç ´æ¡ˆäº†ã€‚ðŸ‘´ç›´æŽ¥è¿›è¡Œä¸€ä¸ªissueçš„æã€‚&lt;/p>
&lt;p>åŽé¢ä¸€æ­¥æ²¡æŠ¥é”™ã€‚å¶å‰‹~&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">$ ./build/sbin/tcpdump --h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcpdump version 4.9.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">libpcap version 1.8.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">OpenSSL 3.0.2 15 Mar 2022
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Compiled with AddressSanitizer/CLang.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ ./build/sbin/tcpdump -r corpus/bootp-testcase.pcap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reading from file corpus/bootp-testcase.pcap, link-type IPV4 (Raw IPv4)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">15:11:03.147545 IP localhost.bootps &amp;gt; 127.1.1.1.bootpc: BOOTP/DHCP, Request from 00:00:00:00:00:00 (oui Ethernet), length 236
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="fuzzer">fuzzer&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">parser&lt;/span>::&lt;span class="n">parse_args&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">cores&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Cores&lt;/span>::&lt;span class="n">from_cmdline&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">cores&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">expect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Failed to parse cores&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">ForkserverBytesCoverageSugar&lt;/span>::&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="mi">86217&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>::&lt;span class="n">builder&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">input_dirs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">output_dir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">cores&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cores&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">program&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">debug_output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">debug&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">arguments&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">build&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>Sugar API to simplify the life of the naive user of LibAFL&lt;/p>
&lt;/blockquote>
&lt;p>LibAFLè´´å¿ƒçš„ä¸ºæˆ‘è¿™ç§ naive user å‡†å¤‡äº†ä¸€æ¡é¾™æœåŠ¡ï¼Œæä¾›äº† Sugar API å°†å‰ä¸¤ç¯‡çš„æ ·æ¿ä»£ç è¿›ä¸€æ­¥ç®€åŒ–ã€‚å¥½çš„ï¼Œfuzzerå†™å®Œäº†ã€‚&lt;/p>
&lt;h4 id="rust-åŸºç¡€ä¹‹-builder">Rust åŸºç¡€ä¹‹ Builder&lt;/h4>
&lt;h3 id="parserrs">parser.rs&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#[derive(Parser, Debug)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">FuzzerOptions&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cp">#[clap(short, long, default_value = &lt;/span>&lt;span class="s">&amp;#34;solutions&amp;#34;&lt;/span>&lt;span class="cp">)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">output&lt;/span>: &lt;span class="nc">PathBuf&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cp">#[clap(short, long, default_value = &lt;/span>&lt;span class="s">&amp;#34;corpus&amp;#34;&lt;/span>&lt;span class="cp">, multiple_values = true)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">input&lt;/span>: &lt;span class="nc">PathBuf&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cp">#[clap(short, long)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">cores&lt;/span>: &lt;span class="nb">String&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cp">#[clap(short, long, required = true, takes_value = true)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">target&lt;/span>: &lt;span class="nb">String&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cp">#[clap(short, long)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">debug&lt;/span>: &lt;span class="kt">bool&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cp">#[clap(
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> short,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> long,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> allow_hyphen_values = true,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> multiple_values = true,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> takes_value = true
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> )]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">args&lt;/span>: &lt;span class="nb">Vec&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">parse_args&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nc">FuzzerOptions&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">FuzzerOptions&lt;/span>::&lt;span class="n">parse&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œä½¿ç”¨äº† clap åº“æ¥è§£æžå‘½ä»¤è¡Œå‚æ•°ï¼Œè½¬æ¢ä¸ºæ•°æ®ç»“æž„&lt;code>FuzzerOptions&lt;/code>ã€‚&lt;/p>
&lt;h4 id="rust-åŸºç¡€ä¹‹-æ³¨è§£">Rust åŸºç¡€ä¹‹ æ³¨è§£&lt;/h4>
&lt;h3 id="è·‘">è·‘ðŸƒâ€&lt;/h3>
&lt;p>ç›´æŽ¥è·‘æ˜¯å¾ˆdumbçš„ï¼Œè¿Ÿè¿Ÿè·‘ä¸å‡ºç»“æžœã€‚è¿™é‡Œå…ˆæŠ„ä¸ª&lt;a class="link" href="https://github.com/the-tcpdump-group/tcpdump/blob/tcpdump-4.9.2/tests/bootp_asan.pcap" target="_blank" rel="noopener"
>ç­”æ¡ˆ&lt;/a>&lt;/p>
&lt;!-- ```
cp `find -name "cve*.pcap"|xargs` ../../corpus
cp `find -name "*heapoverflow*.pcap"|xargs` ../../corpus
https://github.com/the-tcpdump-group/tcpdump/commit/29e5470e6ab84badbc31f4532bb7554a796d9d52
``` -->
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> $ ./build/sbin/tcpdump -r corpus/bootp_asan.pcap -v [2:27:14]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reading from file corpus/bootp_asan.pcap, link-type EN10MB (Ethernet)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">08:00:00.000000 IP (tos 0x0, ttl 252, id 40207, offset 0, flags [+, DF, rsvd], proto UDP (17), length 60951, bad cksum ff (-&amp;gt;8336)!)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">=================================================================
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">==23730==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6060000000b4 at pc 0x56339a3e4010 bp 0x7fffaf70f850 sp 0x7fffaf70f848
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">READ of size 2 at 0x6060000000b4 thread T0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #0 0x56339a3e400f in bootp_print /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./print-bootp.c:325:2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #1 0x56339a46960a in ip_print_demux /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./print-ip.c:387:3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #2 0x56339a47008b in ip_print /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./print-ip.c:658:3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #3 0x56339a4207c2 in ethertype_print /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./print-ether.c:333:10
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #4 0x56339a41e731 in ether_print /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./print-ether.c:236:7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #5 0x56339a36bff1 in pretty_print_packet /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./print.c:339:18
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #6 0x56339a36bff1 in print_packet /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./tcpdump.c:2506:2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #7 0x56339a74458a in pcap_offline_read /home/czy/fuzzing-101-solutions/exercise-3/libpcap/./savefile.c:507:4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #8 0x56339a362050 in pcap_loop /home/czy/fuzzing-101-solutions/exercise-3/libpcap/./pcap.c:875:8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #9 0x56339a362050 in main /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./tcpdump.c:2009:12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç­”æ¡ˆæ˜¯ç®¡ç”¨çš„ï¼Œä½†æ˜¯ç›´æŽ¥ä¸¢è¿› Libafl å´æ²¡æœ‰crashã€‚&lt;/p>
&lt;h3 id="ä¼˜åŒ–">ä¼˜åŒ–&lt;/h3>
&lt;p>ç›®å‰çš„fuzzeråŽŸä½œè€…è·‘äº†ä¸€æ™šä¸Šå•¥ä¹Ÿæ²¡è·‘å‡ºæ¥ï¼Œç”±æ­¤å¼•å…¥ä¸€äº›ä¼˜åŒ–æ–¹æ³•ã€‚&lt;/p>
&lt;h4 id="è¯­æ–™åº“åŽ‹ç¼©optmin">è¯­æ–™åº“åŽ‹ç¼©ï¼šoptmin&lt;/h4>
&lt;p>optmin æ˜¯ afl-tmin çš„ä¼˜åŒ–ç‰ˆã€‚å°†è¯­æ–™åº“ä¸­è§¦å‘é‡å¤è·¯å¾„çš„éƒ¨åˆ†æœ€å°åŒ–ï¼Œæœ‰åŠ©äºŽfuzzerå‡å°‘é‡å¤å°è¯•ã€‚è¿™é‡Œçš„è¯­æ–™åº“åœ¨&lt;code>/solutions/queue&lt;/code>ï¼Œä¹Ÿå°±æ˜¯AFLæ‰§è¡Œè¿‡è‹¥å¹²è½®åŽçš„ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># build&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> AFLplusplus/utils/optimin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./build_optimin.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv optimin ../../../exercise-3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># run&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp -r solutions/queue/* queue_for_cmin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">AFL_MAP_SIZE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">86217&lt;/span> &lt;span class="nv">ASAN_OPTIONS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">abort_on_error&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> ./optimin -f -i queue_for_cmin -o cminnified ./build/sbin/tcpdump -vr @@
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="æ ·ä¾‹åŽ‹ç¼©afl-tmin">æ ·ä¾‹åŽ‹ç¼©ï¼šafl-tmin&lt;/h4>
&lt;p>å¦ä¸€æ–¹é¢ï¼Œtminå¯¹å•ä¸ªè¾“å…¥è¿›è¡ŒåŽ‹ç¼©ï¼Œå‡å°æ–‡ä»¶å¤§å°ä¹Ÿæœ‰åŠ©äºŽæé«˜æ•ˆçŽ‡ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># build&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> AFLplusplus/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make afl-tmin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv afl-tmin ../exercise-3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># run&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp -r solutions/queue/* queue_for_cmin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">AFL_MAP_SIZE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">86217&lt;/span> &lt;span class="nv">ASAN_OPTIONS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">abort_on_error&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> ./optimin -f -i queue_for_cmin -o cminnified ./build/sbin/tcpdump -vr @@
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="è¦†ç›–çŽ‡è§‚å¯Ÿafl-cov">è¦†ç›–çŽ‡è§‚å¯Ÿï¼šafl-cov&lt;/h4>
&lt;p>ç„¶è€Œè¿™ç§å¸¸è§„ä¼˜åŒ–è¿˜æ˜¯æ²¡èƒ½æœ‰çªç ´ï¼ŒåŽŸä½œè€…å†³å®šè§‚å¯Ÿä¸€ä¸‹é‚£äº›ä»£ç è¿˜æ²¡æœ‰è¢«è¦†ç›–ã€‚å®‰è£…è¦†ç›–çŽ‡å·¥å…·afl-covç›¸å¯¹æ¯”è¾ƒç¹çï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">export HOME=/fuzzing-101-solutions/exercise-3/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd $home
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># å®‰è£…afl-cov
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt install lcov
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git clone https://github.com/vanhauser-thc/afl-cov.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># ç§»åŠ¨æºä»£ç 
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir exercise-3-gcov exercise-3-gcov/build
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp -r exercise-3/libpcap exercise-3-gcov
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp -r exercise-3/tcpdump exercise-3-gcov
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp -r exercise-3/solutions exercise-3-gcov
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># æ¸…ç†lockæ–‡ä»¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd exercise-3-gcov/solutions/queue
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find * -empty -delete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># lcov éœ€è¦æ–‡ä»¶åä»…ä¸º6ä½
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">## åŽŸåšå®¢ç”¨çš„pythonè„šæœ¬ï¼ŒðŸ‘´ç›´æŽ¥è¯·æ•™ new bing
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">for i in *; do
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mv -v &amp;#34;$i&amp;#34; &amp;#34;${i: -6}&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">done
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># ç¼–è¯‘å¸¦ cov çš„ libpcap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd $home/exercise-3-gcov/libpcap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make clean
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/opt/afl-cov/afl-cov-build.sh -c ./configure --prefix=$(pwd)/../build; make
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># ç¼–è¯‘å¸¦ cov çš„ tcpdump
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd $home/exercise-3-gcov/tcpdump
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make clean
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CFLAGS=-I$(pwd)/../build/include/ LDFLAGS=-L$(pwd)/../build/lib/ /opt/afl-cov/afl-cov-build.sh -c ./configure --prefix=$(pwd)/../build ; make
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo setcap cap_sys_admin+epi ../build/sbin/tcpdump
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># æ‰§è¡Œ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/opt/afl-cov/afl-cov.sh -c solutions &amp;#34;./build/sbin/tcpdump -vr @@&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è§‚å¯Ÿåˆ°æ ¹æœ¬è¿è¡Œä¸åˆ°ç›®æ ‡CVEæ‰€åœ¨çš„æ–‡ä»¶ã€‚&lt;/p>
&lt;h4 id="å›ºå®šè¾“å…¥">å›ºå®šè¾“å…¥&lt;/h4>
&lt;p>æœ€åŽåŽŸä½œè€…å†³å®šæ”¹ Libafl æºç ï¼Œåœ¨å˜å¼‚ä¹‹å‰å¾€é‡Œå¡žå›ºå®šäº†çš„ BOOTY å¤´ã€‚ä½†æ˜¯ðŸ‘´çš„ LibAFL æºä»£ç å’ŒåŽŸåšå®¢ä¸­æœ‰äº›å¾®åŒºåˆ«ï¼Œè™½ç„¶ç‰ˆæœ¬å·ä¸€æ ·ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="sd">///libafl/src/executors/forkserver.rs:438
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd">&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">executor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">uses_shmem_testcase&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">shmem&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">unsafe&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">executor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">shmem_mut&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">as_mut&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">unwrap_unchecked&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">target_bytes&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">target_bytes&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">target_bytes&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_slice&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">len&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">size_in_bytes&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">to_ne_bytes&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// The first four bytes tells the size of the shmem.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">shmem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_mut_slice&lt;/span>&lt;span class="p">()[&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">copy_from_slice&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">size_in_bytes&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">]);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">shmem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_mut_slice&lt;/span>&lt;span class="p">()[&lt;/span>&lt;span class="no">SHMEM_FUZZ_HDR_SIZE&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">SHMEM_FUZZ_HDR_SIZE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="p">)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">copy_from_slice&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">target_bytes&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_slice&lt;/span>&lt;span class="p">());&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">executor&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">input_file_mut&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">write_buf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">target_bytes&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">as_slice&lt;/span>&lt;span class="p">())&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸è¿‡è¿˜æ˜¯æ‰¾åˆ°äº†å¯¹åº”çš„ä½ç½®ï¼Œå‘&lt;code>write_buf()&lt;/code>æ’å…¥å›ºå®šçš„å¤´éƒ¨å³å¯ã€‚&lt;/p>
&lt;p>ðŸ‘´è§‰å¾—è¿™æ ·ä¸å¤Ÿä¼˜é›…ï¼ŒäºŽæ˜¯å¯»æ€èƒ½å¦è¿›è¡Œä¸€ä¸ªç±»é‡å†™ã€‚&lt;/p>
&lt;p>ã€To be continueã€‘&lt;/p></description></item><item><title>libAFLé€Ÿé€šFuzzing101 (2)</title><link>https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/</link><pubDate>Sun, 30 Jul 2023 02:45:31 +0800</pubDate><guid>https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/</guid><description>&lt;img src="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/final.png" alt="Featured image of post libAFLé€Ÿé€šFuzzing101 (2)" />&lt;blockquote>
&lt;p>æœ¬ç³»åˆ—æ˜¯å­¦ä¹ &lt;a class="link" href="https://epi052.gitlab.io/notes-to-self/blog/2021-11-01-fuzzing-101-with-libafl/" target="_blank" rel="noopener"
>ã€ŠFuzzing101 with LibAFLã€‹&lt;/a>ç³»åˆ—åšå®¢ï¼ˆåŽæ–‡ç»Ÿç§°ï¼šåŽŸåšå®¢ï¼‰çš„ç¬”è®°åˆ†äº«ï¼Œåœ¨å­¦ä¹ ä»‹ç» LibAFL ç”¨æ³•çš„åŒæ—¶æ€»ç»“ Rust çŸ¥è¯†ç‚¹ã€‚&lt;br>
&lt;strong>å‰ç½®çŸ¥è¯†&lt;/strong>ï¼š fuzzåŸºæœ¬æ¦‚å¿µã€AFLåŸºæœ¬ä½¿ç”¨ &lt;br>
&lt;strong>æœ¬ç¯‡è¦ç‚¹&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>LibAFL
&lt;ul>
&lt;li>Inprocessæ¨¡å¼
&lt;ul>
&lt;li>Harness&lt;/li>
&lt;li>ç¼–è¯‘å™¨wrapper&lt;/li>
&lt;li>LLPMï¼Œå¤šæ ¸å¹¶è¡Œ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ¼æ´žåˆ†ç±»ï¼šAFLTriage&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Rust
&lt;ul>
&lt;li>å‡½æ•°ã€é—­åŒ…&lt;/li>
&lt;li>match æ¨¡å¼è¯†åˆ«&lt;/li>
&lt;li>Optionã€Result&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h2 id="execise-15">Execise-1.5&lt;/h2>
&lt;p>Execise-1 ä¸­ç¼–å†™çš„fuzzerååˆ†ç”šè‡³ä¹åˆ†çš„ç®€é™‹ï¼Œè·ç¦»å®žé™…åº”ç”¨è¿˜ç›¸å·®ç”šè¿œã€‚åŽŸåšå®¢åœ¨&lt;a class="link" href="https://epi052.gitlab.io/notes-to-self/blog/2021-11-07-fuzzing-101-with-libafl-part-1.5" target="_blank" rel="noopener"
>1.5é›†&lt;/a>ä¸­åˆ—ä¸¾äº†ä¸‰ç§ä¼˜åŒ–æ–¹æ³•ï¼š&lt;/p>
&lt;ul>
&lt;li>ä½¿ç”¨&lt;code>afl-clang-lto&lt;/code> ä»£æ›¿ &lt;code>afl-clang-fast&lt;/code>â€”â€” fast 1.1x
&lt;ul>
&lt;li>afl-clang-lto(link time optimization): å®žçŽ°æ— ç¢°æ’žæ’æ¡©&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä½¿ç”¨ å…±äº«å†…å­˜ å¹²æŽ‰ æ–‡ä»¶I/O â€”â€” fast 3x
&lt;ul>
&lt;li>patchæºä»£ç ï¼ŒåŠ å…¥&lt;code>__AFL_FUZZ_INIT();&lt;/code>å®&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä½¿ç”¨&lt;code>InProcessExecutor&lt;/code> æ¢æŽ‰ &lt;code>ForkserverExecutor&lt;/code>â€”â€” fast 10x
&lt;ul>
&lt;li>patchæºä»£ç ï¼Œç¼–å†™harness functionå’Œcompiler wraper&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>ç”±äºŽ Execise-1 çš„ç›®æ ‡xpdfæ˜¯å‘½ä»¤è¡Œç¨‹åºï¼Œä¸æ˜¯åº“ï¼Œæ•…éœ€è¦åšä¸€å®šä¿®æ”¹ä½¿å…¶æ”¯æŒé™æ€é“¾æŽ¥ã€‚å…¶æ“ä½œè¾ƒä¸ºç¹çï¼Œæ¶‰åŠmakeè¿ç§»åˆ°cmakeç­‰ï¼Œå»ºè®®æœ‰éœ€æ±‚æ—¶è‡ªè¡Œç ”ç©¶ã€‚&lt;/p>
&lt;p>è€Œ Execise-2 çš„ç›®æ ‡libexifæœ¬èº«æ˜¯ä¸€ä¸ªåº“ï¼Œä¸å¦‚å€ŸåŠ© Execise-2 å­¦ä¹ harnessã€‚&lt;/p>
&lt;h3 id="æ‰€ä»¥ä»€ä¹ˆæ˜¯harness">æ‰€ä»¥ä»€ä¹ˆæ˜¯harnessï¼Ÿ&lt;/h3>
&lt;blockquote>
&lt;p>Harness &lt;br>
v. æŽ§åˆ¶å¹¶åˆ©ç”¨ï¼›ï¼ˆæŠŠåŠ¨ç‰©ï¼‰æ‹´åœ¨ä¸€èµ·ï¼ˆæˆ–æ‹´åˆ°æŸç‰©ä¸Šï¼‰ï¼›ç»™ï¼ˆé©¬ï¼‰å¥—ä¸ŠæŒ½å…·ï¼›è¿žæŽ¥ï¼Œä¸²è” &lt;br>
n. ï¼ˆé©¬çš„ï¼‰æŒ½å…·ï¼Œé©¬å…·ï¼›ç³»å¸¦ï¼ŒåŠå¸¦ï¼›æ—¥å¸¸å·¥ä½œ&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨é¢å¯¹ä¸€ä¸ªåº“æ—¶ï¼Œå¹¶æ²¡æœ‰çŽ°æˆçš„å…¥å£ç‚¹ï¼Œå› æ­¤éœ€è¦å†™ä¸€ä¸ªå‡½æ•°æ¥è°ƒç”¨å®ƒï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯ harnessã€‚æ­¤æ—¶ï¼Œharnessæˆä¸ºäº†ä¸Žfuzzerç›´æŽ¥äº¤äº’çš„ç›®æ ‡ã€‚
ä¹Ÿå°±æ˜¯è¯´ï¼Œfuzzeræ˜¯æ¨ªå†²ç›´æ’žçš„é‡Žé©¬ï¼Œtargetæ˜¯ä¸€æœ›æ— é™…çš„è‰åŽŸï¼Œharnessåˆ™æ˜¯æŒ‡å¼•æ–¹å‘çš„ç¼°ç»³ã€‚&lt;/p>
&lt;p>ä½¿ç”¨harnessæ—¶ï¼Œfuzzerçš„æ‰€æœ‰å·¥ä½œå°†åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­å®Œæˆï¼Œå³InProcessã€‚è¿™å¯¹æ€§èƒ½æœ‰ä»¥ä¸‹å¥½å¤„ï¼š&lt;/p>
&lt;ul>
&lt;li>å¯ä»¥ç›´æŽ¥é€šè¿‡harnessçš„ç¼–å†™ä¿ƒä½¿fuzzeræŽ¢ç´¢æˆ‘ä»¬æ„Ÿå…´è¶£çš„éƒ¨åˆ†&lt;/li>
&lt;li>ä¸Žfork-serverä¸åŒï¼Œè¿›ç¨‹å†…æ‰§è¡Œå…åŽ»äº†è¿›ç¨‹ç®¡ç†çš„è´Ÿæ‹…ï¼Œè¿™ä¸€ç‚¹æ˜¾è‘—æå‡äº†æ€§èƒ½&lt;/li>
&lt;li>å•è¿›ç¨‹æ¨¡å¼å¤©ç„¶æ”¯æŒå¤šæ ¸ï¼Œï¼ˆä¸€ä¸ªfuzzerå®žä¾‹ä¸€ä¸ªcpuæ ¸å¿ƒï¼‰å¯¹çŽ°ä»£å¤šæ ¸å¤„ç†å™¨å‹å¥½&lt;/li>
&lt;/ul>
&lt;p>é‚£ä¹ˆä»£ä»·æ˜¯ä»€ä¹ˆï¼Ÿç”±äºŽharnesså°†åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­è¢«åå¤æ‰§è¡Œï¼Œharnessåº”æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸èƒ½æœ‰å†…å­˜æ³„æ¼ï¼Œå¦åˆ™å°†ä¼šå¯¹fuzzeræœ¬èº«é€ æˆç ´åã€‚&lt;/li>
&lt;li>ä¸è¦æ‰§è¡Œexit()ã€‚è¿™ä¼šç»“æŸå½“å‰è¿›ç¨‹ï¼Œåº”è¯¥å‘é€abortä»¥ä¾›fuzzeré‡å¯&lt;/li>
&lt;li>é¿å…é«˜ç®—æ³•å¤æ‚åº¦ï¼Œé¿å…å¤§é‡å†…å­˜å ç”¨ï¼Œé¿å…æ—¥å¿—è¾“å‡ºç­‰æ‹–æ…¢é€Ÿåº¦çš„è¡Œä¸º&lt;/li>
&lt;/ul>
&lt;p>æ˜¯ä¸æ˜¯æ‘©æ‹³æ“¦æŽŒäº†å‘¢ï¼Ÿè®©æˆ‘ä»¬é‡æ–°åŠ å…¥æˆ˜æ–—å§ï¼&lt;/p>
&lt;h2 id="execise-2-libexif">Execise-2 libexif&lt;/h2>
&lt;h3 id="source--corpus">source &amp;amp; corpus&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># libexifçš„ä¾èµ–&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt-get install autopoint libtool gettext libpopt-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¸‹è½½æºç &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://github.com/libexif/libexif/archive/refs/tags/libexif-0_6_14-release.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar -xf libexif-0_6_14-release.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv libexif-libexif-0_6_14-release libexif
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å‡†å¤‡corpus&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir corpus solutions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> corpus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git clone --no-checkout --filter&lt;span class="o">=&lt;/span>blob:none https://github.com/libexif/libexif.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> libexif
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## åªç•™å›¾ç‰‡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git checkout master -- test/testdata
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv test/testdata/*.jpg ../
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ..
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm -rvf libexif
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="cargotoml">Cargo.toml&lt;/h3>
&lt;p>åœ¨InProcessæ¨¡å¼ä¸­ï¼Œéœ€è¦ç¼–è¯‘å™¨æŠŠfuzzerï¼Œtargetï¼Œharnesså…¨éƒ¨é“¾æŽ¥åˆ°ä¸€èµ·ã€‚æ•…ä»¥åº“çš„å½¢å¼åˆ›å»ºé¡¹ç›®ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>cargo new --lib exercise-2&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>åŒæ—¶ï¼Œæœ¬ç¯‡ä¹Ÿç”¨åˆ°äº†Libaflçš„å…¨éƒ¨ç»„ä»¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># execise-2/Cargo.toml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">package&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;exercise-2&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;0.1.0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">edition&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;2021&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">dependencies&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">libafl&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;0.10.1&amp;#34;&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="c"># libafl core&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">libafl_cc&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;0.10.1&amp;#34;&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="c"># compiler wrapper&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">libafl_targets&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;0.10.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">features&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;libfuzzer&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;sancov_pcguard_hitcounts&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;sancov_cmplog&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">]&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="c"># common code for targets instrumentation&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">lib&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;exercisetwo&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">crate-type&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;staticlib&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ç”Ÿæˆ libexercisetwo.a&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="cargo-make">cargo-make&lt;/h3>
&lt;p>ä½¿ç”¨&lt;code>build.rs&lt;/code>èƒ½å¤Ÿå¢žåŠ è‡ªåŠ¨åŒ–ç¨‹åº¦ï¼Œä½†ç”¨rustå†™shellä¾æ—§ç•¥æ˜¾ç¹çã€‚äºŽæ˜¯åŽŸåšå®¢å¼•å…¥äº† cargo-make å·¥å…·ï¼Œåœ¨cargoåŽŸæœ¬çš„&lt;code>Cargo.toml&lt;/code>åŸºç¡€ä¸ŠåŠ å…¥äº†&lt;code>Makefile.toml&lt;/code>ï¼Œç”¨ä»¥è‡ªå®šä¹‰é…ç½®ï¼Œæž„å»ºè‡ªåŠ¨åŒ–å·¥ä½œæµã€‚
ç±»ä¼¼äºŽ&lt;code>Makefile&lt;/code>ï¼Œåˆæœ‰ç‚¹åƒ&lt;code>docker-compose.yml&lt;/code>ã€‚&lt;/p>
&lt;ul>
&lt;li>å®‰è£…ï¼š&lt;code>cargo install --force cargo-make&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>å¦‚ä¸‹æ‰€ç¤ºï¼Œæ—¢å¯ä»¥æ‰§è¡Œ&lt;code>cargo make build&lt;/code>ä¸€å¥è¯è·‘é€šå…¨éƒ¨ï¼Œä¹Ÿå¯å•ç‹¬æ‰§è¡Œ&lt;code>cargo make build-libexif&lt;/code>ï¼Œååˆ†çµæ´»ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># execise-2/Makefile.toml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">dependencies&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;clean&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;build-compilers&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;copy-project-to-build&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;build-libexif&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;build-fuzzer&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-compilers&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">command&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;cargo&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">args&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;build&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;--release&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">copy-project-to-build&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">script&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">mkdir -p build/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">cp ${CARGO_MAKE_WORKING_DIRECTORY}/../target/release/ex2_compiler build/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">cp ${CARGO_MAKE_WORKING_DIRECTORY}/../target/release/libexercisetwo.a build/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-fuzzer&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cwd&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;build&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">command&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;./ex2_compiler&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">args&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;-I&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;../libexif/libexif&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-I&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;../libexif&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-o&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;fuzzer&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;../harness.c&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;lib/libexif.a&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># -Idir å¢žåŠ dirä¸ºå¤´æ–‡ä»¶çš„æœç´¢è·¯å¾„&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-libexif&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cwd&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;libexif&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">env&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="s2">&amp;#34;CC&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;/fuzzing101/exercise-2/build/ex2_compiler&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;LLVM_CONFIG&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;llvm-config-15&amp;#34;&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">script&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">autoreconf -fi
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">./configure --enable-shared=no --prefix=&amp;#34;&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">CARGO_MAKE_WORKING_DIRECTORY&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="nx">build&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="s2">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make -i
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make install -i
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>çœ‹èµ·æ¥æ¸…çˆ½å¤šäº†ï¼ˆæ­¤æ—¶ðŸ‘´è¿˜æ²¡æœ‰æ„è¯†åˆ°é—®é¢˜çš„ä¸¥é‡æ€§ï¼‰ã€‚&lt;/p>
&lt;h4 id="è¡¥å……linuxå¼€å‘å·¥å…·é“¾">è¡¥å……ï¼šLinuxå¼€å‘å·¥å…·é“¾&lt;/h4>
&lt;blockquote>
&lt;p>./configure é…ç½®: æ ¹æ®Makefile.inæ¨¡æ¿å’Œç³»ç»Ÿä¿¡æ¯ç”ŸæˆMakefile &lt;br>
make ç¼–è¯‘ï¼šæ ¹æ®Makefileå°†æºä»£ç ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ &lt;br>
make install å®‰è£…ï¼šå°†å¯æ‰§è¡Œæ–‡ä»¶å¤åˆ¶åˆ°æ­£ç¡®çš„åœ°æ–¹&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;code>autoreconf&lt;/code>ï¼šå±žäºŽ autotools å·¥å…·é“¾ï¼Œä¹Ÿæ˜¯ç”Ÿæˆmakefileçš„è‡ªåŠ¨åŒ–å·¥å…·ã€‚åŽé€æ¸è¢«cmakeå–ä»£ã€‚ï¼ˆçŽ°åœ¨æµè¡Œçš„æ˜¯Antï¼Ÿï¼‰&lt;/li>
&lt;/ul>
&lt;h3 id="harness--compiler">harness &amp;amp; compiler&lt;/h3>
&lt;h4 id="harnessc">harness.c&lt;/h4>
&lt;p>harnessçš„æ ¸å¿ƒï¼Œä¹Ÿå°±æ˜¯è¢«fuzzerè°ƒç”¨çš„ä½ç½®ï¼Œæ˜¯&lt;code>LLVMFuzzerTestOneInput()&lt;/code>å‡½æ•°ã€‚
å…¶è¾“å…¥æ˜¯ä¸€ä¸ªå­—èŠ‚æ•°ç»„å’Œå…¶å°ºå¯¸ã€‚ä¸»æµfuzzeréƒ½æŽ¥å—è¿™ä¸ªå‡½æ•°å£°æ˜Žï¼Œæˆ–è®¸æ˜¯å› ä¸ºä»–ä»¬åŽç«¯éƒ½ç”¨çš„LLVMçš„Libfuzzerå§ã€‚&lt;/p>
&lt;p>åœ¨Libexifçš„testç›®å½•ä¸‹æœ‰&lt;code>test-fuzzer-persistent.c&lt;/code>ï¼Œæ˜¯ä¸€ä¸ªé€‚ç”¨äºŽAFLæŒä¹…æ¨¡å¼çš„harnessã€‚ç¨åŠ æ”¹é€ å³å¯ï¼š&lt;/p>
&lt;ul>
&lt;li>åˆ é™¤ AFL å®&lt;/li>
&lt;li>åˆ é™¤ä»»ä½•æ‰“å°/æ—¥å¿—è¯­å¥&lt;/li>
&lt;li>å°† &lt;code>main()&lt;/code> é‡å‘½åä¸º &lt;code>LLVMFuzzerTestOneInput()&lt;/code>&lt;/li>
&lt;li>ä¿®å¤å…¶ä»–ç‰ˆæœ¬é—®é¢˜&lt;/li>
&lt;/ul>
&lt;h4 id="compilerrs">compiler.rs&lt;/h4>
&lt;p>æ˜¾ç„¶ï¼Œè¿™éƒ¨åˆ†å¹¶æ²¡æœ‰è®©æˆ‘ä»¬å†™ä¸€ä¸ªç¼–è¯‘å™¨ï¼Œè€Œæ˜¯ä¸€ä¸ªå¥—å£³ï¼Œä¸€å±‚åŒ…è£…(wrapper)ã€‚
è¿™é‡Œå°†targetä¸Žfuzzeré™æ€é“¾æŽ¥åœ¨ä¸€èµ·ï¼Œå¹¶åŠ å…¥&lt;code>-fsanitize=address&lt;/code>å‚æ•°ä»¥ä½¿ç”¨ASANã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// exercise-2/src/bin/ex2_compiler.rs
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">cwd&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">env&lt;/span>::&lt;span class="n">current_dir&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">unwrap&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">args&lt;/span>: &lt;span class="nb">Vec&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">env&lt;/span>::&lt;span class="n">args&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">collect&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">cc&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">ClangWrapper&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">code&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">cc&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">cpp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">silence&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">parse_args&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">expect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Failed to parse the command line&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">link_staticlib&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cwd&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s">&amp;#34;exercisetwo&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">add_arg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;-fsanitize-coverage=trace-pc-guard&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">add_arg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;-fsanitize=address&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">expect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Failed to run the wrapped compiler&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">process&lt;/span>::&lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">code&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¼€å§‹ç¼–å†™fuzzerä¹‹å‰ï¼Œæ ¹æ®é¡¹ç›®çš„æ–‡ä»¶ç»“æž„æ¢³ç†ä¸€ä¸‹ç¼–è¯‘é€»è¾‘ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>build-compilers&lt;/code>: ç”Ÿæˆè‡ªå·±çš„ç¼–è¯‘å™¨ï¼šç¼–è¯‘æ—¶é“¾æŽ¥fuzzeråº“ã€‚&lt;/li>
&lt;li>&lt;code>build-libexif&lt;/code>ï¼šç”¨è‡ªå·±çš„ç¼–è¯‘å™¨ç¼–è¯‘target&lt;/li>
&lt;li>&lt;code>build-fuzzer&lt;/code>ï¼šç”¨è‡ªå·±çš„ç¼–è¯‘å™¨ç¼–è¯‘harnessï¼Œå¹¶é“¾æŽ¥targetåº“&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">|-- Cargo.toml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- Makefile.toml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- corpus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- harness.c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- libexif
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- solutions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">`-- src
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |-- bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | `-- ex2_compiler.rs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> `-- lib.rs
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="libafl-inprocessæ¨¡å¼">Libafl: Inprocessæ¨¡å¼&lt;/h3>
&lt;h4 id="ç»„ä»¶observer--feedback">ç»„ä»¶ï¼šObserver &amp;amp; Feedback&lt;/h4>
&lt;p>ç”±äºŽæˆ‘ä»¬ä½¿ç”¨çš„ä¸å†æ˜¯&lt;code>afl-clang-fast&lt;/code>ï¼Œè€Œæ˜¯ä½¿ç”¨è‡ªå·±çš„ç¼–è¯‘å™¨wrapperã€‚æ•…&lt;code>__AFL_SHM_ID&lt;/code>å·²ç»ä¸å¥½ä½¿äº†ã€‚å¥½åœ¨&lt;code>libafl_targets&lt;/code>æä¾›äº†EDGES_MAPï¼š&lt;code>std_edges_map_observer&lt;/code>ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">HitcountsMapObserver&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">unsafe&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">std_edges_map_observer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;edges&amp;#34;&lt;/span>&lt;span class="p">)});&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ­¤å¤–ï¼Œç®€å•çš„è¶…æ—¶åé¦ˆä¹Ÿæ”¹ä¸ºäº†çœŸæ­£çš„å´©æºƒåé¦ˆï¼š&lt;code>CrashFeedback&lt;/code>ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">objective&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">feedback_and_fast!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">CrashFeedback&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">MaxMapFeedback&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="ç»„ä»¶monitor--eventmanager--status">ç»„ä»¶ï¼šMonitor &amp;amp; EventManager &amp;amp; Status&lt;/h4>
&lt;p>EventManager åœ¨ Inprocess æ¨¡å¼ä¸­æ‰çœŸæ­£å‘æŒ¥åŠŸç”¨ã€‚å¯¹äºŽå¤šå®žä¾‹çŽ¯å¢ƒï¼Œé€šä¿¡é—®é¢˜å¿…é¡»è§£å†³ã€‚LibAFLè®¾è®¡äº†ä¸€å¥—ä½Žçº§æ¶ˆæ¯ä¼ é€’åè®®(LLMP)ï¼Œä½¿ç”¨C-Sæž¶æž„ï¼Œç¬¬ä¸€ä¸ªæ‰§è¡Œçš„fuzzerä½œä¸ºä»£ç†(Broker)ï¼ŒåŽç»­æ‰§è¡Œçš„å‡ä½œä¸ºå®¢æˆ·ç«¯(Client)ã€‚Clientè´Ÿè´£ä¸æ–­æ‰§è¡Œï¼Œå°†ä¿¡æ¯æ±‡æ€»ä¸ŽBrokerç»¼åˆå±•ç¤ºã€‚&lt;/p>
&lt;p>æ­¤å¤–ï¼Œ Inprocess æ¨¡å¼è¿˜å¿…é¡»è®¾å®šè¿›ç¨‹çš„é‡å¯ï¼Œ&lt;code>setup_restarting_mgr_std&lt;/code>ç¬¬ä¸€æ¬¡æ‰§è¡Œä¸­è¿”å›ž&lt;code>(None, LlmpRestartingEventManager)&lt;/code>ï¼ŒåŽç»­åˆ™è¿”å›žä¸Šä¸€ä¸ªè¿›ç¨‹ç•™ä¸‹çš„çŠ¶æ€ï¼Œä»¥æ­¤å®žçŽ°çŠ¶æ€çš„æ°¸ç»­ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">monitor&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">MultiMonitor&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">});&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// MultiMonitor: åŒæ—¶æ”¯æŒBrokeræ¨¡å¼æˆ–Clientæ¨¡å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">state&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">mgr&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">match&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">setup_restarting_mgr_std&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">monitor&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1337&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">EventConfig&lt;/span>::&lt;span class="n">AlwaysUnique&lt;/span>&lt;span class="p">){&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">err&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">match&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">err&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Error&lt;/span>::&lt;span class="n">ShuttingDown&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(());&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">_&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">panic!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Failed to setup the restarting manager: &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">err&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">},&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">state&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">state&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">unwrap_or_else&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">||&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">StdState&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">StdRand&lt;/span>::&lt;span class="n">with_seed&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">current_nanos&lt;/span>&lt;span class="p">()),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">input_corpus&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">solutions_corpus&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">feedback&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">objective&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">unwrap&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">});&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="rust-åŸºç¡€ä¹‹å‡½æ•°è¿”å›žå€¼æ¨¡å¼åŒ¹é…ä¸Žé”™è¯¯å¤„ç†">Rust åŸºç¡€ä¹‹å‡½æ•°è¿”å›žå€¼ã€æ¨¡å¼åŒ¹é…ä¸Žé”™è¯¯å¤„ç†&lt;/h4>
&lt;p>æœ¬ä¾‹ä¸­çš„&lt;code>mgr&lt;/code>æ˜¯ä¸€ä¸ªç»å…¸çš„matchç”¨æ³•ï¼Œç”¨matchå¤„ç†å‡½æ•°çš„è¿”å›žå€¼ã€‚ä¸‹é¢æŠŠæ¦‚å¿µå’Œç¬¦å·æ‹ä¸€éï¼š&lt;/p>
&lt;h5 id="å‡½æ•°">å‡½æ•°&lt;/h5>
&lt;p>Rust çš„å‡½æ•°ä½“ç”±ä¸€ç³»åˆ—è¯­å¥ç»„æˆï¼Œæœ€åŽç”±è¡¨è¾¾å¼ç»“å°¾ã€‚å¿…é¡»ä¸¥æ ¼åˆ†åˆ«è¡¨è¾¾å¼å’Œè¯­å¥ã€‚å› ä¸ºè¡¨è¾¾å¼ä»£è¡¨ä¸€ä¸ªè¿”å›žå€¼ï¼Œè€Œè¯­å¥ä¸è¿”å›žã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">fn&lt;/span> &lt;span class="nf">FUNC&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">PARAM&lt;/span>: &lt;span class="nc">TYPE&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">PARAM&lt;/span>: &lt;span class="nc">TYPE&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="p">.)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nc">RETURN_TYPE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="no">STATEMANT&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="no">EXPRESSION&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>;&lt;/code>: æ ‡è¯†ä¸€æ¡è¯­å¥ã€‚è¡¨è¾¾å¼æ²¡æœ‰åˆ†å·ã€‚&lt;/li>
&lt;li>&lt;code>!&lt;/code>: æ ‡è¯†å‘æ•£å‡½æ•°(diverge function)ï¼Œæ²¡æœ‰è¿”å›žå€¼ã€‚å¦‚&lt;code>println!(&amp;quot;{}&amp;quot;, s)&lt;/code>ï¼Œ&lt;code>panic!()&lt;/code>
&lt;ul>
&lt;li>&lt;code>panic!()&lt;/code>: çº¿ç¨‹ææ…Œã€‚å•çº¿ç¨‹ç¨‹åºå³æŠ¥é”™é€€å‡ºã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>()&lt;/code>: ç©ºå…ƒç»„ï¼Œä¸å ç”¨å†…å­˜ã€‚æ— è¿”å›žå€¼æ—¶çš„è¿”å›žå€¼ã€‚&lt;/li>
&lt;/ul>
&lt;h5 id="æ¨¡å¼åŒ¹é…">æ¨¡å¼åŒ¹é…&lt;/h5>
&lt;p>matchç›¸å½“äºŽswitchçš„åŠ å¼ºç‰ˆï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">match&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">VALUE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="no">PATTERN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">EXPRESSION&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="no">PATTERN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">EXPRESSION&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>_&lt;/code>: è¡¨ç¤ºå‰©ä½™æƒ…å†µçš„PATTERNã€‚&lt;/li>
&lt;li>exhaustiveç‰¹æ€§ï¼šå˜é‡çš„æ‰€æœ‰å¯èƒ½æ€§å¿…é¡»å…¨éƒ¨è¢«è¦†ç›–ã€‚&lt;/li>
&lt;/ul>
&lt;h5 id="é”™è¯¯å¤„ç†">é”™è¯¯å¤„ç†&lt;/h5>
&lt;p>å‡½æ•°è¿”å›žå€¼å¸¸ç”¨ä¸¤ç±»æ³›åž‹æžšä¸¾è¿›è¡ŒåŒ…è£…ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">enum&lt;/span> &lt;span class="nb">Option&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// å¯é€‰å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">None&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// å¯ä»¥æ²¡æœ‰å€¼ã€‚é€‚ç”¨äºŽè®¸å¤šæƒ…å†µï¼šåˆå§‹å€¼ï¼Œå¯é€‰å‚æ•°ï¼Œé”™è¯¯(ä¸ä¼španic!)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// å¿…é¡»æœ‰å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">enum&lt;/span> &lt;span class="nb">Result&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">E&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// è¿”å›žå€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">E&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// Errå¯ä»¥ä¸panic!
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Rustå¯¹Resultå®žçŽ°äº†è®¸å¤šæ–¹ä¾¿çš„æ–¹æ³•ï¼Œè¯¦æƒ…è¯·å‚é˜…æ–‡æ¡£ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>unwrap()&lt;/code>ï¼šè§£åŒ…Resultï¼Œæ‰èƒ½èŽ·å–å€¼
&lt;ul>
&lt;li>å¯¹&lt;code>None&lt;/code>æ‰§è¡Œåˆ™panic!&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>?&lt;/code>ï¼šè¯­æ³•ç³–ï¼Œå°†Errå¯¹è±¡ä¼ æ’­å‡ºæ¥ï¼Œè¿›ä¸€æ­¥ä½¿ä»£ç ç®€æ´ã€‚&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">match&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">FUNC&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">FUNC&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">//ç­‰ä»·å†™æ³•
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å‚è€ƒæ–‡æ¡£ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://rustwiki.org/zh-CN/std/option/index.html" target="_blank" rel="noopener"
>https://rustwiki.org/zh-CN/std/option/index.html&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://rustwiki.org/zh-CN/std/result/index.html" target="_blank" rel="noopener"
>https://rustwiki.org/zh-CN/std/result/index.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="ç»„ä»¶harness--executor">ç»„ä»¶ï¼šHarness &amp;amp; Executor&lt;/h4>
&lt;p>åœ¨fuzzerä¾§ï¼Œ&lt;code>LLVMFuzzerTestOneInput()&lt;/code>å¯¹åº”&lt;code>libfuzzer_test_one_input()&lt;/code>å‡½æ•°&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">harness&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">input&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">BytesInput&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">target_bytes&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">buffer&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_slice&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">libfuzzer_test_one_input&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buffer&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">ExitKind&lt;/span>::&lt;span class="nb">Ok&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">in_proc_executor&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">InProcessExecutor&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">harness&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">tuple_list!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">time_observer&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">fuzzer&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">state&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">mgr&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">unwrap&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>fuzzerå†™å®Œäº†ï¼Œå–„ï¼&lt;/p>
&lt;h4 id="rust-åŸºç¡€ä¹‹é—­åŒ…">Rust åŸºç¡€ä¹‹é—­åŒ…&lt;/h4>
&lt;p>é—­åŒ…(closure)ï¼Œä¸€èˆ¬è¯­è¨€çš„é—­åŒ…å°±æ˜¯ lambda è¡¨è¾¾å¼æˆ–åŒ¿åå‡½æ•°ï¼Œåœ¨Rustä¸­è¿˜è¦åŠ ä¸Šæ•èŽ·å¤–éƒ¨çŽ¯å¢ƒä¸­çš„å˜é‡çš„èƒ½åŠ›ã€‚&lt;/p>
&lt;p>é—­åŒ…æ•èŽ·å˜é‡çš„æ–¹å¼åˆ†ä¸ºä¸‰ç±»ï¼šæŒ‰é¡ºåºæ•èŽ·&lt;/p>
&lt;ul>
&lt;li>Fnï¼šè¡¨ç¤ºæ•èŽ·æ–¹å¼ä¸ºé€šè¿‡ä¸å¯å˜å¼•ç”¨ï¼ˆ&amp;amp;Tï¼‰çš„é—­åŒ…&lt;/li>
&lt;li>FnMutï¼šè¡¨ç¤ºæ•èŽ·æ–¹å¼ä¸ºé€šè¿‡å¯å˜å¼•ç”¨ï¼ˆ&amp;amp;mut Tï¼‰çš„é—­åŒ…&lt;/li>
&lt;li>FnOnceï¼šè¡¨ç¤ºæ•èŽ·æ–¹å¼ä¸ºé€šè¿‡å€¼ï¼ˆTï¼‰çš„é—­åŒ…&lt;/li>
&lt;/ul>
&lt;p>å®žé™…ä¸Šï¼Œé—­åŒ…å°±æ˜¯è¿™ä¸‰ç§Traitçš„è¯­æ³•ç³–ã€‚å…³äºŽTraitç›®å‰å¤§è‡´ç†è§£æˆæŸç§è§„å®šæ³›åž‹å¯¹è±¡çš„è¡Œä¸ºçš„ä¸œè¥¿ã€‚å¦‚ä¸Šé¢çš„ä¸‰ç±»å‡½æ•°ï¼Œä¸åŒç¨‹åº¦ä¸Šçº¦æŸäº†æ³›åž‹ã€‚æ·±åº¦å†…å®¹ç•™å¾…åŽæ–‡å­¦ä¹ ã€‚&lt;/p>
&lt;p>ç©¶ç«Ÿä½•ä¸ºâ€œæ•èŽ·â€ï¼ŸRustæ˜¯æ²¡æœ‰åžƒåœ¾å›žæ”¶çš„è¯­è¨€ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ç”Ÿå‘½å‘¨æœŸã€‚å¼•ç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ†æžå˜é‡ç”Ÿå‘½å‘¨æœŸï¼Œä»¥å†³å®šä½¿ç”¨å“ªä¸ªTraitã€‚&lt;/p>
&lt;p>è¿˜å¯ä»¥ä½¿ç”¨å…³é”®å­—&lt;code>move&lt;/code>å¼ºåˆ¶è½¬ç§»æ‰€æœ‰æƒåˆ°é—­åŒ…ä¸­&lt;/p>
&lt;p>å‚è€ƒæ–‡æ¡£ï¼šhttps://rustwiki.org/zh-CN/rust-by-example/fn/closures/capture.html&lt;/p>
&lt;h3 id="è·‘">è·‘ðŸƒâ€&lt;/h3>
&lt;p>ä½¿ç”¨ASANå¾ˆå¿«å°±å‘çŽ°äº†å´©æºƒï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[AFL++ ae703a5ce157] /fuzzing101/exercise-2 # taskset -c 4 ./build/fuzzer
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Broker #0] (GLOBAL) run time: 0h-0m-57s, clients: 0, corpus: 0, objectives: 0, executions: 0, exec/sec: 0.000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> (CLIENT) corpus: 0, objectives: 0, executions: 0, exec/sec: 0.000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------------8&amp;lt;-------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Stats #3] (GLOBAL) run time: 0h-1m-0s, clients: 4, corpus: 3, objectives: 0, executions: 6, exec/sec: 0.000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> (CLIENT) corpus: 3, objectives: 0, executions: 6, exec/sec: 0.000, edges: 9/10 (90%)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Testcase #3] (GLOBAL) run time: 0h-1m-0s, clients: 4, corpus: 4, objectives: 0, executions: 8, exec/sec: 0.000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> (CLIENT) corpus: 4, objectives: 0, executions: 8, exec/sec: 0.000, edges: 9/10 (90%)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/crash.png"
width="1533"
height="1012"
srcset="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/crash_hu8fed232e790a612be86a124f44e3115c_224593_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/crash_hu8fed232e790a612be86a124f44e3115c_224593_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="151"
data-flex-basis="363px"
>&lt;/p>
&lt;h4 id="debugæˆ‘logåŽ»å“ªäº†">Debugï¼šæˆ‘logåŽ»å“ªäº†&lt;/h4>
&lt;p>ä½†ç»“æžœå¹¶ä¸è®©äººæ»¡æ„ï¼Œèµ·å› æ˜¯&lt;code>cargo make build&lt;/code>æ‰§è¡Œå¹¶æœªæˆåŠŸï¼Œä¸Šè¿°ç»“æžœæ˜¯æ‰‹åŠ¨ç¼–è¯‘å¾—åˆ°ã€‚æŠ¥é”™å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[cargo-make] INFO - Running Task: build-libexif
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------------8&amp;lt;-------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking for a BSD-compatible install... /usr/bin/install -c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking whether build environment is sane... yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking for a race-free mkdir -p... /usr/bin/mkdir -p
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking for gawk... no
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking for mawk... mawk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking whether make sets $(MAKE)... yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking whether make supports nested variables... yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking for POSIX sh $() command substitution... yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking for gcc... /fuzzing101/exercise-2/build/ex2_compiler
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking whether the C compiler works... no
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configure: error: in `/fuzzing101/exercise-2/libexif&amp;#39;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configure: error: C compiler cannot create executables
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">See `config.log&amp;#39; for more details
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[cargo-make] ERROR - Error while executing command, exit code: 77
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[cargo-make] WARN - Build Failed.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å®ƒæç¤ºæˆ‘ï¼Œæˆ‘çš„ç¼–è¯‘å™¨ä¸å¤§å¥½ä½¿ã€‚ä½†æ˜¯è¾ƒä¸ºç¦»è°±çš„æ˜¯æ‰‹åŠ¨æ‰§è¡Œç¼–è¯‘å´æ²¡é—®é¢˜ã€‚
é‚£ä¹ˆæˆ‘ä»¬çœ‹çœ‹&lt;code>config.log&lt;/code>å§ï¼Œç„¶åŽå°±æœ‰ä¸ªé—®é¢˜ï¼Œ&lt;code>config.log&lt;/code>åˆ°åº•è—å“ªäº†ã€‚&lt;/p>
&lt;blockquote>
&lt;p>ðŸ‘´ï¼šä½ æ ¹æœ¬ä¸åœ¨å·¥ä½œç›®å½•ï¼Œä½ èº²å“ªåŽ»äº† &lt;br>
cargo make: æˆ‘ä¸åˆ°å•Š&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/daoge.png"
width="480"
height="532"
srcset="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/daoge_hucb44c3664558582803009d3f384168af_251000_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/daoge_hucb44c3664558582803009d3f384168af_251000_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="90"
data-flex-basis="216px"
>&lt;/p>
&lt;p>è¿™ä¸ªå¹½çµé—®é¢˜æŠ˜ç£¨äº†æˆ‘è®¸ä¹…ï¼Œç›´åˆ°æˆ‘æ„è¯†åˆ°&lt;code>Makefile.toml&lt;/code>é‡Œé¢çš„cleané€‰é¡¹ã€‚ã€‚ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">... rest of stderr output deleted ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configure:3778: $? = 0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configure:3767: /fuzzing101/exercise-2/build/ex2_compiler -V &amp;gt;&amp;amp;5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">clang: error: unsupported option &amp;#39;-V -g&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">clang: error: no such file or directory: &amp;#39;/fuzzing101/exercise-2/libexif/libexercisetwo.a&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è™½ç„¶è¿˜æ˜¯ä¸ç†è§£ä¸ºä»€ä¹ˆï¼Œä½†æ˜¯ç…§çŒ«ç”»è™ŽæŠŠ&lt;code>libexercisetwo.a&lt;/code>æ”¾å…¥å°±ç¼–è¯‘æˆåŠŸäº†ã€‚&lt;/p>
&lt;h4 id="debugå†…å­˜çˆ†äº†">Debugï¼šå†…å­˜çˆ†äº†ï¼&lt;/h4>
&lt;p>å°½ç®¡å¾ˆå¿«è·‘å‡ºcrashï¼Œä½†fuzzerç»å¸¸å´©æºƒé€€å‡ºï¼Œå¯¼è‡´å¹¶æ²¡æœ‰crashä¿å­˜ã€‚æŠ¥é”™å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">thread &amp;#39;&amp;lt;unnamed&amp;gt;&amp;#39; panicked at &amp;#39;Fuzzer-respawner: Storing state in crashed fuzzer instance did not work, no point to spawn the next client! This can happen if the child calls `exit()`, in that case make sure it uses `abort()`, if it got killed unrecoverable (OOM), or if there is a bug in the fuzzer itself. (Child exited with: 9)&amp;#39;, /root/.cargo/registry/src/index.crates.io-6f17d22bba15001f/libafl-0.10.1/src/events/llmp.rs:1071:21
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fatal runtime error: failed to initiate panic, error 5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aborted
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æŠ¥é”™å‘Šè¯‰æˆ‘ä»¬å¯èƒ½æœ‰ä»¥ä¸‹åŽŸå› ï¼š&lt;/p>
&lt;ul>
&lt;li>child calls &lt;code>exit()&lt;/code>ï¼šæˆ‘è·‘çš„ç¡®å®žæ˜¯&lt;code>ASAN_OPTIONS=abort_on_error=1 taskset -c 6 ./build/fuzzer&lt;/code>&lt;/li>
&lt;li>fuzzeræœ‰bugï¼šæˆ‘å¯ä»¥ä¸ç›¸ä¿¡æˆ‘è‡ªå·±ï¼Œä½†æˆ‘ä¸èƒ½ä¸ç›¸ä¿¡ Rustã€‚&lt;/li>
&lt;li>OOMï¼šå†…å­˜æº¢å‡ºã€‚è§‚å¯Ÿä¸‹ä»»åŠ¡ç®¡ç†å™¨ï¼Œå¯ä»¥å‘çŽ°fuzzeræ‰§è¡ŒåŽå†…å­˜å ç”¨è¿…é€Ÿé£™å‡ï¼Œåœ¨è¾¾åˆ°90%åŽfuzzerç¨³å®šå´©æºƒé€€å‡ºã€‚&lt;/li>
&lt;/ul>
&lt;p>é‚£ä¹ˆåŸºæœ¬ç¡®è®¤æ˜¯å†…å­˜æº¢å‡ºçš„é—®é¢˜ã€‚ðŸ‘´çš„16Gå±žå®žä¸å ªå¤§ç”¨ï¼Œè¿™ä¸‹ä¸å¾—ä¸ä¹°å†…å­˜æ¡äº†ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆåŸºæœ¬ç¡®è®¤é—®é¢˜æ— è§£äº†å—ï¼ŸðŸ‘´å¼€å§‹æ€€ç–‘é—®é¢˜å‡ºåœ¨Dockerä¸Šã€‚äºŽæ˜¯ðŸ‘´å›žåˆ°å®¿ä¸»æœº WSL2 ä¸Šé‡æ–°é…çŽ¯å¢ƒã€‚è¿˜æ˜¯åœ¨æ‰§è¡Œ&lt;code>cp build/libexercisetwo.a libexif&lt;/code>ä¹‹åŽæˆåŠŸç¼–è¯‘ã€‚&lt;/p>
&lt;p>è¿™æ¬¡èƒ½å¤Ÿç¨³å®šè¿è¡Œä¸€æ®µæ—¶é—´äº†ï¼Œå¹¶ä¸”æˆåŠŸèŽ·å¾—objectiveã€‚ðŸ‘´å°±æ˜¯ä¸ªç¿æ™ºã€‚&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/final.png"
width="1366"
height="584"
srcset="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/final_hu189931506a8648410d5552fb49660c91_955953_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/final_hu189931506a8648410d5552fb49660c91_955953_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="233"
data-flex-basis="561px"
>&lt;/p>
&lt;p>ðŸ‘´å®£å¸ƒå®žéªŒ2å®Œæˆã€‚&lt;/p>
&lt;h3 id="æˆæžœè½åœ°">æˆæžœè½åœ°&lt;/h3>
&lt;p>å¥½å§è¿˜æœ‰æœ€åŽä¸€æ­¥ã€‚åœ¨è¯¸å¤šcrashä¸­å¯èƒ½æœ‰å¤§é‡å‡é˜³æ€§ï¼Œå¤§é‡é‡å¤æ¼æ´žï¼Œä¸ºäº†èŽ·å¾—æœ€ç»ˆçš„CVEç¼–å·ï¼Œè¿˜éœ€è¦è´¹æ—¶è´¹åŠ›çš„è¾¨åˆ«ã€‚AFLTriage å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„è‡ªåŠ¨åŒ–å·¥å…·ï¼Œå®ƒä½¿ç”¨ GDB å¹¶è¡Œçš„æ‰§è¡Œæ¼æ´žåˆ†ç±»ã€ ASAN è§£æžå’Œ crash åŽ»é‡ç­‰å·¥ä½œã€‚&lt;/p>
&lt;p>AFLTriage çš„å·¥ä½œæµç¨‹ååˆ†ç®€å•ï¼šå°†crashä¾æ¬¡ä¸¢è¿›targetæ‰§è¡Œï¼Œå¹¶è§£è¯»æ‰§è¡ŒæŠ¥å‘Šã€‚
å› æ­¤ï¼Œé¦–å…ˆè¦ä¸ºharnessæ·»åŠ ä¸€ä¸ªmainå‡½æ•°ï¼Œä½¿å…¶è°ƒç”¨ä¸€æ¬¡&lt;code>LLVMFuzzerTestOneInput()&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// harness.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cp">#ifdef TRIAGE_TESTER
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">stat&lt;/span> &lt;span class="n">st&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">filename&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">stat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">st&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">FILE&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">fd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;rb&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">buffer&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">st&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">st_size&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buffer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">st&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">st_size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">LLVMFuzzerTestOneInput&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buffer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">st&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">st_size&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buffer&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fclose&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#endif
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œé€šè¿‡&lt;code>#ifdef&lt;/code>å®æŒ‡ä»¤å’Œbuildé€‰é¡¹å¯¹åº”ï¼Œæ‰§è¡Œ&lt;code>cargo make build-triager&lt;/code>å³å¯è¿›å…¥åˆ†ç±»æµç¨‹ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-triager&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cwd&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;build&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">command&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;./ex2_compiler&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">args&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;-D&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;TRIAGE_TESTER&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-I&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;../libexif/libexif&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-I&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;../libexif&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-o&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;triager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;../harness.c&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;lib/libexif.a&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æœ€åŽæ‰§è¡ŒAFLTriageï¼š&lt;code>../AFLTriage/target/release/afltriage -i ./solutions/ -o ./reports/ ./build/triager @@&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/traige.png"
width="1252"
height="587"
srcset="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/traige_hu377d03d0596fd3cb6672fca4fa7c6181_590421_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/traige_hu377d03d0596fd3cb6672fca4fa7c6181_590421_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="213"
data-flex-basis="511px"
>&lt;/p>
&lt;p>å¾—åˆ°3ä¸ªreportï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">afltriage_ASAN_heap-buffer-overflow_READ_exif_entry_get_value_f8a5a368646cf8484298dd0549da6e12.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">afltriage_ASAN_unknown-crash_WRITE_exif_mnote_data_olympus_save_1e4a69a1a4d7585d8ae1e143a3b5eb94.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">afltriage_SIGSEGV___memmove_sse2_unaligned_erms_b1cfe4f5c38c4991e7c55dccdfb06372.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ðŸ‘´è¿˜æœ‰ç‚¹æ€€ç–‘ASANçš„è¾“å‡ºå¥½åƒéƒ½æ˜¯fuzzeré‡Œé¢çš„bugï¼Œä½†æ˜¯é˜…è¯»æŠ¥å‘Šä¹‹åŽå‘çŽ°ç¡®å®žæ˜¯targeté‡Œé¢çš„ã€‚åªæ˜¯åŽŸåšå®¢çš„ASANèƒ½å¤ŸæŒ‡å‡ºTargetæºä»£ç çš„è¡Œå·ï¼ŒðŸ‘´çš„åªèƒ½æ‹¿åˆ°äºŒè¿›åˆ¶åœ°å€ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Summary: ASAN detected heap-buffer-overflow in exif_entry_get_value after a READ leading to SIGABRT (si_signo=6) / SI_TKILL (si_code=-6)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------------8&amp;lt;-------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#10 0x0000555555695c85 in exif_entry_get_value (/home/czy/fuzzing-101-solutions/exercise-2/build/triager)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 542: const exif_entry_get_value(e = (ExifEntry *)0x604000000350, val = (char *)&amp;lt;optimized out&amp;gt;, maxlen = (unsigned int)1999) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |||:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |||: /* Local reference: ExifEntry * e = 0x604000000350; */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 682: */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 683: if (e-&amp;gt;size &amp;amp;&amp;amp; e-&amp;gt;data &amp;amp;&amp;amp;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 684: (strspn ((char *)e-&amp;gt;data, &amp;#34; &amp;#34;) != strlen ((char *) e-&amp;gt;data)))
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |||:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ---: }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> at exif-entry.c:684
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åªèƒ½è¯´ðŸ‘´çš„çŽ¯å¢ƒè¿˜æ˜¯æœ‰ç‚¹æ¯›ç—…ï¼Œ WSL2 é‡Œé¢è·‘æ¯” WSL2+Docker é‡Œé¢è·‘ï¼Œç¨³å®šè¿è¡Œæ—¶é—´é•¿ï¼Œä½†ä¹Ÿä¸è¶…è¿‡ä¸‰åˆ†é’Ÿã€‚ðŸ‘´åªèƒ½æ‰‹åŠ¨æ–­æ–­ç»­ç»­çš„é‡æ–°è·‘ï¼Œè¿™æ ·fuzzerçš„çŠ¶æ€å…¶å®žæ˜¯ä¸¢å¤±äº†çš„ã€‚åŽé¢çš„å®žéªŒè¿˜æ˜¯åˆ«æŠ˜è…¾æˆ‘è¿™ä¸ªç ´æœ¬å­äº†ã€‚&lt;/p>
&lt;p>è€Œä¸”è·‘å‡ºæ¥çš„crashðŸ‘´çœ‹ç€ä¹Ÿä¸åƒé¢„æœŸè¦æŒ–çš„é‚£ä¿©CVEã€‚ä½†æ˜¯è¿™äº›éƒ½ä¸å½±å“ðŸ‘´å†æ¬¡å®£å¸ƒå®žéªŒ2å®Œæˆã€‚&lt;/p></description></item><item><title>libAFLé€Ÿé€šFuzzing101 (1)</title><link>https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-1/</link><pubDate>Wed, 26 Jul 2023 02:54:55 +0800</pubDate><guid>https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-1/</guid><description>&lt;img src="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-1/exe1.png" alt="Featured image of post libAFLé€Ÿé€šFuzzing101 (1)" />&lt;blockquote>
&lt;p>æœ¬ç³»åˆ—æ˜¯å­¦ä¹ &lt;a class="link" href="https://epi052.gitlab.io/notes-to-self/blog/2021-11-01-fuzzing-101-with-libafl/" target="_blank" rel="noopener"
>ã€ŠFuzzing101 with LibAFLã€‹&lt;/a>ç³»åˆ—åšå®¢ï¼ˆåŽæ–‡ç»Ÿç§°ï¼šåŽŸåšå®¢ï¼‰çš„ç¬”è®°åˆ†äº«ï¼Œåœ¨å­¦ä¹ ä»‹ç» LibAFL ç”¨æ³•çš„åŒæ—¶æ€»ç»“ Rust çŸ¥è¯†ç‚¹ã€‚&lt;br>
&lt;strong>å‰ç½®çŸ¥è¯†&lt;/strong>ï¼š fuzzåŸºæœ¬æ¦‚å¿µã€AFLåŸºæœ¬ä½¿ç”¨ &lt;br>
&lt;strong>æœ¬ç¯‡è¦ç‚¹&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>LibAFL
&lt;ul>
&lt;li>9å¤§ç»„ä»¶&lt;/li>
&lt;li>Forkserveræ¨¡å¼ï¼šç®€å•ç»„è£…&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Rust
&lt;ul>
&lt;li>Cargo åŸºæœ¬ä½¿ç”¨&lt;/li>
&lt;li>å˜é‡æ‰€æœ‰æƒï¼š
&lt;ul>
&lt;li>è½¬ç§»(move) å’Œ æ‹·è´(copy)&lt;/li>
&lt;li>å¼•ç”¨(reference) å’Œ å€Ÿç”¨(borrowing)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;hr>
&lt;h2 id="æ˜¯ä¸æ˜¯æžfuzzçš„éƒ½åœ¨æžrust">æ˜¯ä¸æ˜¯æžfuzzçš„éƒ½åœ¨æžrust&lt;/h2>
&lt;p>&lt;a class="link" href="https://github.com/antonio-morales/Fuzzing101" target="_blank" rel="noopener"
>Fuzzing101&lt;/a>æ˜¯å¤§åé¼Žé¼Žçš„ Fuzzing å…¥é—¨æ•™ç¨‹ã€‚ðŸ‘´ä¹‹å‰æžè¿‡ä¸€ç‚¹ï¼Œæ•…è¿™æ¬¡æ•´ç‚¹èŠ±æ´»ã€‚çœ‹åˆ°æœ‰ä¸ªå«&lt;a class="link" href="https://epi052.gitlab.io/notes-to-self/blog/" target="_blank" rel="noopener"
>epi052&lt;/a>çš„å¤§ä½¬ç”¨ LibAFL åš Fuzzing101ï¼ŒäºŽæ˜¯ðŸ‘´ä¹Ÿè·Ÿç€å­¦ä¸€æ³¢rustã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/AFLplusplus/LibAFL" target="_blank" rel="noopener"
>LibAFL&lt;/a>æ˜¯ç”¨ Rust å†™çš„ Fuzzing æ¡†æž¶ï¼Œä¸»è¦è´¡çŒ®åœ¨äºŽç»™å‡ºäº†ä¸€å¥— Fuzzer çš„æ ‡å‡†åŒ–å®šä¹‰ï¼Œä»¥æ­¤è¯•å›¾æ”¹å–„å½“ä»Š Fuzzing ç ”ç©¶ç•Œæˆæžœå€å‡ºä½†äº’ä¸å…¼å®¹ï¼Œç»å¸¸é‡å¤é€ è½®å­çš„çŽ°è±¡ã€‚&lt;/p>
&lt;p>LibAFL éš¶å±žäºŽ AFL++ é¡¹ç›®ç»„ï¼Œæ•…éœ€è¦å…ˆé…ç½® AFL++ ã€‚è€Œ AFL++ çš„å®˜æ–¹ Docker é•œåƒå°±åŒ…å«äº† Rust çŽ¯å¢ƒï¼Œæ‰€ä»¥ä½¿ç”¨ Docker é… LibAFL çŽ¯å¢ƒå°±åªéœ€ä¸€å¥è¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker pull aflplusplus/aflplusplus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker run -ti -v ./Fuzzing101:/fuzzing101 aflplusplus/aflplusplus
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="execise-1-xpdf">Execise-1 xpdf&lt;/h2>
&lt;p>ç»ƒä¹ ä¸€ä¸»è¦æ˜¯ç†Ÿæ‚‰åŸºæœ¬æµç¨‹ã€‚ä½¿ç”¨AFLä¸»è¦æœ‰ä»¥ä¸‹æ­¥éª¤ï¼š&lt;/p>
&lt;ul>
&lt;li>ç›®æ ‡ç¼–è¯‘æ’æ¡©ã€‚å¦‚ï¼š&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">LLVM_CONFIG&lt;/span>&lt;span class="o">=&lt;/span>llvm-config-15
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CC&lt;/span>&lt;span class="o">=&lt;/span>afl-clang-fast &lt;span class="nv">CXX&lt;/span>&lt;span class="o">=&lt;/span>afl-clang-fast++ ./configure --prefix&lt;span class="o">=&lt;/span>./install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make install
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>è¯­æ–™åº“å‡†å¤‡&lt;/li>
&lt;li>æ‰§è¡Œafl-fuzz&lt;/li>
&lt;/ul>
&lt;p>Let&amp;rsquo;s see å¦‚ä½•ç”¨Rustå®Œæˆä¸Šè¿°æ­¥éª¤ã€‚&lt;/p>
&lt;h3 id="rust-åŸºç¡€ä¹‹cargo">Rust åŸºç¡€ä¹‹cargo&lt;/h3>
&lt;p>åœ¨ Rust ä¸­ï¼Œå¯ä»¥ç”¨&lt;code>rustc&lt;/code>ç¼–è¯‘å•ä¸ªæ–‡ä»¶ï¼Œæ›´å¸¸è§çš„æ˜¯ä½¿ç”¨åŒ…ç®¡ç†å™¨&lt;code>cargo&lt;/code>ã€‚&lt;/p>
&lt;h4 id="cargotoml">Cargo.toml&lt;/h4>
&lt;p>è¿è¡Œ&lt;code>cargo new&lt;/code>åˆ›å»ºä¸€ä¸ª package ï¼Œå…¶ä¸­å¿…æœ‰&lt;code>Cargo.toml&lt;/code>ï¼Œæè¿° package å¦‚ä½•æž„å»ºã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># execise-1/Cargo.toml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">package&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;exercise-1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;0.1.0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">edition&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;2021&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">build&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;build.rs&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">dependencies&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">libafl&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;0.10.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æœ¬é¡¹ç›®é¦–å…ˆè§„å®šäº†æž„å»ºè„šæœ¬ä¸º&lt;code>build.rs&lt;/code>ï¼Œç„¶åŽå¼•å…¥äº† libafl ä¾èµ–ã€‚
è¿è¡Œ&lt;code>cargo build&lt;/code>æ—¶ï¼ŒCargo ä¼šè‡ªåŠ¨å¤„ç†ä¾èµ–ã€‚(åŒ…æ‹¬ crates.io ä¸‹è½½å®‰è£…ï¼Œæˆ‘è§‰å¾—è¿™å°±æ˜¯çŽ°ä»£è¯­è¨€çš„ä¸€ç§è‡ªä¿¡)&lt;/p>
&lt;h4 id="buildrs">build.rs&lt;/h4>
&lt;p>æž„å»ºè„šæœ¬æ˜¯ä¸ºäº†æ–¹ä¾¿ Rust é¡¹ç›®ä¸Žç¬¬ä¸‰æ–¹å·¥å…·çš„é›†æˆã€‚æ¯”å¦‚ä¸Šæ–‡ä¸­ç›®æ ‡ç¼–è¯‘çš„å‡ æ¡æŒ‡ä»¤ï¼Œå°±å¯ä»¥ç”¨ Rust std åº“ä¸­çš„Commandç±»æ¥æ‰§è¡Œã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// make clean;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">Command&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;make&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">arg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;clean&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">current_dir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">xpdf_dir&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">clone&lt;/span>&lt;span class="p">())&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">expect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Couldn&amp;#39;t clean xpdf directory&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä½¿ç”¨æž„å»ºè„šæœ¬è¿˜æœ‰è®¸å¤šå¥½å¤„ï¼Œå¯ä»¥åˆ©ç”¨ Cargo é‡‡å–æ›´çµæ´»çš„æž„å»ºç­–ç•¥ã€‚æž„å»ºè„šæœ¬çš„è¾“å‡ºå¯ä»¥è¢« Cargo è§£é‡Šï¼Œåªéœ€æ‰“å°ä»¥&lt;code>cargo:&lt;/code> å¼€å¤´çš„æŒ‡ä»¤ã€‚å¦‚ä¸‹é¢ä¸¤è¡Œè¾“å‡ºå‘ Cargo è¡¨æ˜Žä»…åœ¨è¿™ä¸¤ä¸ªæ–‡ä»¶å‘ç”Ÿæ”¹åŠ¨æ—¶æ‰§è¡Œæž„å»ºè„šæœ¬ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;cargo:rerun-if-changed=build.rs&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;cargo:rerun-if-changed=src/main.rs&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="libafl-ç»„è£…">LibAFL ç»„è£…&lt;/h3>
&lt;p>ä¸Šè¿°è¿˜æ˜¯ç”œç‚¹ï¼Œä¸‹é¢è¿›å…¥æ­£èœçŽ¯èŠ‚ã€‚ LibAFL å°† Fuzzer å®šä¹‰ä¸º9ä¸ªç»„ä»¶ï¼Œåˆ†åˆ«æ˜¯ï¼š&lt;/p>
&lt;blockquote>
&lt;p>æ‘˜è‡ª&lt;a class="link" href="https://chinggg.github.io/post/libafl/" target="_blank" rel="noopener"
>è¿™ç¯‡åšå®¢&lt;/a>ã€‚&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>Inputï¼šç¨‹åºçš„è¾“å…¥ã€‚
&lt;ul>
&lt;li>é‡ç‚¹æ˜¯æ ¼å¼ï¼Œæœ€å¸¸è§çš„å°±æ˜¯ byte arrayï¼Œä¹Ÿæœ‰ASTç­‰ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Corpusï¼šè¾“å…¥å’Œå…¶é™„å±žå…ƒæ•°æ®çš„å­˜å‚¨ã€‚
&lt;ul>
&lt;li>å­˜å‚¨æœ‰ä½äºŽå†…å­˜å’Œä½äºŽç¡¬ç›˜ä¸¤ç§ï¼ŒåŽè€…æ›´å¹¿æ³›ã€‚è¾“å…¥ä¹Ÿå¯åˆ†ä¸ºæœ‰åŠ©äºŽè¿›åŒ–çš„ interesting testcase å’Œæœ€ç»ˆè§¦å‘ crash çš„ solutionã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Schedulerï¼šä»Ž corpus ä¸­é€‰å– testcase çš„è°ƒåº¦ç­–ç•¥ã€‚
&lt;ul>
&lt;li>æœ€æœ´ç´ çš„å³å…ˆè¿›å…ˆå‡ºæˆ–éšæœºé€‰æ‹©ï¼Œä¹Ÿå¯å¼•å…¥ä¼˜å…ˆçº§ç®—æ³•ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Stageï¼šå®šä¹‰å¯¹ testcase è¿›è¡Œçš„æ“ä½œï¼ˆactionï¼‰ã€‚
&lt;ul>
&lt;li>å¾€å¾€ä¼šè¿›è¡Œå¤šé˜¶æ®µçš„æ“ä½œã€‚å¦‚ AFL ä¸­çš„ random havoc stageã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Observerï¼šæä¾›ä¸€æ¬¡æ‰§è¡Œç›®æ ‡ç¨‹åºçš„ä¿¡æ¯ã€‚
&lt;ul>
&lt;li>å¸¸ç”¨çš„ coverage map å°±æ˜¯ä¸€ç§ observerã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Executorï¼šç”¨ fuzzer çš„è¾“å…¥æ¥æ‰§è¡Œç›®æ ‡ç¨‹åºã€‚
&lt;ul>
&lt;li>ä¸åŒ fuzzer åœ¨è¿™æ–¹é¢åŒºåˆ«å¾ˆå¤§ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Feedbackï¼šå°†ç¨‹åºæ‰§è¡Œçš„ç»“æžœåˆ†ç±»ä»¥å†³å®šæ˜¯å¦å°†å…¶åŠ å…¥ corpusã€‚
&lt;ul>
&lt;li>feedback é€šå¸¸å¤„ç†ä¸€ä¸ªæˆ–å¤šä¸ª observer æŠ¥å‘Šçš„ä¿¡æ¯æ¥åˆ¤æ–­ execution æ˜¯å¦ â€œinterestingâ€ï¼Œæ˜¯å¦æ˜¯æ»¡è¶³æ¡ä»¶çš„ solutionï¼Œæ¯”å¦‚å¯è§‚æµ‹çš„ crashã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Mutatorï¼šä»Žä¸€ä¸ªæˆ–å¤šä¸ªè¾“å…¥ç”Ÿæˆæ–°çš„ testcaseã€‚
&lt;ul>
&lt;li>é€šå¸¸æ˜¯æœ€å¸¸æ”¹åŠ¨çš„ï¼Œä¸åŒ mutator å¯ä»¥ç»„åˆï¼Œå¾€å¾€è¿˜å’Œç‰¹å®šçš„è¾“å…¥ç±»åž‹ç»‘å®šã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Generatorï¼šå‡­ç©ºäº§ç”Ÿæ–°çš„è¾“å…¥ã€‚
&lt;ul>
&lt;li>æœ‰éšæœºç”Ÿæˆçš„ï¼Œä¹Ÿæœ‰ Nautilus è¿™ç§åŸºäºŽè¯­æ³•çš„ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ LibAFL å®žçŽ°ä¸­è¿˜æœ‰è‹¥å¹²é‡è¦ç»„ä»¶ï¼š&lt;/p>
&lt;blockquote>
&lt;p>&lt;a class="link" href="https://docs.rs/libafl/0.10.1/libafl/" target="_blank" rel="noopener"
>APIæ–‡æ¡£&lt;/a> &lt;br>
è¯· å‚é˜…&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>State: åŒ…å«äº†è¿è¡Œæ—¶çš„æ‰€æœ‰å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬ Corpusã€RNG ç­‰ã€‚&lt;/li>
&lt;li>Bolts: å·¥å…·åº“ï¼Œå®žçŽ°äº†è¯¸å¦‚å…±äº«å†…å­˜çš„æ”¯æŒã€‚&lt;/li>
&lt;li>Monitor: å‘ç”¨æˆ·æ‰“å°logä¹‹ç±»ã€‚&lt;/li>
&lt;li>Events: ç»„ä»¶ä¹‹é—´é€šä¿¡&lt;/li>
&lt;li>Fuzzer: é¡¶å±‚ç»„ä»¶ï¼ŒæŠŠä¸€åˆ‡ç»„ç»‡èµ·æ¥&lt;/li>
&lt;/ul>
&lt;p>å› åŽŸåšå®¢çš„è®²è§£å¾ˆè¯¦ç»†ï¼Œä¸”æä¾›äº†å®Œæ•´ä»£ç ã€‚æ•…æœ¬æ–‡è¯•å›¾åˆ‡æ¢è§†è§’ï¼Œä»Žè‡ªé¡¶å‘ä¸‹çš„è§’åº¦æ‹†è§£ä»£ç ï¼š&lt;/p>
&lt;h4 id="ç»„ä»¶fuzzer">ç»„ä»¶ï¼šFuzzer&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">monitor&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">SimpleMonitor&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{s}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">mgr&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">SimpleEventManager&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">monitor&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">scheduler&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">IndexesLenTimeMinimizerScheduler&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">QueueScheduler&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">());&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">mutator&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">StdScheduledMutator&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">havoc_mutations&lt;/span>&lt;span class="p">());&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">stages&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">tuple_list!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">StdMutationalStage&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mutator&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">-------------&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="o">&amp;lt;-------------&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">fuzzer&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">StdFuzzer&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">scheduler&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">feedback&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">objective&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">fuzzer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">fuzz_loop&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">stages&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">executor&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">state&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">mgr&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¯ä»¥çœ‹åˆ° &lt;code>StdFuzzer&lt;/code> ä¸²è”èµ·äº†å…¨éƒ¨ç»„ä»¶ã€‚&lt;code>mgr&lt;/code>ã€&lt;code>scheduler&lt;/code>ã€&lt;code>mutator&lt;/code>ã€&lt;code>stages&lt;/code> éƒ½æ˜¯ä½¿ç”¨åº“è‡ªå¸¦çš„ç±»ï¼Œå›ºçœç•¥ä¹‹ï¼Œä¸‹é¢è¯¦è¿°å¤æ‚äº›çš„ç»„ä»¶ã€‚&lt;/p>
&lt;h4 id="ç»„ä»¶state">ç»„ä»¶ï¼šState&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">state&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">StdState&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">StdRand&lt;/span>::&lt;span class="n">with_seed&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">current_nanos&lt;/span>&lt;span class="p">()),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">input_corpus&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">timeouts_corpus&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">feedback&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">objective&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æŸ¥é˜…æ–‡æ¡£å¯çŸ¥&lt;code>StdState&lt;/code>çš„æˆå‘˜å«ä¹‰ï¼Œè¿™äº›æˆå‘˜å°±æ˜¯Fuzzerçš„å…¨éƒ¨çŠ¶æ€äº†ã€‚ä¸€ä¸ªå¯èƒ½çš„ç–‘æƒ‘æ˜¯ä¸ºä»€ä¹ˆä¼šæœ‰&lt;code>feedback&lt;/code>ã€&lt;code>objective&lt;/code>ä¸¤ç§ Feedbackï¼Œè®©æˆ‘ä»¬ç»§ç»­å‘ä¸Šæ£€é˜…ä»£ç ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pub fn new&amp;lt;F, O&amp;gt;(
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rand: R,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> corpus: C,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> solutions: SC,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> feedback: &amp;amp;mut F,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> objective: &amp;amp;mut O
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">) -&amp;gt; Result&amp;lt;Self, Error&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">where
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> F: Feedback&amp;lt;Self&amp;gt;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> O: Feedback&amp;lt;Self&amp;gt;,
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="rust-åŸºç¡€ä¹‹æ‰€æœ‰æƒ">Rust åŸºç¡€ä¹‹æ‰€æœ‰æƒ&lt;/h4>
&lt;p>æ‰€æœ‰æƒï¼Œæ˜¯ Rust ç‰¹æœ‰çš„è®¾è®¡ï¼Œåœ¨æ— GCçš„å‰æä¸‹å®žçŽ°å†…å­˜å®‰å…¨ä¸Žé«˜æ€§èƒ½ã€‚åŸºæœ¬è§„åˆ™ï¼š&lt;/p>
&lt;ol>
&lt;li>Rust ä¸­æ¯ä¸€ä¸ªå€¼éƒ½è¢«ä¸€ä¸ªå˜é‡æ‰€æ‹¥æœ‰ï¼Œè¯¥å˜é‡è¢«ç§°ä¸ºå€¼çš„æ‰€æœ‰è€…&lt;/li>
&lt;li>ä¸€ä¸ªå€¼åŒæ—¶åªèƒ½è¢«ä¸€ä¸ªå˜é‡æ‰€æ‹¥æœ‰ï¼Œæˆ–è€…è¯´ä¸€ä¸ªå€¼åªèƒ½æ‹¥æœ‰ä¸€ä¸ªæ‰€æœ‰è€…&lt;/li>
&lt;li>å½“æ‰€æœ‰è€…(å˜é‡)ç¦»å¼€ä½œç”¨åŸŸèŒƒå›´æ—¶ï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒ(drop)&lt;/li>
&lt;/ol>
&lt;p>åŸºäºŽè¿™äº›åŽŸåˆ™ï¼Œå½“ä¸€ä¸ªå€¼è¢«å¦ä¸€ä¸ªå˜é‡ä½¿ç”¨æ—¶ï¼Œä¼šå‘ç”Ÿæ‰€æœ‰æƒçš„è½¬ç§»ï¼Œå…ˆå‰çš„å˜é‡ä¾¿ä¸èƒ½è®¿é—®è¯¥å€¼ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;hello&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s2&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s1&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">, world!&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s1&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// æŠ¥é”™ï¼
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;hello&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s2&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">clone&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">, world!&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s1&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// ä¸æŠ¥é”™
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;x = &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">, y = &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// ä¸æŠ¥é”™
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>è½¬ç§»(move) å’Œ æ‹·è´(copy)&lt;/li>
&lt;/ul>
&lt;p>&lt;code>let s2 = s1;&lt;/code>åœ¨ Rust ä¸­è¢«ç§°ä¸ºå˜é‡ç»‘å®šï¼Œä»£è¡¨s1è¢«ç§»åŠ¨åˆ°äº†s2ã€‚&lt;/p>
&lt;p>å¦‚æžœæƒ³è¦è®¿é—®ç›¸åŒå€¼ï¼Œéœ€è¦å¯¹å˜é‡è¿›è¡Œæ‹·è´ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œintç±»åž‹æ²¡æœ‰æ‹·è´ä¹Ÿä¸æŠ¥é”™ï¼Œè¿™æ˜¯å› ä¸ºåŸºæœ¬ç±»åž‹çš„å¤§å°æ˜¯å·²çŸ¥çš„ï¼Œä¸”åˆ†é…åœ¨æ ˆä¸Šï¼Œå¯¹ä»–çš„æ‹·è´æ¯”è¾ƒç®€å•ï¼Œæ•… Rust è‡ªåŠ¨å®žçŽ°äº†æ‹·è´ã€‚è€ŒStringæ˜¯å¤æ‚ç±»åž‹ï¼Œå¿…é¡»æ˜¾å¼çš„æ‹·è´ã€‚&lt;/p>
&lt;ul>
&lt;li>å¼•ç”¨(reference) å’Œ å€Ÿç”¨(borrowing)&lt;/li>
&lt;/ul>
&lt;p>å°†å€¼åœ¨å˜é‡ä¹‹é—´ä¼ æ¥ä¼ åŽ»ç¡®å®žæ¯”è¾ƒéº»çƒ¦ã€‚ Rustå®žçŽ°äº†2ç§å¼•ç”¨ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>&amp;amp;&lt;/code>: ä¸å¯å˜å¼•ç”¨ï¼Œå…è®¸ä½¿ç”¨å€¼ä½†ä¸èŽ·å–æ‰€æœ‰æƒã€‚å¯ä»¥æœ‰å¤šä¸ªã€‚&lt;/li>
&lt;li>&lt;code>&amp;amp;mut&lt;/code>: å¯å˜å¼•ç”¨ã€‚ä»…èƒ½å­˜åœ¨ä¸€ä¸ªã€‚&lt;/li>
&lt;li>å¯å˜å¼•ç”¨ä¸Žä¸å¯å˜å¼•ç”¨ä¸èƒ½åŒæ—¶å­˜åœ¨ã€‚&lt;/li>
&lt;/ul>
&lt;p>èŽ·å–å˜é‡çš„å¼•ç”¨ï¼Œå°±ç§°ä¸ºå€Ÿç”¨ã€‚æ˜¾ç„¶ï¼Œåœ¨ç¦»å¼€ä½œç”¨åŸŸåŽæ‰€æœ‰æƒå°†è¢«å½’è¿˜ã€‚å¼•ç”¨çš„ä½œç”¨åŸŸä»Žåˆ›å»ºä¸€ç›´æŒç»­åˆ°å®ƒæœ€åŽä¸€æ¬¡ä½¿ç”¨ï¼Œè€Œå˜é‡çš„ä½œç”¨åŸŸä»Žåˆ›å»ºæŒç»­åˆ°æŸä¸€ä¸ªèŠ±æ‹¬å·&lt;code>}&lt;/code>ã€‚&lt;/p>
&lt;p>å¯¹å¼•ç”¨æœ‰æ•ˆæ€§çš„æ£€æŸ¥æ˜¯ Rust è§£å†³æ•°æ®ç«žäº‰ï¼Œæ‚¬åž‚æŒ‡é’ˆç­‰å®‰å…¨é—®é¢˜çš„é‡è¦æœºåˆ¶ã€‚&lt;/p>
&lt;p>åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œéœ€è¦&lt;code>feedback&lt;/code>å’Œ&lt;code>objective&lt;/code>éšç€&lt;code>state&lt;/code>æ›´æ–°è€Œä¸æ–­ç§¯ç´¯ï¼Œå› æ­¤ä½¿ç”¨å¯å˜å¼•ç”¨ã€‚è€Œå…¶ä»–æˆå‘˜å’Œ&lt;code>state&lt;/code>ç›¸å…³ï¼Œæ•…ç›´æŽ¥å°†æ‰€æœ‰æƒç§»äº¤ç»™&lt;code>state&lt;/code>ã€‚&lt;/p>
&lt;p>å‚è€ƒæ–‡æ¡£ï¼šhttps://course.rs/basic/ownership/ownership.html&lt;/p>
&lt;h4 id="ç»„ä»¶observer--feedback">ç»„ä»¶ï¼šObserver &amp;amp; Feedback&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">time_observer&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">TimeObserver&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;time&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">unsafe&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">HitcountsMapObserver&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">StdMapObserver&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;shared_mem&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">shmem_buf&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">feedback&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">feedback_or!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">MaxMapFeedback&lt;/span>::&lt;span class="n">tracking&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">TimeFeedback&lt;/span>::&lt;span class="n">with_observer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">time_observer&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">objective&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">feedback_and_fast!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">TimeoutFeedback&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">MaxMapFeedback&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚å®šä¹‰æ‰€è¨€ï¼ŒObserver ä»…æä¾›ä¿¡æ¯ï¼ŒFeedback å°†è§‚å¯Ÿåˆ°çš„ä¿¡æ¯è¿›è¡Œåˆ¤æ–­ã€‚
åœ¨æœ¬ä¾‹ä¸­ï¼Œé¦–å…ˆå®šä¹‰çš„ä¸¤ä¸ªObserveråˆ†åˆ«æä¾›äº†ä»£ç è¿è¡Œæ—¶é—´å’Œä¾¿è¦†ç›–çŽ‡çš„ä¿¡æ¯ã€‚
ç„¶åŽåˆ†å¸ƒå¯¹ä»–ä»¬è¿›è¡Œäº†ä¸åŒçš„åé¦ˆåˆ¤æ–­ã€‚&lt;code>feedback_or&lt;/code>å’Œ&lt;code>feedback_and_fast&lt;/code>æ˜¯é€»è¾‘åˆ¤æ–­å®ã€‚å› æ­¤å¯ä»¥è§£è¯»ä»–ä»¬çš„é€»è¾‘ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>feedback&lt;/code>çš„æ¡ä»¶æ˜¯è¦†ç›–äº†æ–°çš„åˆ†æ”¯ æˆ– â€œè¿è¡Œæ—¶é—´åé¦ˆâ€ã€‚æ•…åé¦ˆçš„æ˜¯æœ‰è¶£çš„æ ·ä¾‹(interesting testcase)
&lt;ul>
&lt;li>å®žé™…ä¸Šï¼Œâ€œè¿è¡Œæ—¶é—´åé¦ˆâ€æ°¸è¿œä¸ä¼šçœŸçš„åé¦ˆï¼Œéœ€è¦é…åˆå…¶ä»–åé¦ˆä½¿ç”¨ã€‚è¿™é‡Œä»…ä½œç¤ºä¾‹ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>objective&lt;/code>çš„æ¡ä»¶æ˜¯è¦†ç›–äº†æ–°çš„åˆ†æ”¯ ä¸” è¿è¡Œè¶…æ—¶ã€‚æ•…åé¦ˆçš„æ˜¯èƒ½è§¦å‘æ— é™é€’å½’æ¼æ´žçš„æ ·ä¾‹ï¼Œå³æˆ‘ä»¬æƒ³è¦çš„ç»“æžœï¼ˆsolutionï¼‰&lt;/li>
&lt;/ul>
&lt;h4 id="ç»„ä»¶executor">ç»„ä»¶ï¼šExecutor&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">fork_server&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">ForkserverExecutor&lt;/span>::&lt;span class="n">builder&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">program&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;./xpdf/install/bin/pdftotext&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">parse_afl_cmdline&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="s">&amp;#34;@@&amp;#34;&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">coverage_map_size&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">MAP_SIZE&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">build&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="fm">tuple_list!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">time_observer&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">timeout&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Duration&lt;/span>::&lt;span class="n">from_secs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">executor&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">TimeoutForkserverExecutor&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fork_server&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">timeout&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æˆ‘ä»¬çš„ Executor è¿˜æ˜¯é‡‡ç”¨ç»å…¸çš„ forkserver æž¶æž„ï¼Œæž„å»º Executor æ—¶ï¼Œé¦–å…ˆåŠ å…¥äº†ä¸¤ä¸ª Observer ï¼Œç„¶åŽæŒ‡å®šäº†è¶…æ—¶æ—¶é—´ï¼Œæœ‰åŠ©äºŽå¢žåŠ fuzzåžåé‡ã€‚&lt;/p>
&lt;h3 id="è·‘">è·‘ðŸƒâ€&lt;/h3>
&lt;p>æ€»ä¹‹å€ŸåŠ© LibAFL çš„æ¡†æž¶ï¼Œå†™ä¸€ä¸ª Fuzzer è¿˜æ˜¯å¾ˆæ¸…æ™°çš„ã€‚ï¼ˆæˆ–è®¸è‹¥å¹²å¹´åŽçš„ Fuzzing å­¦ä¹ è€…å°±ä¸ç”¨å•ƒAFLçš„1000è¡Œæºç äº†ðŸ˜­ï¼‰&lt;/p>
&lt;p>æœ€åŽè·‘å‡ºæ¥ä¸€ä¸ªæ­»å¾ªçŽ¯ã€‚ðŸ‘´å®£å¸ƒå®žéªŒä¸€å®Œæˆã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[AFL++ 798a8ebfa8a4] /fuzzing101/exercise-1 # ./xpdf/install/bin/pdftotext ./timeouts/c497979e26a808e9
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error: PDF file is damaged - attempting to reconstruct xref table...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2459): Dictionary key must be a name object
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2465): Illegal character &amp;#39;&amp;gt;&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2468): Dictionary key must be a name object
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2471): Dictionary key must be a name object
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2486): Dictionary key must be a name object
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2488): Illegal character &amp;lt;2f&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2489): Illegal character &amp;lt;78&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2490): Illegal character &amp;lt;6d&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2491): Illegal character &amp;lt;70&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2492): Illegal character &amp;lt;3a&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2493): Illegal character &amp;lt;4d&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2494): Illegal character &amp;lt;6f&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2496): Illegal character &amp;lt;69&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2498): Illegal character &amp;lt;79&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2501): Illegal character &amp;lt;74&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2503): Dictionary key must be a name object
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------------8&amp;lt;-------------
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>ã€Šæ‰€ä»¥ä½ æƒ³åšå®‰ä¿å·¥ä½œ?ã€‹è¯»åŽæ„Ÿ</title><link>https://lonelyuan.github.io/p/%E6%89%80%E4%BB%A5%E4%BD%A0%E6%83%B3%E5%81%9A%E5%AE%89%E4%BF%9D%E5%B7%A5%E4%BD%9C%E8%AF%BB%E5%90%8E%E6%84%9F/</link><pubDate>Fri, 07 Jul 2023 20:29:12 +0800</pubDate><guid>https://lonelyuan.github.io/p/%E6%89%80%E4%BB%A5%E4%BD%A0%E6%83%B3%E5%81%9A%E5%AE%89%E4%BF%9D%E5%B7%A5%E4%BD%9C%E8%AF%BB%E5%90%8E%E6%84%9F/</guid><description>&lt;p>è¿™ä¸ª&lt;a class="link" href="http://ifsec.blogspot.com/" target="_blank" rel="noopener"
>ã€Šä¼Šä¸‡Â·å¼—æ‹‰ç‰¹é‡Œå…‹çš„å®‰å…¨åšå®¢ã€‹&lt;/a>å•Šï¼Œç¡®å®žæ˜¯ä¸ªå¥½åšå®¢ã€‚è¿™ç¯‡&lt;a class="link" href="http://ifsec.blogspot.com/2018/02/so-you-want-to-work-in-security-and-for.html" target="_blank" rel="noopener"
>ã€Šæ‰€ä»¥ä½ æƒ³åšå®‰ä¿å·¥ä½œ?ã€‹&lt;/a>å•Šï¼Œç¡®å®žæ˜¯ç¯‡å¥½æ–‡ç« ã€‚é‚£ä¹ˆæˆ‘ä¸€ä¸ªæ–°ä¸–çºªç†å·¥ç§‘æˆ˜å£«ï¼Œæ€Žä¹ˆå¼€å§‹å†™è¯»åŽæ„Ÿäº†å‘¢ï¼Ÿè€æ¿çš„ä»»åŠ¡ç½¢äº†ã€‚&lt;/p>
&lt;p>ä¼Šä¸‡è€å“¥æ˜¯è°·æ­Œçš„å®‰å…¨ç ”ç©¶å‘˜ï¼Œä»£è¡¨ä½œæœ‰winaflç­‰ã€‚èƒ½ä¸Šå¤§åŽ‚å½“ç ”ç©¶å‘˜ï¼Œå·²ç»æ˜¯æˆ‘å¯¹èŒä¸šç”Ÿæ¶¯çš„ç†æƒ³äº†ã€‚æ–‡ç« è¯´ï¼Œå¯¹å¤§éƒ¨åˆ†äººæ¥è¯´ï¼Œå®‰å…¨é¦–å…ˆæ˜¯ä¸€ä¸ªçˆ±å¥½ç„¶åŽæ‰æ˜¯å·¥ä½œã€‚è¯šç„¶ï¼Œæ²¡æœ‰çº¯ç²¹çš„çˆ±å¥½æ˜¯æ— æ³•æä¾›é•¿æ—¶é—´åå†·æ¿å‡³çš„è‡ªé©±åŠ›çš„ã€‚ä½†æˆ–è®¸å¤§éƒ¨åˆ†äººå¹¶æ²¡æœ‰å¯¹æŸä¸€ä»¶äº‹çš„ç‹‚çƒ­çˆ±å¥½ï¼Œåœ¨è¤ªåŽ»å…‰é²œå¤–è¡¨åŽï¼Œå¤§éƒ¨åˆ†äººéƒ½æ˜¯ä¸‰åˆ†é’Ÿçƒ­åº¦ã€‚äººä»¬å¸¸è¯´â€œå…´è¶£å¤§äºŽå¤©èµ‹â€ï¼Œæˆ–è®¸æµ“åŽšçš„å…´è¶£æœ¬èº«å°±æ˜¯ä¸€ç§ç¨€æœ‰çš„å¤©èµ‹ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Donâ€™t look now but getting started is more difficult now than it was 10 years ago&lt;/p>
&lt;/blockquote>
&lt;p>å®‰å…¨ç ”ç©¶çš„å…¥é—¨éš¾åº¦æ¯”åå¹´å‰æ›´é«˜ã€‚è€Œæœ¬æ–‡å‘å¸ƒäºŽ2018å¹´ï¼Œé‚£æ—¶æˆ‘æ­£å€¼é«˜è€ƒï¼Œå›½å†…CTFå½¢åŠ¿æ–¹å…´æœªè‰¾ï¼ŒçŽ°åœ¨ç½‘ç»œä¸Šéšå¤„å¯è§çš„å…¥é—¨çŸ¥è¯†ï¼Œéƒ½æ˜¯å½“æ—¶çš„çƒ­é—¨è€ƒç‚¹ã€‚æ–‡ç« è¯´CTFæ˜¯å¾ˆå¥½çš„å…¥é—¨æ–¹å¼ï¼Œå¯ä»¥å‡ç¼“å­¦ä¹ æ›²çº¿çš„é™¡å³­ç¨‹åº¦ã€‚è€ŒçŽ°åœ¨ï¼Œåˆè¿‡åŽ»äº†åŠä¸ªåå¹´ï¼Œæˆ‘ä¹Ÿç´§èµ¶æ…¢èµ¶æ­¥å…¥ç ”ç©¶ç”Ÿé˜¶æ®µã€‚è¿™ä¸ªç»“è®ºèƒ½å¦é€‚ç”¨äºŽå½“ä¸‹çš„å…¥é—¨è€…ï¼Œææ€•éš¾ä»¥ä¸‹å®šè®ºã€‚ï¼ˆä»…é™äºŽä¸­å›½å¤§é™†ï¼‰ï¼ˆåªæ˜¯å› ä¸ºä½œè€…æ²¡æœ‰åŽ»è¿‡å…¶ä»–å›½å®¶ï¼Œæ²¡æœ‰è¯´ä¸­å›½å¤§é™†ä¸å¥½çš„æ„æ€ï¼‰ã€‚&lt;/p>
&lt;p>å½“ç„¶æˆ‘ä¹Ÿä¸æ˜¯è¾“å‡ºè´Ÿèƒ½é‡ï¼Œé¢å¯¹è¶Šæ¥è¶Šå·çš„å¸‚åœºï¼Œé¢å¯¹å…¨çƒç»æµŽå‘å±•ä¸‹è¡Œçš„çŽ¯å¢ƒï¼Œé¢å¯¹æ²¡æœ‰åŽŸå§‹èµ„æœ¬çš„è‡ªå·±ï¼Œå”¯ä¸€èƒ½åšçš„å°±æ˜¯å°½å¯èƒ½å­¦ä¹ å…è´¹çš„çŸ¥è¯†å’ŒæŠ€èƒ½ï¼Œé™è§‚å…¶å˜ã€‚ä½œè€…æœ€åŽè¯´ï¼Œæžå®‰å…¨éœ€è¦é•¿æ—¶é—´åç”µè„‘ï¼Œå¹¶ä¸”&amp;quot;quite intellectually challenging&amp;quot;ï¼Œç»å¸¸&amp;quot;mentally exhausting&amp;quot;ã€‚æ­¤è¨€è¯šç„¶ï¼Œè¦åšå¥½é•¿æ—¶é—´å¾—ä¸åˆ°å›žæŠ¥çš„è§‰æ‚Ÿï¼Œå¯»æ‰¾å’ŒåŸ¹å…»æ­£åé¦ˆï¼›åŒæ—¶ä¹Ÿè¦åŠ å¼ºé”»ç‚¼ï¼Œèº«ä½“å¥åº·å’Œç²¾ç¥žå¥åº·ä¸¤æ‰‹æŠ“ã€‚&lt;/p></description></item><item><title>é—²æ¥æ— äº‹ï¼Œå€’è…¾åšå®¢</title><link>https://lonelyuan.github.io/p/%E9%97%B2%E6%9D%A5%E6%97%A0%E4%BA%8B%E5%80%92%E8%85%BE%E5%8D%9A%E5%AE%A2/</link><pubDate>Sun, 07 Nov 2021 14:19:11 +0000</pubDate><guid>https://lonelyuan.github.io/p/%E9%97%B2%E6%9D%A5%E6%97%A0%E4%BA%8B%E5%80%92%E8%85%BE%E5%8D%9A%E5%AE%A2/</guid><description>&lt;h2 id="åŽ†å²ç¯‡">åŽ†å²ç¯‡&lt;/h2>
&lt;h3 id="ä½ ä»¬-cli-ç¡®å®žæ¯”-gui-æœ‰ç‚¹ç´ è´¨">ä½ ä»¬ CLI ç¡®å®žæ¯” GUI æœ‰ç‚¹ç´ è´¨&lt;/h3>
&lt;p>è¦è®ºè®¡ç®—æœºäººçš„å…¸ä¸­å…¸ï¼Œè¿˜å¾—æ˜¯nå¹´ä¸æ›´æ–°åªæœ‰å¯¥å¯¥å‡ ç¯‡æ–‡ç« çš„ Hexo åšå®¢ã€‚å®ƒä»£è¡¨ç€å‘½ä»¤è¡Œåˆå­¦è€…çš„å…´å¥‹ï¼Œç¬¬ä¸€æ¬¡é… node çŽ¯å¢ƒæˆåŠŸåŽçš„å–œæ‚¦ï¼Œä»¥åŠä¸€ä¸ªæœˆä¹‹åŽçš„ç–‘é—®ï¼š&lt;/p>
&lt;ul>
&lt;li>è¿™ç‚¹å±äº‹æˆ‘ä¸ºä»€ä¹ˆä¸å‘ç§‹ç§‹ç©ºé—´/å¾®åšï¼Ÿ&lt;/li>
&lt;li>åªæœ‰æˆ‘çœ‹æˆ‘ä¸ºä»€ä¹ˆä¸è®° Onenote/Notion ï¼Ÿ&lt;/li>
&lt;li>æƒ³è¦æµé‡æˆ‘ä¸ºä»€ä¹ˆä¸å‘çŸ¥ä¹Ž/ç®€ä¹¦/è¥¿åŸƒæ–¯å¼Ÿæ©â€¦â€¦ï¼Ÿ&lt;/li>
&lt;/ul>
&lt;p>å°½ç®¡ä»ŽçŽ°åœ¨çœ‹ä»¿ä½›æ˜¯å‰æœé—è€ï¼Œä¸ªäººåšå®¢ä¾æ—§æ˜¯ä¸å­˜åœ¨äºŽä¸­æ–‡äº’è”ç½‘ä¸­çš„æžå°‘æ•°é«˜è´¨é‡ä¸­æ–‡å†…å®¹ã€‚å®ƒä»£è¡¨ç€ &lt;a class="link" href="https://phuker.github.io/posts/web-feed.html" target="_blank" rel="noopener"
>RSS&lt;/a> ï¼Œä»£è¡¨ç€æ°¸è¿œä¸ç”¨æ‹…å¿ƒè·‘è·¯å’Œå®¡æŸ¥ï¼Œæ˜¯ geek ä»¬çš„ç²¾ç¥žè‡ªç•™åœ°ã€‚&lt;/p>
&lt;p>ä½†æ˜¯ðŸ‘´è¿˜æ˜¯è§‰å¾—å‘ä¸€ç¯‡åšå®¢æ•²å¥½å‡ æ¡å‘½ä»¤éº»çƒ¦çš„è¦æ­»ã€‚å¤§æ¦‚æ˜¯ðŸ‘´ä¸å†å¹´è½»äº†ï¼ŒðŸ‘´å¼€å§‹è¿½æ±‚ç®€å•å®‰é€¸ï¼ŒåƒæŒ¨äº†é”¤çš„ç‰›ä¸€æ ·ã€‚äºŽæ˜¯ðŸ‘´æœ€ç»ˆé€‰ç”¨ &lt;a class="link" href="https://gridea.dev/" target="_blank" rel="noopener"
>Gridea&lt;/a> ï¼Œä¸€ä¸ªåšå®¢å®¢æˆ·ç«¯ï¼Œå¯ä¸€é”®æŽ¨é€åˆ° Github Pageã€‚è¿™çŽ©æ„æœ‰äº›ä¸å¤ªè¶æ‰‹çš„åœ°æ–¹ï¼Œç­‰ðŸ‘´é—²æ¥æ— äº‹çš„æ—¶å€™æžä¸€æžäºŒæ¬¡å¼€å‘â€¦â€¦&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/%E9%97%B2%E6%9D%A5%E6%97%A0%E4%BA%8B%E5%80%92%E8%85%BE%E5%8D%9A%E5%AE%A2/MML.jpg"
width="1920"
height="1080"
srcset="https://lonelyuan.github.io/p/%E9%97%B2%E6%9D%A5%E6%97%A0%E4%BA%8B%E5%80%92%E8%85%BE%E5%8D%9A%E5%AE%A2/MML_hudd718c4853e7b37b7be00e1d7a560003_150859_480x0_resize_q75_box.jpg 480w, https://lonelyuan.github.io/p/%E9%97%B2%E6%9D%A5%E6%97%A0%E4%BA%8B%E5%80%92%E8%85%BE%E5%8D%9A%E5%AE%A2/MML_hudd718c4853e7b37b7be00e1d7a560003_150859_1024x0_resize_q75_box.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="177"
data-flex-basis="426px"
>&lt;/p>
&lt;p>ç„¶è€Œï¼ŒðŸ‘´è¿˜æ²¡ç­‰åˆ°é—²æ¥æ— äº‹çš„æ—¶å€™ï¼Œå‘è§‰Grideaä½œè€…å¼ƒå‘äº†ã€‚ã€‚ã€‚å…¶å®¢æˆ·ç«¯ï¼ˆelectronå®³äººä¸æµ…ï¼‰ç¼–è¾‘ä½“éªŒå·®ï¼Œgitæ›´æ–°è€å‡ºæ¯›ç—…ã€‚ä½œè€…çŽ°åœ¨åªæ›´æ–°webç«¯ï¼Œæ‰˜ç®¡åˆ°ä»–çš„äº‘æœåŠ¡ä¸‹é¢ã€‚ðŸ‘´è¿˜æ˜¯æ›´ç›¸ä¿¡githubä¸ä¼šè·‘è·¯ï¼Œæ‰€ä»¥ðŸ‘´è¿˜æ˜¯èµ¶ç´§è·‘è·¯å§ã€‚äºŽæ˜¯ï¼š&lt;/p>
&lt;hr>
&lt;h3 id="ä½ ä»¬-js-ç¡®å®žæ¯”-go-æœ‰ç‚¹ç´ è´¨">ä½ ä»¬ JS ç¡®å®žæ¯” Go æœ‰ç‚¹ç´ è´¨&lt;/h3>
&lt;p>äºŽæ˜¯ðŸ‘´æœ€ç»ˆé€‰ç”¨ Hugo åšåšå®¢ï¼Œå› ä¸ºä¸Ž Hexo ç›¸æ¯” Hugo çš„è¿è¡Œé€Ÿåº¦å’Œç©ºé—´å ç”¨éƒ½ååˆ†è½»é‡ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œä½œä¸º Go å¼€å‘çš„é¡¹ç›®ï¼Œå¯ä»¥ç›´æŽ¥ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸éœ€è¦æ¼äººçš„é…çŽ¯å¢ƒçŽ¯èŠ‚ã€‚ðŸ‘´çœ‹ä¸­äº† Stack ä¸»é¢˜ï¼Œä½†æ˜¯è¿™ä¸ªä¸»é¢˜ç”¨çš„äººä¸å°‘ï¼Œæœ‰äº›åƒç¯‡ä¸€å¾‹çš„å°´å°¬ã€‚ä¸ºæ­¤ðŸ‘´å†³å®šæ·±è€•æ¢çš®ä¹‹é“â€¦â€¦&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/%E9%97%B2%E6%9D%A5%E6%97%A0%E4%BA%8B%E5%80%92%E8%85%BE%E5%8D%9A%E5%AE%A2/L.jpg"
width="1280"
height="720"
srcset="https://lonelyuan.github.io/p/%E9%97%B2%E6%9D%A5%E6%97%A0%E4%BA%8B%E5%80%92%E8%85%BE%E5%8D%9A%E5%AE%A2/L_hu370e1e5aa388fd67190c4efe195d2393_378413_480x0_resize_q75_box.jpg 480w, https://lonelyuan.github.io/p/%E9%97%B2%E6%9D%A5%E6%97%A0%E4%BA%8B%E5%80%92%E8%85%BE%E5%8D%9A%E5%AE%A2/L_hu370e1e5aa388fd67190c4efe195d2393_378413_1024x0_resize_q75_box.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="177"
data-flex-basis="426px"
>&lt;/p>
&lt;h2 id="åŽŸç†ç¯‡">åŽŸç†ç¯‡&lt;/h2>
&lt;h3 id="hugo-é¡¹ç›®ç»“æž„">Hugo é¡¹ç›®ç»“æž„&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ archetypes # .md æ¨¡æ¿
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â””â”€â”€ default.md
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ config.toml # é…ç½®æ–‡ä»¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ content # åœ¨è¿™å†™ä¸œè¥¿
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ data # æ›´å¤šé…ç½®æ–‡ä»¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ layouts # .html æ¨¡æ¿
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ public # æ¸²æŸ“å¥½çš„ç½‘ç«™
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ static # é™æ€æ–‡ä»¶ï¼Œhugoä¼šå…¨éƒ¨å¤åˆ¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â””â”€â”€ themes # åšå®¢ä¸»é¢˜
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="content">content&lt;/h4>
&lt;p>è¿™é‡Œæ˜¯ Hugo çš„è¾“å…¥ï¼Œå­˜æ”¾&lt;code>.md&lt;/code>æ ¼å¼çš„æ–‡ç« ã€‚ä½¿ç”¨&lt;code>hugo new&lt;/code>å‘½ä»¤æ—¶ï¼Œä¼šå°è¯•ä»Ž&lt;code>archetypes&lt;/code>ç›®å½•å¯»æ‰¾å¯¹åº”çš„æ¨¡æ¿ï¼Œæ¨¡æ¿é€šå¸¸ä»…åŒ…å«front matterï¼Œå®šä¹‰äº†æ–‡ç« çš„å…ƒå±žæ€§ã€‚è¯­æ³•å¦‚ä¸‹ï¼š&lt;/p>
&lt;p>&lt;code>hugo new &amp;lt;SECTIONNAME&amp;gt;/&amp;lt;FILENAME&amp;gt;.&amp;lt;FORMAT&amp;gt;&lt;/code>&lt;/p>
&lt;p>&lt;code>content&lt;/code>ä¸­çš„å­æ–‡ä»¶å¤¹ç§°ä¸º sections ï¼Œå®ƒä»¬æ˜¯ç½‘ç«™å†…å®¹çš„åŸºæœ¬åˆ†å—ã€‚åˆ†å—çš„ç›®çš„æ˜¯åˆ†é…ä¸åŒçš„å¤„ç†æ–¹å¼ï¼Œå¦‚postéœ€è¦å±•ç¤ºæ–‡ç« åˆ—è¡¨ï¼Œpageä»…å±•ç¤ºå•ç‹¬é¡µé¢ç­‰ã€‚é…ç½®ä¸­çš„&lt;code>permalinks&lt;/code>é¡¹å°±æ˜¯ä»¥åˆ†å—ä¸ºå•ä½åˆ†é…URLã€‚&lt;/p>
&lt;h4 id="public">public&lt;/h4>
&lt;p>è¿™é‡Œæ˜¯ Hugo çš„è¾“å‡ºï¼Œå­˜æ”¾å®Œæ•´çš„ HTML é™æ€ç½‘é¡µã€‚ä½¿ç”¨&lt;code>hugo&lt;/code>å‘½ä»¤æ—¶ï¼Œä¼šå°è¯•ä»Ž&lt;code>layouts&lt;/code>ç›®å½•å¯»æ‰¾å¯¹åº”çš„æ¨¡æ¿ï¼Œ HTML æ¨¡æ¿å‡ä»¥ GO æ¨¡æ¿è¯­æ³•ç¼–å†™ã€‚åœ¨å†™æ–‡ç« æ—¶ä¹Ÿå¯ä½¿ç”¨æ¨¡æ¿æ¥é¿å…å†™ HTML çš„ç¹æ‚ï¼Œå¦‚ Hugo æä¾›çš„å„ç§ &lt;a class="link" href="https://stack.jimmycai.com/writing/shortcodes" target="_blank" rel="noopener"
>shortcode&lt;/a> ã€‚&lt;/p>
&lt;p>ä»¥ Github Page ä¸ºä¾‹ï¼Œéƒ¨ç½²æ—¶ä»…éœ€å°†è¿™ä¸ªæ–‡ä»¶å¤¹åŒæ­¥è‡³ github.io ä»“åº“å³å¯ã€‚&lt;/p>
&lt;h3 id="hugo-è®¾è®¡ç†å¿µ">Hugo è®¾è®¡ç†å¿µ&lt;/h3>
&lt;p>ã€To be continuedã€‘ç¿»è¯‘ç¿»è¯‘å®˜æ–¹æ–‡æ¡£&lt;/p>
&lt;!-- ### ä»Ž front matter åˆ°
Hugo ä¸­å¯¹äºŽæ–‡ç« çš„åˆ†ç±»é«˜åº¦å¯å®šåˆ¶ï¼Œå­˜åœ¨ä¸‰ä¸ªå±‚æ¬¡çš„æ¦‚å¿µï¼š
- Taxonomy åˆ†ç±»æ³•ï¼Œåˆ†ç±»çš„æ ‡å‡†çš„é›†åˆï¼Œåˆæˆ–è€…æ˜¯å…ƒåˆ†ç±»ã€‚
- åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰
- Term åˆ†ç±»æ ‡å‡†
- å¦‚ Tags ã€ Category æ˜¯ Hugo é»˜è®¤æ”¯æŒçš„åˆ†ç±»
- Value åˆ†ç±»çš„å…·ä½“å€¼
- åœ¨æ–‡ç« çš„front matter ä¸­å®šä¹‰
Hugo ä¼šä¸ºå„ç§åˆ†ç±»æ³•ç”Ÿæˆåˆ—è¡¨é¡µï¼Œæ–¹ä¾¿æ£€ç´¢æ–‡ç« ã€‚
https://www.jianshu.com/p/e1f9123c721a
https://gohugo.io/content-management/front-matter/
-->
&lt;h2 id="å¼€å‘ç¯‡">å¼€å‘ç¯‡&lt;/h2>
&lt;h3 id="å¦‚ä½•ä¼˜é›…çš„äºŒæ¬¡å¼€å‘">å¦‚ä½•ä¼˜é›…çš„äºŒæ¬¡å¼€å‘ï¼Ÿ&lt;/h3>
&lt;p>è§‚å¯Ÿ&lt;code>theme&lt;/code>çš„å†…å®¹ï¼Œä¼šå‘çŽ°é™¤äº†æ²¡æœ‰&lt;code>content&lt;/code>ç›®å½•ä¹‹å¤–å’Œç½‘ç«™æ ¹ç›®å½•ç»“æž„å®Œå…¨ä¸€è‡´ã€‚ç”±æ­¤çŒœæµ‹ï¼Œæ‰€è°“&lt;code>theme&lt;/code>ä¹Ÿæ˜¯ä¸€ä¸ª siteï¼Œä½¿ç”¨&lt;code>theme&lt;/code>å°±æ˜¯ç”¨å…¶æ¨¡æ¿è¦†ç›–æˆ‘ä»¬çš„ç½‘ç«™ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆï¼Œç›´æŽ¥ä¿®æ”¹&lt;code>theme&lt;/code>ç›®å½•é‡Œçš„å†…å®¹è‡ªç„¶å¯è¡Œï¼Œä½†å¦‚æžœéœ€è¦å‡çº§ä¸»é¢˜ï¼Œåˆ™ä¼šäº§ç”Ÿè®¸å¤šè®¨åŽŒçš„mergeé—®é¢˜ã€‚å¦‚ä½•å®žçŽ°æ•°æ®å’Œé…ç½®çš„è§£è€¦ï¼Ÿå®žé™…ä¸Šï¼Œä¸Šè¿°å…³äºŽè¦†ç›–é¡ºåºçš„çŒœæƒ³å¹¶ä¸å‡†ç¡®ï¼Œå®žé™…é¡ºåºæ˜¯ï¼š&lt;code>æœ¬åœ°æ¨¡æ¿â†’ä¸»é¢˜æ¨¡æ¿â†’é»˜è®¤æ¨¡æ¿&lt;/code>ã€‚æ•…è€Œï¼Œåœ¨æœ¬åœ°æ¨¡æ¿ä¸­æ·»åŠ ç›¸åŒè·¯å¾„ä¸‹çš„åŒåæ¨¡æ¿æ–‡ä»¶ï¼Œå³å¯è¦†ç›–æŽ‰ä¸»é¢˜æ¨¡æ¿çš„é…ç½®ã€‚&lt;/p>
&lt;p>ä»¥ Stack ä¸»é¢˜ä¸ºä¾‹ï¼Œå…¶åœ¨è®¸å¤šä½ç½®éƒ½å­˜åœ¨ç€è¯¸å¦‚&lt;code>hugo-theme-stack\assets\scss\custom.scss&lt;/code>çš„ç©ºç™½æ–‡ä»¶ï¼Œåªéœ€è¦åœ¨æ ¹ç›®å½•æ–°å»º&lt;code>\assets\scss\custom.scss&lt;/code>å³å¯æ·»åŠ å¯¹ CSS çš„æ”¹åŠ¨ã€‚&lt;/p>
&lt;p>ä¸€èˆ¬æ¥è¯´ï¼Œä»¿ç…§ä¸»é¢˜æä¾›çš„demoç½‘ç«™å³å¯æ»¡è¶³ä¸€èˆ¬çš„äºŒæ¬¡å¼€å‘éœ€æ±‚ã€‚å…³äºŽæ¨¡æ¿æŸ¥æ‰¾é¡ºåºè¿˜æœ‰è¯¸å¤šç»†èŠ‚ï¼Œè¯·å‚é˜…å®˜æ–¹æ–‡æ¡£ï¼š&lt;a class="link" href="https://gohugo.io/templates/lookup-order/" target="_blank" rel="noopener"
>Template lookup order&lt;/a>ã€‚&lt;/p>
&lt;h4 id="articleå…ƒä¿¡æ¯lastmodwordcount">articleå…ƒä¿¡æ¯ï¼šlastmodï¼Œwordcount&lt;/h4>
&lt;p>Hugo æœ¬èº«ä¸ºæ¯ç¯‡æ–‡ç« éƒ½ç»Ÿè®¡äº†ç›¸å…³å˜é‡ï¼Œä½† Stack ä¸»é¢˜æ²¡æœ‰å±•ç¤ºã€‚ä»ŽF12å®šä½åˆ°ç›¸å…³å…ƒç´ ï¼Œå…¶æ¨¡æ¿åœ¨ï¼š&lt;code>\themes\hugo-theme-stack\layouts\partials\article\components\details.html&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">footer&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;article-time&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ if $showDate }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ partial &amp;#34;helper/icon&amp;#34; &amp;#34;date&amp;#34; }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">time&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;article-time--published&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{- .Date.Format (&amp;#34;2006-1-1&amp;#34;) -}} &lt;span class="ni">&amp;amp;nbsp;&lt;/span>published
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">time&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{- if ne .Lastmod .Date -}}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">time&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;article-time--published&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{- .Lastmod.Format (&amp;#34;2006-1-1&amp;#34;) -}} &lt;span class="ni">&amp;amp;nbsp;&lt;/span>last modified
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{- end -}}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">time&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ end }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ if $showReadingTime }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ partial &amp;#34;helper/icon&amp;#34; &amp;#34;clock&amp;#34; }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">time&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;article-time--reading&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ T &amp;#34;article.readingTime&amp;#34; .ReadingTime }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">span&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;post-word-count&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>, {{ .WordCount }} words&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">span&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">time&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {{ end }}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="ä»£ç å—è¡Œå·çªå‡ºè¡Œ">ä»£ç å—ï¼šè¡Œå·ï¼Œçªå‡ºè¡Œ&lt;/h4>
&lt;p>ã€To be continuedã€‘&lt;/p>
&lt;h4 id="é…è‰²å­—ä½“">é…è‰²ï¼Œå­—ä½“&lt;/h4>
&lt;p>ã€To be continuedã€‘&lt;/p>
&lt;h4 id="å¯Œæ–‡æœ¬jsèŠ±æ´»">å¯Œæ–‡æœ¬â€”â€”jsèŠ±æ´»&lt;/h4>
&lt;p>ã€To be continuedã€‘&lt;/p>
&lt;ul>
&lt;li>å¯¼å›¾&lt;/li>
&lt;li>è¯äº‘&lt;/li>
&lt;li>&lt;/li>
&lt;/ul>
&lt;h3 id="ä½ è¿™é™æ€ç½‘ç«™ä¸æ˜¯å¾ˆé™æ€å•Š">ä½ è¿™é™æ€ç½‘ç«™ä¸æ˜¯å¾ˆé™æ€å•Š&lt;/h3>
&lt;h4 id="è¯„è®ºç³»ç»Ÿ">è¯„è®ºç³»ç»Ÿ&lt;/h4>
&lt;p>ðŸ‘´ä½œä¸ºç™½å«–æ€ªï¼Œæ—¢ç„¶é€‰æ‹©äº†Github Pageså½“ç„¶è¦é€‰æ‹©åŒç”Ÿæ€çš„æ–¹æ¡ˆã€‚ç›®å‰æœ‰åŸºäºŽissueçš„ Gitalk å’Œ Giscus ä¸¤ç§æ–¹æ¡ˆã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Gitalkï¼šåŸºäºŽissueï¼Œå’Œä»“åº“ç»‘å®š&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a class="link" href="https://giscus.app/zh-CN" target="_blank" rel="noopener"
>Giscus&lt;/a>ï¼šåŸºäºŽGitHub Discussions&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å…¶ä»–Stackä¸»é¢˜æ”¯æŒçš„è¯„è®ºç³»ç»Ÿï¼šhttps://stack.jimmycai.com/config/comments&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h4 id="ç½‘ç«™ç»Ÿè®¡">ç½‘ç«™ç»Ÿè®¡&lt;/h4>
&lt;p>æ•™ç¨‹ä¸€å¤§æŠŠï¼Œæžå®šç§‘å­¦ä¸Šç½‘å°±æ²¡é—®é¢˜ã€‚&lt;/p>
&lt;p>ç„¶åŽä½ å°±ä¼šå‘çŽ°å¹¶æ²¡æœ‰äººæ¥è®¿é—®ã€‚&lt;/p>
&lt;p>ç»Ÿè®¡å¹³å°ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://analytics.google.com/" target="_blank" rel="noopener"
>https://analytics.google.com/&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://www.cloudflare.com/zh-cn/web-analytics/" target="_blank" rel="noopener"
>https://www.cloudflare.com/zh-cn/web-analytics/&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="å·¥ä½œæµç¯‡">å·¥ä½œæµç¯‡&lt;/h2>
&lt;p>è¿™ä¸€èŠ‚ä»‹ç»ä»Žæ’°å†™åˆ°éƒ¨ç½²è¸©å‘è¿‡çš„å·¥å…·çŽ¯å¢ƒ&lt;/p>
&lt;h3 id="ç¼–å†™vscodeæ’ä»¶-front-matterè¿™ä¸cmså—">ç¼–å†™ï¼švscodeæ’ä»¶ Front Matterï¼šè¿™ä¸CMSå—&lt;/h3>
&lt;p>è¿™ä¸ªæ’ä»¶ä¹ä¸€çœ‹æŒºåŽ‰å®³ï¼Œå®žåˆ™ä¸€æ‹–å››ã€‚æä¾›äº†ä¸€ä¸ªç±»ä¼¼CMSçš„ç•Œé¢ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–é…ç½®ä¸€äº›äº›Front Matterï¼Œæ¯”å¦‚æ—¥æœŸã€‚ä½†æ˜¯å…¶åŠŸèƒ½æ€§åªèƒ½è¯´èŠèƒœäºŽæ— ã€‚&lt;/p>
&lt;h3 id="github-pages--github-action-è‡ªåŠ¨éƒ¨ç½²">Github Pages + Github Action è‡ªåŠ¨éƒ¨ç½²&lt;/h3>
&lt;ul>
&lt;li>&lt;a class="link" href="https://gohugo.io/hosting-and-deployment/hosting-on-github/" target="_blank" rel="noopener"
>https://gohugo.io/hosting-and-deployment/hosting-on-github/&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>éƒ¨ç½²ä¹‹åŽå´å‘çŽ°æ€»æ˜¯å¸¦æœ‰é¡¹ç›®åä½œä¸ºå­è·¯å¾„ï¼ˆå³&lt;code>xxx.github.io/xxx&lt;/code>ï¼‰ã€‚è¿™å°±å¾ˆè®©äººä¸çˆ½äº†ã€‚çºµè§‚å…¨ç½‘çš„åšå®¢å¤§å¤šéƒ½å¸¦ç€è¿™ä¸ªå°¾å·´ï¼Œè¡¨ç¤ºæ€€ç–‘è¿™äº›äººç©¶ç«Ÿæ˜¯ä¸æ˜¯ä¸€ç›´è¿™ä¹ˆç”¨çš„ã€‚&lt;/p>
&lt;p>hugoå®˜æ–¹ç»™å‡ºçš„workflowä¸­ï¼Œæœ€åŽä¸€æ­¥æ˜¯è¿™æ ·çš„&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> # Deployment job
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> deploy:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> environment:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> name: github-pages
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> url: ${{ steps.deployment.outputs.page_url }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> runs-on: ubuntu-latest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> needs: build
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> steps:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - name: Deploy to GitHub Pages
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> id: deployment
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> uses: actions/deploy-pages@v2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ðŸ‘´ç›´æŽ¥ðŸurlï¼Œä½†æ˜¯&lt;code>${{ steps.deployment.outputs.page_url }}&lt;/code>æ˜¯ä¸ªç”¨æ¥è¾“å‡ºçš„ä¸œè¥¿ï¼Œæ”¹å®ƒæ²¡ç”¨ã€‚åº”è¯¥æ˜¯&lt;code>actions/deploy-pages@v2&lt;/code>è¿™ä¸ªactionæœ¬èº«çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>äºŽæ˜¯ðŸ‘´å‚è€ƒäº†22å¹´çš„å‡ ç¯‡åšå®¢ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://client.sspai.com/post/73512#" target="_blank" rel="noopener"
>https://client.sspai.com/post/73512#&lt;/a>!&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">- name: Deploy Web
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> uses: peaceiris/actions-gh-pages@v3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> with:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PERSONAL_TOKEN: ${{ secrets.PERSONAL_TOKEN }}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> EXTERNAL_REPOSITORY: pseudoyu/pseudoyu.github.io
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PUBLISH_BRANCH: master
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PUBLISH_DIR: ./public
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> commit_message: ${{ github.event.head_commit.message }}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™ç§æ–¹æ³•æ¶‰åŠä¸¤ä¸ªä»“åº“ï¼Œå› æ­¤éœ€è¦é¢å¤–é…ç½®tokenã€‚æŒ‰ç…§åšå®¢çš„æ–¹æ³•æ›¿æ¢æˆ&lt;code>peaceiris/actions-gh-pages@v3&lt;/code>åŽï¼Œå¯ä»¥æˆåŠŸåœ¨ä¸»åŸŸåæ›´æ–°äº†ã€‚&lt;/p>
&lt;p>è™½ç„¶ä½†æ˜¯ï¼Œç›®å‰çš„æ“ä½œä»Ž&lt;code>å†™åšå®¢â†’hugoâ†’git push&lt;/code>å˜æˆäº†&lt;code>å†™åšå®¢â†’hugo server(æ€»å¾—é¢„è§ˆä¸€ä¸‹å§)â†’git push&lt;/code>ï¼Œä¼¼ä¹Žå¹¶æ²¡æœ‰ä»€ä¹ˆç®€åŒ–ï¼Œï¼Œï¼Œè™½ç„¶å¯ä»¥ä¾é ç¼–è¾‘å™¨çš„è‡ªåŠ¨git commitçš„æ’ä»¶ï¼Œä½†æ˜¯ðŸ‘´è¿˜æ˜¯ä¸æƒ³æ¯æ¬¡ä¿å­˜éƒ½commitã€‚&lt;/p>
&lt;h4 id="github-action-æ”¶é›†-lastmodify">Github Action æ”¶é›† lastmodify&lt;/h4>
&lt;p>ä½¿ç”¨ Github çš„ CI/CD ç®¡çº¿å¯ä»¥åœ¨æ›´æ–°æ—¶ç»‘å®šåˆ°commitå·ï¼Œä½†æ˜¯ðŸ‘´è§‰å¾—æ²¡å¤ªå¤§ç”¨ã€‚æ”¹ä¸€ä¸ªå­—å°±æ›´æ–°lastmodè¿‡äºŽç²—ç²’åº¦ï¼Œé‚è¿˜æ˜¯é‡‡ç”¨æ‰‹åŠ¨å±•ç¤ºðŸ‘´æƒ³å±•ç¤ºçš„æ—¥æœŸã€‚&lt;/p></description></item><item><title>MOSPI-ChCore lab (1)</title><link>https://lonelyuan.github.io/p/mospi-chcore-lab-1/</link><pubDate>Fri, 29 Oct 2021 17:03:14 +0000</pubDate><guid>https://lonelyuan.github.io/p/mospi-chcore-lab-1/</guid><description>&lt;p>ç”±äºŽðŸ‘´è§‰å¾—ðŸ‘´å­¦æ ¡çš„æ“ä½œç³»ç»Ÿè®²äº†ä¸ªðŸ”¨ï¼Œæ…•åè€Œæ¥å­¦ä¹ ä¸Šäº¤çš„ MOSPI è¯¾ç¨‹ã€‚é“¶æä¹¦çœ‹å®Œä¹‹åŽðŸ‘´å‘çŽ°ðŸ‘´å­¦æ ¡çš„OSç¡®å®žè®²äº†ä¸ªðŸ”¨ã€‚æˆ‘ç›´æŽ¥å½“åœºæ¥ä¸€æ®µåœ£ç»åŸå”±ï¼š&lt;/p>
&lt;p>é‚£ä¸ªé¢è¥¿ç”µæ“ä½œç³»ç»Ÿå—·ï¼Œä¸ä¼šå†™æ•™æå¯ä»¥ä¸å†™ï¼Œå®³ç‰¹ä¹ˆåœ¨å¼„ä½ é‚£ä¸ªç®¡ç¨‹ï¼Œæ¥æˆ‘æ•™ä½ å•Šï¼Œçœ‹å¥½äº†å•Šã€‚é¦–å…ˆ M.A.L.H. åŽŸåˆ™ï¼Œçœ‹æ‡‚äº†å—ï¼Œç„¶åŽå¼€è®²&lt;strong>è™šæ‹Ÿå†…å­˜&lt;/strong>ï¼Œå“Žæˆ‘å°±ä¸è™šæ‹Ÿï¼Œæˆ‘å°±è®²é‚£ä¸ªç©ºé—²é“¾è¡¨ã€‚å“Žï¼Œå†æ‰Žä¸ª&lt;strong>å¤šçº¿ç¨‹&lt;/strong>ï¼Œçœ‹åˆ°æ²¡ï¼Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢äº†ã€‚æˆ‘ç‰¹ä¹ˆç›´æŽ¥ä¸‰æ®µ&lt;strong>ç³»ç»Ÿè°ƒåº¦&lt;/strong>ï¼ˆçŸ­æœŸï¼Œä¸­æœŸï¼Œé•¿æœŸï¼‰ï¼Œç„¶åŽæˆ‘ç›´æŽ¥~å°±ä¸€ä¸ªå¤šæ ¸è°ƒåº¦ï¼Œæˆ‘å°±è°ƒåº¦åˆ°&lt;strong>IPC&lt;/strong>ï¼Œè¿›ç¨‹çŽ°åœ¨å·²ç»å¯ä»¥é€šä¿¡äº†å•Šï¼åˆ«æ€ªæˆ‘æ²¡æœ‰æ•™å¥½ä½ ï¼Œè¿›ç¨‹é€šä¿¡äº†ä¹‹åŽå¹²ä»€ä¹ˆï¼Œæ†‹ç‰¹ä¹ˆè®²ä½ é‚£ç ´å‡ æŠŠå¤„ç†æœºäº†ã€‚çœ‹å¥½å•Šï¼Œè®²å‡ºé”ï¼ˆå¬‰çš®ç¬‘è„¸ï¼‰ï¼Œè®²å‡º&lt;strong>ä¿¡å·é‡&lt;/strong>ç›´æŽ¥å°±æ‰”åˆ°äº’æ–¥èµ„æºèº«ä¸Šï¼Œå°±ç–¯ç‹‚çš„è¿›å…¥ä»–çš„ä¸´ç•ŒåŒºã€‚ç„¶åŽæˆ‘å†ä¸€ä¸ªï¼Œ&lt;strong>æ–‡ä»¶ç³»ç»Ÿ&lt;/strong>ï¼åŠ ä¸‰æ®µç³»ç»Ÿ&lt;strong>è™šæ‹ŸåŒ–&lt;/strong>ï¼ˆCPUè™šæ‹ŸåŒ–ã€å†…å­˜è™šæ‹ŸåŒ–ã€IOè™šæ‹ŸåŒ–ï¼‰ï¼Œå…¨éƒ¨åƒæ»¡ï¼Œå®Œæˆå¼ºæ€ï¼Œä½ å”›ç’§ä½ æ‡‚ä¸ªderï¼Œè®²å¯„å§OSï¼Œæˆ‘çˆ±ä½ ã€‚&lt;/p>
&lt;p>&lt;em>åœ£ç»åŽŸæ–‡ï¼š&lt;/em>&lt;a class="link" href="https://www.bilibili.com/video/BV1Jf4y1L7EZ" target="_blank" rel="noopener"
>æ‹–æ›´äº‘çš„é¹°ä½æ•™å­¦&lt;/a>&lt;/p>
&lt;hr>
&lt;blockquote>
&lt;p>æœ¬ç³»åˆ—ä¸º ChCore lab å®žéªŒæŠ¥å‘Šã€‚
Labæºç ï¼šhttps://gitee.com/ipads-lab/chcore-lab
MOSPIåœ¨çº¿ç½‘ç«™ï¼šhttps://ipads.se.sjtu.edu.cn/mospi/&lt;/p>
&lt;/blockquote>
&lt;h2 id="å®žéªŒçŽ¯å¢ƒ">å®žéªŒçŽ¯å¢ƒ&lt;/h2>
&lt;p>éœ€è¦dockerå’Œqemuï¼Œdockerä¸èµ˜è¿°ã€‚linuxä¸‹å®‰è£…qemuï¼š
&lt;code>sudo apt-get install qemu-system-arm&lt;/code>
å®‰è£…å®Œæˆä¹‹åŽæŸ¥çœ‹ç‰ˆæœ¬å·ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">$ qemu-system-aarch64 --version
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">QEMU emulator version 4.2.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Copyright (c) 2003-2019 Fabrice Bellard and the QEMU Project developers
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>5ä¸ªå®žéªŒåœ¨æºç ä»“åº“åˆ†åˆ«ä»¥5ä¸ªåˆ†æ”¯å­˜åœ¨ã€‚ git clone -bå³å¯ã€‚&lt;/p>
&lt;p>å†…æ ¸æž„å»ºå’Œè°ƒè¯•ï¼š&lt;/p>
&lt;ul>
&lt;li>ç”¨dockeräº¤å‰ç¼–è¯‘å†…æ ¸ï¼š&lt;code>make build&lt;/code>&lt;/li>
&lt;li>å¯åŠ¨qemuï¼š&lt;code>make qemu&lt;/code>
&lt;ul>
&lt;li>è¿™é‡Œé‡åˆ°æŠ¥é”™ï¼š&lt;code> Unable to init server: Could not connect: Connection refused gtk initialization failed&lt;/code>&lt;/li>
&lt;li>è§£å†³æ–¹æ³•ï¼šä¿®æ”¹ Makefile ï¼Œåœ¨&lt;code>QEMUOPTS&lt;/code>å‚æ•°åŽåŠ &lt;code>-nographic&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¯åŠ¨qemuï¼š&lt;code>make qemu-gdb&lt;/code>
&lt;ul>
&lt;li>å°†ç›‘å¬1234ç«¯å£ä»¥ä¾›gdbè¿œç¨‹è°ƒç”¨&lt;/li>
&lt;li>é€€å‡ºï¼š&lt;code>ctrl+a&lt;/code>ï¼Œç„¶åŽæŒ‰xã€‚&lt;/li>
&lt;li>å¦‚æžœæ„å¤–é€€å‡ºï¼Œè¦æ€æ­»è¿›ç¨‹ï¼š&lt;code>kill $(ps -ef | grep qemu | grep 1234 | awk '{print $2}')&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åœ¨å¦ä¸€ä¸ªç»ˆç«¯å¯åŠ¨gdbè°ƒè¯•ï¼š&lt;code>make gdb&lt;/code>
&lt;ul>
&lt;li>è¿™é‡Œå¯èƒ½éœ€è¦å®‰è£…gdb-multiarchï¼š&lt;code>sudo apt-get install gdb-multiarch&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œæœ¬é¡¹ç›®ä¸­ Makefile ä¸»è¦æ˜¯å°è£…äº†ä¸€äº›å‘½ä»¤ã€‚&lt;/p>
&lt;hr>
&lt;h2 id="lab1">Lab1&lt;/h2>
&lt;h3 id="ç»ƒä¹ 3-åŠ è½½å…¥å£å®šä¹‰">ç»ƒä¹ 3-åŠ è½½å…¥å£å®šä¹‰&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@lastyear:~/chcore-lab# readelf -S build/kernel.img
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">There are &lt;span class="m">9&lt;/span> section headers, starting at offset 0x20cd8:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Section Headers:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Nr&lt;span class="o">]&lt;/span> Name Type Address Offset
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Size EntSize Flags Link Info Align
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 0&lt;span class="o">]&lt;/span> NULL &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">00000000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 1&lt;span class="o">]&lt;/span> init PROGBITS &lt;span class="m">0000000000080000&lt;/span> &lt;span class="m">00010000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 000000000000b5b0 &lt;span class="m">0000000000000008&lt;/span> WAX &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">4096&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 2&lt;span class="o">]&lt;/span> .text PROGBITS ffffff000008c000 0001c000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 00000000000011dc &lt;span class="m">0000000000000000&lt;/span> AX &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 3&lt;span class="o">]&lt;/span> .rodata PROGBITS ffffff0000090000 &lt;span class="m">00020000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 00000000000000f8 &lt;span class="m">0000000000000001&lt;/span> AMS &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 4&lt;span class="o">]&lt;/span> .bss NOBITS ffffff0000090100 000200f8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0000000000008000&lt;/span> &lt;span class="m">0000000000000000&lt;/span> WA &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 5&lt;span class="o">]&lt;/span> .comment PROGBITS &lt;span class="m">0000000000000000&lt;/span> 000200f8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0000000000000032&lt;/span> &lt;span class="m">0000000000000001&lt;/span> MS &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 6&lt;span class="o">]&lt;/span> .symtab SYMTAB &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">00020130&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0000000000000858&lt;/span> &lt;span class="m">0000000000000018&lt;/span> &lt;span class="m">7&lt;/span> &lt;span class="m">46&lt;/span> &lt;span class="m">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 7&lt;span class="o">]&lt;/span> .strtab STRTAB &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">00020988&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 000000000000030f &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 8&lt;span class="o">]&lt;/span> .shstrtab STRTAB &lt;span class="m">0000000000000000&lt;/span> 00020c97
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 000000000000003c &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>çœ‹åˆ°initæ®µçš„èµ·å§‹åœ°å€æ˜¯&lt;code>0x80000&lt;/code>ï¼Œå’Œ&lt;code>readelf -h&lt;/code>ä¸­çš„ Entry point address ä¸€è‡´ï¼Œä¹Ÿå’Œ GDB åˆšè¿›å…¥æ—¶&lt;code>where&lt;/code>çš„è¾“å‡ºä¸€è‡´ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">0x0000000000080000 in ?? &lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>gdb&lt;span class="o">)&lt;/span> where
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#0 0x0000000000080000 in _start ()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸‹é¢å¯»æ‰¾&lt;code>_start&lt;/code>çš„å®šä¹‰ï¼Œåœ¨&lt;code>CMakeLists.txt&lt;/code>ä¸­æ‰¾åˆ°&lt;code>_start&lt;/code>ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">set_property&lt;span class="o">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> TARGET kernel.img
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> APPEND_STRING
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PROPERTY
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> LINK_FLAGS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;-T &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">CMAKE_CURRENT_BINARY_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">link_script&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> -e _start&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œä¸º&lt;code>kernel.img&lt;/code>æŒ‡å®šäº†é“¾æŽ¥å™¨è„šæœ¬(-T)å’Œå…¥å£å‡½æ•°(-e)ã€‚&lt;/p>
&lt;p>äºŽæ˜¯è·Ÿéšlink_scriptï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">set&lt;span class="o">(&lt;/span>link_script &lt;span class="s2">&amp;#34;linker.lds&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configure_file&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;./scripts/linker-aarch64.lds.in&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;linker.lds.S&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿›å…¥è„šæœ¬linker-aarch64.lds.inï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;#34;../boot/image.h&amp;#34;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">SECTIONS&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">TEXT_OFFSET&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_start&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">.;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nl">init&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">init_object&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å…¶ä¸­&lt;code>init&lt;/code>æ®µæŒ‡å®šäº†åŠ è½½&lt;code>init_object&lt;/code>ï¼Œå®ƒè¡¨ç¤ºbootloaderçš„æ‰€æœ‰ç›®æ ‡æ–‡ä»¶é›†åˆã€‚å…¶å®šä¹‰å›žåˆ°&lt;code>CmakeLists.txt&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">set&lt;span class="o">(&lt;/span>init_object
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BINARY_KERNEL_IMG_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BOOTLOADER_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/start.S.o
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BINARY_KERNEL_IMG_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BOOTLOADER_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/mmu.c.o
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BINARY_KERNEL_IMG_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BOOTLOADER_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/tools.S.o
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BINARY_KERNEL_IMG_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BOOTLOADER_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/init_c.c.o
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BINARY_KERNEL_IMG_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BOOTLOADER_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/uart.c.o&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¯å‘çŽ°&lt;code>/boot/start.S&lt;/code>å®šä¹‰äº†&lt;code>_start&lt;/code>ã€‚&lt;/p>
&lt;p>ä¸‹é¢ç»§ç»­å¯»æ‰¾åœ°å€ï¼Œåœ¨é“¾æŽ¥å™¨è„šæœ¬å¼•ç”¨äº†&lt;code>image.h&lt;/code>ï¼Œå…¶ä¸­æœ‰&lt;code>TEXT_OFFSET&lt;/code>çš„å®šä¹‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#pragma once
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define SZ_16K 0x4000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define SZ_64K 0x10000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define KERNEL_VADDR 0xffffff0000000000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define TEXT_OFFSET 0x80000
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸€åˆ‡ç»ˆäºŽä¸²èµ·æ¥äº†ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>CMakeLists.txt&lt;/code>ï¼šæ˜¯CMakeçš„è„šæœ¬æ–‡ä»¶ã€‚ CMake æ˜¯è·¨å¹³å°çš„C/C++å»ºæž„å·¥å…·ã€‚
&lt;ul>
&lt;li>ä½œç”¨ï¼š
&lt;ul>
&lt;li>æŒ‡å®šæºæ–‡ä»¶é›†åˆ&lt;code>init_object&lt;/code>&lt;/li>
&lt;li>å®šä¹‰é“¾æŽ¥å™¨è„šæœ¬&lt;code>link_script&lt;/code>&lt;/li>
&lt;li>æŒ‡å®šå…¥å£å‡½æ•°&lt;code>_start&lt;/code>å¹¶æŒ‡å®šé“¾æŽ¥å™¨è„šæœ¬&lt;/li>
&lt;li>æœ€ç»ˆç”Ÿæˆ&lt;code>kernel.img&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>//æœ€è¿‘çœ‹åˆ°çš„æŒºå¥½çš„CMakeæ•™ç¨‹ï¼šhttps://www.bilibili.com/video/BV1rR4y1E7n9&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>linker-aarch64.lds.in&lt;/code>ï¼šldsæ˜¯é“¾æŽ¥å™¨è„šæœ¬æ–‡ä»¶ï¼Œè´Ÿè´£æŽ§åˆ¶è¾“å‡ºçš„ELFæ–‡ä»¶çš„ç»†èŠ‚ã€‚
&lt;ul>
&lt;li>ä½œç”¨ï¼šæŒ‡å®šäº†èµ·å§‹åœ°å€&lt;code>0x80000&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="ç»ƒä¹ 3-å¤šå¤„ç†å™¨æŒ‚èµ·">ç»ƒä¹ 3-å¤šå¤„ç†å™¨æŒ‚èµ·&lt;/h3>
&lt;p>&lt;code>start.S&lt;/code>ä¸­æ³¨é‡Šçš„å¾ˆæ˜Žç™½äº†ï¼Œé€šè¿‡æ£€æŸ¥&lt;code>mpidr_el1&lt;/code>å¯„å­˜å™¨æ¥åˆ¤æ–­ cpuid ï¼Œå¦‚æžœä¸æ˜¯0åˆ™è¿›å…¥æ­»å¾ªçŽ¯ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">BEGIN_FUNC&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">_start&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mrs&lt;/span> &lt;span class="n">x8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">mpidr_el1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">and&lt;/span> &lt;span class="n">x8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">x8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="err">#&lt;/span>&lt;span class="mh">0xFF&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cbz&lt;/span> &lt;span class="n">x8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">primary&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* hang all secondary processors before we intorduce multi-processors */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nl">secondary_hang&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bl&lt;/span> &lt;span class="n">secondary_hang&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nl">primary&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* Turn to el1 from other exception levels. */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bl&lt;/span> &lt;span class="n">arm64_elX_to_el1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* Prepare stack pointer and jump to C. */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">adr&lt;/span> &lt;span class="n">x0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">boot_cpu_stack&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">add&lt;/span> &lt;span class="n">x0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">x0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="err">#&lt;/span>&lt;span class="mh">0x1000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mov&lt;/span> &lt;span class="n">sp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">x0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bl&lt;/span> &lt;span class="n">init_c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* Should never be here */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">b&lt;/span> &lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">END_FUNC&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">_start&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ç»ƒä¹ 4-lmaå’Œvma">ç»ƒä¹ 4-LMAå’ŒVMA&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@lastyear:~/chcore-lab# objdump -h build/kernel.img
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">build/kernel.img: file format elf64-little
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Sections:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Idx Name Size VMA LMA File off Algn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> init 0000b5b0 &lt;span class="m">0000000000080000&lt;/span> &lt;span class="m">0000000000080000&lt;/span> &lt;span class="m">00010000&lt;/span> 2**12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> CONTENTS, ALLOC, LOAD, CODE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1&lt;/span> .text 000011dc ffffff000008c000 000000000008c000 0001c000 2**3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> CONTENTS, ALLOC, LOAD, READONLY, CODE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2&lt;/span> .rodata 000000f8 ffffff0000090000 &lt;span class="m">0000000000090000&lt;/span> &lt;span class="m">00020000&lt;/span> 2**3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> CONTENTS, ALLOC, LOAD, READONLY, DATA
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">3&lt;/span> .bss &lt;span class="m">00008000&lt;/span> ffffff0000090100 &lt;span class="m">0000000000090100&lt;/span> 000200f8 2**4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ALLOC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">4&lt;/span> .comment &lt;span class="m">00000032&lt;/span> &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">0000000000000000&lt;/span> 000200f8 2**0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> CONTENTS, READONLY
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¯ä»¥å‘çŽ°åªæœ‰initæ®µçš„VMAå’ŒLMAç›¸åŒã€‚å…¶èµ‹å€¼è¿˜æ˜¯å›žåˆ°ldsè„šæœ¬ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="n">SECTIONS&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">TEXT_OFFSET&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_start&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">.;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nl">init&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">//initæ®µVMA==VMA
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">init_object&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">ALIGN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">SZ_16K&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// å¯¹é½16k
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">init_end&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">ABSOLUTE&lt;/span>&lt;span class="p">(.);&lt;/span> &lt;span class="c1">// initæ®µç»“æŸ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// KERNEL_VADDRåœ¨image.hå®šä¹‰ä¸º0xffffff0000000000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="n">text&lt;/span> &lt;span class="n">KERNEL_VADDR&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nl">init_end&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="nf">AT&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">init_end&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// ATæŒ‡å®šLMA
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(.&lt;/span>&lt;span class="n">text&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="c1">// .textæ®µï¼šVMA = KERNEL_VADDR + init_end; LMA = init_end
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// åŽé¢çš„æ®µï¼Œå…¨éƒ¨æŒ‰é¡ºåºå¯¹é½å¹¶é€’å¢žï¼Œæ­¤æ—¶VMAå’ŒLMAå·²ç»ä¸åŒï¼Œæ•…åŽé¢çš„æ®µä¹Ÿå…¨éƒ½ä¸åŒ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">.&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">ALIGN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">SZ_64K&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nl">data&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="p">(.&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">ALIGN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">SZ_64K&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nl">rodata&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="p">(.&lt;/span>&lt;span class="n">rodata&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">_edata&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">.&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">KERNEL_VADDR&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// è¿™äº›å¤–éƒ¨å˜é‡æŒ‡çš„æ˜¯LMAï¼Œåˆ™å‡åŽ»è™šæ‹Ÿåœ°å€å¤´
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">_bss_start&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">.&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">KERNEL_VADDR&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nl">bss&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="p">(.&lt;/span>&lt;span class="n">bss&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">_bss_end&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">.&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">KERNEL_VADDR&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">ALIGN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">SZ_64K&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_end&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">.&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">KERNEL_VADDR&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å›žç­”é—®é¢˜ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ä¸ºä»€ä¹ˆLMAå’ŒVMAä¸åŒ&lt;/p>
&lt;ul>
&lt;li>VMAæ˜¯å¯¹åº”è™šæ‹Ÿå†…å­˜çš„åœ°å€ï¼Œä½†åœ¨å†…æ ¸å¯åŠ¨æ—¶è¿˜å¤„äºŽç‰©ç†åœ°å€æ¨¡å¼ï¼ŒVMAå¯èƒ½è¶…å‡ºç‰©ç†å†…å­˜èŒƒå›´ã€‚æ‰€ä»¥åªèƒ½å…ˆåŠ è½½ï¼Œå†æ˜ å°„åˆ°è™šæ‹Ÿåœ°å€ã€‚&lt;/li>
&lt;li>ä¸ºä»€ä¹ˆå†…æ ¸æ®µçš„VMAè¦æ˜ å°„åˆ°é«˜ä½ï¼Œåº”è¯¥æ˜¯ä¸€ç§æƒ¯ä¾‹ã€‚&lt;/li>
&lt;li>ä¸ºä»€ä¹ˆbootloaderä¸ç”¨VMAï¼Œå› ä¸ºä»–è´Ÿè´£åˆå§‹åŒ–é¡µè¡¨ï¼Œä»–ä¸èƒ½ç”¨ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>LMAåˆ°VMAåœ¨ä½•æ—¶è½¬æ¢&lt;/p>
&lt;ul>
&lt;li>ç”±ä¸Šä¸€é—®å¯çŸ¥ï¼Œé¡µè¡¨åˆå§‹åŒ–ä¹‹åŽä¾¿å¯è½¬æ¢ä¸ºVMAã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="ç»ƒä¹ 5-cè¯­è¨€è¿›åˆ¶è½¬æ¢">ç»ƒä¹ 5-cè¯­è¨€è¿›åˆ¶è½¬æ¢&lt;/h3>
&lt;p>ä»ŽåŽå¾€å‰å–ä½™å³å¯ã€‚&lt;/p>
&lt;h3 id="ç»ƒä¹ 6-å‡½æ•°æ ˆ">ç»ƒä¹ 6-å‡½æ•°æ ˆ&lt;/h3>
&lt;p>&lt;code>start.S&lt;/code>ä¸­èµ‹å€¼äº†spï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> /* Prepare stack pointer and jump to C. */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> adr x0, boot_cpu_stack
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add x0, x0, #0x1000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mov sp, x0 /* sp = boot_cpu_stack + 0x1000 */
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>boot_cpu_stack&lt;/code>åœ¨&lt;code>init.c&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define INIT_STACK_SIZE 0x1000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">char&lt;/span> &lt;span class="n">boot_cpu_stack&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">PLAT_CPU_NUMBER&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">INIT_STACK_SIZE&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nf">ALIGN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç”±äºŽ&lt;code>PLAT_CPU_NUMBER&lt;/code>è¢«å®šä¹‰ä¸º4ï¼Œæ•…&lt;code>boot_cpu_stack&lt;/code>å¤§å°ä¸º4*4096ï¼Œå¯ä¾›å››ä¸ªCPUä½¿ç”¨ã€‚spåˆå§‹åŒ–åŽæŒ‡å‘ç¬¬ä¸€ä¸ª4069ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªcpuå†…æ ¸æ ˆçš„æœ€é«˜ä½ã€‚åˆå§‹åŒ–æ—¶ï¼Œfp=spã€‚&lt;/p>
&lt;p>ä½†è¿™æ˜¯bootloaderçš„æ ˆã€‚åŽç»­è¿›å…¥å†…æ ¸åŽï¼Œä¼šé‡æ–°åˆ†é…å†…æ ¸æ ˆï¼Œå‚è§&lt;code>head.S&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">BEGIN_FUNC(start_kernel)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mov x3, #0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> msr TPIDR_EL1, x3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ldr x2, =kernel_stack
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add x2, x2, KERNEL_STACK_SIZE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mov sp, x2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bl main
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">END_FUNC(start_kernel)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>äºŽæ˜¯å†…æ ¸æ ˆçš„å®šä¹‰åœ¨start_kernelå‡½æ•°ã€‚&lt;/p>
&lt;p>æœ‰å…³å†…æ ¸æ ˆçš„ä½ç½®ï¼Œå› ä¸ºkernel_stackæ˜¯å…¨å±€æ•°ç»„ï¼Œä¸”æœªåˆå§‹åŒ–ï¼Œå› è€Œä½äºŽ.bssã€‚åŒæ—¶æ²¡æœ‰å…¶ä»–æœªåˆå§‹åŒ–å˜é‡ï¼Œå› æ­¤é¦–åœ°å€åœ¨&lt;code>.bss + KERNEL_STACK_SIZE&lt;/code>ã€‚&lt;/p>
&lt;p>é€šè¿‡readelfå¾—åˆ°.bssçš„VMAä¸º0xffffff0000090100ï¼ŒKERNEL_STACK_SIZEä¸º0x2000ï¼Œè¿›å…¥gdbè°ƒè¯•å¯ä»¥éªŒè¯&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">gefâž¤ x/g $sp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff0000092100 &amp;lt;kernel_stack+8192&amp;gt;: 0x0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ç»ƒä¹ 7-è°ƒç”¨æƒ¯ä¾‹">ç»ƒä¹ 7-è°ƒç”¨æƒ¯ä¾‹&lt;/h3>
&lt;p>å…ˆçœ‹stack_testå‡½æ•°ã€‚è¿™é‡Œgdbå®‰è£…äº†gefæ’ä»¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">gefâž¤ b stack_test
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Breakpoint 1 at 0xffffff000008c020
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gefâž¤ disas
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Dump of assembler code for function stack_test:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">=&amp;gt; 0xffffff000008c020 &amp;lt;+0&amp;gt;: stp x29, x30, [sp, #-32]! /* FPã€LR å…¥æ ˆ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c024 &amp;lt;+4&amp;gt;: mov x29, sp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c028 &amp;lt;+8&amp;gt;: str x19, [sp, #16] /* x å…¥æ ˆ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c02c &amp;lt;+12&amp;gt;: mov x19, x0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c030 &amp;lt;+16&amp;gt;: mov x1, x0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c034 &amp;lt;+20&amp;gt;: adrp x0, 0xffffff0000090000 # è®¡ç®—åç§»
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c038 &amp;lt;+24&amp;gt;: add x0, x0, #0x0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c03c &amp;lt;+28&amp;gt;: bl 0xffffff000008c620 &amp;lt;printk&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c040 &amp;lt;+32&amp;gt;: cmp x19, #0x0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c044 &amp;lt;+36&amp;gt;: b.gt 0xffffff000008c068 &amp;lt;stack_test+72&amp;gt; # greater than /* é€’å½’ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c048 &amp;lt;+40&amp;gt;: bl 0xffffff000008c0dc &amp;lt;stack_backtrace&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c04c &amp;lt;+44&amp;gt;: mov x1, x19
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c050 &amp;lt;+48&amp;gt;: adrp x0, 0xffffff0000090000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c054 &amp;lt;+52&amp;gt;: add x0, x0, #0x20
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c058 &amp;lt;+56&amp;gt;: bl 0xffffff000008c620 &amp;lt;printk&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c05c &amp;lt;+60&amp;gt;: ldr x19, [sp, #16] # x19 = sp + 16 /* x å‡ºæ ˆ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c060 &amp;lt;+64&amp;gt;: ldp x29, x30, [sp], #32 # load pair /* FPã€LR å‡ºæ ˆ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c064 &amp;lt;+68&amp;gt;: ret
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c068 &amp;lt;+72&amp;gt;: sub x0, x19, #0x1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c06c &amp;lt;+76&amp;gt;: bl 0xffffff000008c020 &amp;lt;stack_test&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c070 &amp;lt;+80&amp;gt;: mov x1, x19
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c074 &amp;lt;+84&amp;gt;: adrp x0, 0xffffff0000090000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c078 &amp;lt;+88&amp;gt;: add x0, x0, #0x20
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c07c &amp;lt;+92&amp;gt;: bl 0xffffff000008c620 &amp;lt;printk&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c080 &amp;lt;+96&amp;gt;: ldr x19, [sp, #16]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c084 &amp;lt;+100&amp;gt;: ldp x29, x30, [sp], #32
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c088 &amp;lt;+104&amp;gt;: ret
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">End of assembler dump.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿è¡Œï¼Œè§‚å¯Ÿæ ˆçš„å˜åŒ–ï¼Œè¿™é‡Œçœç•¥éƒ¨åˆ†è¾“å‡ºï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">gefâž¤ c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ registers â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x0 : 0x0000000000000005 # è¿™ä¸€å±‚å‡½æ•°çš„è¾“å…¥å€¼
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x19 : 0x0000000000000000 # ä¸Šä¸€å±‚å‡½æ•°çš„è¿”å›žå€¼
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x29 : 0xffffff00000920f0 # FP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x30 : 0xffffff000008c0d4 â†’ &amp;lt;main+72&amp;gt; # LR
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$sp : 0xffffff00000920f0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ stack â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920f0â”‚+0x0000: 0x0000000000000000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920f8â”‚+0x0008: 0xffffff000008c018 # æ ˆå¤´ï¼Œå¯èƒ½æ˜¯æ ˆåˆå§‹åŒ–çš„æ•°æ®ç»“æž„
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ trace â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#0] 0xffffff000008c020 â†’ stack_test()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#1] 0xffffff000008c0d4 â†’ main()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gefâž¤ c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ registers â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x0 : 0x0000000000000004
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x19 : 0x0000000000000005
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x29 : 0xffffff00000920d0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x30 : 0xffffff000008c070 #â†’ &amp;lt;stack_test+80&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$sp : 0xffffff00000920d0 â†’ 0xffffff00000920f0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ stack â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920d0â”‚+0x0000: 0xffffff00000920f0 â”€â” # FP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920d8â”‚+0x0008: 0xffffff000008c0d4 â”‚ # LR
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920e0â”‚+0x0010: 0x0000000000000000 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920e8â”‚+0x0018: 0x00000000ffffffc0 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920f0â”‚+0x0020: 0x0000000000000000 â—„â”˜
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920f8â”‚+0x0028: 0xffffff000008c018
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ trace â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#0] 0xffffff000008c020 â†’ stack_test()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#1] 0xffffff000008c070 â†’ stack_test()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#2] 0xffffff000008c0d4 â†’ main()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gefâž¤ c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ registers â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x0 : 0x0000000000000003
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x19 : 0x0000000000000004
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x29 : 0xffffff00000920b0 â†’ 0xffffff00000920d0 â†’ 0xffffff00000920f0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x30 : 0xffffff000008c070
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$sp : 0xffffff00000920b0 â†’ 0xffffff00000920d0 â†’ 0xffffff00000920f0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ stack â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920b0â”‚+0x0000: 0xffffff00000920d0 â”€â” # [#1]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920b8â”‚+0x0008: 0xffffff000008c070 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920c0â”‚+0x0010: 0x0000000000000005 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920c8â”‚+0x0018: 0x00000000ffffffc0 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920d0â”‚+0x0020: 0xffffff00000920f0 â—„â”˜ # [#2]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920d8â”‚+0x0028: 0xffffff000008c0d4 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920e0â”‚+0x0010: 0x0000000000000000 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920e8â”‚+0x0018: 0x00000000ffffffc0 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920f0â”‚+0x0020: 0x0000000000000000 â—„â”˜ # [#3]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920f8â”‚+0x0028: 0xffffff000008c018
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ trace â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#0] 0xffffff000008c020 â†’ stack_test()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#1] 0xffffff000008c070 â†’ stack_test()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#2] 0xffffff000008c070 â†’ stack_test()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#3] 0xffffff000008c0d4 â†’ main()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¯ä»¥çœ‹åˆ°æ¯æ¬¡é€’å½’è°ƒç”¨åŽ‹æ ˆ4ä¸ª64ä½å­—ï¼Œåˆ†åˆ«æ˜¯ï¼šä¸Šä¸€å±‚FPï¼ŒLRï¼Œå‚æ•°xå’Œ0x00000000ffffffc0ã€‚æœ€åŽä¸€ä¸ª64ä½å­—ç”¨é€”æœªçŸ¥ã€‚&lt;/p>
&lt;h3 id="ç»ƒä¹ 9-backtrace">ç»ƒä¹ 9-backtrace&lt;/h3>
&lt;p>æä¾›&lt;code>read_fp()&lt;/code>æŽ¥å£ï¼Œæˆ‘ä»¬çŸ¥é“fpæ°¸è¿œæŒ‡å‘çˆ¶å‡½æ•°çš„fpï¼Œæ•…é€’å½’è°ƒç”¨å³å¯ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl"> &lt;span class="n">u64&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">fp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">u64&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">u64&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="nf">read_fp&lt;/span>&lt;span class="p">());&lt;/span> &lt;span class="c1">// åŒå±‚æŒ‡é’ˆï¼Œå› ä¸ºç¬¬ä¸€å±‚æ˜¯æœ¬å‡½æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">while&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printk&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;LR %lx FP %lx Args %d %d %d %d %d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">fp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">));&lt;/span> &lt;span class="c1">//ä¸ºä»€ä¹ˆ5ä¸ªå‚æ•°æ˜¯fp-2åˆ°fp+2ï¼Ÿæ ·ä¾‹åªåŒ…æ‹¬ä¸€ä¸ªå‚æ•°ï¼Œåªè¦å‡ºçŽ°fp+2å°±èƒ½æµ‹è¯•é€šè¿‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">fp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">u64&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//ä¸‹ä¸€å±‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ»¡åˆ†é€šè¿‡ï¼Œæ‡’å¾—è´´å›¾äº†ã€‚&lt;/p>
&lt;hr>
&lt;p>çœ‹åˆ°å¤§ä½¬å†™çš„ï¼Œçž¬é—´ä¸æƒ³å†™äº†ï¼Œå¯„ã€‚
&lt;a class="link" href="https://www.cnblogs.com/kangyupl/p/chcore_lab1.html" target="_blank" rel="noopener"
>https://www.cnblogs.com/kangyupl/p/chcore_lab1.html&lt;/a>&lt;/p></description></item><item><title>ä»Žscapyå’Œwiresharkå­¦è®¡ç®—æœºç½‘ç»œ</title><link>https://lonelyuan.github.io/p/%E4%BB%8Escapy%E5%92%8Cwireshark%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</link><pubDate>Fri, 22 Oct 2021 23:55:54 +0000</pubDate><guid>https://lonelyuan.github.io/p/%E4%BB%8Escapy%E5%92%8Cwireshark%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</guid><description>&lt;p>ä¼—æ‰€å‘¨çŸ¥ï¼Œè®¡ç½‘è¢«è¯„ä¸ºæœ€å›°çš„è®¡ç®—æœºä¸“ä¸šè¯¾ï¼Œä¿—ç§°è®¡ç®—æœºä¸­çš„è¯­æ–‡ã€‚ðŸ‘´çœ‹äº†ã€Šè®¡ç®—æœºç½‘ç»œï¼è‡ªé¡¶å‘ä¸‹æ–¹æ³•ã€‹ï¼ˆåŽæ–‡ç®€ç§°CNTDAï¼‰ä¹‹åŽï¼Œè§‰å¾—ç¿»è¯‘å°±åƒæ±¤å§†å”å”çš„çƒ‚è‹¹æžœæ´¾ä¸€æ ·ç³Ÿç³•ï¼Œä¸Šå¸å•Šï¼Œæˆ‘å‘èª“ä¼šç‹ ç‹ è¸¢ä»–çš„å±è‚¡ã€‚å»ºè®®å¸¦ðŸ”¥åŽ»çœ‹è‹±æ–‡åŽŸç‰ˆã€‚&lt;/p>
&lt;p>ä½†æ˜¯ðŸ‘´æœ€è¿‘æŽ¥è§¦çš„è®¸å¤šå®žéªŒè¿˜æ˜¯å¾ˆå¥½çŽ©çš„ï¼ŒäºŽæ˜¯æœ¬æ–‡è¯•å›¾é€šè¿‡å…¨ç¨‹åŠ¨æ‰‹å®žæ“å­¦ä¹ è®¡ç½‘ã€‚&lt;/p>
&lt;hr>
&lt;p>ä¸»è¦å·¥å…·ï¼š&lt;/p>
&lt;ul>
&lt;li>wiresharkæ˜¯å nbçš„ç½‘ç»œå°åŒ…åˆ†æžè½¯ä»¶ã€‚å°±æ˜¯ç”¨æ¥æŠ“åŒ…çš„ã€‚&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>ä¸‹è½½ï¼š&lt;a class="link" href="https://www.wireshark.org/download.html" target="_blank" rel="noopener"
>https://www.wireshark.org/download.html&lt;/a>
æ•™ç¨‹ï¼š&lt;a class="link" href="https://www.javatpoint.com/wireshark" target="_blank" rel="noopener"
>https://www.javatpoint.com/wireshark&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>scapyåº“æ˜¯pythonçš„ç½‘ç»œç¼–ç¨‹åº“ï¼Œå¯ä»¥è®©ä½ ç»†è‡´å…¥å¾®çš„æ“çºµç½‘ç»œæµé‡ã€‚å°±æ˜¯ç”¨æ¥å‘åŒ…çš„ã€‚
&lt;ul>
&lt;li>//ä¸è¦å’Œçˆ¬è™«åº“scrapyæ··æ·†&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>scapyæ–‡æ¡£ï¼š&lt;a class="link" href="https://scapy.readthedocs.io/en/latest/" target="_blank" rel="noopener"
>https://scapy.readthedocs.io/en/latest/&lt;/a>
ä¸­æ–‡ç‰ˆï¼š&lt;a class="link" href="https://www.osgeo.cn/scapy/introduction.html" target="_blank" rel="noopener"
>https://www.osgeo.cn/scapy/introduction.html&lt;/a> //æœ‰äº›ç¿»è¯‘é”™è¯¯&lt;/p>
&lt;/blockquote>
&lt;hr>
&lt;h2 id="è®¡ç½‘åŸºæœ¬æ¦‚å¿µ">è®¡ç½‘åŸºæœ¬æ¦‚å¿µ&lt;/h2>
&lt;h3 id="åŒ…package">ðŸ’£åŒ…(package)&lt;/h3>
&lt;p>ç­‰ç­‰ï¼Œå•¥æ˜¯â€œæŠ“åŒ…â€ï¼Ÿå•¥æ˜¯â€œå‘åŒ…â€ï¼Ÿå•¥æ˜¯â€œåŒ…â€ï¼Ÿ&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/post-images/1635925682452.png"
loading="lazy"
alt="åŽŸæ¥è¿™å°±æ˜¯â€œåŒ…â€"
>&lt;/p>
&lt;p>å½“ç„¶ï¼ŒåŒ…ä¸ä»…ä»…æ˜¯ä¸€ä¸ª CSGO æœ¯è¯­ï¼Œåœ¨è®¡ç®—æœºç½‘ç»œä¸­ï¼ŒåŒ…(package)æœ‰å¤šä¸ªè¿‘ä¹‰è¯ï¼ŒåŒ…æ‹¬ï¼šæŠ¥æ–‡/æ•°æ®æŠ¥(Datagram)ï¼Œåˆ†ç»„/å°åŒ…(Packet)â€¦â€¦æ ¹æ®è¯­å¢ƒä¸åŒè€ŒåŒºåˆ†ï¼Œä½†å¤§è‡´æŒ‡çš„æ˜¯åŒä¸€ä»¶äº‹æƒ…ï¼šå³ç½‘ç»œä¸­çœŸæ­£æµåŠ¨ç€çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬å¸Œæœ›ç½‘ç»œæ¥ä¼ é€’çš„ä¸œè¥¿ã€‚åªä¸è¿‡â€œåŒ…â€æ˜¯æœ€é€šä¿—çš„å«æ³•ï¼Œé‚£ä¹ˆæŠ“åŒ…å’Œå‘åŒ…å°±ä¸éš¾ç†è§£äº†ã€‚&lt;/p>
&lt;p>ä½ è¿˜æƒ³é—®ï¼ŒåŒ…åˆ°åº•é•¿ä»€ä¹ˆæ ·ï¼Ÿä¼—æ‰€å‘¨çŸ¥ï¼Œå¿«é€’ç”±åŒ…è£…å’Œé‡Œé¢çš„ä¸œè¥¿ç»„æˆï¼Œå…¶å®žç½‘ç»œä¸Šçš„å°åŒ…ä¹Ÿå·®ä¸å¤šï¼Œä¹Ÿå¤§è‡´éƒ½æœ‰ä¸¤éƒ¨åˆ†ï¼š&lt;/p>
&lt;ul>
&lt;li>åŒ…å¤´ï¼Œå­¦åé¦–éƒ¨(Header)â€”â€”å¿«é€’åŒ…è£…ä¸Šçš„æ ‡ç­¾ï¼Œå†™ç€ç›®çš„åœ°å€ï¼Œè”ç³»ç”µè¯ï¼Œå¿«é€’å·ç­‰ä¿¡æ¯&lt;/li>
&lt;li>åŒ…ä½“ï¼Œå­¦åè½½è·(Payload)â€”â€”å¿«é€’è¦è¿è¾“çš„è´§ç‰©æœ¬èº«ã€‚æŸäº›è¯­å¢ƒä¸‹ä¹Ÿå–œæ¬¢ç§°ä¸ºæŠ¥æ–‡ã€‚&lt;/li>
&lt;/ul>
&lt;p>å½“ç„¶ï¼Œç½‘ç»œå°åŒ…å½’æ ¹ç»“åº•è¿˜æ˜¯çº¿æ€§çš„æ¯”ç‰¹åºåˆ—ï¼ŒäºŽæ˜¯æˆ‘ä»¬éœ€è¦åŒ…å¤´æ¥è¯†åˆ«è¿™ä¸ªå°åŒ…çš„ç›¸å…³ä¿¡æ¯ï¼Œå°±åƒçœ‹å¿«é€’å…ˆçœ‹æ ‡ç­¾ä¸€æ ·ã€‚&lt;/p>
&lt;p>å¦å¤–ï¼Œä¸€ä¸ªåè®®çš„å°åŒ…ä¹Ÿå¯ä»¥æˆä¸ºå¦ä¸€ä¸ªåè®®çš„è½½è·ï¼ŒåŽé¢ä½ ä¼šçœ‹åˆ°è¯¸å¦‚&lt;code>pkt.payload.payload.payload.payload&lt;/code>çš„å¥—å¨ƒç”¨æ³•ï¼Œè¦ç†è§£è¿™ç§å¥—å¨ƒï¼Œè¿˜éœ€è¦çŸ¥é“åˆ†å±‚æ€æƒ³ã€‚&lt;/p>
&lt;h3 id="åˆ†å±‚layering">ðŸ°åˆ†å±‚(layering)&lt;/h3>
&lt;p>CNTDA ä¸­ç”¨é‚®æ”¿ç³»ç»Ÿç±»æ¯”è®¡ç®—æœºç½‘ç»œï¼Œè¿™æ˜¯æœ€å¸¸ç”¨çš„ä¾‹å­ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨å¿«é€’ç‰©æµç½‘æ¥ä¸¾ä¾‹ã€‚éšä¾¿æ‰“å¼€ä½ çš„ç½‘è´­è®°å½•ï¼Œä½ ä¼šå‘çŽ°å¿«é€’ç‰©æµå¤§æ¦‚ç»è¿‡ä»¥ä¸‹è¿‡ç¨‹ï¼š&lt;/p>
&lt;blockquote>
&lt;ul>
&lt;li>&lt;strong>å®¢æˆ·&lt;/strong>å‘è´§ï¼šæŠŠ&lt;em>è´§ç‰©&lt;/em>å’Œ&lt;em>åœ°å€&lt;/em>äº¤ç»™å¿«é€’ç‚¹
&lt;ul>
&lt;li>&lt;strong>å¿«é€’ç½‘ç‚¹&lt;/strong>æ½ä»¶ï¼š&lt;em>åŒ…è£…&lt;/em>è´§ç‰©è€Œå˜æˆåŒ…è£¹ï¼›åŒ…è£¹è¢«é€å¾€æœ€è¿‘çš„ä¸­è½¬ä¸­å¿ƒ
&lt;ul>
&lt;li>&lt;strong>ä¸­è½¬ä¸­å¿ƒ&lt;/strong>è¿è¾“ï¼šæ ¹æ®åŒ…è£¹ç›®çš„åœ°ä¸åŒï¼Œ&lt;em>åˆ†æ‹£&lt;/em>å¹¶&lt;em>è£…è½¦&lt;/em>è¿è¾“ç»™ä¸åŒçš„ä¸­è½¬ä¸­å¿ƒï¼›è‹¥æ”¶åˆ°æœ¬ç‰‡åŒºçš„åŒ…è£¹ï¼Œ&lt;em>å¸è½¦&lt;/em>å¹¶&lt;em>åˆ†æ‹£&lt;/em>ç»™ä¸åŒçš„ç½‘ç‚¹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>å¿«é€’ç½‘ç‚¹&lt;/strong>æ´¾é€ï¼šæŒ‰åŒ…è£¹çš„&lt;em>åœ°å€&lt;/em>ï¼Œå¿«é€’å‘˜é€è´§ä¸Šé—¨&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>å®¢æˆ·&lt;/strong>å–ä»¶ï¼š&lt;em>æ‹†ç®±&lt;/em>ï¼Œæ‹¿åˆ°è´§ç‰©ï¼Œç¡®è®¤æ— è¯¯ç­¾æ”¶&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>ä½ çŸ¥é“å‘ä¸€ä¸ªå¿«é€’è¦ç»åŽ†æ€Žæ ·çš„å›°éš¾å—ï¼Ÿä½ ä¸çŸ¥é“ï¼Œä½ åªå…³å¿ƒä½ è‡ªå·±ã€‚è¿™é‡Œçš„é‡ç‚¹æ˜¯ï¼Œå®¢æˆ·ä¸éœ€è¦å…³å¿ƒä¸­è½¬ä¸­å¿ƒå¦‚ä½•æŒ‡æŒ¥é‡åž‹è´§è½¦æˆ–é£žæœºï¼Œç½‘ç‚¹ä¹Ÿåªéœ€è¦å…³å¿ƒå¦‚ä½•åŒ…è£…å¥½å®¢æˆ·çš„è´§ç‰©ã€‚å¿«é€’ç½‘ç»œæ˜Žæ˜¾çš„å‘ˆçŽ°å‡ºä¸‰å±‚çš„åˆ†å±‚æž¶æž„ï¼Œ&lt;strong>æ¯ä¸€å±‚ä¹‹é—´åªéœ€è¦å…³å¿ƒè‡ªå·±çš„å·¥ä½œï¼Œå¹¶å’Œç›¸é‚»çš„å±‚äº¤äº’&lt;/strong>ã€‚è¿™å°±æ˜¯åº”å¯¹å¤æ‚ç³»ç»Ÿçš„ç»„ç»‡æ–¹æ³•â€”â€”åˆ†å±‚ã€‚&lt;/p>
&lt;p>è¯¾æœ¬ä¸Šä¼šæåˆ°OSIä¸ƒå±‚æ¨¡åž‹æˆ–è€…TCP/IPäº”å±‚æ¨¡åž‹ï¼Œè¿™é‡Œçš„æ¨¡åž‹å…¨ç§°æ˜¯&lt;strong>åè®®åˆ†å±‚æ¨¡åž‹&lt;/strong>ï¼Œåˆæ¥æ–°è¯äº†ï¼Œåˆ«æ€¥ï¼ŒåŽé¢è¿˜æœ‰ï¼š&lt;/p>
&lt;ul>
&lt;li>åè®®(Protocol)ï¼šåŒä¸€å±‚çº§å†…çš„äº¤äº’è§„åˆ™ã€‚//æ¨ªå‘&lt;/li>
&lt;li>æœåŠ¡(Service)ï¼šä¸åŒå±‚çº§é—´çš„äº¤äº’è§„åˆ™ã€‚//çºµå‘&lt;/li>
&lt;/ul>
&lt;p>æ¯ä¸€å±‚çš„å·¥ä½œï¼Œå°±æ˜¯è°ƒç”¨ä¸‹å±‚çš„æŽ¥å£ï¼Œå¹¶ä¸ºä¸Šå±‚æä¾›æœåŠ¡ã€‚æŽ¥å£(Interface)å’ŒæœåŠ¡çš„åŒºåˆ«æ˜¯ï¼ŒæœåŠ¡ä½œä¸ºå®žä½“ï¼Œç”±æœ¬å±‚è´Ÿè´£å®žçŽ°ï¼Œæš´éœ²å‡ºæŽ¥å£ä¾›ä¸Šå±‚è°ƒç”¨ï¼›è€ŒæŽ¥å£åˆ™æ˜¯æŠ½è±¡çš„ï¼Œæœ¬å±‚å¹¶ä¸çŸ¥é“ä¸‹ä¸€å±‚çš„å¯é æ€§ã€‚&lt;/p>
&lt;p>ç”±æ­¤ä½ èƒ½å¦çœ‹å‡ºåˆ†å±‚æ€æƒ³çš„ä¼˜è¶Šæ€§ï¼Ÿæ¯ä¸€å±‚åªå…³æ³¨è‡ªå·±çš„å®žçŽ°ï¼ŒäºŽæ˜¯å¤§é—®é¢˜è¢«åˆ†è§£æˆäº†å°é—®é¢˜ã€‚å¥½æ¯”ä¸€ä¸ªæ€»å·¥ä½œé‡100çš„é—®é¢˜ï¼Œä¸äº†è§£åˆ†å±‚æ€æƒ³çš„ä½ åªèƒ½10+10+10+â€¦â€¦=100ï¼›è€Œåˆ†å±‚æ€æƒ³æä¾›äº†ä¹˜æ³•æ³•åˆ™ï¼ŒäºŽæ˜¯ä½ å¯ä»¥é€šè¿‡10*10=100ï¼Œåªéœ€è¦å®Œæˆ20å·¥ä½œé‡ã€‚//ä¸ªä¸­æ€æƒ³ä¹Ÿä½“çŽ°äº†OOPä¸­çš„è§£è€¦ã€‚&lt;/p>
&lt;p>ä¸Šè¿°ç±»æ¯”ä¸­æ ‡æ³¨äº†ä¸€äº›å¯¹åº”å…³ç³»ï¼š&lt;/p>
&lt;ul>
&lt;li>å°åŒ…(Packaging)ï¼šåŒ…è£…ï¼Œè´§ç‰©â†’åŒ…è£¹ã€‚ä¿¡æ¯åœ¨å±‚æ¬¡é—´ä¼ é€’çš„è¿‡ç¨‹å°±æ˜¯å°åŒ…/è§£å°çš„è¿‡ç¨‹ã€‚&lt;/li>
&lt;li>è·¯ç”±(Routing)ï¼šåˆ†æ‹£ã€‚æ ¹æ®åŒ…è£¹ä¸Šçš„æ ‡ç­¾ï¼Œå†³å®šåŒ…è£…çš„åŽ»å‘ã€‚&lt;/li>
&lt;/ul>
&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸€å±‚éƒ½æœ‰è‡ªå·±çš„â€œè´§ç‰©â€ï¼Œæ¯”å¦‚ä¸­è½¬ä¸­å¿ƒçš„è½½è·æ˜¯æ»¡è½½åŒ…è£¹çš„é•¿é€”è´§è½¦è€Œä¸æ˜¯å•ä¸ªåŒ…è£¹ã€‚æŠ¥æ–‡åœ¨æ¯ä¸€å±‚éƒ½è¢«å°è£…å¹¶äº¤ç»™ä¸‹ä¸€å±‚ï¼Œè¦æƒ³å¾—åˆ°åŽŸå§‹æŠ¥æ–‡åªèƒ½ä¸€å±‚ä¸€å±‚è§£å¼€ï¼Œæ“ä½œæ¨¡å¼ç±»ä¼¼æ ˆã€‚ç”±æ­¤åè®®åˆ†å±‚æ¨¡åž‹ä¹Ÿè¢«ç®€ç§°ä¸º&lt;strong>åè®®æ ˆ&lt;/strong>(Protocol stack)ã€‚&lt;/p>
&lt;p>æœ€åŽç®€å•è§£é‡Šäº”å±‚æ¨¡åž‹æ¯ä¸€å±‚çš„åˆ†å·¥ï¼Œè‡ªåº•å‘ä¸Šé¡ºåºï¼š&lt;/p>
&lt;ul>
&lt;li>ç‰©ç†å±‚ï¼šå¯¹æŽ¥ç‰©ç†ä»‹è´¨ï¼Œè¿è¾“æ¯”ç‰¹
&lt;ul>
&lt;li>æä¾›åŸºäºŽæ¯”ç‰¹çš„é€šä¿¡è·¯å¾„&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>é“¾è·¯å±‚ï¼šå°†è·¯å¾„ä¸²è”æˆé“¾
&lt;ul>
&lt;li>æä¾›åŸºäºŽé“¾è·¯çš„æŽ¥å…¥ã€äº¤ä»˜ã€å’Œä¼ è¾“æœåŠ¡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ç½‘ç»œå±‚ï¼šå°†é“¾è·¯ç¼–ç»‡æˆç½‘
&lt;ul>
&lt;li>æä¾›ä»»æ„ä¸¤ä¸»æœºä¹‹é—´çš„é€šä¿¡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è¿è¾“å±‚ï¼šå°†ä¸»æœºçš„é€šä¿¡åˆ†è§£ä¸ºè¿›ç¨‹çš„é€šä¿¡
&lt;ul>
&lt;li>æä¾›è¿›ç¨‹é—´çš„é€»è¾‘é€šä¿¡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åº”ç”¨å±‚ï¼šå®žçŽ°ç”¨æˆ·éœ€æ±‚
&lt;ul>
&lt;li>å‘ç”¨æˆ·æä¾›é€æ˜Žå¯é çš„ç½‘ç»œæœåŠ¡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>å¶å‰‹ï¼ä½ å·²ç»äº†è§£äº†åˆ†å±‚æ€æƒ³ï¼Œä¸‹é¢æ¥è®¾è®¡äº’è”ç½‘å§ï¼ï¼ˆè¿«çœŸï¼‰&lt;/p>
&lt;h2 id="å¼€å§‹å®žéªŒ">âŒšï¸å¼€å§‹å®žéªŒ&lt;/h2>
&lt;p>æœ‰å…³è®¡ç½‘çš„å­¦ä¹ é¡ºåºè‡ªå¤å°±æœ‰è‡ªé¡¶å‘ä¸‹è¿˜æ˜¯è‡ªåº•å‘ä¸Šçš„åˆ†æ­§ï¼Œä½™ä»¥ä¸ºåªè¦ç†è§£äº†åˆ†å±‚æ€æƒ³ï¼Œé¡ºåºä¾¿ä¸ç®—å¾ˆé‡è¦ã€‚æœ¬ç³»åˆ—å®žéªŒå°†éµä»Žæµ…å…¥æ·±å‡ºçš„åŽŸåˆ™ï¼Œä»Žåº”ç”¨å±‚é€æ­¥æ·±å…¥åˆ°é“¾è·¯å±‚å†è¿”å›žåº”ç”¨å±‚ï¼ŒåŒæ—¶éš¾åº¦ä¸æ–­åŠ å¤§ã€‚&lt;/p>
&lt;p>å®žéªŒæ¥æºï¼š&lt;/p>
&lt;ul>
&lt;li>ðŸ‘´è‡ªå·±ï¼š0x10, 0x20&lt;/li>
&lt;li>SEEDLabï¼Œé›ªåŸŽå¤§å­¦çš„ä¿¡æ¯å®‰å…¨è¯¾é…å¥—å®žéªŒï¼Œç½‘ç»œå®‰å…¨éƒ¨åˆ†ã€‚å›½å†…çŸ¥ååº¦ä¸é«˜æ‰€ä»¥å€¼å¾—ä¸€åšã€‚&lt;a class="link" href="https://seedsecuritylabs.org/Labs_20.04" target="_blank" rel="noopener"
>å®˜æ–¹ç½‘ç«™&lt;/a>&lt;/li>
&lt;li>CNTDA å®žéªŒï¼š&lt;a class="link" href="https://github.com/moranzcw/Computer-Networking-A-Top-Down-Approach-NOTES" target="_blank" rel="noopener"
>GIthubä¸ŠæŠ„çš„ä½œä¸š&lt;/a>&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>å®žéªŒä»£ç ä»“åº“ï¼š&lt;a class="link" href="https://github.com/lonelyuan/ComputerNetwork-exp" target="_blank" rel="noopener"
>lonelyuan/ComputerNetwork-exp (github.com)&lt;/a>&lt;/p>
&lt;p>å®žéªŒç¼–å·è§„åˆ™ï¼š0xabn&lt;/p>
&lt;ul>
&lt;li>aï¼šå±‚çº§ï¼š1 - åº”ç”¨å±‚ï¼›2 - ä¼ è¾“å±‚ï¼›3 - ç½‘ç»œå±‚ï¼›4 - é“¾è·¯å±‚ï¼›5 - ç‰©ç†å±‚&lt;/li>
&lt;li>bï¼šéš¾åº¦ï¼š0 - â­ï¼›1 - â­â­ï¼›2 - â­â­â­ï¼›3 - â­â­â­â­ï¼›4 - â­â­â­â­â­ï¼›&lt;/li>
&lt;li>nï¼šé‡å¤éš¾åº¦åˆ™å†åŠ ä¸€ä½ç¼–å·&lt;/li>
&lt;/ul>
&lt;p>//ã€æƒ³çœ‹å“ªä¸ªæ²¡æ›´æ–°çš„å¯ä»¥å‚¬ðŸ‘´ã€‘&lt;/p>
&lt;/blockquote>
&lt;h3 id="0x10-åº”ç”¨å±‚-server--">0x10 åº”ç”¨å±‚: Server | â­&lt;/h3>
&lt;h4 id="intro">Intro&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>ç›®æ ‡ï¼šç”¨scapy/socketåšä¸€ä¸ªé™æ€æœåŠ¡å™¨ã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å®žé™…ä¸Šï¼Œpython3å·²ç»è‡ªå¸¦äº†ä¸€ä¸ªç®€æ˜“httpæœåŠ¡å™¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">$ python3 -m http.server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Serving HTTP on 0.0.0.0 port &lt;span class="m">8000&lt;/span> &lt;span class="o">(&lt;/span>http://0.0.0.0:8000/&lt;span class="o">)&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">127.0.0.1 - - &lt;span class="o">[&lt;/span>10/Nov/2021 14:51:57&lt;span class="o">]&lt;/span> &lt;span class="s2">&amp;#34;GET / HTTP/1.1&amp;#34;&lt;/span> &lt;span class="m">200&lt;/span> -
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æµè§ˆå™¨è®¿é—®ï¼š&lt;code>localhost:8000&lt;/code>ï¼Œå¦‚æžœå½“å‰ç›®å½•ä¸‹æœ‰&lt;code>index.html&lt;/code>æ–‡ä»¶ï¼Œæµè§ˆå™¨å³å¯æ˜¾ç¤ºè¯¥htmlæ–‡æ¡£ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¯¥httpæœåŠ¡å™¨ä¹Ÿæ˜¯åŸºäºŽå¦ä¸€ä¸ªpythonæ ‡å‡†åº“socketç¼–å†™çš„ï¼Œæœ¬å®žéªŒæˆ‘ä»¬ç›´æŽ¥ç”¨socketå®žçŽ°ä¸€ä¸ªæ›´ç®€å•çš„httpæœåŠ¡å™¨ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>å‰ç½®ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>æœ¯è¯­ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>C/Sæž¶æž„(client-server)ï¼šäº’è”ç½‘çš„åŸºæœ¬æ¨¡åž‹ã€‚é€šä¿¡çš„åŒæ–¹é€šå¸¸åˆ†æˆä¸¤ä¸ªè§’è‰²ï¼š&lt;/p>
&lt;ul>
&lt;li>å‘èµ·çš„ä¸€æ–¹ç§°ä¸ºå®¢æˆ·ç«¯(C)ï¼Œå³å‰ç«¯ã€‚&lt;/li>
&lt;li>æŽ¥æ”¶çš„ä¸€æ–¹ç§°ä¸ºæœåŠ¡ç«¯(C)ï¼Œå³åŽç«¯ã€‚ä¸ºäº†ä¿è¯éšæ—¶æŽ¥æ”¶è¯·æ±‚ï¼ŒæœåŠ¡ç«¯éœ€è¦æŒä¹…ç›‘å¬æŸé€šä¿¡ç«¯å£&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>URLï¼šç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ã€‚ä¹Ÿå°±æ˜¯äº’è”ç½‘ä¸Šçš„åœ°å€ï¼Œç½‘å€ã€‚&lt;/p>
&lt;ul>
&lt;li>å®Œæ•´è¯­æ³•ï¼š&lt;code>[åè®®å]://[ç”¨æˆ·å]:[å¯†ç ]@[æœåŠ¡å™¨åœ°å€]:[æœåŠ¡å™¨ç«¯å£å·]/[è·¯å¾„]?[æŸ¥è¯¢å­—ç¬¦ä¸²]#[ç‰‡æ®µ]&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>HTTPåè®®ï¼šåº”ç”¨å±‚æœ€æ™®éçš„æ–‡æœ¬åè®®ä¹‹ä¸€ã€‚æ–‡æœ¬åè®®è¡¨ç¤ºå…¶æ‰€æœ‰å†…å®¹éƒ½æ˜¯å¯è¯»çš„ï¼Œå…¶ä¸»è¦æ ¼å¼å¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">GET / HTTP/1.1\r\n /* ä¸€ä¸ªçŠ¶æ€è¡Œ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host: localhost\r\n /* å¤šä¸ªé¦–éƒ¨è¡Œ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connection: close\r\n\r\n /* ä»¥ä¸¤ä¸ªCRLF(å›žè½¦æ¢è¡Œï¼Œç¼–ç¨‹æ—¶ç”¨\r\nè¡¨ç¤º)éš”æ–­ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;html&amp;gt;... &amp;lt;/html&amp;gt; /* payload */
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>HTMLï¼šæ ‡è®°è¯­è¨€ï¼Œç”¨&amp;lt;&amp;gt;ç»„ç»‡èµ·ç½‘é¡µçš„éª¨æž¶ã€‚æµè§ˆå™¨ä¼šæŠŠHTMLæºç æ¸²æŸ“æˆå¥½çœ‹çš„ç½‘é¡µã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>socketï¼šé€»è¾‘é€šä¿¡çš„ç«¯ç‚¹ã€‚&lt;/p>
&lt;ul>
&lt;li>socketæ˜¯é€»è¾‘é€šä¿¡çš„æŽ¥å£ã€‚ä¸Šæ–‡æåˆ°ç½‘ç»œå±‚ä¸ºè¿è¾“å±‚å’Œåº”ç”¨å±‚æä¾›äº†ç‚¹åˆ°ç‚¹çš„é€»è¾‘é€šä¿¡æœåŠ¡ï¼Œè¯¥æœåŠ¡çš„åŸºæœ¬æŽ¥å£å°±æ˜¯socketã€‚&lt;/li>
&lt;li>socketæ˜¯é€šä¿¡ç«¯ç‚¹çš„æŠ½è±¡ã€‚å®ƒå°†è¿›ç¨‹/åº”ç”¨å’Œ&lt;code>(ä¸»æœºhost,ç«¯å£port)&lt;/code> äºŒå…ƒç»„ç»‘å®šï¼ŒäºŽæ˜¯é€šè¿‡ &lt;code>(host,port)&lt;/code> å³å¯æ ‡è®°ç½‘ç»œä¸Šçš„è¿›ç¨‹ã€‚
&lt;ul>
&lt;li>ä¸€ä¸ªä¸»æœºæœ‰ä¸€ä¸ªåœ°å€å’Œå¤šä¸ªç«¯å£ã€‚åœ°å€å’Œç«¯å£çš„å…³ç³»ï¼Œå°±åƒæˆ¿å­å’Œçª—æˆ·çš„å…³ç³»ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>socketç”±æ“ä½œç³»ç»Ÿæä¾›ã€‚æœ¬å®žéªŒç”¨åˆ°çš„æ˜¯pythonå¯¹socketçš„å°è£…ï¼Œä½†ä¸ç®¡æ¢ä»€ä¹ˆè¯­è¨€æœ¬è´¨ä¸Šéƒ½æ˜¯ç³»ç»Ÿè°ƒç”¨ã€‚&lt;/li>
&lt;li>//å…¶ç¿»è¯‘â€œå¥—æŽ¥å­—â€éžå¸¸å…·æœ‰è¯¯å¯¼æ€§ï¼Œå»ºè®®ç›´æŽ¥ç”¨è‹±æ–‡å•è¯ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>å»ºè®®èŠ±5åˆ†é’Ÿé€šè¯»ã€Šå›¾è§£HTTPã€‹å‰6ç« ï¼ˆæˆ–è€…ã€ŠCNTDAã€‹2.1-2.2èŠ‚ï¼‰ï¼Œä»¥ç†è§£ä¸Šè¿°æœ¯è¯­&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="guidelines">Guidelines&lt;/h4>
&lt;ol>
&lt;li>
&lt;h5 id="socketé€šä¿¡">Socketé€šä¿¡&lt;/h5>
&lt;/li>
&lt;/ol>
&lt;p>è¦ä½¿ç”¨socketé€šä¿¡ï¼Œé€šä¿¡åŒæ–¹éƒ½éœ€è¦æŒæœ‰ä¸€ä¸ªsocketå¯¹è±¡ï¼Œå…¶ä¸»è¦æ–¹æ³•å’Œç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> SERVER CLIENT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> socket() socket()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â–¼ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bind((host,port)) â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â–¼ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen(num) â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â–¼ â–¼
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> accept() connect((host,port))
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€â–ºsend()â”€â”€â–ºrecv()â—„â”€â”€â”¤
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€â–ºrecv()â—„â”€â”€send()â—„â”€â”€â”¤
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â–¼ â–¼
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> close() close()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>äºŽæ˜¯æˆ‘ä»¬å¯ä»¥å»ºç«‹èµ·æœåŠ¡å™¨ä»£ç çš„æ¡†æž¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bind&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="s1">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">8000&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1"># ç»‘å®šåœ°å€å’Œç«¯å£&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># å¼€å§‹ç›‘å¬ï¼Œnumè¡¨ç¤ºæœ€å¤§è¿žæŽ¥æ•°é‡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">c&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">accept&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># cæ˜¯å®¢æˆ·ç«¯socket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;[+] accepted:&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">req&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">recv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1024&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;[+] recieved:&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">req&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">decode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;utf-8&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1"># æŽ¥æ”¶ç±»åž‹ä¸ºå­—èŠ‚å¯¹è±¡bytesï¼Œè¦æ‰“å°åˆ™åº”å½“ç¼–ç ä¸ºå­—ç¬¦ä¸²&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">http_handler&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">req&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># è§£æžè¯·æ±‚ï¼Œè¿”å›žå“åº”&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">c&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">c&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>It&amp;rsquo;s worth noting thatï¼ŒæœåŠ¡ç«¯socketå¹¶æ²¡æœ‰å‘é€ä»»ä½•æ•°æ®ï¼&lt;code>accept()&lt;/code>æ–¹æ³•å°†è¿”å›žä¸€ä¸ªå®¢æˆ·ç«¯socketå¯¹è±¡ï¼Œç”±è¿™ä¸ªsocketæ‰§è¡Œæ•°æ®çš„æ”¶å‘ã€‚è¿™æ ·åšçš„åŽŸå› æ˜¯ä¸ºäº†å®žçŽ°å¤šè·¯å¤ç”¨ï¼Œå³è®©æœåŠ¡å™¨æ”¯æŒå¤šä¸ªè¿žæŽ¥åŒæ—¶é€šä¿¡ã€‚&lt;/li>
&lt;li>äºŽæ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¯¹æ¯ä¸ªTCPè¿žæŽ¥ï¼Œéƒ½æœ‰ä¸€å¯¹socketå­˜åœ¨äºŽé€šä¿¡çš„ä¸¤ç«¯ã€‚è€ŒæœåŠ¡ç«¯socketä»…ä»…åšäº†ç®¡ç†è¿žæŽ¥çš„å·¥ä½œï¼Œä»–ä»¬æ”¾åœ¨ä¸€ä¸ªç±»é‡Œï¼Œæ˜¯å‡ºäºŽç®€åŒ–ä»£ç çš„è€ƒè™‘ã€‚ï¼ˆå½“ç„¶å®žçŽ°å¤šè·¯å¤ç”¨çš„æ–¹å¼ä¸åªæœ‰ä¸€ç§ã€‚&lt;/li>
&lt;/ul>
&lt;p>çŽ°åœ¨ï¼Œä½ å¯ä»¥è‡ªå·±å°è¯•ç¼–å†™socketå®¢æˆ·ç«¯è·Ÿè¯¥æœåŠ¡å™¨è¿›è¡Œæ˜Žæ–‡çš„é€šä¿¡ã€‚ä¸è¿‡æˆ‘ä»¬çš„ç›®æ ‡æ˜¯HTTPæœåŠ¡å™¨ï¼Œå…ˆå¤ä¹ ä¸€ä¸‹HTTPåè®®æ ¼å¼ï¼ŒçŠ¶æ€ç ï¼Œé¦–éƒ¨ç­‰çŸ¥è¯†å§ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>
&lt;h5 id="httpè§£æž">HTTPè§£æž&lt;/h5>
&lt;/li>
&lt;/ol>
&lt;p>å¦‚æžœç¼–ç¨‹èƒ½åŠ›å°šå¯ï¼Œä½ å¯ä»¥è‡ªå·±å†™HTTPç±»æ¥æŠŠæŠ¥æ–‡è§£æžæˆå¯¹è±¡ã€‚è¿™é‡Œè¿˜æ˜¯ç”¨çŽ°æˆçš„ï¼Œscapyåº“æä¾›çš„&lt;code>HTTPRequest&lt;/code>å’Œ&lt;code>HTTPResponse&lt;/code>ç±»ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">scapy.layers.http&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="o">*&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">scapy.all&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="o">*&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">http_handler&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">req_str&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">req&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">HTTPRequest&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">req&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">do_dissect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">req_str&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># è§£æžè¯·æ±‚&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;[+] req: &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">req&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">summary&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># body = route(req.Path.decode()) # è·¯ç”±å‡½æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">body&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;h1&amp;gt;Hello~~~&amp;lt;/h1&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">HTTPResponse&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">HTTP&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">res&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">body&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;[+] res: &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">res&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">summary&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">raw&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>
&lt;p>&lt;code>do_dissect()&lt;/code>æ–¹æ³•å°†å­—ç¬¦ä¸²è§£æžä¸ºå¯¹è±¡&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>HTTP()/res/body&lt;/code>ï¼šscapyæ ¸å¿ƒè¯­æ³•&lt;code>/&lt;/code>ï¼Œè¡¨ç¤ºåè®®æ ˆçš„å †å ï¼Œå¯ä»¥é“¾å¼è°ƒç”¨ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¿™é‡Œçš„ç±»åž‹ä¸ºï¼š&lt;code>HTTP / HTTPResponse / Raw&lt;/code>ï¼Œä¹‹æ‰€ä»¥è¦è¿™æ ·ä¸‰å±‚è¡¨ç¤ºï¼Œæ˜¯å› ä¸ºHTTPResponse/HTTPRequestç±»ä»…ä»…æ˜¯ä¸€ä¸ªä¸­é—´å±‚ï¼Œå¦‚æžœæ²¡æœ‰HTTPå±‚ï¼Œscapyä¼šæŠ¥warningã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>raw()&lt;/code>æ–¹æ³•è¿”å›žå°åŒ…çš„å­—èŠ‚æ•°ç»„ï¼Œå¯ä»¥çœ‹åˆ°åœ¨socketä¹‹ä¸Šï¼Œæˆ‘ä»¬å…ˆæŠŠæŠ¥æ–‡è½¬åŒ–ä¸ºå¯¹è±¡ï¼Œè§£æžä¹‹åŽå†è¿”å›žæŠ¥æ–‡ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è§‚å¯Ÿå°åŒ…çš„å¸¸ç”¨æ–¹æ³•è¿˜æœ‰ï¼š&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">In [2]: a = Ether()/IP(dst=&amp;#34;www.wsnd.com&amp;#34;)/TCP()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In [3]: a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Out[3]: &amp;lt;Ether type=IPv4 |&amp;lt;IP frag=0 proto=tcp dst=Net(&amp;#34;www.wsnd.com/32&amp;#34;) |&amp;lt;TCP |&amp;gt;&amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In [4]: a.summary()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Out[4]: &amp;#39;Ether / IP / TCP 0.0.0.0:ftp_data &amp;gt; Net(&amp;#34;www.wsnd.com/32&amp;#34;):http S&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In [5]: a.show()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">###[ Ethernet ]###
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dst = ff:ff:ff:ff:ff:ff
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> src = 00:00:00:00:00:00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type = IPv4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">###[ IP ]###
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> version = 4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proto = tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> chksum = None
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> src = 0.0.0.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dst = Net(&amp;#34;www.wsnd.com/32&amp;#34;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \options \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">###[ TCP ]###
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sport = ftp_data
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dport = http
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In [6]: ls(a)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dst : DestMACField = &amp;#39;ff:ff:ff:ff:ff:ff&amp;#39; (&amp;#39;None&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">src : SourceMACField = &amp;#39;00:00:00:00:00:00&amp;#39; (&amp;#39;None&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">type : XShortEnumField = 2048 (&amp;#39;36864&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In [7]: raw(a)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Out[7]: b&amp;#39;\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x08\x00E\x00\x00(\x00\x01\x00\x00@\x06\xc9\xa8\x00\x00\x00\x00H\ti\x1e\x00\x14\x00P\x00\x00\x00\x00\x00\x00\x00\x00P\x02 \x00\xdeW\x00\x00&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In [8]: hexdump(a)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0000 FF FF FF FF FF FF 00 00 00 00 00 00 08 00 45 00 ..............E.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0010 00 28 00 01 00 00 40 06 C9 A8 00 00 00 00 48 09 .(....@.......H.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0020 69 1E 00 14 00 50 00 00 00 00 00 00 00 00 50 02 i....P........P.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0030 20 00 DE 57 00 00 ..W..
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>çŽ°åœ¨è¿è¡ŒæœåŠ¡å™¨ï¼Œç”¨æµè§ˆå™¨è®¿é—®&lt;code>localhost:8000&lt;/code>ï¼Œä½ å¯ä»¥çœ‹åˆ°å¤§å¤§çš„â€œHelloâ€äº†ï¼&lt;/p>
&lt;h4 id="task">Task&lt;/h4>
&lt;p>ä¸‹é¢çš„ä»»åŠ¡äº¤ç»™ä½ ï¼Œç›®æ ‡æ˜¯å°½é‡æŽ¥è¿‘pythonè‡ªå¸¦httpæœåŠ¡å™¨çš„è¡¨çŽ°ã€‚&lt;/p>
&lt;p>ä¸ºäº†å®žçŽ°é™æ€æœåŠ¡å™¨ï¼Œä½ éœ€è¦æ ¹æ®è®¿é—®çš„è·¯å¾„è¿”å›žå¯¹åº”çš„å†…å®¹ã€‚ä¸ºæ­¤ï¼Œè¯·å®Œå–„&lt;code>route()&lt;/code>å‡½æ•°ï¼š&lt;/p>
&lt;ul>
&lt;li>è®¿é—®æ ¹è·¯å¾„&lt;code>/&lt;/code>å°†è¿”å›ž&lt;code>index.html&lt;/code>&lt;/li>
&lt;li>ä½¿ç”¨osæ¨¡å—è¯»å–æ–‡ä»¶ï¼Œæ³¨æ„æ–‡æœ¬æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¦‚å›¾ç‰‡ï¼‰çš„å¤„ç†&lt;/li>
&lt;li>ç”¨HTTPå“åº”ç è¿›è¡Œé”™è¯¯å¤„ç†ï¼Œæ¯”å¦‚&lt;code>404 NOT FOUND&lt;/code>ï¼Œ&lt;code>302 REDIRECT&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>æœ€åŽï¼Œåœ¨æ ¹ç›®å½•(ä½ åœ¨å“ªé‡Œè¿è¡Œä½ çš„æœåŠ¡å™¨è„šæœ¬ï¼Œé‚£é‡Œå°±æ˜¯ä½ çš„æ ¹ç›®å½•)ä¸‹æ”¾å…¥ä»»æ„æ–‡ä»¶ï¼Œæµè§ˆå™¨éƒ½å¯ä»¥è®¿é—®å…¶å†…å®¹ï¼Œå¦‚æžœä¸å­˜åœ¨åˆ™ä¼šè¿”å›ž404ã€‚&lt;/p>
&lt;h4 id="expand">Expand&lt;/h4>
&lt;ul>
&lt;li>æŠ“åŒ…è§‚å¯Ÿè®¿é—®ä½ çš„ç½‘ç«™å’Œè®¿é—®æ­£å¸¸ç½‘ç«™æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ä½ ä¼šå‘çŽ°ï¼Œæœ¬å®žéªŒå‡ ä¹Žæ²¡æœ‰è®²è§£HTTPé¦–éƒ¨çš„ç»†èŠ‚ï¼Œè¯·è‡ªè¡Œäº†è§£è¯¸å¦‚&lt;code>Content-Type:&lt;/code>ï¼Œ&lt;code>Content-Length:&lt;/code>ï¼Œ&lt;code>Transfer-Encoding:&lt;/code>ç­‰é¦–éƒ¨ï¼Œçœ‹çœ‹ä¼ è¾“å›¾ç‰‡/åŽ‹ç¼©æ–‡ä»¶æ—¶çš„æ ‡å‡†åšæ³•ï¼Œä»¥åŠåœ¨é‡åˆ°å¤§æ–‡ä»¶æ—¶å¦‚ä½•å®žçŽ°åˆ†æ®µè¿è¾“ã€‚ï¼ˆå°½ç®¡æˆ‘ä»¬çš„å®žçŽ°å¾ˆç®€é™‹ï¼Œæµè§ˆå™¨è¿˜æ˜¯èƒ½æ­£å¸¸å·¥ä½œï¼Œè¯´æ˜ŽHTTPæ˜¯ç›¸å½“å¥å£®çš„åè®®ï¼‰&lt;/li>
&lt;li>ä½ çš„æœåŠ¡å™¨æ˜¯å¦æœ‰å®‰å…¨é—®é¢˜ï¼Ÿä½ å¯ä»¥è®¿é—®æ ¹ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶å—ï¼Ÿå¦‚ï¼š &lt;code>/../../../../etc/passwd&lt;/code>ï¼ˆlinuxä¸‹ï¼‰&lt;/li>
&lt;li>æœåŠ¡å™¨æ¦‚å¿µè¾¨æžï¼šWebåˆå­¦è€…å®¹æ˜“å¯¹æœåŠ¡å™¨æ¦‚å¿µæ„Ÿåˆ°è¿·æƒ‘ã€‚è½¯ä»¶è¯­å¢ƒä¸‹ï¼ŒæœåŠ¡å™¨æŒ‡å¯¹å¤–æä¾›æœåŠ¡çš„ç¨‹åºï¼Œå¸¸ç”¨æœåŠ¡å™¨å¦‚apacheã€nginxï¼Œtomcatç­‰ï¼›ç¡¬ä»¶è¯­å¢ƒä¸‹åˆ™æŒ‡è¿è¡Œç€æœåŠ¡å™¨è½¯ä»¶çš„æœºå™¨ã€‚&lt;/li>
&lt;li>æˆ‘ä»¬å®žçŽ°çš„æ˜¯é™æ€ç½‘ç«™ï¼Œä½ å¯èƒ½ç–‘æƒ‘æ˜¯ä¸æ˜¯è¿˜æœ‰åŠ¨æ€ç½‘ç«™ã€‚å½“ç„¶æœ‰ï¼ŒåŒºåˆ†åŠ¨æ€å’Œé™æ€å¹¶ä¸æ˜¯ç½‘é¡µä¼šä¸ä¼šè‡ªå·±åŠ¨ï¼Œè€Œæ˜¯æœåŠ¡å™¨ä¸Šçš„æ•°æ®æ˜¯å¦å¯ä»¥åŠ¨æ€çš„æ”¹å˜ï¼Œè€Œæˆ‘ä»¬çš„æœåŠ¡å™¨åªèƒ½è¢«åŠ¨çš„æ˜¾ç¤ºæ–‡ä»¶ï¼Œå®¢æˆ·ç«¯æ— æ³•åšå‡ºä»»ä½•æ›´æ”¹ã€‚çŽ°ä»£webæ¡†æž¶è¯¸å¦‚Springbootï¼ŒDjangoä¹‹ç±»å½“ç„¶æ˜¯åŠ¨æ€ç½‘ç«™æ¡†æž¶ã€‚&lt;/li>
&lt;/ul>
&lt;p>å®žé™…ä¸Šï¼Œè®¡ç½‘å¹¶ä¸å…³å¿ƒåº”ç”¨å±‚ä»¥ä¸Šçš„ä¸œè¥¿ï¼Œè®©æˆ‘ä»¬å‘ä¸‹çœ‹ï¼ŒæŽ¢ç©¶socketèƒŒåŽçš„åŽŸç†å§ã€‚&lt;/p>
&lt;h3 id="0x20-ä¼ è¾“å±‚socket--">0x20 ä¼ è¾“å±‚ï¼šSocket | â­&lt;/h3>
&lt;h4 id="intro-1">Intro&lt;/h4>
&lt;ul>
&lt;li>ç›®æ ‡ï¼šç”¨ scapy å®žçŽ°TCPåè®®ï¼Œä»¥å°½å¯èƒ½æ›¿æ¢ä¸Šä¸€ä¸ªå®žéªŒä½¿ç”¨çš„socketæ¨¡å—
&lt;ul>
&lt;li>// ä½ å¯èƒ½çŒœåˆ°äº†ï¼Œä¸‹ä¸€ä¸ªå®žéªŒæ˜¯ä¸æ˜¯è¦è‡ªå·±å®žçŽ°IPåè®®å‘€ï¼Ÿæ­å–œä½ çŒœé”™äº†ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å‰ç½®ï¼š
&lt;ul>
&lt;li>æœ¯è¯­
&lt;ul>
&lt;li>TCP/UDP&lt;/li>
&lt;li>TCPæŠ¥æ–‡æ ¼å¼&lt;/li>
&lt;li>æœ‰é™çŠ¶æ€æœº&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å®Œæˆæœ¬å®žéªŒä»…æ¶‰åŠã€ŠCNTDAã€‹3.4-3.5èŠ‚ï¼Œå¦‚æžœç†è§£æœ‰å›°éš¾ï¼Œå»ºè®®å…ˆå®Œæˆ&lt;em>Wireshark å®žéªŒï¼šTCPè§‚å¯Ÿ&lt;/em>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åœ¨ä¸Šä¸€ä¸ªå®žéªŒä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°socketæ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„ç³»ç»Ÿè°ƒç”¨ï¼Œä¾‹å¦‚ Linux ä¸­ï¼Œåˆ›å»ºsocketå¯¹è±¡è¿”å›žçš„&lt;code>sock_fd&lt;/code>æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå³å»ºç«‹è¿žæŽ¥åŽå¯ä»¥ç›´æŽ¥åƒæ–‡ä»¶ä¸€æ ·è¯»å†™ï¼Œç»‘å®šç«¯å£åŽæ“ä½œç³»ç»Ÿä¼šä¿æŠ¤è¯¥ç«¯å£ä¸è¢«å…¶ä»–è¿›ç¨‹å ç”¨ã€‚è€Œæœ¬å®žéªŒå…³æ³¨è¿è¾“å±‚åŽŸç†ï¼Œæ‰€ä»¥ç»•è¿‡äº†æ“ä½œç³»ç»Ÿï¼Œä½¿ç”¨æ›´åº•å±‚çš„æŽ¥å£å®žçŽ°TCPã€‚å½“ç„¶ï¼Œæ˜¯æœ€ç®€é™‹çš„ä¸€ç§å®žçŽ°ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="guidelines-1">Guidelines&lt;/h4>
&lt;ol>
&lt;li>Socketå®žçŽ°åŽŸç†&lt;/li>
&lt;/ol>
&lt;p>é‚£ä¹ˆï¼Œsocketé‡Œé¢åˆ°åº•æœ‰ä»€ä¹ˆï¼Ÿé¦–å…ˆï¼Œè¦ä¿å­˜åœ°å€ç«¯å£ç­‰ä¿¡æ¯ï¼›å…¶æ¬¡ï¼Œè¦æœ‰æ”¶å‘çš„ä¸¤ä¸ªç¼“å†²åŒºï¼Œè¿™é‡Œå¯ä»¥ç”¨é˜Ÿåˆ—ï¼›ç„¶åŽï¼Œä¸ºäº†å®žçŽ°å¯é è¿è¾“ï¼Œéœ€è¦ç”¨åˆ°è®¡æ—¶å™¨æ¥è§¦å‘é‡ä¼ ï¼Œéœ€è¦å˜é‡æ ‡è®°æ»‘åŠ¨çª—å£ï¼›æˆ‘ä»¬è¿˜ç”¨è‡ªåŠ¨æœºæ€æƒ³æ¥ç®¡ç†è¿žæŽ¥çŠ¶æ€ã€‚Socketåº•å±‚æ¨¡åž‹å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> â”Œâ”€â”€â”€â”€â”€Socketâ”€â”€â”€â”€â”€â”€â”
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”Œâ”€â”€â”€â”€â”€â” â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â”œâ”€â”€â”¼â”€â–º SendQ â”œâ”€â”€â”¼â”€â–ºâ”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ App â”‚ â”‚ Buffers â”‚ â”‚ IP â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â”‚â—„â”€â”¼â”€â”€â”¤ RecvQ â—„â”€â”¼â”€â”€â”¤ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â””â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â””â”€â”€â”€â”€â”˜
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€â”€â”€Variablesâ”€â”€â”€â”€â”¤
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ Status â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ Timer â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ SendBase â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ NextSeq â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œå°±éœ€è¦é¢å‘å¯¹è±¡ä¸Šåœºäº†&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Socket&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="fm">__init__&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">SendQ&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Queue&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">RecvQ&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Queue&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Status&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Status&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CLOSED&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Timer&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Timer&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">SendBase&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">NextSeq&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># SERVER&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">bind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">addr&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">accept&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#return c, addr &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># CLIENT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">connect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># BOTH&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">recv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">length&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#return data&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">close&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸‹é¢é€ä¸ªå®žçŽ°socketæŽ¥å£ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>
&lt;p>å®šåˆ¶TCPæŠ¥æ–‡&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¿žæŽ¥ç®¡ç†&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>äº†è§£äº†ä¸‰æ¬¡æ¡æ‰‹ï¼Œå°±å¯ä»¥å®žçŽ°connectå‡½æ•°äº†&lt;/p>
&lt;h4 id="task-1">Task&lt;/h4>
&lt;ol>
&lt;li>å¤šè·¯å¤ç”¨&lt;/li>
&lt;/ol>
&lt;p>ç›®å‰çš„å®žçŽ°åªèƒ½æ”¯æŒä¸€ä¸ªTCPè¿žæŽ¥ï¼Œè¯·å®žçŽ°&lt;code>listen(num)&lt;/code>å‡½æ•°ï¼Œè°ƒç”¨æ—¶åˆ›å»º num å¯¹è¯»å†™ç¼“å†²åŒºï¼Œå“åº”çš„ä¸º&lt;/p>
&lt;ol>
&lt;li>å®Œå–„TCPåŠŸèƒ½ï¼š&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>RTT&lt;/li>
&lt;li>å¯é è¿è¾“&lt;/li>
&lt;li>æµé‡æŽ§åˆ¶&lt;/li>
&lt;li>é˜»å¡žæŽ§åˆ¶&lt;/li>
&lt;/ul>
&lt;ol start="2">
&lt;li>æ‹“å±•UDPåˆ°ä½ çš„socket&lt;/li>
&lt;/ol>
&lt;h4 id="expand-1">Expand&lt;/h4>
&lt;h3 id="0x30-ç½‘ç»œå±‚-è·¯ç”±è¿½è¸ª--">0x30 ç½‘ç»œå±‚: è·¯ç”±è¿½è¸ª | â­&lt;/h3>
&lt;h4 id="intro-2">Intro&lt;/h4>
&lt;p>æœ¯è¯­ï¼š&lt;/p>
&lt;ul>
&lt;li>IPå±‚ï¼šIPåè®®ï¼ŒICMPåè®®ï¼Œè·¯ç”±åè®®&lt;/li>
&lt;li>è·¯ç”±è¿½è¸ªï¼šè¯·æ±‚æŸåœ°å€ç»è¿‡äº†é‚£äº›è·¯ç”±å™¨ï¼Ÿ&lt;/li>
&lt;/ul>
&lt;h4 id="guidelines-2">Guidelines&lt;/h4>
&lt;p>scapyå®žçŽ°äº†è·¯ç”±è¿½è¸ªå‡½æ•°ï¼Œä½ å¯ä»¥é’»ç ”ä¸€ä¸‹&lt;a class="link" href="https://github.com/secdev/scapy/blob/master/scapy/layers/inet.py#L1740-L1773" target="_blank" rel="noopener"
>æºç &lt;/a>ï¼ˆå¾ˆçŸ­ï¼‰ï¼Œä¸‹é¢å†™ä¸€ä¸ªè‡ªå·±çš„tracerouteã€‚&lt;/p>
&lt;h4 id="task-2">Task&lt;/h4>
&lt;p>ä¸‹é¢ç”¨Ipythonæ¼”ç¤ºï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">In&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="kn">from&lt;/span> &lt;span class="nn">scapy.all&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="o">*&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">In&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="n">target&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;www.amazon.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">In&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="n">ans&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">unans&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">IP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dst&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">ttl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">30&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">TCP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">flags&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mh">0x2&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Begin&lt;/span> &lt;span class="n">emission&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Finished&lt;/span> &lt;span class="n">sending&lt;/span> &lt;span class="mi">30&lt;/span> &lt;span class="n">packets&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">.*****..**********..........................................................................^&lt;/span>&lt;span class="n">C&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Received&lt;/span> &lt;span class="mi">92&lt;/span> &lt;span class="n">packets&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">got&lt;/span> &lt;span class="mi">15&lt;/span> &lt;span class="n">answers&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">remaining&lt;/span> &lt;span class="mi">15&lt;/span> &lt;span class="n">packets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">In&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">snd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rcv&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">ans&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">snd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ttl&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rcv&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">src&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">isinstance&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rcv&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">TCP&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">1&lt;/span> &lt;span class="mf">11.206.119.46&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">2&lt;/span> &lt;span class="mf">11.110.80.173&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">3&lt;/span> &lt;span class="mf">10.102.15.74&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">4&lt;/span> &lt;span class="mf">11.73.2.241&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">5&lt;/span> &lt;span class="mf">124.160.189.101&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">6&lt;/span> &lt;span class="mf">219.158.97.2&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">7&lt;/span> &lt;span class="mf">219.158.34.190&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">8&lt;/span> &lt;span class="mf">69.192.14.38&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">9&lt;/span> &lt;span class="mf">219.158.24.134&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">10&lt;/span> &lt;span class="mf">219.158.10.30&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">11&lt;/span> &lt;span class="mf">69.192.14.38&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">12&lt;/span> &lt;span class="mf">69.192.14.38&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">13&lt;/span> &lt;span class="mf">69.192.14.38&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">14&lt;/span> &lt;span class="mf">69.192.14.38&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸‹é¢è®²è§£æ ¸å¿ƒä»£ç ï¼š&lt;/p>
&lt;p>&lt;code>ans,unans=sr(IP(dst=target,ttl=(1,30),id=RandShort())/TCP(flags=0x2))&lt;/code>&lt;/p>
&lt;ul>
&lt;li>sr()ï¼šsend and receiveï¼Œè¿”å›žçš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯å¾—åˆ°åº”ç­”çš„æ•°æ®åŒ…åˆ—è¡¨å’Œæœªåº”ç­”çš„åŒ…åˆ—è¡¨ã€‚&lt;/li>
&lt;li>ttl=(4,30)ï¼šttlå‚æ•°åœ¨IPå±‚è¡¨ç¤ºICMPåŒ…çš„è½¬å‘æ¬¡æ•°ï¼ˆè·³æ•°ï¼‰ã€‚æ­¤å¤–ï¼Œä¼ å…¥tupleè¡¨ç¤ºä¸€ä¸ªèŒƒå›´ï¼Œsrå‡½æ•°å°†ä¼šä¸ºè¿™ä¸ªèŒƒå›´å†…çš„æ¯ä¸ªå€¼ç”Ÿæˆä¸€ä¸ªå‘åŒ…ã€‚ï¼ˆå¦‚æžœæœ‰å¤šä¸ªtupleå‚æ•°ï¼Œåˆ™ä¼šæŒ‰ç¬›å¡å°”ç§¯è§„åˆ™ç”Ÿæˆå‘åŒ…åˆ—è¡¨ï¼‰&lt;/li>
&lt;li>TCP(flags=0x2)ï¼šåœ¨TCPå¤´éƒ¨è®¾å®šflagå­—æ®µçš„å€¼ï¼Œ0x2å¯¹åº”ACKï¼Œå³ç¡®è®¤æ”¶åˆ°åŒ…ã€‚&lt;/li>
&lt;li>ç»¼åˆèµ·æ¥ï¼Œè¿™æ¡ä»£ç å°†å‘é€30ä¸ªåŒ…ï¼Œå…¶ttlä»Ž1åˆ°30ã€‚å¹¶ç­›é€‰è¿”å›žACKçš„åŒ…ã€‚&lt;/li>
&lt;li>è¿™æ ·æ ¹æ®IPå±‚è·¯ç”±ç®—æ³•ï¼Œåˆ°è¾¾ttlçš„åŒ…æ— è®ºæ˜¯å¦æ‰¾åˆ°ç›®æ ‡éƒ½ä¼šè¿”å›žï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡ï¼ŒTCPå±‚è¿”å›žACKã€‚éåŽ†ttlå½¢æˆçš„åˆ—è¡¨å³æ˜¯ç»è¿‡çš„æ‰€æœ‰è·¯ç”±ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="expand-2">Expand&lt;/h4>
&lt;h3 id="0x301-ç½‘ç»œå±‚-æ¬ºéª—ping----todo">0x301 ç½‘ç»œå±‚: æ¬ºéª—ping | â­ | TODO&lt;/h3>
&lt;h4 id="intro-3">Intro&lt;/h4>
&lt;ul>
&lt;li>æ¥æºï¼šhttps://seedsecuritylabs.org/Labs_20.04/Files/ICMP_Redirect/ICMP_Redirect.pdf&lt;/li>
&lt;li>æœ¯è¯­ï¼š&lt;/li>
&lt;/ul>
&lt;h4 id="guidelines-3">Guidelines&lt;/h4>
&lt;h4 id="task-3">Task&lt;/h4>
&lt;h4 id="expand-3">Expand&lt;/h4>
&lt;h3 id="0x41-é“¾è·¯å±‚-arpç¼“å­˜æŠ•æ¯’----todo">0x41 é“¾è·¯å±‚: ARPç¼“å­˜æŠ•æ¯’ | â­â­ | TODO&lt;/h3>
&lt;p>&lt;a class="link" href="https://seedsecuritylabs.org/Labs_20.04/Files/ARP_Attack/ARP_Attack.pdf" target="_blank" rel="noopener"
>https://seedsecuritylabs.org/Labs_20.04/Files/ARP_Attack/ARP_Attack.pdf&lt;/a>&lt;/p>
&lt;h3 id="0x21-ä¼ è¾“å±‚-tcpæ”»å‡»----todo">0x21 ä¼ è¾“å±‚: TCPæ”»å‡» | â­â­ | TODO&lt;/h3>
&lt;p>&lt;a class="link" href="https://seedsecuritylabs.org/Labs_20.04/Files/TCP_Attacks/TCP_Attacks.pdf" target="_blank" rel="noopener"
>https://seedsecuritylabs.org/Labs_20.04/Files/TCP_Attacks/TCP_Attacks.pdf&lt;/a>&lt;/p>
&lt;p>TCPåè®®
SYNæ³›æ´ª
TCP reset
TCP session hijackingåå¼¹shell ï¼ˆé‡ç‚¹ï¼‰&lt;/p>
&lt;h3 id="0x31-ç½‘ç»œå±‚-natdhcpå’Œè™šæ‹Ÿæœº-----todo">0x31 ç½‘ç»œå±‚: NATï¼ŒDHCPå’Œè™šæ‹Ÿæœº | â­â­ | TODO&lt;/h3>
&lt;p>ç›¸ä¿¡æŠ˜è…¾è¿‡è™šæ‹Ÿæœºçš„åŒå­¦éƒ½ç»•ä¸è¿‡è¿™ä¸ªé—®é¢˜ï¼šæˆ‘çš„è™šæ‹Ÿæœºæ€Žä¹ˆè¿žä¸ä¸Šç½‘ï¼Ÿæœ¬å®žéªŒåŸºäºŽwmwareè™šæ‹Ÿæœºå¹³å°ï¼Œè®²è§£å‡ ç§è™šæ‹Ÿæœºç½‘ç»œæ¨¡å¼åŠå…¶åŽŸç†ã€‚&lt;/p>
&lt;h3 id="0x13-åº”ç”¨å±‚-dnsæœ¬åœ°æ”»å‡»----todo">0x13 åº”ç”¨å±‚: DNSæœ¬åœ°æ”»å‡» | â­â­â­ | TODO&lt;/h3>
&lt;p>&lt;a class="link" href="https://seedsecuritylabs.org/Labs_20.04/Files/DNS_Local/DNS_Local.pdf" target="_blank" rel="noopener"
>https://seedsecuritylabs.org/Labs_20.04/Files/DNS_Local/DNS_Local.pdf&lt;/a>&lt;/p>
&lt;h3 id="0x14-åº”ç”¨å±‚-sslåè®®å’Œhttps----todo">0x14 åº”ç”¨å±‚: SSLåè®®å’ŒHTTPS | â­â­â­â­ | TODO&lt;/h3>
&lt;h3 id="0x15-åº”ç”¨å±‚-å¤šçº¿ç¨‹webä»£ç†æœåŠ¡å™¨-----todo">0x15 åº”ç”¨å±‚: å¤šçº¿ç¨‹Webä»£ç†æœåŠ¡å™¨ | â­â­â­â­â­ | TODO&lt;/h3>
&lt;h3 id="0x151-åº”ç”¨å±‚-vpn----todo">0x151 åº”ç”¨å±‚: VPN | â­â­â­â­â­ | TODO&lt;/h3>
&lt;p>æŽ¢ç©¶VPNåŽŸç†&lt;/p>
&lt;h3 id="0x152-åº”ç”¨å±‚-v2rayåè®®å­¦ä¹ ----todo">0x152 åº”ç”¨å±‚: V2Rayåè®®å­¦ä¹  | ï¼Ÿï¼Ÿï¼Ÿ | TODO&lt;/h3>
&lt;p>æœ‰ç”Ÿä¹‹å¹´ç ”ç©¶ä¸€ä¸‹Vmessç­‰åè®®&lt;/p>
&lt;!-- çœç•¥çš„ï¼š
- é˜²ç«å¢™iptableså®žéªŒ
- mitnickæ”»å‡»
- BGP
- 802.11
- --></description></item><item><title>å¹´è½»äººçš„ç¬¬äºŒä¸ªç½‘ç«™ï¼ˆäºŒï¼‰ - flask-supreme-tutorial</title><link>https://lonelyuan.github.io/p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99%E4%BA%8C-flask-supreme-tutorial/</link><pubDate>Thu, 16 Sep 2021 12:43:23 +0000</pubDate><guid>https://lonelyuan.github.io/p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99%E4%BA%8C-flask-supreme-tutorial/</guid><description>&lt;blockquote>
&lt;p>&lt;a class="link" href="https://lonelyuan.github.io/post/flask-mega-tutorial/" target="_blank" rel="noopener"
>ä¸Šå›žä¹¦&lt;/a>è¯´åˆ°ï¼Œç½‘ç«™åˆå…·é›å½¢ï¼Œä½†ç»é«˜äººæŒ‡ç‚¹ï¼Œè¿˜æ˜¯æœ‰å¾ˆå¤šä¸è¶³ã€‚
æœ¬æ–‡å°†å¤§èƒ†æ‰©å……ç½‘ç«™ç»“æž„ï¼Œç›®æ ‡æ˜¯å°†ç½‘ç«™æ‹“å±•æˆä¸€ä¸ª CMS ã€‚
æ‰€ä»¥ï¼Œä¸è¦åœä¸‹æ¥å•Šï¼ðŸ‘†ï¼ˆæŒ‡å¼€å‘&lt;/p>
&lt;/blockquote>
&lt;hr>
&lt;h2 id="0x00-è“å›¾ä¸Žé‡æž„">0x00 è“å›¾ä¸Žé‡æž„&lt;/h2>
&lt;p>ä¸Žä¹‹å‰ç›¸æ¯”ï¼Œç½‘ç«™å°†å¢žåŠ ä»¥ä¸‹åŠŸèƒ½ï¼š&lt;/p>
&lt;ul>
&lt;li>å›¾åº“ï¼šæ–‡ä»¶ä¸Šä¼ æ¨¡å—&lt;/li>
&lt;li>è¯„è®ºï¼šæ¥¼ä¸­æ¥¼åŠŸèƒ½&lt;/li>
&lt;li>åŽå°ï¼šæƒé™æ¨¡å—ï¼ŒåŽå°æ¨¡å—&lt;/li>
&lt;li>ä¼˜åŒ–ï¼šæ›´å¥å£®çš„æ•°æ®åº“æŽ¥å£ï¼Œæ›´ç»†è‡´çš„æƒé™æŽ§åˆ¶&lt;/li>
&lt;li>plusåŠŸèƒ½ï¼šç”¨ redis å®žçŽ°çƒ­æœ&lt;/li>
&lt;/ul>
&lt;p>åœ¨å¼€å‘è¿™äº›åŠŸèƒ½ä¹‹å‰ï¼Œé¦–å…ˆé‡æ•´é¡¹ç›®ç»“æž„ã€‚å¦‚ï¼š&lt;/p>
&lt;ul>
&lt;li>å®Œå…¨è“å›¾åŒ–ã€‚&lt;a class="link" href="https://blog.csdn.net/ldq_sd/article/details/104766636" target="_blank" rel="noopener"
>å‚è€ƒ&lt;/a>
&lt;ul>
&lt;li>æ¨¡æ¿ä¹Ÿæ”¾å…¥ç‹¬ç«‹å­ç›®å½•é‡Œï¼Œè“å›¾æ³¨å†Œæ—¶ä½¿ç”¨template_folderå‚æ•°ï¼Œä¸è¿‡è¿™æ ·å®¹æ˜“äº§ç”Ÿbugï¼Œflask å®˜æ–¹æŽ¨èä½¿ç”¨ç¡¬ç¼–ç ï¼Œæ±—ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ¸…ç†ä¾èµ–ï¼Œä¸ä½¿ç”¨ç»´æŠ¤çŠ¶æ€å·®çš„åº“ã€‚
&lt;ul>
&lt;li>å¼€å‘æ–°åŠŸèƒ½çš„æ—¶å€™ï¼ŒåŽ»å“ªé‡Œæ‰¾æœ€ä½³å®žè·µï¼Œæ‰¾å¥½ç”¨çš„åº“å‘¢ï¼Ÿæœ‰ä¸€ä¸ª Github æœç´¢å°æŠ€å·§ï¼Œåä¸º &amp;ldquo;awesome-xxx&amp;rdquo; çš„ä»“åº“é€šå¸¸æ˜¯æŸæŠ€æœ¯çš„ä¼˜è´¨èµ„æºåˆ—è¡¨ã€‚å¦‚ï¼šhttps://github.com/humiaozuzu/awesome-flask&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="0x01-æ–‡ä»¶ç³»ç»Ÿ">0x01 æ–‡ä»¶ç³»ç»Ÿ&lt;/h2>
&lt;blockquote>
&lt;p>æœ¬éƒ¨åˆ†å‚è€ƒäº†&lt;a class="link" href="https://greyli.com" target="_blank" rel="noopener"
>æŽè¾‰&lt;/a>å¤§ä½¬çš„ç³»åˆ—æ–‡ç« ï¼Œ
&lt;a class="link" href="https://zhuanlan.zhihu.com/p/23731819?refer=flask" target="_blank" rel="noopener"
>https://zhuanlan.zhihu.com/p/23731819?refer=flask&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>å¤´åƒï¼Œç…§ç‰‡â€¦â€¦æ–‡ä»¶ä¸Šä¼ æ˜¯ç»•ä¸å¼€çš„è¯é¢˜ã€‚åœ¨&lt;a class="link" href="#shangyipian" >ä¸Šä¸€ç¯‡&lt;/a>å‚è€ƒçš„æ•™ç¨‹ä¸­ï¼Œå¤´åƒçš„å®žçŽ°æ˜¯ç”±æ‰˜ç®¡ç½‘ç«™ç”Ÿæˆéšæœºçš„å›¾ç‰‡ã€‚é—æ†¾çš„æ˜¯å¹¶æ²¡æœ‰åƒ ORM ä¸€æ ·æ–¹ä¾¿æ•°æ®åº“å¤„ç†çš„æ–‡ä»¶å¤„ç†æ¡†æž¶å¯ä¾›ä½¿ç”¨ï¼Œè¿˜æ˜¯è‡ªå·±æŠŠä»–å•ƒä¸‹æ¥å§ã€‚&lt;/p>
&lt;p>æ³¨æ„è¸©å‘ï¼å¤§éƒ¨ä»½èµ„æ–™æŽ¨èä½¿ç”¨Flask_uploadsæ’ä»¶ï¼Œç„¶è€Œä½¿ç”¨è¯¥æ’ä»¶æ—¶å‡ºçŽ°å¦‚ä¸‹æŠ¥é”™ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">ImportError: cannot import name &amp;#39;secure_filename&amp;#39; from &amp;#39;werkzeug&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æŸ¥é˜…Stackoverflowå¾—çŸ¥æ˜¯PYPIæºä¸Šçš„Flask_uploadsæ’ä»¶ä¸å†ç»´æŠ¤äº†ï¼ŒäºŽæ˜¯å’Œ werkzeug åº“çš„apiä¸å…¼å®¹ï¼Œæ˜¯æ’ä»¶å†…åœ¨çš„bugã€‚ç½‘ä¸Šçš„è§£å†³æ–¹æ³•æœ‰äºŒï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸€æ˜¯ä¿®æ”¹åº“æºç &lt;/li>
&lt;li>äºŒæ˜¯æ¢å¦ä¸€ä¸ªåº“ï¼Œç»´æŠ¤è‰¯å¥½ä¸”å¯æ— ç¼è¿ç§»ï¼Œåä¸º&lt;a class="link" href="https://pypi.org/project/Flask-Reuploaded/" target="_blank" rel="noopener"
>Flask-Reuploaded&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>å‰è€…ä¸åˆ©äºŽåŽç»­éƒ¨ç½²ï¼Œæœ¬äººå€¾å‘äºŽåŽè€…ã€‚ç„¶è€Œï¼Œä½¿ç”¨æ–°åº“ä¹Ÿé‡åˆ°äº†è¯¸å¤šéº»çƒ¦ï¼Œä½¿ç”¨&lt;code>UploadSet.url()&lt;/code>æ–¹æ³•æ—¶ï¼ŒæŠ¥é”™å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">werkzeug.routing.BuildError: Could not build url for endpoint &amp;#39;_uploads.uploaded_file&amp;#39; with values [&amp;#39;filename&amp;#39;, &amp;#39;setname&amp;#39;].
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>UploadSet.url()&lt;/code>æ–¹æ³•è¿”å›žå¯¹åº”æ–‡ä»¶çš„å¯è®¿é—®urlï¼Œè¿”å›žçš„urlé»˜è®¤å¸¦æœ‰&lt;code>_upload/&lt;/code>å‰ç¼€ï¼Œè¿™æ˜¯ Flask-Uploads è‡ªå¸¦çš„è·¯ç”±ï¼Œä¹Ÿè¢«ç§°ä¸º autoserve ã€‚
ç„¶è€Œå®˜æ–¹æ–‡æ¡£é‡Œæœ‰è¿™æ ·ä¸€å¥è¯&lt;/p>
&lt;blockquote>
&lt;p>autoserve of uploaded images now has been deactivated; this was a poorly documented â€œfeatureâ€, which even could have lead to unwanted data disclosure; if you want to activate the feature again, you need to set UPLOADS_AUTOSERVE=True&lt;/p>
&lt;/blockquote>
&lt;p>çœ‹æ¥ Flask-Reuploaded çš„ä½œè€…ä¼¼ä¹Žè®¤ä¸ºæ–‡ä»¶è¯»å–åŠŸèƒ½ä¸Žæˆ‘æ— ç“œã€‚å¥½å§ï¼Œè¿™éƒ¨åˆ†æˆ‘ä»¬è‡ªå·±å®žçŽ°ã€‚&lt;/p>
&lt;p>// æµªè´¹äº†ä¸€æ™šä¸Šdebugï¼Œç»“æžœåªæ˜¯å› ä¸ºæ–‡æ¡£æ²¡çœ‹æ˜Žç™½ï¼Œå†æ¬¡è¯æ˜Žè¯»æ–‡æ¡£çš„é‡è¦æ€§ã€‚&lt;/p>
&lt;h3 id="flask-reuploaded-æ–‡ä»¶ä¸Šä¼ ">Flask-Reuploaded: æ–‡ä»¶ä¸Šä¼ &lt;/h3>
&lt;p>æ’ä»¶å°†ä¸Šä¼ çš„ä¸€ç±»æ–‡ä»¶æŠ½è±¡æˆé›†åˆ&lt;code>UploadSet&lt;/code>ã€‚å¯¹æ¯ä¸ª Set æœ‰å¦‚ä¸‹æ“ä½œï¼š&lt;/p>
&lt;ul>
&lt;li>é…ç½®æ–‡ä»¶ç±»åž‹ï¼š&lt;code>photos = UploadSet('photos', IMAGES)&lt;/code> //ç±»åž‹åŒ…æ‹¬ï¼šIMAGESã€TEXTã€AUDIOâ€¦â€¦&lt;/li>
&lt;li>é…ç½®å­˜è´®è·¯å¾„ï¼š&lt;code>app.config['UPLOADED_PHOTOS_DEST']&lt;/code> // Photos ä¸º Set çš„å˜é‡å&lt;/li>
&lt;li>ä¿å­˜æ–‡ä»¶ï¼š&lt;code>filename = photos.save(request.files['photo'])&lt;/code>&lt;/li>
&lt;li>è¿”å›žé“¾æŽ¥ï¼š&lt;code>photos.url(filename)&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>æœ€åŽï¼Œæ³¨å†Œ Set å’Œæ’ä»¶æ³¨å†Œç±»ä¼¼ï¼š&lt;code>configure_uploads(app, [avatars, photos])&lt;/code> //å¯ä¸€æ¬¡æ€§å…¨éƒ¨æ³¨å†Œ&lt;/p>
&lt;p>å®žçŽ°å¤´åƒä¸Šä¼ çš„æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>æ¨¡åž‹å±‚ï¼š User æ·»åŠ  avatar å­—æ®µï¼Œå‚¨å­˜å¤´åƒçš„æ–‡ä»¶åã€‚åŽŸ&lt;code>avatar()&lt;/code>æ–¹æ³•ä½œä¸ºé»˜è®¤å¤´åƒã€‚&lt;/li>
&lt;li>è¡¨å•å±‚ï¼š edit_profile è¡¨å•å¢žåŠ &lt;code>FileField&lt;/code>å­—æ®µ&lt;/li>
&lt;li>è§†å›¾å±‚ï¼š å‚¨å­˜æ–‡ä»¶ï¼Œå‘æ•°æ®åº“æäº¤æ–‡ä»¶åã€‚&lt;/li>
&lt;li>æ¨¡æ¿å±‚ï¼š æ”¹ç”¨ç¡¬è·¯ç”±èŽ·å–urlã€‚// æœ€ç»ˆ .url() è¿˜æ˜¯æœ‰bugï¼Œå†æ¬¡è¯´æ˜Žä¸è¦ä¹±ç”¨ä¸çŸ¥åçš„æ’ä»¶&lt;/li>
&lt;/ul>
&lt;h3 id="å›¾åº“æ¨¡å—">å›¾åº“æ¨¡å—&lt;/h3>
&lt;p>æœ¬æ¨¡å—åŒ…æ‹¬å¦‚ä¸‹è·¯ç”±ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>/index&lt;/code>ï¼šä¸»é¡µæ˜¾ç¤ºç€‘å¸ƒæµ&lt;/li>
&lt;li>&lt;code>/upload&lt;/code>ï¼šä¸Šä¼ æŽ¥å£ï¼šå‚è€ƒå¤´åƒä¸Šä¼ &lt;/li>
&lt;li>&lt;code>/detail&lt;/code>ï¼šè¯¦æƒ…ï¼Œæ˜¾ç¤ºè¯„è®º&lt;/li>
&lt;li>&lt;code>/delete&lt;/code>ï¼šåˆ é™¤æŽ¥å£ï¼šåŒæ—¶åˆ é™¤æ–‡ä»¶&lt;/li>
&lt;/ul>
&lt;p>ç”±äºŽæœ¬é¡¹ç›®å‰ç«¯æ¡†æž¶æ˜¯ Bootstrap ï¼ŒðŸ‘´ä¸æƒ³å†™Jqueryï¼Œæ‰€ä»¥ç›´æŽ¥åˆ·æ–°é¡µé¢ï¼Œä¹Ÿä¸å¼„æ— é™æ»šåŠ¨äº†ï¼ŒæŒ‰é’®äº†äº‹ã€‚å¦å¤–ä¸ºäº†ä¸åŒåˆ—é•¿åº¦å°½é‡å‡åŒ€ï¼Œæ•…é‡‡ç”¨å–å·§çš„æ–¹æ³•ï¼Œå¹³å‡åˆ†é…ã€‚æ ¹æ®å¤§æ•°å®šç†ï¼Œåªè¦éšæœºå›¾ç‰‡è¶³å¤Ÿå¤šè‚¯å®šä¼šå·®ä¸å¤šå‡åŒ€ã€‚ã€‚ã€‚ã€‚&lt;/p>
&lt;h2 id="0x02-è¯„è®ºç³»ç»Ÿ">0x02 è¯„è®ºç³»ç»Ÿ&lt;/h2>
&lt;h3 id="æ•°æ®åº“è®¾è®¡">æ•°æ®åº“è®¾è®¡&lt;/h3>
&lt;p>è¯„è®ºåŒ…å«äº†ä¸¤ä¸ªä¸€å¯¹å¤šå…³ç³»ï¼Œæ—¢æ˜¯è¯„è®ºå’Œæ–‡ç« çš„ä¸€å¯¹å¤šå…³ç³»ï¼Œä¹Ÿæ˜¯è¯„è®ºå’Œç”¨æˆ·çš„ä¸€å¯¹å¤šã€‚ä¸ºæ­¤ï¼Œåªéœ€è¦ç»™Userå’ŒPostæ·»åŠ å…³ç³»å³å¯ã€‚
ç„¶è€Œï¼Œæˆ‘ä»¬å¸Œæœ›è®¾è®¡ç»Ÿä¸€çš„Commentæ¨¡åž‹ï¼Œè¯„è®ºçš„å¯¹è±¡æ—¢å¯ä»¥æ˜¯æ–‡ç« ï¼Œä¹Ÿå¯ä»¥æ˜¯å›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–è¯„è®ºã€‚ä¸ºæ­¤ï¼Œæ·»åŠ ä¸€ä¸ªæžšä¸¾ç±»åž‹çš„å­—æ®µæŒ‡ç¤ºè¯„è®ºç±»åž‹ï¼Œä»Žè€Œé‡‡ç”¨ä¸åŒçš„å¤„ç†é€»è¾‘ã€‚&lt;/p>
&lt;h3 id="æ¥¼ä¸­æ¥¼">æ¥¼ä¸­æ¥¼&lt;/h3>
&lt;p>è€Œä¸»æµç½‘ç«™ä¸å…‰æ”¯æŒå¯¹æ–‡ç« è¯„è®ºï¼Œè¿˜æ”¯æŒæ¥¼ä¸­æ¥¼ã€‚å¯¹æ¥¼ä¸­æ¥¼çš„å®žçŽ°æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ¡ˆï¼š&lt;/p>
&lt;ul>
&lt;li>æŒ‰æ—¶é—´å¹³é“ºï¼šä»¥åŽŸç™¾åº¦è´´å§ä¸ºä¾‹
&lt;ul>
&lt;li>æ·»åŠ  &lt;code>reply_id&lt;/code> å­—æ®µï¼ŒæŒ‡ç¤ºè¦å›žå¤çš„äºº&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¥—å¨ƒå¼ç¼©è¿›ï¼šä»¥æŸäº›è€å¼bbsä¸ºä¾‹
&lt;ul>
&lt;li>æ·»åŠ  &lt;code>parent_id&lt;/code> å­—æ®µï¼ŒæŒ‡ç¤ºçˆ¶è¯„è®ºï¼ˆé¡¶å±‚è¯„è®ºåˆ™ä¸ºæœ¬èº«idï¼‰ï¼Œåœ¨å®žä½“ç±»ä¸­ä¿å­˜å­è¯„è®ºåˆ—è¡¨&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¼¹çª—å¼æŸ¥çœ‹ï¼šä»¥çŸ¥ä¹Žï¼Œbç«™ä¸ºä¾‹
&lt;ul>
&lt;li>åœ¨æŒ‰æ—¶é—´å¹³é“ºçš„åŸºç¡€ä¸Šï¼Œè‹¥ &lt;code>reply_id&lt;/code>å­˜åœ¨æ·»åŠ â€œæŸ¥çœ‹å¯¹è¯â€æŒ‰é’®ï¼Œé€’å½’çš„æž„å»ºå¯¹è¯å¹¶å¼¹çª—ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>å…¶ä¸­ï¼Œç¬¬ä¸€ç§å®žçŽ°ç®€å•ï¼Œç”¨æˆ·ä¸å‹å¥½ï¼›ç¬¬äºŒç§å®žçŽ°å¤æ‚ï¼Œå¯¹å¤šå±‚çº§å¯¹è¯æ— æ³•èƒœä»»ï¼›ç¬¬ä¸‰ç§æ˜¯æœ€ä¸»æµçš„å®žçŽ°æ–¹å¼ã€‚&lt;/p>
&lt;p>é€šè¿‡ä»¥&lt;code>reply_id&lt;/code>ä½œä¸ºæŒ‡é’ˆï¼Œæ‰€æœ‰è¯„è®ºè¿žæŽ¥æˆäº†ä¸€æ£µæ ‘ï¼Œåœ¨ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œâ€œæŸ¥çœ‹å¯¹è¯â€æ“ä½œï¼Œå°±æ˜¯æ‰§è¡Œæ ‘çš„å¯»æ ¹ã€‚â€œæŸ¥çœ‹å¯¹è¯â€å‡½æ•°å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl"> &lt;span class="nd">@staticmethod&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">view_dialogue&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">c_id&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dialogue&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">c_id&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="n">Comment&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">query&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">c_id&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">type&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;comment&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">c_id&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Comment&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">query&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">c_id&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">reply_id&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">Comment&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">query&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">c_id&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="ow">is&lt;/span> &lt;span class="kc">None&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">break&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dialogue&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">c_id&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">dialogue&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="0x03-ç½‘ç«™åŽå°">0x03 ç½‘ç«™åŽå°&lt;/h2>
&lt;p>ç½‘ç«™çš„åŽå°é€šå¸¸ç»™ç®¡ç†å‘˜æä¾›ç»Ÿä¸€ç›‘ç®¡æ•°æ®åº“çš„ç•Œé¢ã€‚æœ‰ä»¥ä¸‹æ’ä»¶å¸®åŠ©å®žçŽ°ï¼š&lt;/p>
&lt;ul>
&lt;li>Flask-adminï¼šä¸€é”®ç”ŸæˆåŽå°é¡µé¢ï¼Œå¹¶å¯ä»¥è‡ªå®šä¹‰è§†å›¾å’Œæ¨¡åž‹ã€‚&lt;/li>
&lt;li>Flask-Securityï¼š æ¯”adminå±‚æ¬¡æ›´é«˜ï¼Œå°è£…äº†å¸¸ç”¨è§†å›¾å’Œæ¨¡æ¿ã€‚ä½†æ˜¯æ–‡æ¡£å°‘ï¼Œä¸”å¾ˆå¤šåŠŸèƒ½æˆ‘ä»¬å·²ç»å®žçŽ°äº†ï¼Œå†ä½¿ç”¨å®ƒå°±è¦æŽ¨ç¿»é‡åšã€‚é‚å¼ƒç”¨ã€‚&lt;/li>
&lt;/ul>
&lt;p>æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨äº† RBACï¼ˆRole-Based Access Control) åŸºäºŽè§’è‰²çš„è®¿é—®æŽ§åˆ¶ï¼Œç®€å•è¯´å°±æ˜¯è®¾è®¡ä¸€ä¸ªè§’è‰²è¡¨ï¼Œç”¨æˆ·è¡¨å’Œè§’è‰²è¡¨ç”¨å…³è”è¡¨å®žçŽ°å¤šå¯¹å¤šå…³è”ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œé’ˆå¯¹è§’è‰²çš„æƒé™åˆ†é…ï¼Œä¿®æ”¹æƒé™æ—¶æ— éœ€ä¿®æ”¹æ¯ä¸ªç”¨æˆ·ã€‚&lt;/p>
&lt;h2 id="0x04-çƒ­æœ">0x04 çƒ­æœ&lt;/h2>
&lt;p>æœ¬èŠ‚å†åŠ å…¥ä¸€ä¸ªé‡é‡çº§å†…å®¹ï¼Œåˆ©ç”¨ redis å®žçŽ°æµè§ˆé‡æŽ’è¡Œæ¦œï¼Œä¹Ÿå°±æ˜¯çƒ­æœã€‚å½“ç„¶ï¼ŒçœŸæ­£çš„çƒ­æœæ¦œå•æŽ’åè§„åˆ™æ›´åŠ å¤æ‚ï¼Œè¿™é‡Œåªé€šè¿‡ç®€å•çš„æµè§ˆé‡è®¡æ•°æ¥ç»ƒä¹  redis çš„ä½¿ç”¨ã€‚&lt;/p>
&lt;p>ã€ðŸ‘´æœ‰æ—¶é—´å†åšã€‘&lt;/p>
&lt;h2 id="ä¸è¦è®©å¼€å‘åœä¸‹æ¥">ä¸è¦è®©å¼€å‘åœä¸‹æ¥&lt;/h2>
&lt;p>å¯ä»¥åŠ çš„åŠŸèƒ½è¿˜æœ‰å¾ˆå¤šï¼šæ—¶é—´çº¿ï¼Œemojiæ”¯æŒï¼Œå¤šåª’ä½“ï¼Œå‰åŽç«¯åˆ†ç¦»(Vue)ï¼Œï¼Œ&lt;/p>
&lt;p>é™¤äº†åŠŸèƒ½ï¼Œå½“é¢å¯¹æ›´é«˜é‡çº§çš„æµé‡æ—¶ï¼Œç½‘ç«™æ€§èƒ½ä¾¿æ›´åŠ é‡è¦ï¼Œè¿™æ—¶å€™æ¶ˆæ¯é˜Ÿåˆ—ï¼ŒPRCï¼Œå¾®æœåŠ¡/åˆ†å¸ƒå¼ï¼Œï¼Œï¼Œæ›´è®©äººå¤´ç§ƒã€‚&lt;/p>
&lt;p>Webå¼€å‘ä¹‹è·¯ï¼Œé“é˜»ä¸”é•¿ã€‚ä½†æ˜¯ï¼Œåªè¦å¼€å‘ä¸åœä¸‹æ¥ï¼Œé“è·¯å°±ä¼šä¸æ–­å»¶ç”³ã€‚ã€‚ã€‚ï¼ˆå¸Œæœ›ä¹‹èŠ±.mp3ï¼‰&lt;/p></description></item><item><title>å¹´è½»äººçš„ç¬¬äºŒä¸ªç½‘ç«™ - The Flask Mega Tutorial</title><link>https://lonelyuan.github.io/p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99-the-flask-mega-tutorial/</link><pubDate>Thu, 09 Sep 2021 20:18:56 +0000</pubDate><guid>https://lonelyuan.github.io/p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99-the-flask-mega-tutorial/</guid><description>&lt;blockquote>
&lt;p>æœ¬æ–‡ä¸º Flask æ¡†æž¶å­¦ä¹ ç¬”è®°ï¼Œä¸»è¦å‚è€ƒäº† &lt;a class="link" href="https://luhuisicnu.gitbook.io/the-flask-mega-tutorial-zh" target="_blank" rel="noopener"
>The-Flask-Mega-Tutorial&lt;/a> å’Œ ã€ŠFlask Webå¼€å‘ï¼šåŸºäºŽPythonçš„Webåº”ç”¨å¼€å‘å®žæˆ˜ã€‹ä¸¤æœ¬ä¹¦ï¼Œå¹¶åœ¨åŽŸé¡¹ç›®çš„åŸºç¡€ä¸Šæ‹“å±•ã€‚ï¼ˆä¸‹æ–‡ç»Ÿç§°è¿™ä¸¤ä¸ªèµ„æºä¸ºâ€œæœ¬æ•™ç¨‹â€ï¼‰
ä¸ç†Ÿæ‚‰ Flask æ¡†æž¶è¯·å…ˆé˜…è¯»&lt;a class="link" href="https://dormousehole.readthedocs.io/en/latest/quickstart.html" target="_blank" rel="noopener"
>å¿«é€Ÿä¸Šæ‰‹ - flask ä¸­æ–‡æ–‡æ¡£&lt;/a> ã€‚&lt;/p>
&lt;p>è¿™ä¸¤æœ¬ä¹¦çš„ä½œè€…æ˜¯åŒä¸€ä¸ªäººï¼Œå°±å†…å®¹ä¸Šè¯´åŽè€…ç®—æ˜¯å‰è€…çš„è±ªåŽç‰ˆã€‚æœ¬æ•™ç¨‹çš„ä¼˜ç‚¹æ˜¯å†…å®¹å…¨é¢ï¼Œä»Žå…¥é—¨åˆ°éƒ¨ç½²ä¸€ç«™å¼æœåŠ¡ï¼›ç¼ºç‚¹æ˜¯ä¸å¤Ÿæ·±å…¥ï¼Œä¸”æœ‰äº›è¿‡æ—¶ï¼Œä¹¦ä¸­ä¸¾ä¾‹çš„è¯¸å¤šæ’ä»¶å‡ä¸ºä½œè€…ä¸ºäº†æ­¤ä¹¦è€Œå¼€å‘çš„ï¼Œå·²ç»è®¸ä¹…ä¸å†ç»´æŠ¤ï¼Œå¯¼è‡´å¾ˆéš¾åœ¨å…¶ç¤ºä¾‹é¡¹ç›®ä¸Šæ‹“å±•ã€‚ä¸€çœ‹æ‰‰é¡µï¼Œ2015å¹´å‡ºç‰ˆï¼Œé‚£æ²¡äº‹äº†ã€‚
è‡³äºŽç¬¬ä¸€ä¸ªç½‘ç«™ï¼Ÿå‚è§&lt;a class="link" href="#%e6%88%91%e8%bf%98%e6%b2%a1%e5%86%99%e5%91%a2" >#TODO:å¹´è½»äººçš„ç¬¬ä¸€ä¸ªç½‘ç«™&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;hr>
&lt;h2 id="0x00-å¤§åž‹é¡¹ç›®ç»“æž„">0x00 å¤§åž‹é¡¹ç›®ç»“æž„&lt;/h2>
&lt;p>åœ¨å¤§éƒ¨åˆ†é¢å‘åˆå­¦è€…çš„ demo ä¸­ï¼Œåº”ç”¨ä»¥ç®€å•çš„é¡¹ç›®ç»“æž„ç”šè‡³å•æ–‡ä»¶è¡¨ç¤ºã€‚åœ¨å¤§åž‹é¡¹ç›®ä¸­ï¼Œç½‘ç«™çš„ä¸åŒåŠŸèƒ½è¢«æ‹†åˆ†æˆç‹¬ç«‹çš„æ¨¡å—ï¼Œä»¥æ–¹ä¾¿æ‹“å±•å’Œç»´æŠ¤ã€‚ä¸€ä¸ªæ›´é€šç”¨çš„ Flask é¡¹ç›®ä»£ç æž¶æž„å¦‚ä¸‹ï¼šï¼ˆä»…è€ƒè™‘ä¸šåŠ¡ä»£ç ï¼‰&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">microblog/ # æ ¹ç›®å½•
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> app/ # é¡¹ç›®æºç 
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> __init__.py # é¡¹ç›®åˆå§‹åŒ–ï¼Œå½“è¯¥åŒ…è¢«importï¼Œé¦–å…ˆæ‰§è¡Œ__init__.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> routes.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> forms.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> main.py # æ¡†æž¶å…¥å£
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> config.py # Configé…ç½®ç±»
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> .flaskenv
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶æœ‰ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>app/&lt;/code>æ‰€æœ‰ç½‘ç«™æºä»£ç ç»Ÿä¸€å½’åˆ°appç›®å½•ä¸‹ã€‚
&lt;ul>
&lt;li>åœ¨&lt;code>app/&lt;/code>å†…éƒ¨ï¼Œä¸åŒçš„åŠŸèƒ½å¯è¿›ä¸€æ­¥åˆ’åˆ†æˆç‹¬ç«‹æ¨¡å—ï¼Œè¯¦è§[æ¨¡å—åŒ–åº”ç”¨](#0x05 æ¨¡å—åŒ–åº”ç”¨ï¼šåŠŸèƒ½è§£è€¦)ä¸€ç« ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>main.py&lt;/code>: å…¥å£è„šæœ¬ï¼Œé€šè¿‡è¯¥æ–‡ä»¶å¼•å…¥appä¸­çš„ä»£ç å¹¶ç”Ÿæˆåº”ç”¨å®žä¾‹ï¼ˆå‘½åéšæ„ï¼‰&lt;/li>
&lt;li>&lt;code>.flaskenv&lt;/code>: flaskçŽ¯å¢ƒå˜é‡ï¼Œä»¥é…åˆflaskå‘½ä»¤ã€‚å…¥å£è„šæœ¬è¢«å®šä¹‰ä¸º&lt;code>FLASK_APP&lt;/code>ï¼Œæ‰§è¡Œ&lt;code>flask run&lt;/code>æ—¶å°†å¯åŠ¨è¯¥è„šæœ¬ã€‚&lt;/li>
&lt;li>&lt;code>config.py&lt;/code>: é…ç½®è„šæœ¬ï¼Œæ•´ä¸ªé¡¹ç›®çš„é…ç½®ä¿¡æ¯éƒ½å†™åœ¨Configç±»é‡Œã€‚ä¸ŽçŽ¯å¢ƒå˜é‡çš„åŒºåˆ«åœ¨äºŽï¼Œå› ä¸ºæ˜¯pythonè„šæœ¬ï¼ŒåŠŸèƒ½æ›´å¼ºå¤§ï¼Œå¯è¢«ä»»ä½•åœ°æ–¹çš„ä»£ç å¼•ç”¨ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="0x01-hello-worldæ¨¡æ¿å’Œè§†å›¾">0x01 Hello worldï¼šæ¨¡æ¿å’Œè§†å›¾&lt;/h2>
&lt;p>æœ€åŸºæœ¬çš„ web åŠŸèƒ½ï¼Œæ— éžæŽ¥å—è¯·æ±‚ã€è¿”å›žæ•°æ®ã€‚å…¶ä¸­ï¼Œè·¯ç”± (route) ç”¨æ¥åŒºåˆ†ä¸åŒçš„è¯·æ±‚ï¼Œæ¨¡æ¿ (templates) ç”¨æ¥ç”Ÿæˆä¸åŒçš„æ•°æ®ã€‚&lt;/p>
&lt;h4 id="è·¯ç”±è§†å›¾">è·¯ç”±/è§†å›¾&lt;/h4>
&lt;p>åœ¨éžå‰åŽç«¯åˆ†ç¦»çš„é¡¹ç›®ä¸­ï¼Œè§†å›¾å‡½æ•°ç›´æŽ¥è¿”å›žæ¸²æŸ“å¥½çš„ç½‘é¡µï¼Œç”±&lt;code>@app.route()&lt;/code>ä¿®é¥°åŽï¼Œè§†å›¾å’Œè·¯ç”±ä¾¿ç»‘å®šåœ¨ä¸€èµ·ã€‚
åœ¨mvcæ¨¡åž‹ä¸­æ›´åƒcontrolleræŽ§åˆ¶å™¨çš„è§’è‰²ï¼Œç„¶è€Œåœ¨flaskç”Ÿæ€ä¸­æ›´å–œæ¬¢ç§°ä¸ºè§†å›¾å‡½æ•°ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>url_for()&lt;/code> ä½¿ç”¨URLåˆ°è§†å›¾å‡½æ•°çš„å†…éƒ¨æ˜ å°„å…³ç³»æ¥ç”ŸæˆURLï¼Œç”¨æ¥æ›¿æ¢ç¡¬é“¾æŽ¥ã€‚åœ¨ä¸šåŠ¡åŠŸèƒ½è§£è€¦åŽå¿…é¡»ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚
&lt;ul>
&lt;li>NOTEï¼šå½“è·¯ç”±å’Œè§†å›¾å‡½æ•°åä¸ä¸€è‡´ï¼Œè®¿é—®è¯¥è·¯ç”±å¯ä»¥æ­£ç¡®å“åº”ï¼Œä½†æ˜¯ä½¿ç”¨&lt;code>url_for()&lt;/code>è°ƒç”¨è¯¥è§†å›¾æ—¶ä¼šæŠ¥é”™&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>{% extends &amp;quot;base.html&amp;quot; %}&lt;/code> and &lt;code>{% include &amp;quot;_post.html&amp;quot; %}&lt;/code> ä½¿ç”¨å­æ¨¡æ¿æ¥å®žçŽ°ç½‘é¡µå…¬ç”¨çš„éƒ¨åˆ†ã€‚å¦‚ï¼šé¡µçœ‰ï¼Œé¡µè„šï¼Œåˆ—è¡¨é¡¹ç­‰ã€‚
&lt;ul>
&lt;li>æ¨¡æ¿å’Œ Python ä»£ç çš„å…³ç³»æœ‰äº›ç±»ä¼¼ä¸Ž JSP å’Œ Java ä»£ç çš„å…³ç³»ï¼Œä½†æ¨¡æ¿è¯­æ³•å¹¶ä¸æ˜¯å®Œæ•´çš„è„šæœ¬è¯­è¨€ï¼Œç›¸è¾ƒè€Œè¨€é™åˆ¶æ›´å¤šï¼Œå®‰å…¨æ€§æ›´å¥½ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="è¡¨å•">è¡¨å•&lt;/h4>
&lt;blockquote>
&lt;p>å‡ ä¹Žæ‰€æœ‰æˆåŠŸçš„æ¡†æž¶éƒ½æœ‰ä¸°å¯Œçš„æ’ä»¶ç”Ÿæ€ã€‚ä¸‹é¢å¼•å…¥æ–°åŠŸèƒ½æ—¶ï¼Œå¤§å¤šå€ŸåŠ©æ’ä»¶æ¥æ–¹ä¾¿çš„å®žçŽ°ã€‚å¤§å¤šæ•°Flaskæ’ä»¶ä½¿ç”¨&lt;code>flask_&amp;lt;name&amp;gt;&lt;/code> å‘½åçº¦å®šã€‚&lt;/p>
&lt;/blockquote>
&lt;p>Flask-WTFæ’ä»¶æä¾›äº†å¯¹Webè¡¨å•çš„æŠ½è±¡ï¼Œåªéœ€å®šä¹‰è¡¨å•ç±»ä»¥åŠè®¾ç½®ç±»å±žæ€§å³å¯ã€‚&lt;/p>
&lt;p>æ¨¡æ¿è¯­æ³•ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>{{ form.&amp;lt;name&amp;gt;.label }}&lt;/code>æ¸²æŸ“æ ‡ç­¾&lt;/li>
&lt;li>&lt;code>{{ form.&amp;lt;name&amp;gt;() }}&lt;/code>èŽ·å–å±žæ€§å€¼&lt;/li>
&lt;li>&lt;code>form.hidden_tag()&lt;/code>æ¨¡æ¿å‚æ•°ç”Ÿæˆäº†ä¸€ä¸ªéšè—å­—æ®µï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªç”¨äºŽä¿æŠ¤è¡¨å•å…å—CSRFæ”»å‡»çš„token&lt;/li>
&lt;/ul>
&lt;p>å°†è¡¨å•å¼•å…¥æ¨¡æ¿&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">form&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">LoginForm&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># ç”Ÿæˆäº†ä¸€ä¸ªå®žä¾‹ä¼ å…¥æ¨¡æ¿&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">return&lt;/span> &lt;span class="n">render_template&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;login.html&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">title&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;Sign In&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">form&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">form&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="flash-é—ªçŽ°æ¶ˆæ¯">flash é—ªçŽ°æ¶ˆæ¯&lt;/h4>
&lt;p>flash é€šè¿‡ session å‚¨å­˜ï¼Œç”¨äºŽæ˜¾ç¤ºåªå‡ºçŽ°ä¸€æ¬¡çš„æç¤ºæ¶ˆæ¯ã€‚ç”¨æ³•ï¼š&lt;/p>
&lt;ul>
&lt;li>åœ¨è·¯ç”±ä¸­ä½¿ç”¨&lt;code>flash()&lt;/code>ï¼Œè§¦å‘æ—¶æ¶ˆæ¯ä¾¿å†™å…¥ session ä¸­çš„ message åˆ—è¡¨&lt;/li>
&lt;li>åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨&lt;code>get_flashed_messages()&lt;/code>ï¼Œä»Ž session ä¸­è¯»å–&lt;/li>
&lt;/ul>
&lt;h2 id="0x02-æ•°æ®åº“-orm">0x02 æ•°æ®åº“ ORM&lt;/h2>
&lt;p>å¾ˆä¹…å¾ˆä¹…ä»¥å‰ï¼Œwebç½‘ç«™å’Œæ•°æ®åº“äº¤äº’è¿˜éœ€è¦å†™å¾ˆå¤šå¾ˆç¡¬çš„ SQL è¯­å¥ï¼Œæ•ˆçŽ‡ä½Žä¸”å®¹æ˜“å‡ºçŽ°æ³¨å…¥æ¼æ´ž(SQLi)ã€‚çŽ°ä»£webå¼€å‘éƒ½ä½¿ç”¨ ORM æ¡†æž¶ç®€åŒ–æ•°æ®åº“äº¤äº’ï¼Œä¸”åŸºæœ¬æœç»äº† SQLi æ¼æ´žã€‚&lt;/p>
&lt;p>æœ¬é¡¹ç›®ä½¿ç”¨å¦‚ä¸‹æ’ä»¶æ‰“é€šæ•°æ®åº“ï¼š&lt;/p>
&lt;ul>
&lt;li>Flask-SQLAlchemy: Pythonç”Ÿæ€æœ€çŸ¥åçš„ORMæ¡†æž¶&lt;/li>
&lt;li>Flask-Migrate: æœ¬æ•™ç¨‹ä½œè€…ç¼–å†™çš„æ•°æ®åº“è¿ç§»æ¡†æž¶&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>æ’ä»¶é¦–å…ˆè¦æ³¨å†Œã€‚ç»Ÿä¸€æµç¨‹: åˆå§‹åŒ–appå®žä¾‹ï¼Œä¼ å…¥æ’ä»¶ç±»ä½œä¸ºæ’ä»¶å®žä¾‹çš„å‚æ•°&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># app/__init__.py&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">app&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Flask&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="vm">__name__&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># flaskåŸºç±»&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">app&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">from_object&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Config&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">db&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">SQLAlchemy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">app&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">migrate&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Migrate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">app&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">db&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/blockquote>
&lt;h3 id="sqlalchemymodelå±‚">SQLalchemyï¼šmodelå±‚&lt;/h3>
&lt;h4 id="æ¨¡åž‹å®šä¹‰">æ¨¡åž‹å®šä¹‰&lt;/h4>
&lt;p>ä½¿ç”¨ç±»å’Œç±»å±žæ€§ä»£è¡¨ table å’Œ colunm ï¼Œä¾¿å¯è½»æ¾ç¼–å†™æ•°æ®æ¨¡åž‹ã€‚SQLalchemy çš„æ¦‚å¿µæŠ½è±¡å¦‚ä¸‹å›¾ï¼š
&lt;img src="https://lonelyuan.github.io/p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99-the-flask-mega-tutorial/1631793936306.png"
width="760"
height="229"
srcset="https://lonelyuan.github.io/p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99-the-flask-mega-tutorial/1631793936306_hu7f25cecc8aefde770917be517cb2f54b_27444_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/%E5%B9%B4%E8%BD%BB%E4%BA%BA%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%BD%91%E7%AB%99-the-flask-mega-tutorial/1631793936306_hu7f25cecc8aefde770917be517cb2f54b_27444_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="331"
data-flex-basis="796px"
>&lt;/p>
&lt;p>Flask-SQLAlchemy è‡ªåŠ¨è®¾ç½®ç±»åä¸ºå°å†™æ¥ä½œä¸ºå¯¹åº”è¡¨çš„åç§°ï¼Œä¹Ÿå¯ä»¥ç”¨&lt;code>__tablename__&lt;/code>ç±»å±žæ€§æ¥å®šä¹‰ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Post&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Model&lt;/span>&lt;span class="p">):&lt;/span> &lt;span class="c1"># è¡¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">id&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Column&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Integer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">primary_key&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">True&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># åˆ—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">....&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="curdåŸºæœ¬æ“ä½œ">CURDåŸºæœ¬æ“ä½œ&lt;/h4>
&lt;p>ORM æ¡†æž¶é€šå¸¸é›†æˆäº†å¸¸ç”¨æ“ä½œï¼Œä½†ä¹Ÿæ”¯æŒæ›´åº•å±‚çš„æ•°æ®åº“æŽ¥å£ã€‚&lt;/p>
&lt;blockquote>
&lt;p>åœ¨ Springboot Jpa ä¸­ï¼Œæ ¹æ®æ–¹æ³•åçš„æ‹¼å†™æ¥å†™è‡ªå®šä¹‰æŸ¥è¯¢ï¼Œè€Œåœ¨ SQLalchemy ä¸­ï¼Œæä¾›çš„æŽ¥å£é€šè¿‡é“¾å¼è°ƒç”¨æ‹¼æŽ¥ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨ SQLalchemy ä¸­ï¼ŒåŸºæœ¬æ“ä½œå¤§éƒ½æœ‰åŸºäºŽäº‹åŠ¡ (session) çš„å’ŒåŸºäºŽæŸ¥è¯¢ (query) çš„ä¸¤ç§æ–¹å¼ã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>æŸ¥&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">session&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">query&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">User&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>queryæ–¹æ³•åªæœ‰æž„é€ ä¸€ä¸ªæŸ¥è¯¢ï¼Œåªæœ‰åœ¨&lt;code>Query.get()&lt;/code>ã€&lt;code>Query.all()&lt;/code>ã€&lt;code>Query.one()&lt;/code>ç­‰ç»“æŸç¬¦ä¹‹åŽæ‰ä¼šæ‰§è¡ŒæŸ¥è¯¢&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¢žï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">session&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">session&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">commit&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>åˆ &lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">session&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">query&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">User&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">delete&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">session&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">delete&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">session&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">query&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">User&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">session&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">commit&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>æ”¹&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">query&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">session&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">.&lt;/span>&lt;span class="n">query&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">User&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">.&lt;/span>&lt;span class="n">filter_by&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">.&lt;/span>&lt;span class="n">update&lt;/span>&lt;span class="p">({&lt;/span>&lt;span class="s2">&amp;#34;username&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">User&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">username&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s2">&amp;#34;a&amp;#34;&lt;/span>&lt;span class="p">},&lt;/span> &lt;span class="n">synchronize_session&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="kc">False&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">user&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">session&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">query&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">User&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">user&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">password&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;zxcv&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">session&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">commit&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="flask-migrate-æ•°æ®åº“è¿ç§»">Flask-Migrate: æ•°æ®åº“è¿ç§»&lt;/h3>
&lt;p>é…ç½®æ•°æ®åº“çš„åˆå§‹æ•°æ®æ¡†æž¶ï¼Œä¸€èˆ¬å†™æˆSQLè„šæœ¬å½¢å¼ã€‚
migrate æ¡†æž¶ç›´æŽ¥æ ¹æ® model å±‚ç”Ÿæˆè¿ç§»è„šæœ¬ï¼Œå¯ä»¥æ–¹ä¾¿çš„è·Ÿè¸ªæ•°æ®æ¨¡åž‹çš„ä¿®æ”¹å’Œæ•°æ®åº“çš„åˆ‡æ¢ã€‚ï¼ˆè¿™ä¸ªæ¡†æž¶è¿˜æ˜¯æœ¬æ•™ç¨‹ä½œè€…è‡ªå·±å¼€å‘çš„ï¼Œå¼ºï¼‰&lt;/p>
&lt;p>flask dbå­å‘½ä»¤&lt;/p>
&lt;ul>
&lt;li>&lt;code>flask db init&lt;/code>ï¼šåˆå§‹åŒ–ï¼Œç”Ÿæˆmigrationsç›®å½•&lt;/li>
&lt;li>&lt;code>flask db migrate&lt;/code>ï¼šç”Ÿæˆè¿ç§»è„šæœ¬ï¼Œä¿®æ”¹modelåŽä½¿å…¶ç”Ÿæ•ˆ
&lt;ul>
&lt;li>&lt;code>flask db migrate -m &amp;quot;posts table&amp;quot; &lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>flask db upgrade&lt;/code>ï¼šåº”ç”¨æ•°æ®åº“ä¿®æ”¹ï¼ˆå¼€å‘é˜¶æ®µé»˜è®¤ä½¿ç”¨sqliteæ•°æ®åº“&lt;/li>
&lt;li>&lt;code>flask db downgrade&lt;/code>ï¼šå›žæ»šä¸Šæ¬¡çš„è¿ç§»&lt;/li>
&lt;/ul>
&lt;h2 id="0x03-å¼€å‘èŒƒå¼ç”¨æˆ·ç³»ç»Ÿ">0x03 å¼€å‘èŒƒå¼ï¼šç”¨æˆ·ç³»ç»Ÿ&lt;/h2>
&lt;blockquote>
&lt;p>mixinï¼šæ··å…¥ï¼Œå¤šé‡ç»§æ‰¿çš„ä¸€ç§å½¢å¼&lt;/p>
&lt;/blockquote>
&lt;p>è¡¨å•å’Œæ•°æ®åº“æ”¯æŒåˆ†åˆ«è§£å†³äº†å‰ç«¯å’ŒåŽç«¯çš„åŸºæœ¬éœ€æ±‚ï¼Œä¸‹é¢å¯ä»¥ä¸Šçº¿ä¸€ä¸ªåŸºæœ¬åŠŸèƒ½äº†ï¼Œç”¨æˆ·ç™»å½•ã€‚
æ‰€éœ€æ’ä»¶ï¼šFlask-Loginã€‚&lt;/p>
&lt;h4 id="usermixinç±»">UserMixinç±»&lt;/h4>
&lt;p>UserMixinç±»é›†æˆäº†loginæ’ä»¶è¦æ±‚çš„ç”¨æˆ·æ¨¡åž‹å±žæ€§ï¼Œå°†å…¶æ··å…¥åˆ° User æ¨¡åž‹ä¸­ï¼Œå³å¯ç”¨&lt;code>@login_required &lt;/code>å®žçŽ°æƒé™æŽ§åˆ¶ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">@app.route(&amp;#39;/result/&amp;#39;, methods=[&amp;#39;POST&amp;#39;]) # NOTEï¼šæœ‰é¡ºåºå…³ç³»ï¼Œåä¹‹åˆ™ä¸ç”Ÿæ•ˆ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">@login_required
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç”¨æˆ·ç³»ç»Ÿï¼ŒåŒ…æ‹¬ç™»å½•ã€ç™»å‡ºã€æ³¨å†Œå‡ ä¸ªåŠŸèƒ½ã€‚ç¼–å†™è¿™äº›åŠŸèƒ½çš„æ­¥éª¤å…¶å®žå¾ˆç±»ä¼¼ï¼š&lt;/p>
&lt;ul>
&lt;li>è®¾è®¡æ•°æ®åº“ï¼Œåœ¨model.pyä¸­&lt;/li>
&lt;li>è®¾è®¡è¡¨å•å¯¹è±¡ï¼Œåœ¨form.pyä¸­&lt;/li>
&lt;li>è®¾è®¡é¡µé¢ï¼Œåœ¨æ¨¡æ¿.htmlä¸­&lt;/li>
&lt;li>è®¾è®¡è§†å›¾å‡½æ•°ï¼Œåœ¨routes.pyä¸­&lt;/li>
&lt;/ul>
&lt;p>ä¹Ÿå¯¹åº”äº†mvcæ¡†æž¶çš„è®¾è®¡ç†å¿µï¼Œæ¯”å¦‚è®¾è®¡è¡¨å•å°±æœ‰äº›åƒ javaweb ä¸­çš„ DAO å±‚ã€‚ä½†ä¹Ÿæœ‰åŒºåˆ«ï¼Œ Flask æ¡†æž¶æ›´å¸Œæœ›ä¸šåŠ¡é€»è¾‘å†™åœ¨æ•°æ®åº“æ¨¡åž‹ä¸­ï¼Œè€Œè§†å›¾å‡½æ•°å°½é‡ä¿æŒç®€æ´ï¼Œä»¥æ–¹ä¾¿å•å…ƒæµ‹è¯•ã€‚&lt;/p>
&lt;h4 id="prg-æ¨¡å¼">PRG æ¨¡å¼&lt;/h4>
&lt;p>å³ä¸º &lt;code>Post/Redirect/Get&lt;/code>ï¼Œå…¶æ ¼å¼å¤§æ¦‚å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="nd">@bp.route&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;/some_form&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">methods&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;GET&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;POST&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">some_form&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># prepare forms &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">form&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">validate_on_submit&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># submit modification&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">redirect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">url_for&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;main.some_form&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">elif&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">method&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;GET&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># GET data&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">render_template&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;some_form.html&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">form&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">form&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>é»˜è®¤æƒ…å†µï¼Œæäº¤ POST è¯·æ±‚åŽï¼Œå¦‚æžœç›´æŽ¥åˆ·æ–°æµè§ˆå™¨ï¼Œä¼šé‡æ–°åœ¨ POST ä¸€æ¬¡ã€‚ä½¿ç”¨PRGæ¨¡å¼å³å¯è§£å†³é‡å¤æäº¤è¡¨å•çš„é—®é¢˜ã€‚&lt;/p>
&lt;h2 id="0x04-æ·±å…¥æ•°æ®åº“ç²‰ä¸æœºåˆ¶">0x04 æ·±å…¥æ•°æ®åº“ï¼šç²‰ä¸æœºåˆ¶&lt;/h2>
&lt;h3 id="æ•°æ®åº“å…³ç³»">æ•°æ®åº“å…³ç³»&lt;/h3>
&lt;p>è¦å…³æ³¨åˆ«äººï¼Œå°±è¦è®©æ•°æ®åº“è®°ä½æˆ‘å…³æ³¨çš„äººçš„åå­—ï¼Œå½“ç„¶ï¼Œåªè®°ä½åå­—è‚¯å®šä¸å¤Ÿï¼Œä¸‡ä¸€æ”¹åäº†å‘¢ã€‚å› æ­¤æ¯ä¸ªç”¨æˆ·éƒ½éœ€è¦æœ‰å”¯ä¸€æœ‰æ•ˆçš„æ ‡è¯†ï¼ˆå…¶å®žæ›´é‡è¦çš„æ˜¯æ€§èƒ½å› ç´ ï¼‰ã€‚æ­£å› å¦‚æ­¤ï¼Œæ•°æ®åº“ä¸­æ¯ä¸ªè¡¨éƒ½è¦æœ‰ä¸€ä¸ªå”¯ä¸€çš„åˆ—ï¼Œç§°ä¸º&lt;strong>ä¸»é”®&lt;/strong>(primary key)ã€‚å½“ä¸åŒè¡¨ä¹‹é—´å­˜åœ¨å…³ç³»ï¼Œä¸€ä¸ªè¡¨è¦é€šè¿‡ä¸»é”®å¯»æ‰¾å…¶ä»–è¡¨é¡¹ï¼Œå…¶ä»–è¡¨çš„ä¸»é”®å‚¨å­˜åœ¨æœ¬è¡¨ä¸­ï¼Œç§°ä¸º&lt;strong>å¤–é”®&lt;/strong>(foreign key)ã€‚å¤–é”®å…³è”æ—¢å¯ä»¥è¡¨ç¤ºä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œä¹Ÿå¯ä»¥ä¸€å¯¹å¤š(1-&amp;gt;n)ã€‚&lt;/p>
&lt;p>SQLalchemy å¯¹å…³ç³»çš„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>å¤–é”®ï¼š&lt;code>db.ForeignKey('user.id')&lt;/code>&lt;/li>
&lt;li>å…³ç³»ï¼š&lt;code>db.relationship('Post', backref='author', lazy='dynamic')&lt;/code>
&lt;ul>
&lt;li>å‚æ•°1ï¼šæ‰€å…³è”çš„è¡¨(n in 1-&amp;gt;n)ï¼Œè¿™é‡Œæ˜¯æ¨¡åž‹çš„å˜é‡å&lt;/li>
&lt;li>å‚æ•°2ï¼šç”± &amp;ldquo;n&amp;rdquo; å›žè°ƒ &amp;ldquo;1&amp;rdquo; çš„è™šæ‹Ÿå­—æ®µï¼Œç”¨æ³•ï¼š&lt;code>post.author&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="ç²‰ä¸æœºåˆ¶">ç²‰ä¸æœºåˆ¶&lt;/h3>
&lt;p>ç„¶è€Œï¼Œç²‰ä¸æœºåˆ¶åŒ…æ‹¬å…³æ³¨å’Œè¢«å…³æ³¨ã€‚è¿™æ˜¯ä¸€ç§å¤šå¯¹å¤šçš„å…³ç³»ï¼ŒäºŽæ˜¯éœ€è¦ç”¨å«æœ‰ä¸¤ä¸ªå¤–é”®çš„&lt;strong>å…³è”è¡¨&lt;/strong>è¡¨ç¤ºã€‚åˆå› ä¸ºå…³æ³¨è€…å’Œè¢«å…³æ³¨è€…åœ¨ä¸€ä¸ªè¡¨é‡Œï¼ˆUserï¼‰ï¼Œè¿™ç§å…³ç³»åˆç§°ä¸º&lt;strong>è‡ªå¼•ç”¨&lt;/strong>ã€‚&lt;/p>
&lt;h4 id="æ¨¡åž‹">æ¨¡åž‹&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>å…³è”è¡¨åªæœ‰å¼•ç”¨ç±»åž‹ï¼Œæ•…ä¸éœ€è¦æ´¾ç”Ÿæ¨¡åž‹ç±»&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">followers&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Table&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;followers&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Column&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;follower_id&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Integer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ForeignKey&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;user.id&amp;#39;&lt;/span>&lt;span class="p">)),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Column&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;followed_id&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Integer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ForeignKey&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;user.id&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>ä¸ºUseræ·»åŠ å…³ç³»&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">followed&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">relationship&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;User&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1"># å³ä¾§å®žä½“&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">secondary&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">followers&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="c1"># æŒ‡å®šå…³è”è¡¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">primaryjoin&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">followers&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">follower_id&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nb">id&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="c1"># æŒ‡å®šå·¦å…³ç³»&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">secondaryjoin&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">followers&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">followed_id&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nb">id&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="c1"># æŒ‡å®šå³å…³ç³»&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">backref&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">backref&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;followers&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">lazy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;dynamic&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">lazy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;dynamic&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># æŒ‡å®šå›žè°ƒ&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;h4 id="å¤æ‚æŸ¥è¯¢">å¤æ‚æŸ¥è¯¢&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>æŸ¥è¯¢ç²‰ä¸åˆ—è¡¨&lt;/p>
&lt;ul>
&lt;li>
&lt;p>SQL è¯­å¥ï¼š&lt;code>SELECT * FROM user, followers WHERE followers.follower_id = 3 AND followers.followed_id = user.id&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>SQLalchemy æŽ¥å£ï¼š&lt;code>user.followers.all()&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å®žé™…æ‰§è¡Œçš„ SQL è¯­å¥ï¼šï¼ˆæ‰“å° query å¯¹è±¡å¾—åˆ°ï¼‰&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">SELECT ,,, FROM user, followers
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WHERE followers.followed_id = ? AND followers.follower_id = user.id
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>NOTEï¼šå¦‚æžœæ–¹æ³•é›†æˆåœ¨modelé‡Œï¼Œæ–¹æ³•åä¸è¦å’Œå­—æ®µåç›¸åŒï¼Œè‡ªå·±å®šä¹‰çš„æ–¹æ³•ä¼šè¦†ç›–è¯¥å­—æ®µã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>æŸ¥çœ‹å·²å…³æ³¨ç”¨æˆ·çš„åŠ¨æ€&lt;/p>
&lt;ul>
&lt;li>
&lt;p>SQL è¯­å¥ï¼š&lt;code>SELECT * FROM post JOIN followers on followers.followed_id = post.user_id where followers.follower_id = 2&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>SQLalchemy æŽ¥å£ï¼š&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="n">Post&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">query&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">followers&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">followers&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">followed_id&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Post&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">user_id&lt;/span>&lt;span class="p">)).&lt;/span>&lt;span class="n">filter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">followers&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">follower_id&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">order_by&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Post&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">timestamp&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">desc&lt;/span>&lt;span class="p">())&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>
&lt;p>å®žé™…æ‰§è¡Œçš„SQLè¯­å¥ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">SELECT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">,,,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">SELECT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">,,,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">post&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">JOIN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">followers&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">ON&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">followers&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">followed_id&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">post&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">user_id&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">WHERE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">followers&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">follower_id&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">UNION&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">SELECT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">post&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">WHERE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">post&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">user_id&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">AS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">anon_1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">ORDER&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">BY&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">anon_1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">post_timestamp&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">DESC&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>ç”±äºŽpythonçš„å¼±ç±»åž‹ç‰¹å¾ï¼Œæœ‰æ—¶å€™å¾ˆéš¾æ˜Žç™½å‡½æ•°ä¹‹é—´ä¼ é€’çš„æ˜¯ä»€ä¹ˆå¯¹è±¡ã€‚æˆ‘ä»¬ä»Žä¸Šå¾€ä¸‹æ¢³ç†ä¸€éï¼š&lt;/p>
&lt;ul>
&lt;li>è¯·æ±‚åˆ°è¾¾è·¯ç”±å‡½æ•°ï¼Œå¼€å§‹æ‰§è¡ŒæŸ¥è¯¢&lt;code>Post.query.....&lt;/code>ï¼Œæ­¤æ—¶åªæ˜¯åœ¨æž„é€ æŸ¥è¯¢ï¼Œå¹¶æœªå–å¾—æ•°æ®ï¼Œæ­¤æ—¶çš„å¯¹è±¡ç±»åž‹ï¼š&lt;code>&amp;lt;class 'sqlalchemy.orm.query.Query'&amp;gt;&lt;/code>&lt;/li>
&lt;li>ç›´åˆ°&lt;code>get()&lt;/code>,&lt;code>all()&lt;/code>,&lt;code>paginate().items&lt;/code>ç»“æŸç¬¦ç­‰å‡ºçŽ°ï¼ŒæŸ¥è¯¢æ‰è¢«æ‰§è¡Œï¼Œè¿”å›žæ•°æ®ç±»åž‹å®žä¾‹ï¼Œå¦‚Userã€‚&lt;/li>
&lt;li>æ•°æ®ç±»å®žä¾‹ä¼ å…¥æ¨¡æ¿ï¼Œå¹¶ç”±&lt;code>__str__&lt;/code>ç­‰æ–¹æ³•å‚ä¸Žæ¸²æŸ“ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="0x05-ç½‘ç«™ç¾ŽåŒ–">0x05 ç½‘ç«™ç¾ŽåŒ–&lt;/h2>
&lt;p>æœ¬æ•™ç¨‹æä¾›çš„flask-bootstrapæ’ä»¶ï¼Œè¾ƒä¸ºç®€é™‹ï¼Œä¸”è¯¥æ’ä»¶å¹´ä¹…å¤±ä¿®ï¼Œé‚æ›¿æ¢ä¹‹ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œå…ˆæžæ˜Žç™½ç›®å‰é¡¹ç›®å‰ç«¯çš„æž¶æž„&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">/templates
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> auth/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> errors/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> base.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> _posts.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> index.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ‰€æœ‰æ¨¡æ¿éƒ½æœ‰ä¸€ä¸ªçˆ¶æ¨¡ç‰ˆï¼š&lt;code>base.html&lt;/code>ï¼Œå…¶ç»“æž„å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">{% extends &amp;#39;bootstrap/base.html&amp;#39; %}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{% block title %}Hallo Wolrd{% endblock %}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{% block head %} ... {% endblock %}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{% block scripts %} ... {% endblock %}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{% block navbar %} ... {% endblock %}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{% block content %}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> {% block app_content %}{% endblock %}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">{% endblock %}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>app_content&lt;/code>ç•™ç©ºï¼Œå³å…¶ä½™æ¨¡æ¿å‡åœ¨&lt;code>app_content&lt;/code>å†…å¡«å……ã€‚&lt;/p>
&lt;p>è¿›ä¸€æ­¥è¿½æº¯&lt;code>bootstrap/base.html&lt;/code>çš„æºç ï¼Œå‘çŽ°å…¶å®ƒ block è¯¸å¦‚&lt;code>navbar&lt;/code>ä¹Ÿéƒ½ç•™ç©ºæˆ–ä»…ä»…é…ç½®äº† Bootstrap çš„ cdnã€‚ ç”±æ­¤ï¼Œåªéœ€å°†&lt;code>base.html&lt;/code>è¿ç§»å³å¯ã€‚&lt;/p>
&lt;p>åœ¨ç½‘ä¸Šå¯»æ‰¾æ–°çš„UIæ¨¡æ¿ï¼Œä¸è¦åœ¨ä¸­æ–‡äº’è”ç½‘æœç´¢ï¼Œbasically garbageã€‚æ‰¾åˆ°ä¸€ä¸ª &lt;a class="link" href="https://demos.creative-tim.com/material-kit/index.html" target="_blank" rel="noopener"
>Meterial æ¨¡æ¿&lt;/a> è¿˜ç®—é¡ºçœ¼ï¼Œé‚ç”¨ä¹‹ã€‚&lt;/p>
&lt;p>ä¸ç†Ÿæ‚‰ Bootstrap å¸ƒå±€çš„å¯ä»¥ä½¿ç”¨å¯è§†åŒ–å·¥å…·æ¥è®¾è®¡å‰ç«¯ï¼Œå¦‚ï¼šhttp://www.ibootstrap.cn/&lt;/p>
&lt;p>å¯¹ç…§æ¨¡æ¿ï¼Œå°†&lt;code>base.html&lt;/code>æŽç©ºï¼Œæ•ˆæžœå¦‚ä¸‹ï¼š&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/post-images/1631795716824.png"
loading="lazy"
>&lt;/p>
&lt;p>é‡åˆ°çš„bugæœ‰ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸‹æ‹‰èœå•å¤±æ•ˆï¼šæŸ¥è¯¢å¾—çŸ¥æœ‰å¯èƒ½æ˜¯bootstrapç‰ˆæœ¬å†²çª
&lt;ul>
&lt;li>//ç»“æžœå¹¶ä¸æ˜¯ï¼Œåªæ˜¯å¿˜è®°å¼•å…¥jsæ–‡ä»¶è€Œå·²ï¼Œæˆ‘æ˜¯å‚»é€¼ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ–‡ä»¶ä¸Šä¼ æŒ‰é’®æ¶ˆå¤±ï¼šæœ¬æ•™ç¨‹ä¸­ï¼Œè¡¨å•æ¸²æŸ“é‡‡ç”¨&lt;code>wtf.quick_form()&lt;/code>ï¼Œè¿™çŽ©æ„è¿˜æ˜¯æ¥è‡ª&lt;code>bootstrap/wtf.html&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>æœ€åŽå†³å®šæ•´ä¸ªðŸäº† Flask-Bootstrap æ’ä»¶ã€‚&lt;/p>
&lt;h4 id="å¯Œæ–‡æœ¬ç¼–è¾‘å™¨">å¯Œæ–‡æœ¬ç¼–è¾‘å™¨&lt;/h4>
&lt;p>åœ¨ã€ŠFlask Webå¼€å‘ï¼šåŸºäºŽPythonçš„Webåº”ç”¨å¼€å‘å®žæˆ˜ã€‹ä¸­æåˆ°äº†markdownç¼–è¾‘å™¨çš„å®žçŽ°ã€‚&lt;/p>
&lt;p>éœ€è¦çš„åŒ…ï¼š&lt;/p>
&lt;ul>
&lt;li>PageDown: JS ç‰ˆ Markdown æ¸²æŸ“å™¨ï¼Œç”¨äºŽå®¢æˆ·ç«¯é¢„è§ˆã€‚&lt;/li>
&lt;li>Flask-PageDown: flask é›†æˆæ’ä»¶ã€‚è¯¥æ’ä»¶éœ€è¦æ³¨å†Œ&lt;/li>
&lt;li>Markdown: Python ç‰ˆ Markdown æ¸²æŸ“å™¨ï¼Œç”¨äºŽæœåŠ¡ç«¯æ¸²æŸ“ã€‚&lt;/li>
&lt;li>Bleach: HTML æ¸…ç†å™¨ï¼Œä¿è¯å®‰å…¨æ€§&lt;/li>
&lt;/ul>
&lt;p>ä¸ºäº†å…¼é¡¾å®‰å…¨å’Œæ•ˆçŽ‡ï¼Œåšæ³•æ˜¯åŒæ—¶ä¿å­˜ markdown æºæ–‡æœ¬å’Œ HTML æ–‡ä»¶ã€‚æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>è¡¨å•æ”¹ä¸º &lt;code>PageDownField&lt;/code>&lt;/li>
&lt;li>æ¨¡æ¿å¼•å…¥ PageDown å®ï¼Œä»¥å®žçŽ°å³æ—¶é¢„è§ˆ&lt;/li>
&lt;li>ä¸º Post æ¨¡åž‹å¢žåŠ å­—æ®µï¼Œå¹¶æ·»åŠ  markdown æ¸²æŸ“æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸ºç±»æ–¹æ³•ï¼Œéœ€è¦&lt;code>@staticmethod&lt;/code>ä¿®é¥°&lt;/li>
&lt;li>åœ¨æ¨¡åž‹å¤–éƒ¨ç›‘å¬æ•°æ®åº“äº‹ä»¶ï¼Œä»…å½“ markdown æ–‡æœ¬å‡ºçŽ°å˜åŠ¨æ—¶è°ƒç”¨æ¸²æŸ“æ–¹æ³•ã€‚&lt;/li>
&lt;li>ä¿®æ”¹æ¨¡æ¿ä»¥æ˜¾ç¤ºæœåŠ¡ç«¯è¿”å›žçš„ html æ–‡æœ¬&lt;/li>
&lt;/ul>
&lt;p>ç„¶è€Œé¢„è§ˆå™¨è¿‡äºŽç®€é™‹ï¼Œä¹Ÿå¾ˆéš¾ä¿®æ”¹ã€‚åœ¨githubä»“åº“ä¸Šå‘çŽ°è¯¥æ’ä»¶ä¹Ÿæ˜¯æœ¬æ•™ç¨‹ä½œè€…å†™çš„ï¼Œå·²ç»å¾ˆä¹…æ²¡æœ‰ç»´æŠ¤ã€‚é¡¿æ—¶å¯¹æœ¬ä¹¦ä½œè€…æœ‰äº›ä¸æ»¡ã€‚&lt;/p>
&lt;h2 id="0x06-æ¨¡å—åŒ–åº”ç”¨åŠŸèƒ½è§£è€¦">0x06 æ¨¡å—åŒ–åº”ç”¨ï¼šåŠŸèƒ½è§£è€¦&lt;/h2>
&lt;p>ä¿æŒ app ä½œä¸ºå…¨å±€å˜é‡çš„æ¨¡å¼ï¼Œå¯èƒ½ä¼šç»™åŽç»­å¼•å…¥æ–°åŠŸèƒ½å’Œå•å…ƒæµ‹è¯•å¸¦æ¥éº»çƒ¦ã€‚
è¦é€‚åº”å¤§åž‹é¡¹ç›®éœ€æ±‚ï¼Œéœ€è¦æŠŠç½‘ç«™åŠŸèƒ½æ‹†åˆ†æˆç‹¬ç«‹çš„æ¨¡å—ã€‚&lt;/p>
&lt;h3 id="blueprintåŒ–">BlueprintåŒ–&lt;/h3>
&lt;p>è¦å®žçŽ°è§£è€¦ï¼Œä¸€ç§åŠŸèƒ½çš„ç›¸å…³ä»£ç å¯ä»¥å€ŸåŠ©Blueprintå½’ç±»åˆ°ä¸€ä¸ªåŒ…é‡Œã€‚å…¶æ–‡ä»¶ç»“æž„å¤§è‡´å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">app/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> some_fuction/ &amp;lt;-- blueprint package
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> __init__.py &amp;lt;-- blueprint creation
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ... other code ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> templates/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> some_fuction/ &amp;lt;-- templates
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> __init__.py &amp;lt;-- blueprint registration
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åˆ›å»ºblueprintä¸Žåˆ›å»ºåº”ç”¨éžå¸¸ç›¸ä¼¼ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">flask&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Blueprint&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">bp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Blueprint&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;func&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="vm">__name__&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">app.func&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Func&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è€Œæ¶ˆç­äº†&lt;code>app&lt;/code>ï¼Œè“å›¾å†…éƒ¨çš„å¼•ç”¨ç»Ÿä¸€å˜æˆäº†è“å›¾åã€‚è€Œå¤–éƒ¨è¯¸å¦‚&lt;code>url_for&lt;/code>çš„å‚æ•°åˆ™éœ€è¦åŠ ä¸Š&lt;code>åŒ…å.&lt;/code>åšå‰ç¼€ã€‚&lt;/p>
&lt;h3 id="åº”ç”¨å·¥åŽ‚æ¨¡å¼">åº”ç”¨å·¥åŽ‚æ¨¡å¼&lt;/h3>
&lt;p>å·¥åŽ‚å‡½æ•°æ˜¯ä¸€ä¸ªå¤–éƒ¨å‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨æ‰§è¡Œæ’ä»¶æ³¨å†Œå’Œé…ç½®å·¥ä½œï¼Œå¹¶é€šè¿‡ä»–è¿”å›žåº”ç”¨å®žä¾‹ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># app/__init__.py&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">db&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">SQLAlchemy&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">create_app&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">config_class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">Config&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">app&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Flask&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="vm">__name__&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">app&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">config&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">from_object&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">config_class&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">db&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">init_app&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">app&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿”å›žåŽï¼Œflaskæä¾›çš„ä¸Šä¸‹æ–‡å¯¹è±¡&lt;code>current_app&lt;/code>å°†æŒ‡å‘åº”ç”¨å®žä¾‹ã€‚è¯¦è§å®˜æ–¹æ–‡æ¡£ï¼š&lt;a class="link" href="http://docs.jinkan.org/docs/flask/appcontext.html" target="_blank" rel="noopener"
>åº”ç”¨ä¸Šä¸‹æ–‡&lt;/a>&lt;/p>
&lt;h4 id="å¤šçº¿ç¨‹">å¤šçº¿ç¨‹&lt;/h4>
&lt;p>&lt;code>current_app&lt;/code>æ˜¯çº¿ç¨‹ç»‘å®šçš„ï¼Œè‹¥è¦åœ¨è¯¸å¦‚é‚®ä»¶æœåŠ¡çš„ä½äºŽå…¶ä»–çº¿ç¨‹çš„åŠŸèƒ½è°ƒç”¨ä»–ï¼Œåˆ™ä¼šå‘çŽ°æ²¡æœ‰èµ‹å€¼ã€‚
éœ€è¦ä½¿ç”¨&lt;code>current_app._get_current_object()&lt;/code>è¡¨è¾¾å¼ã€‚&lt;/p>
&lt;h4 id="pythonæ¦‚å¿µè¾¨æžåŒ…åº“æ’ä»¶">Pythonæ¦‚å¿µè¾¨æžï¼šåŒ…ï¼Œåº“ï¼Œæ’ä»¶&lt;/h4>
&lt;blockquote>
&lt;p>åŒ… (package) æ˜¯æŒ‡ä¸€ç§ä»£ç ç»“æž„ï¼Œåªè¦æœ‰æ–‡ä»¶å¤¹å’Œ &lt;code>__init__.py&lt;/code> éƒ½æ˜¯åŒ…ã€‚
åº“ (library) å’Œæ’ä»¶ (plugin) éƒ½æ˜¯ä»Žå¤–éƒ¨å¼•å…¥çš„åŒ…ï¼ŒåŒºåˆ«åœ¨äºŽï¼Œæ’ä»¶è¦é›†æˆè¿›åº”ç”¨ï¼Œæ‰€ä»¥éœ€è¦æ³¨å†Œç­‰æ­¥éª¤ï¼›è€Œåº“æ›´ç‹¬ç«‹ï¼Œå¯ä»¥éšæ—¶éšåœ°è°ƒç”¨&lt;/p>
&lt;/blockquote>
&lt;h2 id="0x07-å¼€å‘å¸®æ‰‹">0x07 å¼€å‘å¸®æ‰‹&lt;/h2>
&lt;p>æœ¬èŠ‚è®²è§£ä¸€äº›æ‚é¡¹ã€‚&lt;/p>
&lt;h4 id="è°ƒè¯•">è°ƒè¯•&lt;/h4>
&lt;ul>
&lt;li>&lt;code>flask shell&lt;/code>å‘½ä»¤ï¼šä¸ºé¿å…æ¯æ¬¡è°ƒè¯•éƒ½è¦é‡æ–°import appï¼Œä½¿ç”¨ä¸Šä¸‹æ–‡è°ƒç”¨è§£é‡Šå™¨ï¼Œç”¨&lt;code>@app.shell_context_processor&lt;/code>è£…é¥°ä¸Šä¸‹æ–‡å‡½æ•°&lt;/li>
&lt;/ul>
&lt;h4 id="å•å…ƒæµ‹è¯•">å•å…ƒæµ‹è¯•&lt;/h4>
&lt;p>unittest åº“ï¼Œè¯¦è§&lt;a class="link" href="" >ä¸‹ä¸€ç¯‡&lt;/a>ã€‚&lt;/p>
&lt;h4 id="è®°å½•æ—¥å¿—åˆ°æ–‡ä»¶">è®°å½•æ—¥å¿—åˆ°æ–‡ä»¶&lt;/h4>
&lt;p>logger åº“&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">app&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">debug&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">exists&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;logs&amp;#39;&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">os&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">mkdir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;logs&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file_handler&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">RotatingFileHandler&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;logs/microblog.log&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">maxBytes&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">10240&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">backupCount&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file_handler&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setFormatter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">logging&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Formatter&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="si">%(asctime)s&lt;/span>&lt;span class="s1"> &lt;/span>&lt;span class="si">%(levelname)s&lt;/span>&lt;span class="s1">: &lt;/span>&lt;span class="si">%(message)s&lt;/span>&lt;span class="s1"> [in &lt;/span>&lt;span class="si">%(pathname)s&lt;/span>&lt;span class="s1">:&lt;/span>&lt;span class="si">%(lineno)d&lt;/span>&lt;span class="s1">]&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">file_handler&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setLevel&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">logging&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">app&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">logger&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addHandler&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">file_handler&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">app&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">logger&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">setLevel&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">logging&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">INFO&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">app&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">logger&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Microblog startup&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="requirementtxt">requirement.txt&lt;/h4>
&lt;p>è£…çš„åº“å¤ªå¤šæ€Žä¹ˆåŠžï¼Ÿåªéœ€è¦ä¸¤æ¡å‘½ä»¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">pip freeze &amp;gt; requirements.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pip install -r requirements.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="0x08-ç½‘ç«™ä¸Šçº¿">0x08 ç½‘ç«™ä¸Šçº¿&lt;/h2>
&lt;p>æœ€åŽç®€å•åˆ—å‡ºå‡ ç§ç½‘ç«™éƒ¨ç½²çš„æ–¹æ³•ï¼Œè¯¦æƒ…å‚è€ƒæœ¬æ•™ç¨‹æˆ–è‡ªè¡Œæœç´¢ã€‚&lt;/p>
&lt;h4 id="nativeæ¨¡å¼">nativeæ¨¡å¼&lt;/h4>
&lt;ul>
&lt;li>ä¹°ä¸»æœº
&lt;ul>
&lt;li>è¿žä¸»æœºï¼šssh&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä¹°åŸŸå
&lt;ul>
&lt;li>é…åŸŸå&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>é…çŽ¯å¢ƒ
&lt;ul>
&lt;li>æ•°æ®åº“&lt;/li>
&lt;li>æœåŠ¡å™¨&lt;/li>
&lt;li>å…¶ä»–ä¾èµ–&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æŒç»­è¿ç»´&lt;/li>
&lt;/ul>
&lt;h4 id="å®¹å™¨åŒ–æŠ€æœ¯docker">å®¹å™¨åŒ–æŠ€æœ¯ï¼šdocker&lt;/h4>
&lt;ul>
&lt;li>å†™dockerfile&lt;/li>
&lt;li>docker-compose up &amp;ndash;build -d&lt;/li>
&lt;/ul>
&lt;h4 id="äº‘æŠ€æœ¯paas">äº‘æŠ€æœ¯ï¼šPaaS&lt;/h4>
&lt;ul>
&lt;li>æ³¨å†Œäº‘å¹³å°è´¦æˆ·&lt;/li>
&lt;li>å†™Procfile&lt;/li>
&lt;li>git push&lt;/li>
&lt;/ul></description></item><item><title>CISCN2021åŽä¸œç™¾èµ›åŒºåˆ†åŒºé€‰æ‹”èµ›AWDå¤ç›˜</title><link>https://lonelyuan.github.io/p/ciscn2021%E5%8D%8E%E4%B8%9C%E7%99%BE%E8%B5%9B%E5%8C%BA%E5%88%86%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9Bawd%E5%A4%8D%E7%9B%98/</link><pubDate>Wed, 16 Jun 2021 16:54:30 +0000</pubDate><guid>https://lonelyuan.github.io/p/ciscn2021%E5%8D%8E%E4%B8%9C%E7%99%BE%E8%B5%9B%E5%8C%BA%E5%88%86%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9Bawd%E5%A4%8D%E7%9B%98/</guid><description>&lt;img src="https://lonelyuan.github.io/p/ciscn2021%E5%8D%8E%E4%B8%9C%E7%99%BE%E8%B5%9B%E5%8C%BA%E5%88%86%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9Bawd%E5%A4%8D%E7%9B%98/awd-da-pian.jfif" alt="Featured image of post CISCN2021åŽä¸œç™¾èµ›åŒºåˆ†åŒºé€‰æ‹”èµ›AWDå¤ç›˜" />&lt;h2 id="heading">ðŸ›&lt;/h2>
&lt;p>è¿™æ˜¯ðŸ‘´ç¬¬ä¸€æ¬¡æ‰“é«˜è¾¾80æ”¯é˜Ÿä¼çš„å¤§åž‹AWDï¼ŒðŸ‘´æ­¤è¡Œçš„ç›®æ ‡å°±æ˜¯ç§°éœ¸é…’åº—çš„æ¸¸æ³³æ± ã€‚åŽæ¥å‘çŽ°æ¸¸æ³³æ± è¦é’±ï¼ŒðŸ‘´åªèƒ½é—æ†¾è´¥åŒ—ã€‚ï¼ˆåŽæ¥å‘çŽ°æƒ…æŠ¥å‡ºäº†é—®é¢˜ï¼Œæ ¹æœ¬ä¸è¦é’±ï¼Œè¡€äºï¼‰æ€»çš„æ¥è¯´ï¼Œé…’åº—æµ´ç¼¸å¾ˆå¸¦ï¼Œä¸»åŠžæ–¹æ€åº¦å¾ˆå¥½ï¼Œèµ›åœºå¾ˆæ¸…çœŸï¼Œå‚èµ›ä½“éªŒå¾ˆçˆ½ï¼Œèµšäº†ã€‚&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/ciscn2021%E5%8D%8E%E4%B8%9C%E7%99%BE%E8%B5%9B%E5%8C%BA%E5%88%86%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9Bawd%E5%A4%8D%E7%9B%98/1624254620015.gif"
width="553"
height="398"
srcset="https://lonelyuan.github.io/p/ciscn2021%E5%8D%8E%E4%B8%9C%E7%99%BE%E8%B5%9B%E5%8C%BA%E5%88%86%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9Bawd%E5%A4%8D%E7%9B%98/1624254620015_hu71762a94476e0f7d3b604d446863041c_696119_480x0_resize_box_1.gif 480w, https://lonelyuan.github.io/p/ciscn2021%E5%8D%8E%E4%B8%9C%E7%99%BE%E8%B5%9B%E5%8C%BA%E5%88%86%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9Bawd%E5%A4%8D%E7%9B%98/1624254620015_hu71762a94476e0f7d3b604d446863041c_696119_1024x0_resize_box_1.gif 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="138"
data-flex-basis="333px"
>&lt;/p>
&lt;blockquote>
&lt;p>â€œç»ˆç«¯è¶Šç‚«ï¼Œå—¨å®¢è¶Šå¸¦ï¼›å—¨å®¢è¶Šå¸¦ï¼Œå¸½å­è¶Šå¸¦â€&lt;/p>
&lt;/blockquote>
&lt;!--
åœ¨CISCN2021åŽä¸œç™¾èµ›åŒºåˆ†åŒºèµ›ä¸­ï¼Œå‹é˜ŸStudentUnionæˆ˜é˜ŸæˆåŠŸæˆä¸ºäº†CISCN2021åŽä¸œç™¾èµ›åŒºåˆ†åŒºèµ›çš„ðŸ‘´ï¼Œå–œæç¬¬ä¸‰ï¼Œé€¼å¹³è´µæ ¡åŽ†å²æœ€å¥½æˆç»©ï¼Œå¹¶è£ç™»å­¦é™¢å…¬ä¼—å·ï¼›ðŸ‘´çŽ‡é¢†çš„é˜Ÿä¼åˆ™é€¼å¹³ðŸ‘´ä»¬åœ¨CISCN2021çº¿ä¸Šåˆèµ›ä¸­çš„æŽ’åï¼Œæˆ‘ä»¬éƒ½æœ‰ç¾Žå¥½çš„æœªæ¥ã€‚
-->
&lt;h2 id="awdå¤ç›˜">ðŸAWDå¤ç›˜&lt;/h2>
&lt;p>é¦–å…ˆæ ¹æ®å‚èµ›æ‰‹å†Œï¼Œè¿›è¡Œä¸€ä¸ªè§„åˆ™çš„å¤åˆ¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">1ã€ é‡‡ç”¨çº¿ä¸‹èµ›çš„æ–¹å¼ï¼Œå‚èµ›å›¢é˜Ÿé€šè¿‡æœ‰çº¿è¿žæŽ¥åˆ°å±€åŸŸç½‘ï¼Œå¹¶è¿›è¡Œç½‘ç»œè¿žé€šæ€§çš„æµ‹è¯•ã€‚è¯·è‡ªå¤‡è¿žæŽ¥ç½‘ç»œæ‰€éœ€è¦çš„è®¾å¤‡å¦‚usbè½¬RJ45è½¬æ¢å™¨ç­‰å·¥å…·ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2ã€ æ”»é˜²èµ›éƒ¨ç½²è‹¥å¹²é“èµ›é¢˜ï¼Œåˆå§‹åˆ†å€¼ä¸º10500åˆ†ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3ã€ ä½¿ç”¨xctfç”¨æˆ·é€šè¿‡sshè¿žæŽ¥GameBoxï¼ŒGameBoxçš„ipåœ°å€å’Œç™»å½•å¯†ç é€šè¿‡èµ›äº‹é¡µé¢ä¸‹è½½èŽ·å–ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4ã€ æ¯”èµ›10åˆ†é’Ÿ/å›žåˆï¼Œæ¯ä¸ªå›žåˆä¼šæ›´æ–°GameBoxä¸Šçš„flagã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5ã€ æ¯ä¸ªå›žåˆå†…ï¼Œä¸€ä¸ªæˆ˜é˜Ÿçš„ä¸€ä¸ªæœåŠ¡è¢«æ¸—é€æ”»å‡»æˆåŠŸï¼ˆè¢«èŽ·å–åˆ°flagå¹¶æäº¤ï¼‰ï¼Œåˆ™æ‰£é™¤10åˆ†ï¼Œæ”»å‡»æˆåŠŸçš„æˆ˜é˜Ÿå¹³åˆ†è¿™äº›åˆ†æ•°ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">6ã€ æ¯ä¸ªå›žåˆå†…ï¼ŒæœåŠ¡å®•æœºæˆ–æ— æ³•é€šè¿‡checkåˆ™ä¼šè¢«æ‰£é™¤10åˆ†ï¼ŒæœåŠ¡æ­£å¸¸çš„æˆ˜é˜Ÿå¹³åˆ†è¿™äº›åˆ†æ•°ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">7ã€ å‚èµ›æˆ˜é˜Ÿåœ¨ä¿®å¤æ¼æ´žæ—¶ï¼Œè¯·ä¿æŒæœåŠ¡çš„æ­£å¸¸åŠŸèƒ½å’Œæ‰“å°å­—ç¬¦ã€ç•Œé¢æ ·å¼ï¼Œå¦åˆ™å°†æ— æ³•é€šè¿‡ç³»ç»Ÿcheckã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">8ã€ æ¯ä¸ªå›žåˆå†…ï¼ŒæœåŠ¡å¼‚å¸¸å’Œè¢«æ‹¿flagå¯ä»¥åŒæ—¶å‘ç”Ÿï¼Œå³æˆ˜é˜Ÿåœ¨ä¸€ä¸ªå›žåˆå†…å•ä¸ªæœåŠ¡å¯èƒ½ä¼šè¢«æ‰£é™¤ä¸¤è€…å åŠ çš„åˆ†æ•°ï¼Œæœ€å¤šæ‰£é™¤20åˆ†ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ã€‚ã€‚ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">7ã€ è¯·å‚èµ›æˆ˜é˜Ÿåœ¨æ¯”èµ›å¼€å§‹æ—¶å¯¹æ‰€æœ‰æœåŠ¡è¿›è¡Œå¤‡ä»½ï¼Œä¸»åŠžæ–¹ä»…æä¾›2æ¬¡é‡ç½®æœºä¼šï¼Œ2æ¬¡æœºä¼šä½¿ç”¨åŽä¸äºˆé‡ç½®ã€‚ç”³è¯·é‡ç½®æ—¶è¯·æä¾›æˆ˜é˜Ÿåç§°ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">8ã€ ç¦æ­¢ä½¿ç”¨é€šç”¨é˜²å¾¡æ–¹æ³•å¦‚wafç­‰å·¥å…·ï¼Œè¿è§„è€…ç¬¬ä¸€æ¬¡è¢«å‘çŽ°æ‰£é™¤å½“å‰åˆ†å€¼çš„10%ï¼Œç¬¬äºŒæ¬¡è¢«å‘çŽ°æ‰£é™¤å½“å‰åˆ†å€¼çš„50%ï¼Œç¬¬ä¸‰æ¬¡è¢«å‘çŽ°å–æ¶ˆå‚èµ›èµ„æ ¼å¹¶å‘å…¶å­¦æ ¡å‘æ–‡è¿›è¡Œé€šæŠ¥æ‰¹è¯„ã€‚
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>æ¯”èµ›å…¨ç¨‹æ”¶æ‰‹æœºï¼Œæ–­å¤–ç½‘ï¼Œä¸èƒ½ç”¨wafï¼Œä¸å‡†ç”¨ä¸æ­»é©¬ï¼Œå¤§å®¶éƒ½å¾ˆæ¸…çœŸï¼Œæ‰¾å›žäº†ctfæœ€åˆçš„å¿«ä¹ã€‚&lt;/li>
&lt;/ul>
&lt;p>ç„¶åŽæŒ‰ç…§AWDå¼€å±€çš„ä»»åŠ¡æ¸…å•ï¼Œè¿›è¡Œä¸€ä¸ªç›˜çš„å¤ï¼š&lt;/p>
&lt;h3 id="å‡†å¤‡é˜¶æ®µ">å‡†å¤‡é˜¶æ®µ&lt;/h3>
&lt;ul>
&lt;li>sshè¿žæŽ¥ï¼š
&lt;ul>
&lt;li>ä¸»åŠžæ–¹æä¾›äº†sshå¯†é’¥ï¼Œå’Œé¶æœºip
&lt;ul>
&lt;li>äºŽæ˜¯çœç•¥&lt;code> ssh-copy-id -i ~/.ssh/id_rsa.pub root@xx.xx.xx.xx&lt;/code>çŽ¯èŠ‚ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä½†æ˜¯ä¸‡èƒ½çš„Windows Terminalè¿žä¸ä¸ŠåŽ»ï¼ˆä¾ç„¶ä¸çŸ¥é“ä¸ºå•¥ï¼‰ï¼ŒðŸ‘´åªèƒ½ç”¨å›¾å½¢åŒ–sshå®¢æˆ·ç«¯æ·»åŠ ç§é’¥è¿žæŽ¥ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>IPæ‰«æï¼š
&lt;ul>
&lt;li>å…±æœ‰7é“é¢˜ï¼Œ3é“webï¼Œ4é“pwnï¼Œæ¯é“é¢˜ç›®ä¸€ä¸ªç‹¬ç«‹é¶æœºï¼Œæœ‰ç‹¬ç«‹çš„ipåœ°å€ã€‚ä¸åŒé¶æœºdæ®µä¸åŒï¼Œä¸åŒé˜Ÿä¼cæ®µä¸åŒï¼ŒæŒ‰åˆèµ›æŽ’ååˆ†é…ã€‚å¹³å°ä¸Šå‘ŠçŸ¥äº†å…¨éƒ¨çš„ipåˆ—è¡¨ã€‚
&lt;ul>
&lt;li>äºŽæ˜¯çœç•¥&lt;code>nmap -sn xx.xx.xx.0/24&lt;/code>çŽ¯èŠ‚ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>é€‰æ‰‹æœºå’Œé¶æœºæ± åœ¨ä¸€ä¸ªå±€åŸŸç½‘å†…ã€‚ä¸åŒé˜Ÿä¼cæ®µä¸åŒï¼Œä¸€ä¸ªé˜Ÿä¼å†…çš„ä¸åŒç”µè„‘dæ®µä¸åŒã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æµé‡ç›‘æŽ§ï¼š
&lt;ul>
&lt;li>ä¸»åŠžæ–¹è´´å¿ƒçš„æä¾›äº†è¢«æ‰“æµé‡(ä½†æ˜¯åªæœ‰ä¸‹è¡Œæµé‡)ï¼Œç›´æŽ¥åœ¨~/packageç›®å½•ä¸‹ç»™å‡º.pcapæ–‡ä»¶ã€‚
&lt;ul>
&lt;li>äºŽæ˜¯çœç•¥&lt;code>tcpdump tcp -i eth0 -t -s 0 and dst port ! 22 and src net 192.168.1.0/24 -w ./target.cap&lt;/code>çŽ¯èŠ‚ã€‚&lt;/li>
&lt;li>(ä¸è¿‡ç”¨æˆ·åå«xctfï¼Œæƒé™å¡çš„å¾ˆæ­»ã€‚ä¸ç»™æµé‡çš„è¯ä¼°è®¡ä¹Ÿåªèƒ½åœ¨ç«™é‡Œä¸Šæµé‡ç›‘æŽ§è„šæœ¬)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ›´æ–°é€Ÿåº¦å¾ˆå¿«ï¼Œè¢«æ‰“ä¹‹åŽå‡ ä¹Žå¯ä»¥ç«‹åˆ»æ‰¾åˆ°æµé‡ã€‚äºŽæ˜¯æ‰‹é€Ÿå¾ˆé‡è¦ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="å¼€å±€é˜¶æ®µ">å¼€å±€é˜¶æ®µ&lt;/h3>
&lt;ul>
&lt;li>å¤‡ä»½æºç ï¼š&lt;code>tar -zcvf w.tar.gz /var/www/html&lt;/code>
&lt;ul>
&lt;li>ç»“æžœ&lt;code>&amp;gt; Permission Denied&lt;/code>ï¼Œé‚è·³è¿‡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ‰«é©¬åˆ é©¬ï¼šDç›¾
&lt;ul>
&lt;li>ðŸ‘´ç›´æŽ¥åœ¨å›¾å½¢åŒ–shellé‡Œä¸‹è½½ä»£ç ï¼Œç„¶åŽå´©å±Žäº†å‡ æ¬¡ï¼Œæ‰‹é€Ÿæ…¢äº†ã€‚&lt;/li>
&lt;li>æ¯ä¸ªwebé¢˜éƒ½æœ‰ä¸€ä¸ªä¸æ˜Žå°æ–‡ä»¶ï¼Œæ˜¾ç„¶æ˜¯å°é©¬ï¼Œåˆ é™¤ä¹‹ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¤‡ä»½æ•°æ®åº“ï¼š&lt;code>mysqldump -uctf -p --databases [dbname] &amp;gt; /tmp/db.sql&lt;/code>
&lt;ul>
&lt;li>ç»“æžœ&lt;code>&amp;gt; Permission Denied&lt;/code>ï¼Œé‚è·³è¿‡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ”¹æ•°æ®åº“å¯†ç ï¼š&lt;code>mysql&amp;gt;SET PASSWORD FOR ctf@localhost=PASSWORD('newpass');&lt;/code>
&lt;ul>
&lt;li>ç»“æžœ&lt;code>&amp;gt; Permission Denied&lt;/code>ï¼Œ(â•¯â–”çš¿â–”)â•¯çŽ©nm
&lt;img src="https://lonelyuan.github.io/p/ciscn2021%E5%8D%8E%E4%B8%9C%E7%99%BE%E8%B5%9B%E5%8C%BA%E5%88%86%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9Bawd%E5%A4%8D%E7%9B%98/1624253899126.gif"
width="226"
height="171"
srcset="https://lonelyuan.github.io/p/ciscn2021%E5%8D%8E%E4%B8%9C%E7%99%BE%E8%B5%9B%E5%8C%BA%E5%88%86%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9Bawd%E5%A4%8D%E7%9B%98/1624253899126_hu2892bfd7e7ddde818291317a22bc7d44_927840_480x0_resize_box_1.gif 480w, https://lonelyuan.github.io/p/ciscn2021%E5%8D%8E%E4%B8%9C%E7%99%BE%E8%B5%9B%E5%8C%BA%E5%88%86%E5%8C%BA%E9%80%89%E6%8B%94%E8%B5%9Bawd%E5%A4%8D%E7%9B%98/1624253899126_hu2892bfd7e7ddde818291317a22bc7d44_927840_1024x0_resize_box_1.gif 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="132"
data-flex-basis="317px"
>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ç„¶åŽå¼€å§‹æºç å®¡è®¡(âŒ)&lt;/li>
&lt;li>ç„¶åŽç­‰å¾…è¢«æ‰“ä¹‹åŽç¿»æµé‡(âœ”ï¸)&lt;/li>
&lt;/ul>
&lt;h3 id="æ”»é˜²é˜¶æ®µ">æ”»é˜²é˜¶æ®µ&lt;/h3>
&lt;p>ðŸ‘´åªçœ‹å¾—æ‡‚webé¢˜ç›®ã€‚ä¸‰é“webé¢˜å…¨æ˜¯cmsï¼Œæ˜¯ç»å…¸lampçŽ¯å¢ƒã€‚å¯æ˜¯ðŸ‘´çœ‹ä¸æ‡‚cmsï¼ŒðŸ‘´æ˜¯fiveã€‚&lt;/p>
&lt;h4 id="web1safecms">web1ï¼šsafecms&lt;/h4>
&lt;ul>
&lt;li>æ¯”èµ›ä¸€å¼€å§‹ï¼Œå•ªçš„ä¸€ä¸‹å¾ˆå¿«å•Šï¼Œå…¨åœºè¢«æ‰“ï¼Œç¿»æµé‡æŠ“åˆ°payloadï¼Œæ˜¯ä¸€ä¸ªæ¨¡æ¿æ–‡ä»¶çš„ä»»æ„è¯»æ¼æ´žã€‚ç›´æŽ¥æ‰¹é‡æ‹¿flagã€‚&lt;/li>
&lt;li>å®šä½åˆ°è·¯ç”±ï¼Œæ³¨é‡Šä¹‹ï¼Œä¸å¥½ä½¿ï¼Œè¿˜æ˜¯è¢«æ‰“ï¼›åˆ é™¤è¿™ä¸ª.class.phpï¼Œä¸å¥½ä½¿ï¼›ðŸ‘´æ€€ç–‘æ˜¯è¿è¡Œæ—¶ç¼“å­˜ä¸æ›´æ–°ï¼Œç›´æŽ¥&lt;code>service restart apache2&lt;/code>
&lt;ul>
&lt;li>ç»“æžœ&lt;code>&amp;gt;Permission Denied&lt;/code>ï¼ŒðŸ‘´ä½›äº†&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å°±è¿™æ ·è¢«æ‰“äº†å¥½ä¸€ä¼šï¼Œæ‰å‘çŽ°ç›´æŽ¥ä¿®æ”¹index.phpï¼Œèƒ½ç›´æŽ¥ç”Ÿæ•ˆï¼Œè¡€äºã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="web2eyou">web2ï¼šeyou&lt;/h4>
&lt;ul>
&lt;li>è¿™é“é¢˜è¢«æ‰“çš„å¾ˆå°‘ï¼Œè¢«å®•æœºçš„å¾ˆå¤šã€‚æŠ“æµé‡ï¼Œå‘çŽ°å¾ˆå¤šæ··æ·†æµé‡ã€‚ï¼ˆæ—¥å¿—å†™shellï¼Ÿï¼‰&lt;/li>
&lt;li>ðŸ‘´è·Ÿç€æµé‡å°è¯•ç”¨è¿‡æ»¤çš„æ–¹æ³•ä¿®å¤ï¼Œä½†æ˜¯è¿˜æ˜¯è¢«å®•ã€‚&lt;/li>
&lt;li>è‹¥å¹²è½®åŽï¼ŒðŸ‘´æ²¡åŠžæ³•ï¼Œåªå¥½ç”³è¯·é‡ç½®ï¼Œå¹¶åœ¨ä¸‹ä¸€è½®è¢«å®•ã€‚&lt;/li>
&lt;li>è‹¥å¹²è½®åŽï¼ŒðŸ‘´æ²¡åŠžæ³•ï¼Œåªå¥½ç”³è¯·é‡ç½®ï¼Œå¹¶åœ¨è¿™ä¸€è½®è¢«å®•ã€‚&lt;/li>
&lt;li>è‹¥å¹²è½®åŽï¼ŒðŸ‘´æ²¡åŠžæ³•ï¼Œåªå¥½ç™½ç»™ï¼Œå¹¶åœ¨æŸä¸€è½®æ¢å¤æ­£å¸¸å¹¶åšæŒåˆ°æœ€åŽã€‚æˆ‘ï¼Ÿï¼Ÿï¼Ÿ
&lt;ul>
&lt;li>è¯¥ä¸ä¼šæ˜¯æŸé˜Ÿæˆ–è€…è£åˆ¤çœ‹æˆ‘ä»¬å¤ªå¯æ€œå¸®æˆ‘ä»¬é‡ç½®äº†å§ï¼Œä¸–ç•Œä¸Šè¿˜æœ‰è¿™ä¹ˆæ¸©æŸ”çš„äººï¼Œæˆ‘çœŸçš„å“­æ­»&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è¿™é“é¢˜æ— äº†ã€‚ï¼ˆèµ›åŽæ‰çŸ¥é“ï¼Œæœ‰é˜Ÿä¼æ‰¾åˆ°sqliå¹¶ç™»å½•åŽå°ï¼Œåœ¨åŽå°å…³é—­äº†ç«™ç‚¹å¹¶ç¾Šäº†ç®¡ç†å‘˜è´¦å·ã€‚ä¿®nmã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="web3lol">web3ï¼šlol&lt;/h4>
&lt;ul>
&lt;li>è¿™é“é¢˜æ˜¯æœ€åŽä¸‰å°æ—¶æ”¾çš„ï¼ŒðŸ‘´è¿™æ—¶å€™å·²ç»è‡ªé—­äº†å‡ ä¸ªå°æ—¶ã€‚äºŽæ˜¯ðŸ‘´ç—›å®šæ€ç—›ï¼Œå¼€å±€ç›´æŽ¥æŠŠadmin.phpç¾Šäº†ï¼Œç„¶åŽå¥‡è¿¹èˆ¬çš„å®ˆåˆ°äº†æœ€åŽã€‚åäº†ï¼Œå¥½èµ·æ¥äº†ã€‚&lt;/li>
&lt;li>å…¨åœºè¢«æ‰“ï¼Œç¿»æµé‡æ‰¾åˆ°payloadï¼ŒæŸè·¯å¾„ä¸‹æœ‰ç™½ç»™shellï¼Œç›´æŽ¥åˆ é©¬å¹¶åæ‰“ã€‚&lt;/li>
&lt;li>æŸé˜Ÿä½¿ç”¨äº†åœ¨ç½‘é¡µè¾“å‡ºä¸­å¡žéšæœºå­—ç¬¦ä¸²çš„é˜²å¾¡æ–¹æ³•ï¼Œä½†æ˜¯æ²¡ç ´åflagï¼Œä¸”å¡«å……çš„å­—ç¬¦æ˜¯å›ºå®šçš„ï¼Œè¢«æˆ‘è‚‰çœ¼è¯†ç ´ï¼Œæˆ‘ç›´æŽ¥è¿›è¡Œä¸€ä¸ª&lt;code>if ip == xx: flag = flag[12:]&lt;/code>ã€‚è™½ç„¶æ²¡ä»€ä¹ˆåµç”¨ï¼Œä½†æ˜¯å¾ˆå¿«ä¹ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="pwn">pwnï¼š&lt;/h4>
&lt;p>ä¸€çœ‹åˆ°4ä¸ªpwnðŸ‘´ç›´æŽ¥å‚»æŽ‰ã€‚ðŸ‘´è§‰å¾—ðŸ‘´ä¸ä¼šåšï¼Œå› æ­¤ä¹Ÿæ²¡åŽ»çœ‹ï¼Œä½†å¬å¤§ä½¬è¯´ï¼Œç›´æŽ¥æŠ“æµé‡è¿›è¡Œä¸€ä¸ªè½¬å‘å°±èƒ½æ‹¿åˆ†ï¼ŒðŸ‘´ä¸‹æ¬¡ä¸€å®šå‡†å¤‡å¥½pwntoolsã€‚&lt;/p>
&lt;h2 id="è‡ªåŠ¨åŒ–æ”»é˜²æ¡†æž¶">ðŸ”’è‡ªåŠ¨åŒ–æ”»é˜²æ¡†æž¶&lt;/h2>
&lt;p>AWDä¸­ï¼Œæ‰‹äº¤flagå®žåœ¨æ˜¯å¾ˆæµªè´¹æ—¶é—´çš„è¡Œä¸ºã€‚è™½ç„¶æœ‰æ—¶å€™è‡ªåŠ¨åŒ–ä¸å¤ªå¥½å†™åªèƒ½æ‰‹äº¤ï¼Œåƒè¿™æ¬¡ååˆ†é’Ÿä¸€è½®ï¼Œæœ‰72æ”¯é˜Ÿä¼ï¼Œå°±ç®—ä½ æ‰‹é€ŸæƒŠå¥‡ï¼Œä¹Ÿæ²¡æœ‰æ—¶é—´å®¡è®¡æºç äº†ã€‚å› æ­¤æ‰“AWDé‡ç‚¹å°±åœ¨ä¸€ä¸ªè‡ªåŠ¨åŒ–ã€‚ç½‘ä¸Šèƒ½æ‰¾åˆ°å„ç§æ¡†æž¶ï¼Œä½†æ˜¯ç”¨çš„æ—¶å€™æ€»æ˜¯ä¸é¡ºæ‰‹ï¼Œé‡åˆ°bugä¹Ÿä¸ä¼šä¿®ã€‚åªæœ‰è‡ªå·±å†™çš„æ‰æœ€å¥½ç”¨ã€‚&lt;/p>
&lt;p>å…ˆè¯´è¯´ç”¨å¤„æœ€å¤§çš„å·¥å…·ï¼Œå°±æ˜¯æ‰¹é‡æ”»å‡»æ¡†æž¶/è‡ªåŠ¨åŒ–æ”»å‡»è„šæœ¬ã€‚è¿™ä¸ªæ¡†æž¶ä¸»è¦æœ‰ä»¥ä¸‹è¦ç´ ï¼š&lt;/p>
&lt;ul>
&lt;li>è¾“å…¥ï¼š
&lt;ul>
&lt;li>å¾…æ”»å‡»ipåˆ—è¡¨ï¼šé€šå¸¸å†™åœ¨ip.txté‡Œ&lt;/li>
&lt;li>æ”»å‡»å‡½æ•°ï¼šå³å°è£…å¥½çš„payloadè¯·æ±‚&lt;/li>
&lt;li>äº¤flagå‡½æ•°ï¼šæ ¹æ®å¹³å°æŽ¥å£å°è£…&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è¾“å‡ºï¼š
&lt;ul>
&lt;li>æ‰¹é‡æ”»å‡»ï¼Œè¾“å‡ºæ”»å‡»ç»“æžœ&lt;/li>
&lt;li>æ”»å‡»æˆåŠŸåˆ™æäº¤&lt;/li>
&lt;li>åé¦ˆå¾—åˆ†ç»“æžœ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>æ¡†æž¶çš„æ ¸å¿ƒæ— éžä»¥ä¸‹é€»è¾‘ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">challenge_list&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="c1"># æ”»å‡»å‡½æ•°ç´¢å¼•&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">ip_list&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="c1"># é¦–å…ˆç”Ÿæˆipåˆ—è¡¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">flag&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">get_flag&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># æ ¹æ®jæ‰¾åˆ°ç›¸åº”æ”»å‡»å‡½æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">flag&lt;/span>&lt;span class="o">!=&lt;/span>&lt;span class="s1">&amp;#39;Attacked failed&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">submit_flag&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">flag&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">print_result&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">time&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">round&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ¯”èµ›æ—¶ï¼Œæ‰¾åˆ°æ¼æ´žæˆ–è€…æŠ“åˆ°æµé‡ï¼Œç«‹åˆ»å†™å¥½ç›¸åº”çš„æ”»å‡»å‡½æ•°ï¼Œé‡å¯è„šæœ¬å³å¯ã€‚&lt;/p>
&lt;p>ä¸ºäº†æé«˜ç¨³å®šæ€§å’Œæ˜“ç”¨æ€§ï¼Œè¿™å¥—æ¡†æž¶å¯ä»¥å†™çš„å¾ˆå¤æ‚ã€‚æ¯”å¦‚ï¼š&lt;/p>
&lt;ul>
&lt;li>åŠ å…¥å¤šçº¿ç¨‹ï¼Œè®©æ¡†æž¶éžé˜»å¡žçš„æŒç»­è¿è¡Œ&lt;/li>
&lt;li>åŠ å…¥é¢å‘å¯¹è±¡ï¼Œå†™æˆç±»åº“&lt;/li>
&lt;li>è‡ªå¸¦ä¸€äº›trickï¼Œæ¯”å¦‚æµé‡æ··æ·†å™¨ç­‰ã€‚&lt;/li>
&lt;li>å½“ç„¶ï¼Œè¿˜å¯ä»¥å†™ä¸€ä¸ªç½‘ç«™æ¥å¯è§†åŒ–ç®¡ç†&lt;/li>
&lt;/ul>
&lt;p>è¿™é‡Œå°±æ¶‰åŠæ¡†æž¶ç¼–ç¨‹äº†ï¼Œèƒ½æ·±æŒ–çš„åœ°æ–¹è¿˜æœ‰å¾ˆå¤šã€‚&lt;/p>
&lt;p>é™¤äº†æ‰¹é‡æ”»å‡»è„šæœ¬ï¼Œç”¨åˆ°çš„è„šæœ¬è¿˜æœ‰ï¼š&lt;/p>
&lt;ul>
&lt;li>æƒé™ç»´æŒ/æ‰¹é‡shellè„šæœ¬ï¼šç”¨äºŽç®¡ç†å¤šä¸ªshell
&lt;ul>
&lt;li>ä½†æ˜¯ä¸æ­»é©¬è¢«ç¦ç”¨ï¼Œå› æ­¤æœ¬æ¬¡æ¯”èµ›ä¸­shellå‡ºçŽ°çš„ä¸æ˜¯å¾ˆå¤šã€‚&lt;/li>
&lt;li>ï¼ˆðŸ‘´è¿˜å‡†å¤‡äº†æ‹¿åˆ°ç™½ç»™shellä¹‹åŽæŒä¹…åŒ–çš„è„šæœ¬ï¼Œç»“æžœä¸€ä¸ªshelléƒ½æ²¡æ‹¿åˆ°ï¼Œå‡†å¤‡ä¸ªðŸ”¨ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ–‡ä»¶ç›‘æŽ§è„šæœ¬ï¼šç”¨äºŽç›‘æŽ§flagç­‰é‡è¦æ–‡ä»¶è¢«è¯»å–å’Œä¿®æ”¹çš„å‡†ç¡®æ—¶é—´ï¼Œå¯ä»¥å¸®åŠ©ç¡®å®špayload
&lt;ul>
&lt;li>å†ç‰›é€¼ä¸€ç‚¹è¿˜å¯ä»¥æä¾›ç³»ç»Ÿå¤‡ä»½å’Œå›žå¤åŠŸèƒ½ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>ä¸Šè¿°éƒ½æ˜¯ç³»ç»Ÿè„šæœ¬ï¼Œå¤§å¤šåœ¨æœ¬æœºç”¨pythonå†™çš„ã€‚ä¸‹é¢è¯´å‡ ç§ç½‘é¡µè„šæœ¬ï¼Œå³ç›´æŽ¥ç”¨require/includeåŒ…å«çš„phpè„šæœ¬&lt;/p>
&lt;ul>
&lt;li>æµé‡ç›‘æŽ§è„šæœ¬ï¼šåŒºåˆ«äºŽç³»ç»Ÿçº§æµé‡ç›‘æŽ§ï¼Œç”¨äºŽç›‘æŽ§æ•æ„Ÿæµé‡ä»¥æŠ“å–payload&lt;/li>
&lt;li>é€šé˜²è„šæœ¬ï¼šä¹Ÿå°±æ˜¯wafï¼Œå¯ä»¥è¿›è¡Œå¾ˆå……åˆ†çš„è¿‡æ»¤
&lt;ul>
&lt;li>æœ¬æ¬¡æ¯”èµ›ä¸­è¢«ç¦ç”¨ï¼Œå› ä¸ºç¡®å®žç ´åæ¸¸æˆä½“éªŒ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>è¿™äº›è„šæœ¬ï¼Œç”¨å¥½äº†æ‰æ˜¯è¶æ‰‹çš„å…µå™¨ã€‚è¿™æ¬¡æ¯”èµ›ä¸­ðŸ‘´çš„æ‰‹é€Ÿè¿œä¸å¤Ÿå¿«ï¼Œå»¶è¯¯äº†å¾ˆå¤šæˆ˜æœºã€‚&lt;/p>
&lt;h2 id="å¿«è¿›åˆ°è€ƒè¯•å‘¨ç ´é˜²">ðŸŒŠå¿«è¿›åˆ°ã€Šè€ƒè¯•å‘¨ç ´é˜²ã€‹&lt;/h2>
&lt;p>å›žé¡¾æ•´åœºæ¯”èµ›ï¼Œç›¸æ¯”æ­£ç»çš„æ¼æ´žæŒ–æŽ˜ï¼Œéšæœºåº”å˜çš„èƒ½åŠ›å¯¹åˆ†æ•°ä¹Ÿæœ‰å¾ˆå¤§å½±å“ã€‚æ€»ç»“å‡ ä¸ªå› ç´ ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>awdçš„å¾—åˆ†æ˜¯éšæ—¶é—´ç§¯ç´¯çš„ï¼Œå› æ­¤è¦æŽŒæŽ§å…¨å±€ï¼Œæ—¶åˆ»ç›¯ç´§æ¯é“é¢˜æœ‰æ— è–„å¼±çŽ¯èŠ‚å’Œçªç ´å£ã€‚æœ¬æ¬¡æ¯”èµ›é¢˜ç›®æ•°é‡å¤šè¾¾7é“ï¼ŒðŸ‘´é˜Ÿæœ‰å¤§ä½¬æ²¡æ¥ï¼Œè¿˜å¸¦äº†ä¸€ä¸ªèŒæ–°ï¼Œçº¦ç­‰äºŽäºŒæ‰“å››ï¼Œå‡ºçŽ°äº†çœ‹ä¸è¿‡æ¥é¢˜çš„æƒ…å†µã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¿˜æœ‰å°±æ˜¯æ‰‹é€Ÿï¼Œç”±äºŽæµé‡å¾ˆåŠæ—¶ï¼Œpayloadä¸€è¢«æŠ“åˆ°ï¼Œç”šè‡³å¯ä»¥åœ¨ä¸€è½®checkä¹‹å†…ä¸¢è¿›æ‰¹é‡æ”»å‡»è„šæœ¬ï¼Œç›´æŽ¥å’Œé¦–å…ˆæŒ–æŽ˜åˆ°æ¼æ´žçš„é˜Ÿä¼å¹³åˆ†åˆ†æ•°ã€‚è¿™è¦æ±‚è‡ªåŠ¨åŒ–è„šæœ¬çš„ç†Ÿç»ƒè¿ç”¨ï¼Œå°½é‡é¿å…æ‰‹äº¤flagã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æœ€åŽè¿˜æœ‰ä¸€ç‚¹ç­–ç•¥é—®é¢˜ã€‚åˆ†æžä¸‰ç§é¢˜ç›®çŠ¶æ€ï¼Œåˆ—ä¸ªè¡¨å®šæ€§åˆ†æžä¸€æ³¢æœ€ä¼˜è§£ï¼š&lt;/p>
&lt;/li>
&lt;/ul>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:center">&lt;/th>
&lt;th style="text-align:center">èƒ½åæ‰“&lt;/th>
&lt;th style="text-align:center">ä¸èƒ½åæ‰“&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:center">åœºä¸Šå¤§å¤šæ•°Attacked&lt;/td>
&lt;td style="text-align:center">å…ˆåæ‰“å†ä¿®æ´ž&lt;/td>
&lt;td style="text-align:center">ä¸èƒ½ä¿®æ´žåˆ™downè‡ªå·±&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">åœºä¸Šå¤§å¤šæ•°CheckDown&lt;/td>
&lt;td style="text-align:center">æ‰“ä»–å–µçš„&lt;/td>
&lt;td style="text-align:center">å°½é‡åˆ«down&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;ul>
&lt;li>å‡ºçŽ°æ¼æ´žå¤§éƒ¨åˆ†äººä¼šè¢«æ‰“ï¼Œè¿™æ—¶å¦‚æžœä½ ä¸èƒ½ç«‹åˆ»ä¿®è¡¥è€Œèƒ½ç«‹åˆ»åæ‰“ï¼Œç›¸å½“ç¨‹åº¦ä¸Šæ˜¯ä¸äºçš„ã€‚å¦‚æžœä½ ä¿®ä¸å¥½ä¹Ÿå¯ä»¥é€‰æ‹©å®•æœºï¼Œå› ä¸ºè¿™æ ·åˆ†æ‘Šäº†ä¸¢æŽ‰çš„åˆ†æ•°ã€‚&lt;/li>
&lt;li>å°½é‡é¿å…è¢«æ‰“+è¢«å®•ï¼Œæ‰£åŒå€åˆ†æ•°å±žå®žæ˜¯è¡€äºã€‚å¦‚æžœå†³å®šå®•æœºï¼Œå…ˆæ‘¸æ¸…checkçš„æ—¶é—´å’Œç»“ç®—çš„æ—¶é—´ï¼Œæœ€å¥½åœ¨æ–°ä¸€è½®ç»“ç®—åŽç«‹å³åˆ ç«™downè‡ªå·±ã€‚&lt;/li>
&lt;li>å½“ç„¶ï¼Œå¦‚æžœæ‚¨èƒ½æŒ–åˆ°æ´žï¼Œå®å°±æ˜¯åž‚ç›´ä¸Šåˆ†çš„ðŸ‘´ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä»Ž8ç‚¹åŠåˆ°6ç‚¹åŠï¼Œæ‰“10ä¸ªå°æ—¶çš„AWDï¼Œè¦å…¨ç¨‹ä¿æŒæ•æ„Ÿå’Œæœºæ™ºï¼Œç¡®å®žå¯¹èº«ä½“ç´ è´¨æœ‰äº›è¦æ±‚ã€‚ðŸ‘´åé«˜é“åˆ°åˆè‚¥åäº†6å°æ—¶ï¼Œæ‰“æ¯”èµ›åäº†10å°æ—¶ï¼Œå¥½æ‚¬æ²¡ç»™æˆ‘ç—”ç–®åå‡ºæ¥ã€‚æ™šä¸Šå›žåˆ°é’å²›å¹¶è¿›è¡Œæœ€åŽä¸€æ¬¡å¤œåº—ï¼Œå¿«è¿›åˆ°ã€Šè€ƒè¯•å‘¨ç ´é˜²ã€‹ã€‚&lt;/p></description></item><item><title>åŸºäºŽvivadoçš„åŸºäºŽFPGAçš„ä¸€ç§åŸºäºŽMIPSçš„ä¸€ç§äº”çº§æµæ°´çº¿CPUå®žçŽ°çš„æ³¨é‡Š</title><link>https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/</link><pubDate>Wed, 09 Jun 2021 17:14:19 +0000</pubDate><guid>https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/</guid><description>&lt;img src="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/mips_pipeline_cpu.jfif" alt="Featured image of post åŸºäºŽvivadoçš„åŸºäºŽFPGAçš„ä¸€ç§åŸºäºŽMIPSçš„ä¸€ç§äº”çº§æµæ°´çº¿CPUå®žçŽ°çš„æ³¨é‡Š" />&lt;blockquote>
&lt;p>æœ¬æ–‡æ‰€è¿°ä¸ºè®¡ç®—æœºç»„æˆåŽŸç†è¯¾æ‹“å±•å®žéªŒçš„ç›¸å…³è®°å½•ï¼ŒåŸºäºŽâ€œé¾™èŠ¯ä½“ç³»ç»“æž„ä¸ŽCPUè®¾è®¡æ•™å­¦å®žéªŒç³»ç»Ÿâ€
é¡¹ç›®å®˜ç½‘ï¼š &lt;a class="link" href="http://www.loongson.cn/business/general/teach/356.html" target="_blank" rel="noopener"
>http://www.loongson.cn/business/general/teach/356.html&lt;/a>ï¼›
ç›¸å…³èµ„æ–™ä»£ç ï¼š#TODO:: githubä»“åº“
PSï¼šæ ‡é¢˜å¯ç®€è®°ä¸ºã€ŠåŸºäºŽåŸºäºŽçš„ä¸€ç§åŸºäºŽçš„ä¸€ç§å®žçŽ°ã€‹&lt;/p>
&lt;/blockquote>
&lt;h2 id="åæ§½æ—¶é—´">ðŸ¤“åæ§½æ—¶é—´&lt;/h2>
&lt;p>å¿«è€ƒè¯•äº†ï¼ŒðŸ‘´å‘è§‰ðŸ‘´è®¡ç»„å­¦äº†ä¸ªðŸ”¨ï¼ŒðŸ‘´åŽ»å¹´ä¹Ÿå­¦äº†ä¸ªðŸ”¨ï¼Œä½†æ˜¯åŽ»å¹´å¯ä»¥å½’å› äºŽæ™¦æ°”çš„æ™¦æ°”ï¼Œä»Šå¹´åªèƒ½è¯´è‡ªå·±æ™¦æ°”ã€‚éš¾é“è¿˜è¦é‡è¹ˆåŽ»å¹´çš„æ™¦æ°”å—ï¼ŸðŸ‘´æœ¬åº”è¯¥å›žåŽ»èƒŒè¯¾æœ¬ï¼Œåˆ·è€ƒç ”é¢˜ï¼Œä½†æ˜¯ðŸ‘´ä¸€çœ‹pptå°±æƒ³èµ·æˆ‘ä»¬æ•¬çˆ±çš„ã€Šè®¡ç®—æœºç»„æˆåŽŸç†ã€‹è¯¾çš„ä»»è¯¾è€å¸ˆï¼Œä¸å“¥åå¤å¼ºè°ƒçš„è‡³ç†åè¨€ï¼šâ€œå¬ä¸æ‡‚çš„ä¸¾æ‰‹ï¼ˆæ— åœé¡¿ï¼‰éƒ½æ²¡ä¸¾æ‰‹ï¼Œéƒ½å¬æ‡‚äº†ï¼Œéžå¸¸å¥½ã€‚â€æœ¬äººååˆ†é’¦ä½©ä¸å“¥è€å¸ˆå¯¹å¹½é»˜æ„Ÿçš„ç‹¬ç‰¹ç†è§£ã€‚&lt;br>&lt;/p>
&lt;p>&lt;em>ï¼ˆä½†æ˜¯ç‰¹æ­¤å£°æ˜Žï¼šæœ¬äººä¸äº†è§£ã€ä¸è®¤åŒå…¶å…³äºŽ&amp;quot;5Gæ˜¯ä¸ªå‡ æŠŠ&amp;quot;ï¼Œ&amp;ldquo;é«˜æ™“æ¾å¾ˆnbè¿™ä¸ªäºº&amp;rdquo;ï¼Œ&amp;ldquo;é’±=æµªæ¼«&amp;quot;ç­‰è®®é¢˜çš„çœ‹æ³•ï¼‰&lt;/em>&lt;br>&lt;/p>
&lt;p>è€Œä¸”ðŸ‘´è¿™äººå¾ˆæ€ªï¼Œè¯¾æœ¬ä¸Šçš„é‡ç‚¹ï¼Œä¸å¥½çŽ©ï¼›é€‰åšçš„å®žéªŒï¼Œå¥½çŽ©ï¼å“Žå°±æ˜¯çŽ©ï¼Œæ€ªä¸å¾—å·ä¸è¿‡åˆ«äººï¼Œä½ ä¹Ÿé…å·ï¼Ÿæ»šåŽ»è€ƒç ”å§ã€‚&lt;br>&lt;/p>
&lt;p>ä¼—æ‰€å‘¨çŸ¥ï¼Œè®¡ç®—æœºå­¦ç”Ÿçš„æœ¬ç§‘ç”Ÿæ¶¯ï¼Œå¦‚æžœèƒ½åšåˆ°åœ¨è‡ªå·±è®¾è®¡çš„CPUä¸Šè¿è¡Œè‡ªå·±å†™çš„æ“ä½œç³»ç»Ÿå¹¶ç”¨è‡ªå·±å†™çš„ç¼–è¯‘å™¨è·‘ä»£ç ï¼Œé‚£å°±éžå¸¸æˆåŠŸäº†ã€‚ðŸ‘´å·®ä¸å¤šï¼ŒðŸ‘´èƒ½åœ¨è‡ªå·±æœçš„ä»£ç ä¸Šå†™è‡ªå·±çš„æ³¨é‡Šå¹¶ç”¨è‡ªå·±çš„ç”µè„‘æˆªå›¾ï¼Œéƒ½æ˜¯ä¸‰ä¸ª&amp;quot;è‡ªå·±&amp;rdquo;ã€‚é‚£ä¹ˆä»Šå¤©ç»™å¤§å®¶çˆ†ä¸ªå•¥æï¼Œæµæ°´çº¿å¥¥ã€‚&lt;br>&lt;/p>
&lt;h2 id="-ç”¨è®¡ç®—æœºé€ è®¡ç®—æœº">ðŸ”§ â€œç”¨â€è®¡ç®—æœºâ†’â€œé€ â€è®¡ç®—æœº&lt;/h2>
&lt;p>ä¸Šå›žä¹¦è¯´åˆ°ï¼ˆ#TODO:: CSAPPå¤§ç¯‡ï¼‰ï¼Œæ±‡ç¼–å™¨(as)è®©æˆ‘ä»¬å¾—åˆ°äº†æœºå™¨èƒ½çœ‹æ‡‚çš„æ¯”ç‰¹æµï¼Œæœ€åŽä¸€æ­¥åªéœ€è¦è¿žæŽ¥å™¨(ld)å°†å…¶å’Œå…¶ä»–è°ƒç”¨ä¸€èµ·è½½å…¥å†…å­˜ã€‚è¿™å›žç­”äº†ç¨‹åºå¦‚ä½•åœ¨CPUè¿™ä¸ªå¹³å°ä¸Šè¿è¡Œçš„é—®é¢˜ï¼Œç„¶è€Œä¸€ä¸ªæ›´åŸºæœ¬çš„é—®é¢˜æ˜¯ï¼Œè¿™ä¸ªçŽ°æœ‰çš„å¹³å°æ˜¯å¦‚ä½•å®žçŽ°çš„ï¼Ÿä¸€ä¸ªç²—ç•¥çš„è®¤è¯†æ˜¯ï¼Œæˆ‘ä»¬çŸ¥é“è¿™äº›è¶³ä»¥å®žçŽ°CPUçš„å¤æ‚çš„é€»è¾‘ï¼Œå…¶æœ€å°å•å…ƒæ€»å¯¹åº”åˆ°ç®€å•çš„è¯¸å¦‚é€»è¾‘é—¨ä¸Šé¢ï¼Œä½†æ˜¯è½å®žåˆ°çœŸæ­£çš„ç‰©ç†å®žçŽ°ä¹‹ä¸Šï¼Œå¦‚ä½•ä½¿æ•ˆçŽ‡æœ€é«˜ï¼ŸåŠŸè€—æœ€å°ï¼Ÿè¿™äº›é—®é¢˜æ‰€è·¨è¶Šçš„å¤æ‚åº¦çš„é‡çº§ä¾ç„¶æ˜¯ä¸€ç‰‡å·¨å¤§çš„è¿·é›¾ã€‚ç…§äº®è¿™ç‰‡è¿·é›¾çš„çŸ¥è¯†ï¼Œå¤§æ¦‚éš¶å±žäºŽICå­¦ç§‘ã€‚&lt;br>&lt;/p>
&lt;p>Howeverï¼Œä½œä¸ºCSä¸“ä¸šè€Œä¸æ˜¯ICä¸“ä¸šï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä»…åœ¨äºŽç†è§£æ‰€è°“â€œç»„æˆåŽŸç†â€ã€‚åœ¨ICäº§ä¸šçš„å¤æ‚åº¦è§„æ¨¡æ•°è½´ä¸Šï¼Œå‘ä¸‹æ˜¯ä¸“æœ‰èŠ¯ç‰‡ï¼ˆåˆç§°åµŒå…¥å¼ï¼Ÿï¼‰ï¼ŒåŠŸèƒ½ä¸“ç”¨ï¼Œè§„æ¨¡è¾ƒå°ï¼›å‘ä¸Šæ˜¯é€šç”¨èŠ¯ç‰‡ï¼Œå³æ‰‹æœºç”µè„‘ç­‰çš„æ ¸å¿ƒï¼Œå…¶éš¾åº¦ä¸è¨€è€Œå–»ã€‚ä½äºŽä¸­é—´çš„FPGAåˆ™æ—¢å…¼é¡¾äº†è‡ªç”±åº¦ä¹Ÿè€ƒè™‘äº†é€Ÿåº¦ï¼Œå› æ­¤ï¼Œè¿™çŽ©æ„èƒ½æ»¡è¶³CSæœ¬ç§‘æ•™å­¦çš„éœ€è¦ï¼ˆä¸»è¦æ˜¯ä¾¿å®œè€æ“ï¼‰ã€‚&lt;br>&lt;/p>
&lt;h2 id="é«˜è´µçš„icå·¥ç¨‹å¸ˆéƒ½ç”¨å•¥è½®å­">ðŸ”®é«˜è´µçš„ICå·¥ç¨‹å¸ˆéƒ½ç”¨å•¥è½®å­&lt;/h2>
&lt;p>Vivadoæ˜¯ä¸€ä¸ªFPGAé›†æˆè®¾è®¡å¹³å°ï¼ˆä¹Ÿç®—ä¸€ä¸ªEDAï¼Ÿï¼‰ï¼Œä»–ä¸»ç•Œé¢å·¦ä¾§çš„å·¥ä½œæµçª—å£å¾ˆå¥½çš„æ¦‚æ‹¬äº†åˆ©ç”¨FPGAå¼€å‘çš„åŸºæœ¬æµç¨‹ã€‚å³&lt;/p>
&lt;ul>
&lt;li>ç¼–å†™è®¾è®¡æºç (Source)ï¼šä½¿ç”¨Verilogè¯­è¨€ç¼–å†™é€»è¾‘æˆ–å¼•å…¥IP
&lt;ul>
&lt;li>è®¾è®¡ä»¿çœŸæ¨¡æ‹Ÿ(Simulation)ï¼šé€šè¿‡è§‚å¯Ÿä»¿çœŸæ³¢å½¢å›¾å’Œç¼–å†™testbenchæ¥å¯¹è®¾è®¡è¿›è¡Œdebug
&lt;ul>
&lt;li>ç»¼åˆ(Systhesis)é—¨çº§ç½‘è¡¨ï¼šä»ŽRTLçº§æè¿°é™ç»´åˆ°é—¨çº§ç½‘è¡¨
&lt;ul>
&lt;li>ç”Ÿæˆ(Implementation)å¸ƒå±€å¸ƒçº¿ï¼šæ ¹æ®ç®¡è„šçº¦æŸï¼Œå°†ä¾ç„¶æ˜¯è™šæ‹Ÿçš„é—¨çº§è¿žçº¿è½å®žä¸ºå®žé™…çš„çº¿è·¯
&lt;ul>
&lt;li>è¿›è¡Œç¡¬ä»¶ç¼–ç¨‹(program)ï¼šç”Ÿæˆæ¯”ç‰¹æµå¹¶å†™å…¥ç›®æ ‡è®¾å¤‡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623373911775.png"
width="284"
height="898"
srcset="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623373911775_huf28bb0831bd4f5e30206b091a37b5db9_21335_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623373911775_huf28bb0831bd4f5e30206b091a37b5db9_21335_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="31"
data-flex-basis="75px"
>&lt;/p>
&lt;blockquote>
&lt;p>åè¯è§£é‡Šï¼š
ICï¼šé›†æˆç”µè·¯
FPGAï¼šçŽ°åœºå¯ç¼–ç¨‹é—¨é˜µåˆ—
Verilogï¼šä¸€ç§ç¡¬ä»¶æè¿°è¯­è¨€ï¼Œè¯­æ³•æ¶µç›–äº†è‡ªé¡¶å‘ä¸‹äº”ä¸ªæŠ½è±¡å±‚é¢ï¼šç³»ç»Ÿçº§ã€ç®—æ³•çº§ã€RTLçº§ã€é—¨çº§ã€å¼€å…³çº§ã€‚
RTLï¼šå¯„å­˜å™¨ä¼ è¾“çº§ã€‚ä¸€èˆ¬ä½¿ç”¨æœ€å¤šçš„å°±æ˜¯RTLçº§ã€‚
IPï¼šIntellectual Propertyå†…æ ¸æ¨¡å—ï¼Œå¯ä»¥ç†è§£ä¸ºå°†ä»£ç å°è£…ä¸ºå‡½æ•°ã€‚åˆ†ä¸ºï¼Œè½¯IPå†…æ ¸(soft IP core)ï¼Œå›ºIPå†…æ ¸(firm IP core)å’Œç¡¬IPå†…æ ¸(hard IP core)3ä¸ªå±‚æ¬¡ï¼Œç›¸å½“äºŽé›†æˆç”µè·¯çš„æ¯›å¯ã€åŠæˆå“å’Œæˆå“ã€‚
SoCï¼šç‰‡ä¸Šç³»ç»Ÿï¼Œå¤§æ¦‚æ˜¯èŠ¯ç‰‡åŠå…¶è£…è½½çš„ç¬¬ä¸€å±‚è½¯ä»¶æŽ¥å£çš„é›†åˆï¼Œå¾ˆå®½æ³›çš„æ¦‚å¿µã€‚
EDAï¼šç”µå­è®¾è®¡è‡ªåŠ¨åŒ–ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´æŽ¢æ¸…äº†è¿™ç‰‡è¿·é›¾ï¼ŒCPUçš„è®¾è®¡å¦‚ä½•ä»Žé«˜æŠ½è±¡å±‚æ¬¡çš„é€»è¾‘ï¼Œæ¢³ç†æˆæœ€åº•å±‚çš„é€»è¾‘é—¨ï¼Œå†å®žçŽ°ä¸ºå°å°çš„èŠ¯ç‰‡ã€‚é‚£ä¹ˆæˆ‘ä»¬æœ‰äº†è½®å­ï¼Œè¦é€ ä¸€ä¸ªCPUï¼Œè¿˜è¦ç¡®å®šç›®æ ‡æŒ‡ä»¤é›†ã€‚ç”±äºŽæœ¬é¡¹ç›®ç”±é¾™èŠ¯å…¬å¸èµžåŠ©ï¼Œé‚£å¿…ç„¶è¦é€‰MIPSäº†ã€‚&lt;/p>
&lt;h2 id="mipsæŒ‡ä»¤é›†æ ¼å¼">ðŸ“ŒMIPSæŒ‡ä»¤é›†æ ¼å¼&lt;/h2>
&lt;p>å•¥å«æŒ‡ä»¤é›†å‘¢ï¼Œå­¦è¿‡å‡ ç§è¯­è¨€å°±ä¸éš¾ç†è§£ã€‚é«˜çº§ç¨‹åºè¯­è¨€è§„å®šæ¯ä¸ªasciiç çš„ç»„åˆæ‰€å¯¹åº”çš„å«ä¹‰ï¼ŒæŒ‡ä»¤é›†è§„å®š0å’Œ1çš„ç»„åˆæ‰€å¯¹åº”çš„å¯„å­˜å™¨ï¼ŒALUçš„å„ç§ä¿¡å·ã€‚MIPSæŒ‡ä»¤é›†ä»Žå±žäºŽRISCç³»åˆ—ï¼Œæœ€åŸºæœ¬çš„æŒ‡ä»¤æœ‰31æ¡ã€‚&lt;br>&lt;/p>
&lt;p>//è®²åˆ°è¿™é‡Œæœ¬åº”è¯¥æ‰“ä¸ªè¡¨å±•ç¤º31æ¡æŒ‡ä»¤ï¼Œä½†æ˜¯ðŸ‘´æ‡’å¾—æ‰“äº†ã€‚&lt;br>&lt;/p>
&lt;p>Vivadoä¸­ï¼Œ.coeæ–‡ä»¶ç”¨äºŽåˆå§‹åŒ–IPæ ¸ï¼Œæœ¬å®žéªŒç»™å‡ºçš„.coeæ–‡ä»¶ä¸­å­˜æ”¾äº†å‡ æ¡æŒ‡ä»¤ï¼Œä¸è¿‡æ˜¯16è¿›åˆ¶æ•°å­—ï¼Œå†™ä¸ªå°è„šæœ¬æ‰“å°æˆå¯è¯»çš„å½¢å¼ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;span class="lnt">80
&lt;/span>&lt;span class="lnt">81
&lt;/span>&lt;span class="lnt">82
&lt;/span>&lt;span class="lnt">83
&lt;/span>&lt;span class="lnt">84
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># mips_dump.py&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">with&lt;/span> &lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;r&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">hex_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bin_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">list&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">map&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">lambda&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nb">bin&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">)),&lt;/span>&lt;span class="n">hex_list&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># bin_code_list = [&amp;#34;{:0&amp;gt;32}&amp;#34;.format(i[2:],&amp;#39;b&amp;#39;) for i in bin_list]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bin_code_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zfill&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">bin_list&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">IType_op_dict&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001000&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;addi&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001001&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;addiu&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001100&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;ori&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001101&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;xori&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001111&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;lui&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100011&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;lw&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;101011&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sw&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000100&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;beq&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000101&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;bne&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001010&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;slti&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001011&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sltiu&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RType_func_dict&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100000&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;add&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100001&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;addu&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100010&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sub&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100011&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;subu&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100100&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;and&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100101&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;or&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100110&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;xor&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100111&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;nor&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;101010&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;slt&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;101011&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sltu&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000000&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sll&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000010&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;srl&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000011&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sra&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000100&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sllv&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000110&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;srlv&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000111&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;srav&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001000&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;jr&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">f_hex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ori&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">width&lt;/span>&lt;span class="p">):&lt;/span> &lt;span class="c1"># bin-&amp;gt;hex&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="s2">&amp;#34;0x&amp;#34;&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="nb">hex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ori&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">))[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zfill&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">width&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">f_reg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ori&lt;/span>&lt;span class="p">):&lt;/span> &lt;span class="c1"># print register num&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="s2">&amp;#34;$&amp;#34;&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ori&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zfill&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">code_dump&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">inst&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nb">list&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">type&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;R&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">inst&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ljust&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s2">&amp;#34;, &amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="n">f_reg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]),&lt;/span>&lt;span class="n">f_reg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]),&lt;/span>&lt;span class="n">f_reg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]),&lt;/span>&lt;span class="n">f_hex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">elif&lt;/span> &lt;span class="nb">type&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;I&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">inst&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ljust&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s2">&amp;#34;, &amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="n">f_reg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]),&lt;/span>&lt;span class="n">f_reg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]),&lt;/span>&lt;span class="n">f_hex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">)])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">inst&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ljust&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="s1">&amp;#39;0x&amp;#39;&lt;/span>&lt;span class="o">+&lt;/span> &lt;span class="nb">hex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">))[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zfill&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">assembly_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="n">_&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">bin_code_list&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">op&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[:&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1"># public field&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">try&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">op&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;000000&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="c1"># R-Type&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">11&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">11&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">21&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">shamt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">21&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">func&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">:]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">assembly_list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">code_dump&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;R&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">RType_func_dict&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">func&lt;/span>&lt;span class="p">],[&lt;/span>&lt;span class="n">rs&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">rt&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">rd&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">shamt&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">elif&lt;/span> &lt;span class="n">op&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;000010&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;000011&amp;#39;&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="c1"># J-Type&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">target&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">:]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">assembly_list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">code_dump&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;J&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;j&amp;#39;&lt;/span>&lt;span class="p">,[&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="c1"># I-Type&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">18&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">imm&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">18&lt;/span>&lt;span class="p">:]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">assembly_list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">code_dump&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;I&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">IType_op_dict&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">op&lt;/span>&lt;span class="p">],[&lt;/span>&lt;span class="n">rs&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rt&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">imm&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">except&lt;/span> &lt;span class="ne">Exception&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">assembly_list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;***** decode error! *****&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">head&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;+---hexdump----|--------- assembly ---------+&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">head&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="nb">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">bin_code_list&lt;/span>&lt;span class="p">)):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;|&amp;#34;&lt;/span>&lt;span class="o">+&lt;/span> &lt;span class="n">f_hex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">bin&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="o">+&lt;/span> &lt;span class="n">hex_list&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="s2">&amp;#34; | &amp;#34;&lt;/span>&lt;span class="o">+&lt;/span> &lt;span class="n">assembly_list&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ljust&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s2">&amp;#34; |&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">tail&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;+&amp;#34;&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="s2">&amp;#34;-&amp;#34;&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="mi">43&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="s2">&amp;#34;+&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tail&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ‰“å°å‡ºæ¥ðŸ‘´å‚»äº†ï¼Œæ€Žä¹ˆè¿˜æœ‰ä¸åœ¨31æ¡èŒƒå›´é‡Œçš„ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">+---hexdump----|--------- assembly ---------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x00 24010001 | addiu $00, $04, 0x00000001 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x04 00011100 | sll $00, $01, $02, 0x04 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x08 00411821 | addu $02, $01, $03, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x0c 00022082 | srl $00, $02, $04, 0x02 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x10 28990005 | slti $09, $36, 0x00000005 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x14 07210010 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x18 00642823 | subu $03, $04, $05, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x1c AC050014 | sw $00, $20, 0x00000014 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x20 00A23027 | nor $05, $02, $06, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x24 00C33825 | or $06, $03, $07, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x28 00E64026 | xor $07, $06, $08, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x2c AC08001C | sw $00, $32, 0x0000001c |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x30 11030002 | beq $16, $12, 0x00000002 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x34 00C7482A | slt $06, $07, $09, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x38 24010008 | addiu $00, $04, 0x00000008 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x3c 8C2A0014 | lw $02, $40, 0x00000014 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x40 15450004 | bne $20, $20, 0x00000004 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x44 00415824 | and $02, $01, $11, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x48 AC2B001C | sw $02, $44, 0x0000001c |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x4c AC240010 | sw $02, $16, 0x00000010 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x50 0C000019 | j 0x00000019 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x54 3C0C000C | lui $00, $48, 0x0000000c |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x58 004CD007 | srav $02, $12, $26, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x5c 003AD804 | sllv $01, $26, $27, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x60 0360F809 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x64 A07A0005 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x68 0063682B | sltu $03, $03, $13, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x6c 1DA00003 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x70 00867004 | sllv $04, $06, $14, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x74 000E7883 | sra $00, $14, $15, 0x02 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x78 002F8006 | srlv $01, $15, $16, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x7c 1A000008 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x80 002F8007 | srav $01, $15, $16, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x84 240B008C | addiu $00, $44, 0x0000008c |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x88 06000006 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x8c 8D5C0003 | lw $21, $48, 0x00000003 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x90 179D0007 | bne $57, $52, 0x00000007 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x94 A0AF0008 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x98 80B20008 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x9c 90B30008 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xa0 2DF8FFFF | sltiu $31, $35, 0x00003fff |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xa4 0185E825 | or $12, $05, $29, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xa8 01600008 | jr $11, $00, $00, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xac 31F4FFFF | ori $31, $19, 0x00003fff |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xb0 35F5FFFF | xori $31, $23, 0x00003fff |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xb4 39F6FFFF | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xb8 08000000 | j 0x00000000 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+-------------------------------------------+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ€»ä¹‹ï¼Œä»£ç éƒ½ç»™ä½ äº†ï¼Œä¸‹é¢ç»™å‡ºä¸€ä¸ªvivadoå®žéªŒçš„å®Œæ•´æµç¨‹ï¼Œä¸å…¨é¢ï¼Œä½†æ˜¯éƒ½æ˜¯è¸©å‘ç»éªŒã€‚&lt;/p>
&lt;h2 id="vivadoä½¿ç”¨">ðŸ†’Vivadoä½¿ç”¨&lt;/h2>
&lt;p>æœ¬æµç¨‹çŽ¯å¢ƒï¼šVivado 2020.2&lt;br>
å¼€å‘æ¿åž‹å·ï¼šLS-CPU-EXB-1&lt;br>&lt;/p>
&lt;h3 id="åˆ›å»ºé¡¹ç›®">åˆ›å»ºé¡¹ç›®&lt;/h3>
&lt;p>ä¸‹ä¸€æ­¥ï¼Œä¸‹ä¸€æ­¥ï¼Œä¸‹ä¸€æ­¥ï¼Œï¼Œï¼Œç¡®è®¤ã€‚
è¿™ä¸€æ­¥åªéœ€è¦æ³¨æ„é€‰å™¨ä»¶ï¼Œä¸€å®šè¦é€‰å¯¹ã€‚å¦åˆ™æœ‰å¯èƒ½åœ¨Implementationé‡åˆ°â€œç«¯å£ç”µå¹³ä¸åŒ¹é…â€â€œç«¯å£æ•°é‡ä¸è¶³â€ç­‰ç¡¬ä»¶é—®é¢˜ã€‚å½“ç„¶ï¼Œæœ‰å¯èƒ½åž‹å·ç›¸è¿‘çš„æ€§èƒ½è§„æ ¼ä¹Ÿå·®ä¸å¤šï¼Œè¿™å±žäºŽçŽ„å­¦é—®é¢˜äº†ã€‚å®žéªŒä¹¦ä¸Šé€‰æ‹©çš„çš„åž‹å·åº”è¯¥æ˜¯â€œxc7a200tfbg676-2â€ï¼Œä½†æ˜¯ðŸ‘´ç”¨çš„æ˜¯â€œxc7a200tfbv676-2â€ä¹Ÿèƒ½æˆåŠŸå†™å…¥æ¯”ç‰¹æµã€‚&lt;/p>
&lt;h3 id="ç¼–å†™ä»£ç å¹¶ä»¿çœŸ">ç¼–å†™ä»£ç å¹¶ä»¿çœŸ&lt;/h3>
&lt;p>æœ¬å®žéªŒçš„ä»£ç å¤§å¤šæ¥è‡ªâ€œ2016-04-14â€ï¼Œé‚£å°±æ˜¯é¾™èŠ¯å…¬å¸ç»™çš„æºä»£ç ã€‚åœ¨è¯¥ç³»åˆ—ä»£ç ä¸­æœ‰ä¸€å¤„bugï¼Œä½äºŽâ€œå•å‘¨æœŸCPUå®žéªŒâ€çš„single_cycle_cpu.vä¸­ã€‚214è¡Œï¼Œ&lt;code>resetn&lt;/code>åº”è¯¥ä¸º&lt;code>{4{resetn}}&lt;/code>ï¼Œå†™ä½¿èƒ½ä½å®½åº”ä¸ºä¸º4ã€‚
&lt;img src="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379687932.png"
width="1127"
height="171"
srcset="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379687932_hufe86cef61ae65608cb32f2b7a6318565_35328_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379687932_hufe86cef61ae65608cb32f2b7a6318565_35328_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="659"
data-flex-basis="1581px"
>&lt;/p>
&lt;p>ä¸‹é¢è®²è§£ä¸€ä¸‹é¡¹ç›®ç»“æž„ï¼Œæ‰€æœ‰å®žéªŒéƒ½æ˜¯ç±»ä¼¼çš„ï¼š
&lt;img src="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623374928604.png"
width="685"
height="892"
srcset="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623374928604_hu98bc94ba53dca30899515e8f1ad871e0_210347_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623374928604_hu98bc94ba53dca30899515e8f1ad871e0_210347_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="76"
data-flex-basis="184px"
>
ä¸‰ä¸ªé¡¶å±‚æ–‡ä»¶å¤¹åˆ†åˆ«å¯¹åº”Add Sourceé‡Œçš„ä¸‰ç±»æºæ–‡ä»¶ï¼šæ·»åŠ è®¾è®¡ï¼Œæ·»åŠ ä»¿çœŸï¼Œæ·»åŠ çº¦æŸã€‚å¦‚æžœä¸éœ€è¦ä¸Šæ¿ï¼Œåªå®Œæˆä»¿çœŸï¼Œé‚£ä¹ˆåªéœ€è¦æ·»åŠ è®¾è®¡ï¼ˆå‡ ä¸ª.vï¼‰ï¼Œæ·»åŠ ä»¿çœŸï¼ˆtestbench.v/tb.vï¼‰å°±è¶³å¤Ÿäº†ï¼Œxxx_display.vä¹Ÿæ˜¯ä¸Šæ¿éœ€è¦çš„æ•…è€Œå¯ä»¥å¿½ç•¥ã€‚ï¼ˆå®žé™…ä¸Šï¼Œå›¾ä¸­æˆ‘ç”¨ç®­å¤´æ ‡è®°çš„éƒ½ç”¨ä¸åˆ°ï¼‰ã€‚&lt;/p>
&lt;p>ç¼–å†™tbï¼Œæ— éžæ˜¯ç»™tbé‡Œå£°æ˜Žä¸ºinputçš„ä¿¡å·èµ‹å€¼ï¼Œè¿˜å¯ä»¥ä½¿ç”¨&lt;code>#xx&lt;/code>ï¼Œè®©tbç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚&lt;/p>
&lt;p>ç‚¹å‡»Run Simulationï¼Œç­‰ä¸€ä¼šå°±èƒ½çœ‹åˆ°æ³¢å½¢å›¾ã€‚æ³¢å½¢å›¾æœ‰ä¸‰ç§é¢œè‰²ï¼š&lt;/p>
&lt;ul>
&lt;li>ç»¿è‰²ä»£è¡¨ä¿¡å·æ­£å¸¸æ­£å¸¸ï¼›&lt;/li>
&lt;li>çº¢è‰²çš„Xä»£è¡¨ä¿¡å·ä¸ç¡®å®šï¼›&lt;/li>
&lt;li>è“è‰²çš„Zä»£è¡¨ä¿¡å·ä¼‘çœ ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¸€èˆ¬é‡åˆ°çº¢Xï¼Œéƒ½æ˜¯æœªåˆå§‹åŒ–é—®é¢˜ã€‚è“Zå¤§æ¦‚æ˜¯æ²¡æœ‰æ¨¡å—è°ƒç”¨è¿™äº›ä¿¡å·ã€‚Vivadoæ³¢å½¢å›¾çš„æ“ä½œæžå…¶éš¾ç”¨ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸ªç›¸å¯¹å¥½ç”¨çš„æ“ä½œï¼šå·¦é”®ä»Žå·¦å‘å³æ°´å¹³åˆ’ï¼Œä¼šç›´æŽ¥ç¼©æ”¾åˆ°é¼ æ ‡æ»‘è¿‡çš„è¿™ä¸€æ®µã€‚å³é”®é€‰æ‹©è¿›åˆ¶ç­‰æ“ä½œç•¥ã€‚&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623378896380.png"
width="1000"
height="757"
srcset="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623378896380_hue25177b2e4edfc44898f590de0dbab08_40422_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623378896380_hue25177b2e4edfc44898f590de0dbab08_40422_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="132"
data-flex-basis="317px"
>&lt;/p>
&lt;p>ä»¿çœŸéœ€è¦æ³¨æ„çš„é—®é¢˜ï¼š&lt;/p>
&lt;ul>
&lt;li>å¦‚æžœæ–‡ä»¶æ²¡é—®é¢˜ï¼Œæ¨¡å—è°ƒç”¨å±‚æ¬¡ä¼šè¢«è‡ªåŠ¨è§£æžä»Žè€Œå‘ˆçŽ°æˆä¸€æ£µæ ‘ï¼Œè€Œä¸æ˜¯å¥½å‡ ä¸ªé¡¶å±‚æ–‡ä»¶ã€‚&lt;/li>
&lt;li>æ³¨æ„set as topï¼Œåº”è¯¥è®¾ä¸ºæ ¹éƒ¨æ¨¡å—ï¼ˆè°ƒç”¨å…¶ä»–æ¨¡å—çš„ï¼‰å’Œtb
&lt;ul>
&lt;li>//å¦‚æžœè®¾é”™äº†å¯èƒ½åœ¨Implementationä¼šå‡ºçŽ°â€œç«¯å£æœªèµ‹åˆå€¼â€çš„æŠ¥é”™ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä¸­æ–‡ä¹±ç æ˜¯ç»å…¸å­—ç¬¦é›†é—®é¢˜ï¼Œæœ‰å¯èƒ½åœ¨æ¢è¡Œå¤„å¯¼è‡´è¯­æ³•é”™è¯¯ã€‚å»ºè®®ç»Ÿä¸€æ¢æˆutf-8ã€‚
&lt;ul>
&lt;li>ç®€å•è§£å†³æ–¹æ³•ï¼šä»Žvscodeé‡Œå¤åˆ¶ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="å¼•å…¥ipæ ¸">å¼•å…¥IPæ ¸&lt;/h3>
&lt;p>å¯¹äºŽæµæ°´çº¿CPUï¼Œdata_ramå’Œinst_roméœ€è¦åŒæ­¥å†™ï¼Œè‡ªå·±å®žçŽ°æ¯”è¾ƒå¤æ‚ï¼Œæ•…ç›´æŽ¥å®žä¾‹åŒ–å°è£…å¥½çš„å†…å­˜å—IPã€‚å¦‚ä½•å¼•å…¥ï¼Ÿé¦–å…ˆè¯´æ˜Žå‡ ç§æ–‡ä»¶æ ¼å¼ï¼š&lt;/p>
&lt;ul>
&lt;li>.dcp åŽŸæ„ä¸ºcheckpointsæ–‡ä»¶ï¼Œæ˜¯ä¸€ç§åŠ å¯†åŽ‹ç¼©æ–‡ä»¶ã€‚ç”¨äºŽå°è£…æ¨¡å—æ–¹ä¾¿è°ƒç”¨ï¼Œä½†å¯¹ç‰ˆæœ¬è¦æ±‚æžå…¶æ•æ„Ÿã€‚&lt;/li>
&lt;li>.xci/.xcix IPæ ¸é…ç½®æ–‡ä»¶ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªxmlã€‚æ˜¯Vivadoåœ¨æ–°ç‰ˆæœ¬æå€¡ä½¿ç”¨xciè€Œä¸æ˜¯dcpã€‚&lt;/li>
&lt;li>.xdc ç®¡è„šçº¦æŸæ–‡ä»¶ã€‚åœ¨Implementationç”¨åˆ°ï¼Œæ­¤å¤„æŒ‰ä¸‹ä¸è¡¨ã€‚&lt;/li>
&lt;/ul>
&lt;p>è¿™å‡ ç§æ–‡ä»¶æ ¼å¼éƒ½æ˜¯å¯ä»¥ç›´æŽ¥Add Sourceæ·»åŠ è¿›æ¥çš„ã€‚å®žéªŒè€å¸ˆåŒæ—¶æä¾›dcpå’Œxciæ–‡ä»¶ï¼Œæ·»åŠ dcpå´©å±Žäº†ï¼ŒåŽŸå› ä¼°è®¡å¦‚ä¸Šã€‚æ·»åŠ xciä¹‹åŽï¼Œæç¤ºæˆ‘å°†IPæ›´æ–°ä¸ºcore cointainerçš„å½¢å¼&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623377228417.png"
width="669"
height="513"
srcset="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623377228417_hu3723a569f5da7a4a86a5166afb1cfa77_35011_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623377228417_hu3723a569f5da7a4a86a5166afb1cfa77_35011_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="130"
data-flex-basis="312px"
>&lt;/p>
&lt;p>æ›´æ–°å°±å®Œäº†ã€‚ç„¶åŽéœ€è¦ç­‰ä¸€ä¼šï¼ŒIPè¿˜è¦æ‰§è¡Œä¸€æ­¥synthï¼Œè¿™æ®µæ—¶é—´é‡ŒIPå±žäºŽé”ä½çš„çŠ¶æ€ï¼Œä¸èƒ½ä¿®æ”¹é…ç½®ã€‚&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623377562565.png"
width="429"
height="113"
srcset="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623377562565_hu20944bb791fcafc19453988e909e4c86_6875_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623377562565_hu20944bb791fcafc19453988e909e4c86_6875_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="379"
data-flex-basis="911px"
>&lt;/p>
&lt;p>æ³¨æ„æ›´æ¢å™¨ä»¶åŽï¼ŒIPæ ¸éƒ½ä¼šé”ä½ã€‚è¿™è¡¨ç¤ºIPçš„é…ç½®å’Œå½“å‰çŽ¯å¢ƒä¸åŒ¹é…ã€‚å¯¹æ‰€æœ‰IPé”ä½çš„é—®é¢˜ï¼Œåªéœ€è¦ç‚¹å‡»èœå•æ Reportsâ†’Reports IP Statusï¼Œç„¶åŽç‚¹upgradeå³å¯è§£é™¤é”å®šã€‚&lt;/p>
&lt;h3 id="æˆ‘ç›´æŽ¥ä¸Šæ¿">æˆ‘ç›´æŽ¥ä¸Šæ¿&lt;/h3>
&lt;p>ç›´æŽ¥ç‚¹ç”Ÿæˆæ¯”ç‰¹æµï¼Œä¼šä¸€æ­¥æ­¥çš„æŒ‰å·¥ä½œæµå‘ä¸‹è¿è¡Œï¼Œç­‰å¾…å‡ åˆ†é’Ÿå°±èƒ½æ„‰å¿«çš„æ”¶èŽ·ä½ çš„æŠ¥é”™äº†ï¼&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379096063.jpg"
width="1440"
height="1080"
srcset="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379096063_hu89db98ea66f840c7603fe283c7e8a11b_471271_480x0_resize_q75_box.jpg 480w, https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379096063_hu89db98ea66f840c7603fe283c7e8a11b_471271_1024x0_resize_q75_box.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="133"
data-flex-basis="320px"
>&lt;/p>
&lt;p>åœ¨æŠŠä¸Šæ–‡æåˆ°çš„å‘éƒ½è¸©è¿‡ä¸€éä¹‹åŽï¼Œç»ˆäºŽæ²¡æœ‰critical warningï¼Œæ³ªç›®ã€‚&lt;/p>
&lt;p>ä½†æ˜¯æ­¤æ—¶å®žéªŒè¯¾å·²ç»ç»“æŸäº†ï¼ŒðŸ‘´å·æºœåˆ°æ²¡äººçš„å®žéªŒå®¤ï¼Œå¹¶ç•™ä¸‹ä»¥ä¸‹çè´µç”»é¢&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379266894.jpg"
width="2340"
height="1080"
srcset="https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379266894_hu51bb5a7a2a7c819eb623949b43a1f068_1273620_480x0_resize_q75_box.jpg 480w, https://lonelyuan.github.io/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379266894_hu51bb5a7a2a7c819eb623949b43a1f068_1273620_1024x0_resize_q75_box.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="216"
data-flex-basis="520px"
>&lt;/p>
&lt;p>ç„¶åŽðŸ‘´å‘çŽ°data_ramå†™å…¥å¤±è´¥ã€‚ä½†æ˜¯ðŸ‘´æ²¡æ—¶é—´æžäº†ï¼ŒðŸ‘´è¿˜æ˜¯æ»šåŽ»å¤ä¹ è¯¾æœ¬å§ã€‚&lt;/p>
&lt;h2 id="å¤šå‘¨æœŸæµæ°´çº¿cpuåŽŸç†">ðŸ—¿å¤šå‘¨æœŸæµæ°´çº¿CPUåŽŸç†&lt;/h2>
&lt;p>æœ€åŽï¼Œç»§ç»­å¤ä¹ è®¡ç»„ã€‚&lt;br>&lt;/p></description></item><item><title>æˆ‘å’Œæ‹–å»¶ç—‡çš„æˆ˜äº‰</title><link>https://lonelyuan.github.io/p/%E6%88%91%E5%92%8C%E6%8B%96%E5%BB%B6%E7%97%87%E7%9A%84%E6%88%98%E4%BA%89/</link><pubDate>Thu, 15 Apr 2021 23:01:29 +0000</pubDate><guid>https://lonelyuan.github.io/p/%E6%88%91%E5%92%8C%E6%8B%96%E5%BB%B6%E7%97%87%E7%9A%84%E6%88%98%E4%BA%89/</guid><description>&lt;img src="https://lonelyuan.github.io/p/%E6%88%91%E5%92%8C%E6%8B%96%E5%BB%B6%E7%97%87%E7%9A%84%E6%88%98%E4%BA%89/ProcrastinationWar.jfif" alt="Featured image of post æˆ‘å’Œæ‹–å»¶ç—‡çš„æˆ˜äº‰" />&lt;p>// ç¬‘æ­»ï¼Œæ ¹æœ¬èµ¢ä¸äº†ã€‚å—ä¸é¸Ÿï¼Œç›´æŽ¥æŠ•é™~&lt;/p>
&lt;p>0x01 | æ‹–å»¶ç—‡çš„ç”Ÿç†åŸºç¡€&lt;/p>
&lt;p>0x02 | å¯¹æ‹–å»¶ç—‡çš„æ–¹æ³•è®ºç»¼è¿°&lt;/p>
&lt;p>0x03 | è¥¿è¥¿å¼—æ–¯è®¡åˆ’&lt;/p></description></item><item><title>CSAPP - Bomblab</title><link>https://lonelyuan.github.io/p/csapp-bomblab/</link><pubDate>Thu, 27 Feb 2020 22:43:31 +0000</pubDate><guid>https://lonelyuan.github.io/p/csapp-bomblab/</guid><description>&lt;h1 id="csappbomblab">CSAPPï¼šBomblab&lt;/h1>
&lt;p>é€†å‘çš„ä¼ ç»Ÿè‰ºèƒ½æ‹†ç‚¸å¼¹ï¼ŒðŸ‘´çš„é’æ˜¥å›žæ¥äº†ã€‚&lt;/p>
&lt;p>æ–‡ä»¶ç»“æž„ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">bomb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€ README
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€ bomb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â””â”€â”€ bomb.c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åªæœ‰ä¸€ä¸ªç¨‹åºï¼Œç»™çš„æºç åŸºæœ¬æ²¡ç”¨ï¼Œæˆ‘ä»¬è¦ç”¨é€†å‘å·¥ç¨‹çš„æ–¹æ³•ç†è§£ç¨‹åºï¼Œæ‰¾åˆ°æ­£ç¡®çš„å­—ç¬¦ä¸²ã€‚&lt;/p>
&lt;p>è®²åæ±‡ç¼–å™¨çš„ç»“æžœå¯¼å‡ºï¼š&lt;code>objdump -d bomb &amp;gt; bomb.txt&lt;/code>&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°æœ‰6å…³ï¼Œæ¯ä¸€å…³æŽ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè‹¥è·³è½¬åˆ°explode_bombå‡½æ•°ï¼Œåˆ™ç­”æ¡ˆé”™è¯¯ã€‚&lt;/p>
&lt;h3 id="ç¬¬ä¸€å…³å­—ç¬¦ä¸²æ¯”è¾ƒ">ç¬¬ä¸€å…³ï¼šå­—ç¬¦ä¸²æ¯”è¾ƒ&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">0000000000400ee0 &amp;lt;phase_1&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ee0: 48 83 ec 08 sub $0x8,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ee4: be 00 24 40 00 mov $0x402400,%esi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ee9: e8 4a 04 00 00 callq 401338 &amp;lt;strings_not_equal&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>é€»è¾‘æ˜¯ç›´æŽ¥æ¯”è¾ƒå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œä¸è¿‡&lt;code>$0x402400&lt;/code>ä¸æ˜¯ç¨‹åºå†…åœ°å€ï¼Œè¯´æ˜Žç­”æ¡ˆè¢«è—åœ¨äº†æˆ‘ä»¬çœ‹ä¸åˆ°çš„å†…å­˜ä½ç½®ã€‚&lt;/p>
&lt;p>äºŽæ˜¯ä¸ŠGDBï¼Œåœ¨&amp;lt;phase_1&amp;gt;ä¸‹æ–­ç‚¹ï¼Œ&lt;code>stepi&lt;/code>å•æ­¥æ‰§è¡Œåˆ°callqä¹‹å‰ï¼ŒæŸ¥çœ‹å¯„å­˜å™¨:&lt;code>x\s $esi&lt;/code>ï¼Œå¾—åˆ°ç­”æ¡ˆã€‚ï¼ˆæ¯å°ç”µè„‘çš„ç­”æ¡ˆéƒ½ä¸ä¸€æ ·ï¼‰&lt;/p>
&lt;h3 id="ç¬¬äºŒå…³å¾ªçŽ¯">ç¬¬äºŒå…³ï¼šå¾ªçŽ¯&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">0000000000400efc &amp;lt;phase_2&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400efc: 55 push %rbp //åŽ‹æ ˆ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400efd: 53 push %rbx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400efe: 48 83 ec 28 sub $0x28,%rsp //å¼€è¾Ÿæ ˆå¸§
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f02: 48 89 e6 mov %rsp,%rsi//æ ˆé¡¶åœ°å€â†’rsiå‚æ•°äºŒ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f05: e8 52 05 00 00 callq 40145c &amp;lt;read_six_numbers&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚å‡½æ•°åæ‰€ç¤ºï¼Œè¯»6ä¸ªæ•°å­—ï¼Œä¸ºä»€ä¹ˆæ˜¯6å‘¢ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºå­˜æ”¾å‚æ•°çš„å¯„å­˜å™¨æ€»å…±æœ‰6ä¸ªå§ã€‚ï¼ˆç„¶è€Œå¹¶ä¸ï¼‰&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°è°ƒç”¨å‰å¼€è¾Ÿäº†0x28çš„æ ˆä¸Šç©ºé—´ï¼Œè¶³å¤Ÿå­˜æ”¾6ä¸ªæ•´æ•°ã€‚æ ˆé¡¶åœ°å€è¢«å­˜å…¥%rsiï¼Œä»¥æ­¤ä¼ é€’è¯¥åœ°å€ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">000000000040145c &amp;lt;read_six_numbers&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">//%rsi:çˆ¶è¿›ç¨‹&amp;lt;phase_2&amp;gt;çš„æ ˆé¡¶åœ°å€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40145c: 48 83 ec 18 sub $0x18,%rsp //æ ˆå¸§é•¿24
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401460: 48 89 f2 mov %rsi,%rdx //rsiâ†’å‚æ•°ä¸‰ï¼šnum1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401463: 48 8d 4e 04 lea 0x4(%rsi),%rcx //rsi+4â†’å‚æ•°å››ï¼šnum2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401467: 48 8d 46 14 lea 0x14(%rsi),%rax //rsi+20â†’rax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40146b: 48 89 44 24 08 mov %rax,0x8(%rsp) //raxâ†’æ ˆé¡¶+8ï¼šnum6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401470: 48 8d 46 10 lea 0x10(%rsi),%rax //rsi+16â†’rax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401474: 48 89 04 24 mov %rax,(%rsp) //raxâ†’æ ˆé¡¶ï¼šnum5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401478: 4c 8d 4e 0c lea 0xc(%rsi),%r9 //rsi+12â†’å‚æ•°å…­ï¼šnum4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40147c: 4c 8d 46 08 lea 0x8(%rsi),%r8 //rsi+8â†’å‚æ•°äº”ï¼šnum3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401480: be c3 25 40 00 mov $0x4025c3,%esi//0x4025c3:&amp;#34;%d %d %d %d %d %d&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401485: b8 00 00 00 00 mov $0x0,%eax //è¿”å›žå€¼èµ‹0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40148a: e8 61 f7 ff ff callq 400bf0 &amp;lt;__isoc99_sscanf@plt&amp;gt; //sscanf()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40148f: 83 f8 05 cmp $0x5,%eax //è¿”å›žå€¼å’Œ5æ¯”è¾ƒï¼Œå³è¾“å…¥6ä¸ªå€¼æ‰èƒ½é€šè¿‡
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401492: 7f 05 jg 401499 &amp;lt;read_six_numbers+0x3d&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401494: e8 a1 ff ff ff callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401499: 48 83 c4 18 add $0x18,%rsp //å‡ºæ ˆ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40149d: c3 retq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>çœ‹&amp;lt;read_six_numbers&amp;gt;ï¼Œ%rsiä¸­çš„åœ°å€ä»¥4ä¸ºæ­¥é•¿è¢«åˆ†åˆ«å‚¨å­˜ã€‚çŒœæµ‹sscanfå‡½æ•°çš„è¿”å›žå€¼ä¸­ï¼Œç¬¬ä¸€ä¸ªè¡¨ç¤ºè¾“å…¥å‚æ•°çš„ä¸ªæ•°ï¼›ç¨‹åºè¦æ±‚6ä¸ªè¾“å…¥ï¼ŒåŠ ä¸Šrsiè¢«å ç”¨ï¼ŒäºŽæ˜¯å¤šçš„ä¸¤ä¸ªå­˜å…¥æ ˆä¸­ã€‚ä¸”sscanfå‡½æ•°çš„è¿”å›žå€¼æŒ‰å‚æ•°å¯„å­˜å™¨ï¼ˆå¤šçš„åœ°å€åœ¨æ ˆä¸Šï¼‰å­˜æ”¾çš„åœ°å€ä¼ è¾“ï¼Œå³è¾“å…¥å€¼è¢«æŒ‰é¡ºåºå­˜å…¥phase_2çš„æ ˆå¸§ä¸­ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> 400f0a: 83 3c 24 01 cmpl $0x1,(%rsp) //æ ˆé¡¶ä½ç½®å–åŒå­—å’Œ1æ¯”è¾ƒ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f0e: 74 20 je 400f30 &amp;lt;phase_2+0x34&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f10: e8 25 05 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f17: 8b 43 fc mov -0x4(%rbx),%eax //å¾ªçŽ¯å¤´ï¼šnum1â†’eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f1a: 01 c0 add %eax,%eax // eax*2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f1c: 39 03 cmp %eax,(%rbx) //å’Œnum2æ¯”è¾ƒ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f1e: 74 05 je 400f25 &amp;lt;phase_2+0x29&amp;gt; //ç›¸ç­‰æ‰é€šè¿‡
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f20: e8 15 05 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f25: 48 83 c3 04 add $0x4,%rbx //rbxå¢ž4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f29: 48 39 eb cmp %rbp,%rbx //rbxå’Œrsp+24æ¯”è¾ƒï¼Œç›¸ç­‰åˆ™è·³å‡º
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f2c: 75 e9 jne 400f17 &amp;lt;phase_2+0x1b&amp;gt; //å¾ªçŽ¯å°¾ï¼Œå¾ªçŽ¯å…±6è½®
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f2e: eb 0c jmp 400f3c &amp;lt;phase_2+0x40&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f30: 48 8d 5c 24 04 lea 0x4(%rsp),%rbx //num2åœ°å€â†’rbx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f35: 48 8d 6c 24 18 lea 0x18(%rsp),%rbp//rbxåœ°å€â†’rbp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f3a: eb db jmp 400f17 &amp;lt;phase_2+0x1b&amp;gt; //å¼€å§‹å¾ªçŽ¯
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è·³å‡º&amp;lt;read_six_numbers&amp;gt;åŽï¼Œé¦–å…ˆæ£€æŸ¥æ ˆé¡¶åœ°å€æŒ‡å‘çš„å€¼æ˜¯å¦ä¸º1ï¼Œå³ç¬¬ä¸€ä¸ªæ•°å­—æ˜¯1ã€‚&lt;/p>
&lt;p>ä¹‹åŽè¿›å…¥å¾ªçŽ¯ï¼Œå¾ªçŽ¯ä½“æ¯æ¬¡éƒ½ä¼šæŠŠå½“å‰æ•°å­—*2å’Œä¸‹ä¸€ä¸ªæ•°å­—æ¯”è¾ƒï¼Œå³æ¯ä¸ªæ•°å­—éƒ½æ˜¯å‰ä¸€ä¸ªçš„äºŒå€ï¼›%rbxä½œè®¡æ•°å˜é‡ï¼Œå…±å¾ªçŽ¯6æ¬¡ã€‚ç­”æ¡ˆå‘¼ä¹‹æ¬²å‡ºã€‚&lt;/p>
&lt;h3 id="ç¬¬ä¸‰å…³åˆ†æ”¯">ç¬¬ä¸‰å…³ï¼šåˆ†æ”¯&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">0000000000400f43 &amp;lt;phase_3&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f43: 48 83 ec 18 sub $0x18,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f47: 48 8d 4c 24 0c lea 0xc(%rsp),%rcx //rsp+12â†’rcx: mun2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f4c: 48 8d 54 24 08 lea 0x8(%rsp),%rdx //rsp+8â†’rdx: mun1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f51: be cf 25 40 00 mov $0x4025cf,%esi //0x4025cf: &amp;#34;%d %d&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f56: b8 00 00 00 00 mov $0x0,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f5b: e8 90 fc ff ff callq 400bf0 &amp;lt;__isoc99_sscanf@plt&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f60: 83 f8 01 cmp $0x1,%eax //ä¸å°‘äºŽä¸€ä¸ªè¾“å…¥
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f63: 7f 05 jg 400f6a &amp;lt;phase_3+0x27&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f65: e8 d0 04 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f6a: 83 7c 24 08 07 cmpl $0x7,0x8(%rsp) //
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f6f: 77 3c ja 400fad &amp;lt;phase_3+0x6a&amp;gt; //è¶…è¿‡7åˆ™çˆ†ç‚¸
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f71: 8b 44 24 08 mov 0x8(%rsp),%eax //å–num1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f75: ff 24 c5 70 24 40 00 jmpq *0x402470(,%rax,8)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ­¤å¤„&lt;code>*&lt;/code>ç›¸å½“äºŽcä¸­çš„å–åœ°å€ç¬¦&lt;code>&amp;amp;&lt;/code>ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">400f7c: b8 cf 00 00 00 mov $0xcf,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400f81: eb 3b jmp 400fbe &amp;lt;phase_3+0x7b&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Â·Â·Â·Â·Â·Â·
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œæœ‰7æ®µå½¢å¼é‡å¤çš„ä»£ç ï¼Œç»“åˆç¬¬ä¸€ä¸ªæ•°å­—ä¸èƒ½å¤§äºŽ7ï¼ŒçŒœæµ‹è¿™é‡Œæ˜¯switchåž‹ç»“æž„ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">400fad: e8 88 04 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fb2: b8 00 00 00 00 mov $0x0,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fb7: eb 05 jmp 400fbe &amp;lt;phase_3+0x7b&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fb9: b8 37 01 00 00 mov $0x137,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fbe: 3b 44 24 0c cmp 0xc(%rsp),%eax //æ¯”è¾ƒnum2å’Œeax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fc2: 74 05 je 400fc9 &amp;lt;phase_3+0x86&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fc4: e8 71 04 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fc9: 48 83 c4 18 add $0x18,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fcd: c3 retq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç¬¬äºŒä¸ªæ•°å­—æ˜¯%eaxçš„å€¼ï¼Œç”±ç¬¬ä¸€ä¸ªæ•°å†³å®šã€‚æ•…ç­”æ¡ˆæœ‰7ä¸ªã€‚&lt;/p>
&lt;h3 id="ç¬¬å››å…³é€’å½’">ç¬¬å››å…³ï¼šé€’å½’&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">000000000040100c &amp;lt;phase_4&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">......
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401029: 83 f8 02 cmp $0x2,%eax //åªèƒ½æœ‰2å‚æ•°
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40102c: 75 07 jne 401035 &amp;lt;phase_4+0x29&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40102e: 83 7c 24 08 0e cmpl $0xe,0x8(%rsp) //0 &amp;lt;= num1 &amp;lt;= 14
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401033: 76 05 jbe 40103a &amp;lt;phase_4+0x2e&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401035: e8 00 04 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40103a: ba 0e 00 00 00 mov $0xe,%edx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40103f: be 00 00 00 00 mov $0x0,%esi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401044: 8b 7c 24 08 mov 0x8(%rsp),%edi //num1â†’edi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401048: e8 81 ff ff ff callq 400fce &amp;lt;func4&amp;gt; //
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¾“å…¥è§„åˆ™å’Œä¸Šä¸€å…³ä¸€æ ·ï¼Œç¬¬ä¸€ä¸ªæ•°éœ€åœ¨0åˆ°14ä¹‹é—´ï¼ˆcmplåªèƒ½ç”¨äºŽæ— ç¬¦å·æ•°ï¼Ÿï¼‰&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">0000000000400fce &amp;lt;func4&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">//é¦–æ¬¡è°ƒç”¨æ—¶ï¼š%eax:0x2 %ebx:0 %ecx:0 %edx:0xe %esi:0x0 %edi:num1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fce: 48 83 ec 08 sub $0x8,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fd2: 89 d0 mov %edx,%eax //eax:14
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fd4: 29 f0 sub %esi,%eax //eax:14-0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fd6: 89 c1 mov %eax,%ecx //ecx:14
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fd8: c1 e9 1f shr $0x1f,%ecx //ecx:0 //é€»è¾‘å³ç§»31ï¼Œå³å–ç¬¦å·ä½ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fdb: 01 c8 add %ecx,%eax //eax:14+0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fdd: d1 f8 sar %eax //ç®—æœ¯å³ç§»1ä½ï¼Ÿeax:14/2=7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fdf: 8d 0c 30 lea (%rax,%rsi,1),%ecx //ecx:7+0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fe2: 39 f9 cmp %edi,%ecx //æ¯”è¾ƒnum1å’Œ7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fe4: 7e 0c jle 400ff2 &amp;lt;func4+0x24&amp;gt; //ä¸å¤§äºŽâ†’r17
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fe6: 8d 51 ff lea -0x1(%rcx),%edx //edx:ecx-1=6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fe9: e8 e0 ff ff ff callq 400fce &amp;lt;func4&amp;gt; //é€’å½’â†’r3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fee: 01 c0 add %eax,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ff0: eb 15 jmp 401007 &amp;lt;func4+0x39&amp;gt; //è·³å‡º
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ff2: b8 00 00 00 00 mov $0x0,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ff7: 39 f9 cmp %edi,%ecx //æ¯”è¾ƒnum1å’Œ7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ff9: 7d 0c jge 401007 &amp;lt;func4+0x39&amp;gt; //ä¸å°äºŽ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ffb: 8d 71 01 lea 0x1(%rcx),%esi //esi:ecx+1=8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ffe: e8 cb ff ff ff callq 400fce &amp;lt;func4&amp;gt; //é€’å½’â†’r3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401003: 8d 44 00 01 lea 0x1(%rax,%rax,1),%eax //eax=2*eax+1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401007: 48 83 c4 08 add $0x8,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40100b: c3 retq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å‰é¢ä¸€é€šç®—æœ¯æ“ä½œï¼ŒåŽé¢è®¾è®¡äº†é€’å½’ã€‚&lt;/p>
&lt;p>è¿™é‡Œä¸€æ­¥ç§»ä½æ“ä½œçœ‹èµ·æ¥åƒæ˜¯å–ç¬¦å·ä½ï¼Œä½†æ˜¯è¾“å…¥ä¸€å®šå¤§äºŽ0ï¼Œç¬¦å·ä½æ˜¯0ï¼Œæ‰€ä»¥è¿™ä¸ªæ“ä½œæ„ä¹‰ä½•åœ¨ï¼Ÿ&lt;/p>
&lt;p>äººè‚‰IDAèµ°èµ·ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">fun4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">num1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num1&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nf">fun4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">a&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num1&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nf">fun4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">fun4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">14&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç¬¬ä¸€ä¸ªæ•°è®¾ä¸º7å¯é¿å…é€’å½’è°ƒç”¨ï¼Œä½†è¿”å›žå€¼ä¸æ˜¯0ï¼Œä¸ç¬¦åˆã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">40104d: 85 c0 test %eax,%eax //eax=0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">40104f: 75 07 jne 401058 &amp;lt;phase_4+0x4c&amp;gt;//ä¸ç­‰äºŽ0çˆ†ç‚¸
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">401051: 83 7c 24 0c 00 cmpl $0x0,0xc(%rsp) //mun2å’Œ0æ¯”è¾ƒï¼Ÿ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">401056: 74 05 je 40105d &amp;lt;phase_4+0x51&amp;gt;//ä¸ç­‰äºŽ0çˆ†ç‚¸
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">401058: e8 dd 03 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">40105d: 48 83 c4 18 add $0x18,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">401061: c3 retq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>çœ‹åˆ°&lt;func4>çš„è¿”å›žå€¼å’Œnum2çš†éœ€ä¸º0ï¼Œåˆ™num2ç¡®å®šã€‚&lt;/p>
&lt;p>å¤§ä¸äº†çˆ†ç ´å‘—ï¼Œç´¢æ€§è¯•äº†1æ¬¡å°±æˆäº†ã€‚emm&lt;/p>
&lt;p>ã€åŽé¢ä¸‰å…³æ–½å·¥ä¸­ã€‚ã€‚ã€‚ã€‘&lt;/p>
&lt;h3 id="ç¬¬äº”å…³">ç¬¬äº”å…³&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">0000000000401062 &amp;lt;phase_5&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401062: 53 push %rbx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401063: 48 83 ec 20 sub $0x20,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401067: 48 89 fb mov %rdi,%rbx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40106a: 64 48 8b 04 25 28 00 mov %fs:0x28,%rax //???
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401073: 48 89 44 24 18 mov %rax,0x18(%rsp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401078: 31 c0 xor %eax,%eax //eax:0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40107a: e8 9c 02 00 00 callq 40131b &amp;lt;string_length&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40107f: 83 f8 06 cmp $0x6,%eax //è¾“å…¥é•¿åº¦ä¸º6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401082: 74 4e je 4010d2 &amp;lt;phase_5+0x70&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401084: e8 b1 03 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401089: eb 47 jmp 4010d2 &amp;lt;phase_5+0x70&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40108b: 0f b6 0c 03 movzbl (%rbx,%rax,1),%ecx //å¾ªçŽ¯å¤´ã€‚æ–°æŒ‡ä»¤
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40108f: 88 0c 24 mov %cl,(%rsp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401092: 48 8b 14 24 mov (%rsp),%rdx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401096: 83 e2 0f and $0xf,%edx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401099: 0f b6 92 b0 24 40 00 movzbl 0x4024b0(%rdx),%edx //ï¼Ÿï¼Ÿï¼Ÿ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010a0: 88 54 04 10 mov %dl,0x10(%rsp,%rax,1)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010a4: 48 83 c0 01 add $0x1,%rax //è®¡æ•°å˜é‡rax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010a8: 48 83 f8 06 cmp $0x6,%rax //å¾ªçŽ¯6è½®
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010ac: 75 dd jne 40108b &amp;lt;phase_5+0x29&amp;gt; //å¾ªçŽ¯å°¾
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010ae: c6 44 24 16 00 movb $0x0,0x16(%rsp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010b3: be 5e 24 40 00 mov $0x40245e,%esi //ï¼Ÿï¼Ÿ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010b8: 48 8d 7c 24 10 lea 0x10(%rsp),%rdi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010bd: e8 76 02 00 00 callq 401338 &amp;lt;strings_not_equal&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010c2: 85 c0 test %eax,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010c4: 74 13 je 4010d9 &amp;lt;phase_5+0x77&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010c6: e8 6f 03 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010cb: 0f 1f 44 00 00 nopl 0x0(%rax,%rax,1) //ï¼Ÿï¼Ÿï¼Ÿ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010d0: eb 07 jmp 4010d9 &amp;lt;phase_5+0x77&amp;gt;//è·³å‡º
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010d2: b8 00 00 00 00 mov $0x0,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010d7: eb b2 jmp 40108b &amp;lt;phase_5+0x29&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010d9: 48 8b 44 24 18 mov 0x18(%rsp),%rax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010de: 64 48 33 04 25 28 00 xor %fs:0x28,%rax //ï¼Ÿï¼Ÿï¼Ÿ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010e7: 74 05 je 4010ee &amp;lt;phase_5+0x8c&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010e9: e8 42 fa ff ff callq 400b30 &amp;lt;__stack_chk_fail@plt&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010ee: 48 83 c4 20 add $0x20,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010f2: 5b pop %rbx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010f3: c3 retq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ç¬¬å…­å…³">ç¬¬å…­å…³&lt;/h3>
&lt;h3 id="éšè—å…³">éšè—å…³&lt;/h3>
&lt;p>éšè—å…³è—åœ¨æ¯ä¸€å…³çš„åŽé¢ï¼Œ&lt;/p>
&lt;h2 id="gdbä½¿ç”¨">GDBä½¿ç”¨ï¼š&lt;/h2>
&lt;p>åŸºç¡€ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">q : quit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">h : help
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">file prog//åŠ è½½ç¨‹åºï¼Œä¹Ÿå¯ä½œä¸ºgdbå‘½ä»¤çš„å‚æ•°
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">r : run
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">k : kill
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ–­ç‚¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">b : breakpoints break
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - func_name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - *0x400522
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - &amp;amp;var
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - main.c:100//æºä»£ç æ–­ç‚¹ï¼Œè¿è¡Œå‰å³å¯
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - if con//æ¡ä»¶æ–­ç‚¹
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">w : watch //è§‚å¯Ÿå¯¹è±¡å˜åŒ–æ—¶æ–­ç‚¹
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">d : delete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - b n
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">disable b n
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ‰§è¡Œï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">c : continue
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">f : finish
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">stepi n
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nexti
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">set args ./a.txt //ä»Žæ–‡ä»¶è¯»å–è¾“å…¥
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ£€æŸ¥ä»£ç ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">disas //å±•ç¤ºæ±‡ç¼–
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - funcname
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 0x400000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">list
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">edit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ£€æŸ¥æ•°æ®ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">x : examine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">p : print
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">æ ¼å¼æŽ§åˆ¶ï¼š/[n][f][u]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - n:å†…å­˜å•å…ƒä¸ªæ•°
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - f:æ˜¾ç¤ºæ ¼å¼ï¼š
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - x(hex) æŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - d(decimal) æŒ‰åè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - u(unsigned decimal) æŒ‰åè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºæ— ç¬¦å·æ•´åž‹ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - o(octal) æŒ‰å…«è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - t(binary) æŒ‰äºŒè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - a(address) æŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - c(char) æŒ‰å­—ç¬¦æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - f(float) æŒ‰æµ®ç‚¹æ•°æ ¼å¼æ˜¾ç¤ºå˜é‡
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - u:å•å…ƒé•¿åº¦ï¼ˆæŒ‰å­—èŠ‚ï¼‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">i : info
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - r : registers
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - b [n]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - $rsp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¡¨è¾¾å¼ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å †æ ˆï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">bt : backtrace//æ˜¾ç¤ºå †æ ˆ
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>CSAPP - Datalab</title><link>https://lonelyuan.github.io/p/csapp-datalab/</link><pubDate>Tue, 21 Jan 2020 00:00:03 +0000</pubDate><guid>https://lonelyuan.github.io/p/csapp-datalab/</guid><description>&lt;p>ç¬¬ä¸€ä¸ªlabï¼Œå…³äºŽä½è¿ç®—ã€‚é€šè¿‡å—é™åˆ¶çš„cè¯­è¨€ç¼–ç¨‹å®žçŽ°å‡½æ•°åŠŸèƒ½ã€‚è¿™äº›å‡½æ•°éƒ½æ˜¯éžå¸¸åŸºæœ¬çš„åŠŸèƒ½ï¼Œæ­£å¦‚ä¹¦åã€ŠCS:APPã€‹æ‰€ç¤ºï¼Œå¯å‘æˆ‘ä»¬ä»Žç¨‹åºå‘˜è§†è§’ç†è§£è®¡ç®—æœºçš„æ·±å±‚æ›´æ·±å±‚ã€‚&lt;/p>
&lt;p>READMEä¸­è¯´æ˜Žäº†é¡¹ç›®ç»“æž„ã€‚ç›´æŽ¥è¯»&lt;code>bits.c&lt;/code>ï¼Œåªéœ€è¦å¡«å……å…¶ä¸­çš„å‡½æ•°ã€‚æ¯æ¬¡æµ‹è¯•ç¨‹åºéƒ½è¦å…ˆmakeä¸€ä¸‹ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;span class="lnt">119
&lt;/span>&lt;span class="lnt">120
&lt;/span>&lt;span class="lnt">121
&lt;/span>&lt;span class="lnt">122
&lt;/span>&lt;span class="lnt">123
&lt;/span>&lt;span class="lnt">124
&lt;/span>&lt;span class="lnt">125
&lt;/span>&lt;span class="lnt">126
&lt;/span>&lt;span class="lnt">127
&lt;/span>&lt;span class="lnt">128
&lt;/span>&lt;span class="lnt">129
&lt;/span>&lt;span class="lnt">130
&lt;/span>&lt;span class="lnt">131
&lt;/span>&lt;span class="lnt">132
&lt;/span>&lt;span class="lnt">133
&lt;/span>&lt;span class="lnt">134
&lt;/span>&lt;span class="lnt">135
&lt;/span>&lt;span class="lnt">136
&lt;/span>&lt;span class="lnt">137
&lt;/span>&lt;span class="lnt">138
&lt;/span>&lt;span class="lnt">139
&lt;/span>&lt;span class="lnt">140
&lt;/span>&lt;span class="lnt">141
&lt;/span>&lt;span class="lnt">142
&lt;/span>&lt;span class="lnt">143
&lt;/span>&lt;span class="lnt">144
&lt;/span>&lt;span class="lnt">145
&lt;/span>&lt;span class="lnt">146
&lt;/span>&lt;span class="lnt">147
&lt;/span>&lt;span class="lnt">148
&lt;/span>&lt;span class="lnt">149
&lt;/span>&lt;span class="lnt">150
&lt;/span>&lt;span class="lnt">151
&lt;/span>&lt;span class="lnt">152
&lt;/span>&lt;span class="lnt">153
&lt;/span>&lt;span class="lnt">154
&lt;/span>&lt;span class="lnt">155
&lt;/span>&lt;span class="lnt">156
&lt;/span>&lt;span class="lnt">157
&lt;/span>&lt;span class="lnt">158
&lt;/span>&lt;span class="lnt">159
&lt;/span>&lt;span class="lnt">160
&lt;/span>&lt;span class="lnt">161
&lt;/span>&lt;span class="lnt">162
&lt;/span>&lt;span class="lnt">163
&lt;/span>&lt;span class="lnt">164
&lt;/span>&lt;span class="lnt">165
&lt;/span>&lt;span class="lnt">166
&lt;/span>&lt;span class="lnt">167
&lt;/span>&lt;span class="lnt">168
&lt;/span>&lt;span class="lnt">169
&lt;/span>&lt;span class="lnt">170
&lt;/span>&lt;span class="lnt">171
&lt;/span>&lt;span class="lnt">172
&lt;/span>&lt;span class="lnt">173
&lt;/span>&lt;span class="lnt">174
&lt;/span>&lt;span class="lnt">175
&lt;/span>&lt;span class="lnt">176
&lt;/span>&lt;span class="lnt">177
&lt;/span>&lt;span class="lnt">178
&lt;/span>&lt;span class="lnt">179
&lt;/span>&lt;span class="lnt">180
&lt;/span>&lt;span class="lnt">181
&lt;/span>&lt;span class="lnt">182
&lt;/span>&lt;span class="lnt">183
&lt;/span>&lt;span class="lnt">184
&lt;/span>&lt;span class="lnt">185
&lt;/span>&lt;span class="lnt">186
&lt;/span>&lt;span class="lnt">187
&lt;/span>&lt;span class="lnt">188
&lt;/span>&lt;span class="lnt">189
&lt;/span>&lt;span class="lnt">190
&lt;/span>&lt;span class="lnt">191
&lt;/span>&lt;span class="lnt">192
&lt;/span>&lt;span class="lnt">193
&lt;/span>&lt;span class="lnt">194
&lt;/span>&lt;span class="lnt">195
&lt;/span>&lt;span class="lnt">196
&lt;/span>&lt;span class="lnt">197
&lt;/span>&lt;span class="lnt">198
&lt;/span>&lt;span class="lnt">199
&lt;/span>&lt;span class="lnt">200
&lt;/span>&lt;span class="lnt">201
&lt;/span>&lt;span class="lnt">202
&lt;/span>&lt;span class="lnt">203
&lt;/span>&lt;span class="lnt">204
&lt;/span>&lt;span class="lnt">205
&lt;/span>&lt;span class="lnt">206
&lt;/span>&lt;span class="lnt">207
&lt;/span>&lt;span class="lnt">208
&lt;/span>&lt;span class="lnt">209
&lt;/span>&lt;span class="lnt">210
&lt;/span>&lt;span class="lnt">211
&lt;/span>&lt;span class="lnt">212
&lt;/span>&lt;span class="lnt">213
&lt;/span>&lt;span class="lnt">214
&lt;/span>&lt;span class="lnt">215
&lt;/span>&lt;span class="lnt">216
&lt;/span>&lt;span class="lnt">217
&lt;/span>&lt;span class="lnt">218
&lt;/span>&lt;span class="lnt">219
&lt;/span>&lt;span class="lnt">220
&lt;/span>&lt;span class="lnt">221
&lt;/span>&lt;span class="lnt">222
&lt;/span>&lt;span class="lnt">223
&lt;/span>&lt;span class="lnt">224
&lt;/span>&lt;span class="lnt">225
&lt;/span>&lt;span class="lnt">226
&lt;/span>&lt;span class="lnt">227
&lt;/span>&lt;span class="lnt">228
&lt;/span>&lt;span class="lnt">229
&lt;/span>&lt;span class="lnt">230
&lt;/span>&lt;span class="lnt">231
&lt;/span>&lt;span class="lnt">232
&lt;/span>&lt;span class="lnt">233
&lt;/span>&lt;span class="lnt">234
&lt;/span>&lt;span class="lnt">235
&lt;/span>&lt;span class="lnt">236
&lt;/span>&lt;span class="lnt">237
&lt;/span>&lt;span class="lnt">238
&lt;/span>&lt;span class="lnt">239
&lt;/span>&lt;span class="lnt">240
&lt;/span>&lt;span class="lnt">241
&lt;/span>&lt;span class="lnt">242
&lt;/span>&lt;span class="lnt">243
&lt;/span>&lt;span class="lnt">244
&lt;/span>&lt;span class="lnt">245
&lt;/span>&lt;span class="lnt">246
&lt;/span>&lt;span class="lnt">247
&lt;/span>&lt;span class="lnt">248
&lt;/span>&lt;span class="lnt">249
&lt;/span>&lt;span class="lnt">250
&lt;/span>&lt;span class="lnt">251
&lt;/span>&lt;span class="lnt">252
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * bitXor - x^y using only ~ and &amp;amp;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Example: bitXor(4, 5) = 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ~ &amp;amp;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 14
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">bitXor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// x^y
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// = (~x&amp;amp;y)|(x&amp;amp;~y) // å¼‚æˆ–å…¬å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// = ~(~(~x&amp;amp;y)&amp;amp;~(x&amp;amp;~y)) // å¾·æ‘©æ ¹å¾‹ï¼Œops: 8
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// = ~((x|~y)&amp;amp;(~x|y)) // å¾·æ‘©æ ¹å¾‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// = ~(x&amp;amp;~x|x&amp;amp;y|y&amp;amp;~y|~x&amp;amp;~y) // åˆ†é…å¾‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// = ~(x&amp;amp;y|~x&amp;amp;~y) // å¸æ”¶çŽ‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;~&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;amp;~&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// å¾·æ‘©æ ¹å¾‹ï¼Œops: 7
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * tmin - return minimum two&amp;#39;s complement integer
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">tmin&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// For negative numbers: complement = inverse + 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">31&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// tmin=0x80, tmax=0x7f
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ä¸ºä»€ä¹ˆæ˜¯è¡¥ç ï¼Ÿ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ä¸ºäº†æ–¹ä¾¿è®¡ç®—æœºå¤„ç†ï¼Œæˆ‘ä»¬å¸Œæœ›è´Ÿæ•°å’Œå…¶ç›¸åæ•°ç›¸åŠ ä¹‹åŽè‡ªç„¶çš„æº¢å‡ºå¾—0ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// x+~x=1, å†åŠ 1åˆ™æº¢å‡ºå¾—0ã€‚å› æ­¤è¡¥ç =åç +1ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// åŒæ—¶ç¬¦å·ä½å¤©ç„¶çš„è•´å«åœ¨æœ€é«˜ä½ä¸Šï¼Œè¿™æœ‰è®¸å¤šå¥½å¤„ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å…¶ä¸€æ˜¯æ­£æ•°çš„è¡¨çŽ°å’Œæ— ç¬¦å·æ•´æ•°ä¸€è‡´ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å…¶äºŒæ˜¯ç”±äºŽï¼‹0å’Œ-0ä¸€è‡´ï¼Œç›¸æ¯”æ˜¾å¼ç¬¦å·ä½èƒ½å¤šè¡¨ç¤ºä¸€ä¸ªæ•°å­—ï¼ŒèŒƒå›´æ˜¯[-2^(n-1),2^(n-1)-1]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * isTmax - returns 1 if x is the maximum, two&amp;#39;s complement number,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * and 0 otherwise
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | +
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 10
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">isTmax&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ! é€»è¾‘å–åï¼Œä»…å…¨0è¿”å›ž1ï¼Œå…¶ä½™æƒ…å†µéƒ½è¿”å›ž0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ~ æŒ‰ä½å–å
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// è¡¥ç ç›¸åæ•° = åç  + 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ä¸¤ä¸ªç‰¹ä¾‹ï¼š~tmin+1=tmin; ~0+1=0. ç›¸åæ•°ä¸ºè‡ªèº«
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å¾—åˆ°å‡ ä¸ªå‡½æ•°ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// negate(x) (~x+1) // å–ç›¸åæ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// iszero(x) (!!x) // ä»…å½“!!0=0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// equal(x,y) !(x^y) // åˆ¤æ–­ç›¸ç­‰
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ~tmax=tmin, è½¬æ¢ä¸ºç­›é€‰tminå’Œ0xff
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å› æ­¤ç­”æ¡ˆä¸º equal(~x,negate(~x)) &amp;amp; iszero(~x)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!!~&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// ops: 8
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * allOddBits - return 1 if all odd-numbered bits in word set to 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * where bits are numbered from 0 (least significant) to 31 (most significant)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Examples allOddBits(0xFFFFFFFD) = 0, allOddBits(0xAAAAAAAA) = 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 12
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">allOddBits&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æŽ©ç : x &amp;amp; 0b1111, ç»“æžœç›¸å½“äºŽåªå–äº†xçš„åŽ4ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å¥‡æ•°ä½å…¨ä¸º1ï¼Œä½¿ç”¨æŽ©ç 0xAAAAAAAAæå–å¥‡æ•°ä½ï¼Œå†ä½¿ç”¨equal(x,0xAAAAAAAA)åˆ¤æ–­å³å¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">mask&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0xAA&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mask&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">mask&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mask&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">mask&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">16&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">mask&lt;/span> &lt;span class="o">^&lt;/span> &lt;span class="n">mask&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// ops: 7
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * negate - return -x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Example: negate(1) = -1.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 5
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">negate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * isAsciiDigit - return 1 if 0x30 &amp;lt;= x &amp;lt;= 0x39 (ASCII codes for characters &amp;#39;0&amp;#39; to &amp;#39;9&amp;#39;)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Example: isAsciiDigit(0x35) = 1.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * isAsciiDigit(0x3a) = 0.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * isAsciiDigit(0x05) = 0.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 15
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">isAsciiDigit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// x &amp;gt; y
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// =&amp;gt; x+(~y+1) &amp;gt; 0 // x+(-y)&amp;gt;0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// =&amp;gt; !(x+(~y+1) &amp;gt;&amp;gt; 31) // ä½¿ç”¨ç¬¦å·ä½åˆ¤æ–­&amp;gt;0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å¾—åˆ°æ¯”è¾ƒå‡½æ•°ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// gpos(x, y) !(x+(~y+1) &amp;gt;&amp;gt; 31)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å¸¦å…¥å³å¯ !((0x39 + ~x+1)&amp;gt;&amp;gt;31) &amp;amp; !((x + ~0x30+1)&amp;gt;&amp;gt;31) // ops: 11
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mh">0x3A&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="mh">0x30&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// ops: 10
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * conditional - same as x ? y : z
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Example: conditional(2,4,5) = 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 16
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">conditional&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">z&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æˆ–è¿ç®—ä¸¤ä¾§ä¸åŒæ—¶ä¸º1å³å¯æž„æˆæ¡ä»¶åˆ¤æ–­ï¼Œä½¿ç”¨æŽ©ç æŽ§åˆ¶è¾“å‡ºå†…å®¹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// é”™è¯¯åšæ³•ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// int mask = x &amp;gt;&amp;gt; 31; // ç®—æ•°å³ç§»å–ç¬¦å·ä½å¡«å……å…¨éƒ¨ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// x ? y : z å¯¹xæ˜¯é€»è¾‘åˆ¤æ–­ä¸æ˜¯ç®—æœ¯åˆ¤æ–­
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">mask&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="o">~!&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// ä»…0è¿”å›ž1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="n">mask&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mask&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">z&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="c1">// ops: 7
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * isLessOrEqual - if x &amp;lt;= y then return 1, else return 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Example: isLessOrEqual(4,5) = 1.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 24
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">isLessOrEqual&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// gpos(x, y) åœ¨è·¨ç¬¦å·çš„æƒ…å†µä¸‹å¤±çµï¼Œå¢žåŠ ä¸¤ç§æƒ…å†µåˆ¤æ–­:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// 1. x=yï¼šè¿”å›ž1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// 2. xå’Œyä¸åŒç¬¦å·ï¼šxä¸ºè´Ÿæ—¶ä¸€å®šå°äºŽï¼Œè¿”å›ž1ï¼Œxç¬¦å·ä½ä¹Ÿæ˜¯1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å› æ­¤ç­”æ¡ˆä¸º equal(signx,signy) ? (gpos(y,x) | equal(x,y)) : signx
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">signx&lt;/span>&lt;span class="o">=!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">signy&lt;/span>&lt;span class="o">=!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">mask&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">signx&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="n">signy&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">mask&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">mask&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">signx&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// ops: 19
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * logicalNeg - implement the ! operator, using all of
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * the legal operators except !
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Examples: logicalNeg(3) = 0, logicalNeg(0) = 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 12
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">logicalNeg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ä»…0è¿”å›ž1ï¼Œå…¶ä½™è¿”å›ž0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// è¿˜æ˜¯å€ŸåŠ©ä¸¤ä¸ªç‰¹ä¾‹ï¼š~tmin+1=tmin; ~0+1=0. ç›¸åæ•°ä¸ºè‡ªèº«
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ç­”æ¡ˆä¸º equal(x,~x+1) &amp;amp; !equal(x,tmin)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// !(x^0) &amp;amp; !!(x^(1&amp;lt;&amp;lt;31))
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">&amp;lt;&amp;lt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">)));&lt;/span> &lt;span class="c1">// ops: 6
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/* howManyBits - return the minimum number of bits required to represent x in
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * two&amp;#39;s complement
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Examples: howManyBits(12) = 5 // [-16,15]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * howManyBits(298) = 10 // [-512,511]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * howManyBits(-5) = 4 // [-8,7]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * howManyBits(0) = 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * howManyBits(-1) = 1 // [-1,0]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * howManyBits(0x80000000) = 32
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 90
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">howManyBits&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è´Ÿæ•°å–åï¼Œç»Ÿä¸€å¤„ç†
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// x&amp;gt;&amp;gt;31 ? ~x:x = x&amp;gt;&amp;gt;31 &amp;amp; ~x | ~(x&amp;gt;&amp;gt;31) &amp;amp; x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ä½å®½å–å†³äºŽæœ€é«˜ä½ï¼Œé—®é¢˜è½¬åŒ–ä¸ºå¯»æ‰¾æœ€é«˜ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// 90ä¸ªæ“ä½œç¬¦ä¸è¶³ä»¥éåŽ†32ä¸ªä½ï¼Œå› æ­¤éœ€è¦ä¼˜åŒ–æœç´¢ç®—æ³•ï¼Œå¦‚äºŒåˆ†ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// !!(x&amp;gt;&amp;gt;16) åˆ¤æ–­xçš„é«˜16ä½æ˜¯å¦å­˜åœ¨1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">b16&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è‹¥å­˜åœ¨ï¼Œè‡³å°‘éœ€è¦16ä½ï¼Œå› æ­¤b16èµ‹å€¼ä¸º16æˆ–0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">b16&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// é€šè¿‡ç§»ä½å®žçŽ°äºŒåˆ†æœç´¢ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// è‹¥é«˜ä½å­˜åœ¨åˆ™èˆå¼ƒä½Žä½ï¼Œé«˜ä½å…¨0åˆ™åˆ¤æ–­ä½Žä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">b8&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">b8&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">b4&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">b4&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">b2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">b2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">b1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">b1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">b16&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">b8&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">b4&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">b2&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">b1&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//float
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * floatScale2 - Return bit-level equivalent of expression 2*f for
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * floating point argument f.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Both the argument and result are passed as unsigned int&amp;#39;s, but
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * they are to be interpreted as the bit-level representation of
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * single-precision floating point values.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * When argument is NaN, return argument
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: Any integer/unsigned operations incl. ||, &amp;amp;&amp;amp;. also if, while
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 30
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">unsigned&lt;/span> &lt;span class="nf">floatScale2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="n">uf&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">uf&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">31&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">exp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">uf&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x7f800000&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">frac&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">uf&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="mh">0xff800000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">exp&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="n">frac&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// éžè§„æ ¼æ•°ä¹˜2å³å¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">exp&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">255&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="n">uf&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// ç‰¹æ®Šå€¼ç›´æŽ¥è¿”å›ž
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">exp&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">exp&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">255&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mh">0x7f800000&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// ä¹˜æ³•ä¸å¯èƒ½å¾—åˆ°NaNï¼Œæ‰€ä»¥è¿”å›žæ— ç©·
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">exp&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">frac&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * floatFloat2Int - Return bit-level equivalent of expression (int) f
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * for floating point argument f.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Argument is passed as unsigned int, but
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * it is to be interpreted as the bit-level representation of a
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * single-precision floating point value.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Anything out of range (including NaN and infinity) should return
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * 0x80000000u.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: Any integer/unsigned operations incl. ||, &amp;amp;&amp;amp;. also if, while
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 30
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">floatFloat2Int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="n">uf&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">uf&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">31&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">exp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">uf&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x7f800000&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">frac&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">uf&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="mh">0xff800000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">E&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">exp&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">127&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">exp&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">255&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="n">E&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">31&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mh">0x80000000&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// ç‰¹æ®Šå€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">E&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// å°æ•°èˆå…¥ä¸º0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">M&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">frac&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// 1 + frac
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">V&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">E&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">23&lt;/span> &lt;span class="o">?&lt;/span> &lt;span class="n">M&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">E&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="n">M&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">23&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">E&lt;/span>&lt;span class="p">));&lt;/span> &lt;span class="c1">// Må·²ç»è¢«å·¦ç§»äº†23ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">V&lt;/span> &lt;span class="o">*=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// è´Ÿæ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="n">V&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * floatPower2 - Return bit-level equivalent of the expression 2.0^x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * (2.0 raised to the power x) for any 32-bit integer x.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> *
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * The unsigned value that is returned should have the identical bit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * representation as the single-precision floating-point number 2.0^x.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * If the result is too small to be represented as a denorm, return
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * 0. If too large, return +INF.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> *
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: Any integer/unsigned operations incl. ||, &amp;amp;&amp;amp;. Also if, while
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 30
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">unsigned&lt;/span> &lt;span class="nf">floatPower2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// V = (-1)^s * M * 2^E
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// E = e-127 Eâˆˆ[-126,127]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// s=0,f=0, xå¸¦å…¥Eå³å¯å¾—åˆ° 2^x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ä¸ºæ­¤ï¼Œåæ¼”ä»ŽEæ±‚eçš„è¿‡ç¨‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;=&lt;/span> &lt;span class="mi">128&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mh">0x7f800000&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// +INF
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">126&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">127&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// [-126,127]: 2^xä¸ºè§„æ ¼æ•°, f=1.0, e=x+127
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">150&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">150&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// [-150,-125]: 2^xä¸ºéžè§„æ ¼æ•°, f=2^(x+150), e=0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// too small
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¤ªå²å…¬æ›°ï¼šå‰é¢å‡ ä¸ªè€ƒå¯Ÿintçš„é¢˜ç›®å±‚å±‚æ·±å…¥ï¼Œä»ŽæŽ©ç æ€æƒ³åˆ°æ¡ä»¶åˆ¤æ–­ï¼Œæ¯ä¸ªæ–°é¢˜ç›®éƒ½å¯ä»¥ç”¨åˆ°å‰é¢é¢˜ç›®çš„æ€è·¯ã€‚åªæœ‰howManyBitséœ€è¦æƒ³åˆ°å¦‚ä½•ç”¨ç§»ä½æž„é€ è¿­ä»£ï¼Œæœ‰ä¸€å®šçš„éš¾åº¦ã€‚ç›¸æ¯”è€Œè¨€æœ€åŽçš„æµ®ç‚¹æ•°é¢˜ç›®ç”±äºŽæ”¾å¼€äº†è¯¸å¤šé™åˆ¶ï¼Œå˜æˆäº†ä¸€èˆ¬çš„ç¼–ç¨‹é¢˜ï¼Œåªéœ€è¦ç†Ÿç»ƒæŽŒæ¡æµ®ç‚¹æ•°è§„åˆ™å³å¯ä½œç­”ã€‚&lt;/p></description></item><item><title>æ·±åº¦å­¦ä¹ å…¥é—¨â€”â€”jetbotæ™ºèƒ½å°è½¦å°é²œï¼ˆäºŒï¼‰</title><link>https://lonelyuan.github.io/p/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8jetbot%E6%99%BA%E8%83%BD%E5%B0%8F%E8%BD%A6%E5%B0%9D%E9%B2%9C%E4%BA%8C/</link><pubDate>Tue, 01 Oct 2019 00:26:38 +0000</pubDate><guid>https://lonelyuan.github.io/p/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8jetbot%E6%99%BA%E8%83%BD%E5%B0%8F%E8%BD%A6%E5%B0%9D%E9%B2%9C%E4%BA%8C/</guid><description>&lt;p>é‚£ä¸ªç”·å­©ä¸æƒ³çŽ©äººå·¥æ™ºèƒ½å‘¢ï¼Ÿåœ¨çŽ„å­¦ä¿®bugä¹‹åŽï¼Œæˆ‘ç»ˆäºŽè·‘é€šäº†jetbotè‡ªå¸¦çš„æ·±åº¦å­¦ä¹ demoã€‚&lt;/p>
&lt;p>æ€Žæ ·æ‰èƒ½è®©aiç¨‹åºå‘æŒ¥å¥½çš„æ•ˆæžœå‘¢ï¼Ÿä¼—æ‰€å‘¨çŸ¥ï¼Œæ‰€è°“äººå·¥æ™ºèƒ½ï¼Œæœ‰å¤šå°‘äººå·¥å°±æœ‰å¤šæ™ºèƒ½ã€‚&lt;/p>
&lt;p>AIçš„å‘å±•ç¦»ä¸å¼€ä¸‰ä¸ªè¦ç´ ï¼š&lt;strong>ç®—åŠ›&lt;/strong>ï¼Œ&lt;strong>ç®—æ³•&lt;/strong>å’Œ&lt;strong>ç®—æ&lt;/strong>ã€‚æ ¹æ®æ‘©å°”å®šå¾‹ï¼Œç®—åŠ›çš„å‘å±•æ˜¯ä¸ä¼šåœæ»žçš„ï¼ˆè™½ç„¶å®šå¾‹å¿«å¤±æ•ˆäº†ï¼‰ï¼›è¿›å‡ å¹´æ¥çš„AIçƒ­æ­£æ˜¯ç®—æ³•çš„çªç ´ï¼Œå³æ·±åº¦å­¦ä¹ ç›¸å…³ç®—æ³•çš„çªé£žçŒ›è¿›ï¼›è€Œç®—æå°±æ˜¯ç”¨æ¥è®­ç»ƒæ¨¡åž‹çš„æ•°æ®ï¼Œæœªæ¥å‡ å¹´AIåº”ç”¨çš„è¿›ä¸€æ­¥è½åœ°ç¦»ä¸å¼€ç®—æçš„è¿›ä¸€æ­¥å¼€å‘ï¼ˆä¸­å›½åœ¨AIæ–¹é¢çš„æœ€å¤§ä¼˜åŠ¿æ­£åœ¨äºŽæ­¤ï¼‰ã€‚æ•°æ®é›†çš„ä¸°å¯Œç¨‹åº¦å’Œæœ‰æ•ˆç¨‹åº¦ç›´æŽ¥å½±å“äº†AIåº”ç”¨çš„æ•ˆæžœï¼Œæˆ‘å°†åœ¨ä¸‹æ–‡è¯¦ç»†è¯´æ˜Žã€‚&lt;/p>
&lt;p>åœ¨jetboté¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½ä½“éªŒåˆ°ç”¨â€œäººå·¥â€æ¢â€œæ™ºèƒ½â€çš„å¿«ä¹ã€‚ä½œä¸ºè§†è§‰è¯†åˆ«ç±»çš„AIåº”ç”¨ï¼Œæˆ‘ä»¬è¦åœ¨é¢„è®¾çŽ¯å¢ƒé‡Œåˆ›å»ºæ•°æ®é›†ï¼Œå¹¶ä¸ºå…¶æ ‡æ³¨ã€‚æœ‰äº†æ•°æ®é›†ï¼Œjetbotæ­è½½çš„NVIDIAç‰ŒGPUåœ¨æ–¹å¯¸ä¹‹é—´å°±èƒ½å®Œæˆæµ·é‡è®¡ç®—ï¼Œä»…ç”¨ä¸€é¢—æ‘„åƒå¤´å°±èƒ½å®žçŽ°è‡ªåŠ¨é¿éšœï¼Œç›®æ ‡è¿½è¸ªï¼Œè‡ªåŠ¨å·¡çº¿ç­‰ç­‰ç‚«é…·åŠŸèƒ½ï¼ä¸è¦1999ï¼Œä¹Ÿä¸è¦999ï¼Œåªè¦99ï¼99åˆ€NVIDIAè®¡ç®—å¡å¸¦å›žå®¶ï¼ï¼ˆå¦®ç»´é›…æ‰“é’±ï¼‰&lt;/p>
&lt;blockquote>
&lt;p>ç»™èŒæ–°ç†æ¸…å‡ ä¸ªæ¦‚å¿µï¼š&lt;/p>
&lt;p>äººå·¥æ™ºèƒ½ï¼Œæœºå™¨å­¦ä¹ ï¼Œæ·±åº¦å­¦ä¹ çš„å…³ç³»ï¼š&lt;/p>
&lt;ul>
&lt;li>æ·±åº¦å­¦ä¹ ï¼šä¸€ç§å®žçŽ°æœºå™¨å­¦ä¹ çš„æŠ€æœ¯ï¼›æœºå™¨å­¦ä¹ ï¼šä¸€ç§å®žçŽ°äººå·¥æ™ºèƒ½çš„æ–¹æ³•&lt;/li>
&lt;li>ã€åŒ…å«å…³ç³»å›¾ã€‘&lt;/li>
&lt;/ul>
&lt;p>AIçš„å‘å±•è·¯å¾„ï¼š&lt;/p>
&lt;ul>
&lt;li>å¼±AIï¼šå•ç‹¬é¢†åŸŸå·¥ä½œæ•ˆçŽ‡è¶…è¿‡äººç±»â†’&lt;/li>
&lt;li>é€šç”¨AIï¼šå¯ä»¥å¹¿æ³›åº”ç”¨äºŽå¤§éƒ¨åˆ†é¢†åŸŸâ†’&lt;/li>
&lt;li>å¼ºAIï¼šæœ‰è‡ªä¸»æ„è¯†ï¼Œå³å°†ç­ç»äººç±»ï¼ˆä¸æ˜¯ï¼‰â†’&lt;/li>
&lt;/ul>
&lt;p>çŽ°åœ¨AIå‘å±•åˆ°ä»€ä¹ˆåœ°æ­¥äº†ï¼šå¼±AIï¼Œæœ‰ç”Ÿä¹‹å¹´å¯èƒ½è§åˆ°é€šç”¨AI&lt;/p>
&lt;/blockquote>
&lt;p>æŽ¨èä¸€æ³¢æ±‰åŒ–çš„å¾ˆå¥½çš„wikiï¼Œä¹Ÿæœ‰è‡ªå·±åŽŸåˆ›çš„å†…å®¹ï¼šhttp://www.waveshare.net/wiki/JetBot_AI_Kit&lt;/p>
&lt;p>æœ¬ç¯‡è¯¦ç»†ä»‹ç»ä¸¤ä¸ªdemoçš„ä»£ç å’Œå¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼Œæœ€åŽé™„ä¸Šç¥žç»ç½‘ç»œçš„å…¥é—¨ç¬”è®°ã€‚åŒæ ·æ˜¯åˆæ¬¡æŽ¥è§¦ï¼Œå¤§ä½¬è¯·ç»•é“ã€‚&lt;/p>
&lt;h3 id="demo1è‡ªåŠ¨é¿éšœ">demo1ï¼šè‡ªåŠ¨é¿éšœ&lt;/h3>
&lt;p>å°è½¦å¦‚ä½•å®žçŽ°è‡ªåŠ¨é¿éšœçš„å‘¢ï¼Ÿç”¨é€šä¿—çš„ä¸èƒ½å†é€šä¿—çš„è¯´æ³•ï¼ŒAIç¨‹åºé€šè¿‡å­¦ä¹ ä½ ç»™ä»–çš„æ•°æ®é›†ï¼ŒçŸ¥é“äº†ä»€ä¹ˆæ ·çš„å›¾åƒæ˜¯æ­»è·¯ï¼Œä»€ä¹ˆæ ·çš„å›¾åƒæ˜¯é€šè·¯ã€‚å¾—åˆ°æ–°å›¾åƒæ—¶å°±èƒ½åˆ¤æ–­æ˜¯æ­»è·¯çš„æ¦‚çŽ‡æœ‰å¤šå°‘ï¼Œåœ¨ç¨‹åºé‡Œå¯ä»¥å¾ˆç®€å•çš„çœ‹å‡ºï¼Œå½“è¿™ä¸ªæ¦‚çŽ‡å¤§äºŽ0.5çš„æ—¶å€™å°±è§¦å‘å°è½¦è½¬å‘ã€‚&lt;/p>
&lt;p>å…·ä½“è€Œè¨€ï¼Œä½ è¦åœ¨ä½ çš„çŽ¯å¢ƒé‡Œæ‹è‡³å°‘200å¼ ç…§ç‰‡ï¼Œ100å¼ æ ‡è®°ä¸ºé€šè·¯ï¼ˆfreeï¼‰ï¼Œ100å¼ æ ‡è®°ä¸ºæ­»è·¯ï¼ˆblockedï¼‰ã€‚è¿™ä¾¿æ˜¯ä½ çš„æ•°æ®é›†ï¼ˆdatasetï¼‰ã€‚æž„å»ºæ•°æ®é›†çš„æ—¶å€™å°½é‡åˆ†æ•£åœ¨çŽ¯å¢ƒçš„å„ä¸ªä½ç½®å’Œå„ä¸ªæ–¹å‘ï¼Œå¯ä»¥æ²¿è¾¹ç•ŒçŽ¯ç»•ä¸€åœˆï¼Œèµ°ä¸€æ®µè·ç¦»åœä¸‹ï¼Œè½¬ä¸€åœˆï¼Œæ”¶é›†8-10å¼ å›¾ç‰‡ã€‚åæ­£ä½ çš„æ•°æ®è¶Šå¤šï¼Œæ ‡è®°çš„è¶Šå‡†ç¡®ï¼Œæ¨¡åž‹æ•ˆæžœè¶Šå¥½ã€‚&lt;/p>
&lt;p>ä¸‹ä¸€æ­¥å°±å¼€å§‹è®­ç»ƒæ¨¡åž‹äº†ï¼Œä»Žä»£ç é‡Œçœ‹å‡ºï¼Œè¿™ä¸ªdemoä½¿ç”¨AlexNetæ¨¡åž‹ï¼Œç”¨pytorchå®žçŽ°ï¼ˆåºŸè¯ï¼‰ã€‚ç¬¬ä¸€æ¬¡è¿è¡Œä½ ä¼šä¸‹è½½ä¸€ä¸ª244Må·¦å³çš„å¤§æ–‡ä»¶ï¼Œåœ¨&lt;code>/home/jetbot/.torch/models&lt;/code>ç›®å½•ä¸‹ä¼šçœ‹åˆ°è¿™ä¸ª.pthæ–‡ä»¶ã€‚è¿™ä¾¿æ˜¯AlexNetäº†ã€‚&lt;/p>
&lt;p>ç»§ç»­è¿è¡Œç¨‹åºï¼Œå®Œæ•´çš„è¾“å‡ºç»“æžœæœ‰ä¸‰åè¡Œï¼Œæ¯è¡ŒåŽé¢çš„å°æ•°ä»£è¡¨å½“å‰æ¨¡åž‹çš„å‡†ç¡®åº¦ï¼ˆï¼Ÿï¼‰ï¼Œç¨‹åºæœ€åŽä¼šä»Žè¿™30ä¸ªæ¨¡åž‹ä¸­é€‰å–å‡†ç¡®åº¦æœ€é«˜çš„ä½œä¸ºæœ€ç»ˆæ¨¡åž‹ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªpthæ–‡ä»¶ï¼š&lt;code>best_model.pth&lt;/code>&lt;/p>
&lt;p>ä¸‹è½½æ–‡ä»¶å’Œè®­ç»ƒæ¨¡åž‹éƒ½éœ€è¦èŠ±æŒºé•¿æ—¶é—´ï¼Œçœ‹åˆ°kernel busyï¼Œä¹Ÿå°±æ˜¯å³ä¸Šè§’çš„å¤§é»‘ç‚¹ä¸è¦è½»æ˜“æ‰“æ–­ã€‚&lt;/p>
&lt;p>ä»€ä¹ˆæ˜¯æ¨¡åž‹å‘¢ï¼Ÿç¨å¾®è§£é‡Šä¸€ä¸‹æœºå™¨å­¦ä¹ çš„æ¦‚å¿µã€‚&lt;/p>
&lt;p>æ¨¡åž‹å°±æ˜¯å‡½æ•°ï¼Œå…¶è¦ç´ ä¸ºè¾“å…¥ï¼Œè¾“å‡ºï¼Œå’Œå˜æ¢å…³ç³»ã€‚ä¸¾ä¾‹è¯´æ˜Žï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>æ¨¡åž‹&lt;/th>
&lt;th>è¾“å…¥&lt;/th>
&lt;th>è¾“å‡º&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>ç»†èŒå‘å…»åˆ†ç§»åŠ¨&lt;/td>
&lt;td>å¤–ç•ŒçŽ¯å¢ƒçš„åŒ–å­¦ä¿¡å·&lt;/td>
&lt;td>å‚¬åŠ¨éž­æ¯›çš„ç”µä¿¡å·&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>å­¦ç”Ÿå‚åŠ é«˜è€ƒ&lt;/td>
&lt;td>è¯•å·åå°„çš„å…‰ä¿¡å·&lt;/td>
&lt;td>è¯•å·ä¸Šé—®é¢˜çš„ç­”æ¡ˆ&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>å°è½¦è‡ªåŠ¨é¿éšœ&lt;/td>
&lt;td>æ‘„åƒå¤´ä¼ è¾“å›¾åƒä¿¡å·&lt;/td>
&lt;td>å‰æ–¹è¢«å µå¡žçš„æ¦‚çŽ‡&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>å®žé™…ä¸Šï¼ŒçŸ¥è¯†çš„æœ¬è´¨ä¹Ÿæ˜¯å‡½æ•°ï¼Œç”Ÿå‘½å»¶ç»­çš„å…³é”®å°±åœ¨äºŽè¯¥ç”Ÿå‘½çš„æ¨¡åž‹æ˜¯å¦é€‚åº”çŽ¯å¢ƒã€‚è¿™é‡Œä¸æ·±å…¥è§£é‡Šäº†ï¼Œè§‰å¾—æƒŠå¥‡è¯·å‚é˜…Yjangoçš„é¢‘é“https://space.bilibili.com/344849038ä»–ç”¨æœºå™¨å­¦ä¹ çš„è§’åº¦è§£é‡Šç”Ÿç‰©è¿›åŒ–ï¼Œéžå¸¸é¢ è¦†ä¸‰è§‚ã€‚&lt;/p>
&lt;p>æ€»ä¹‹è®­ç»ƒå‡ºæ¥çš„æ¨¡åž‹å°±æ˜¯è¿™æ ·ä¸€ä¸ªå‡½æ•°ã€‚å…¶è¾“å…¥ä¸ºç»è¿‡å¤„ç†çš„æ‘„åƒå¤´çš„å›¾å½¢ä¿¡å·ï¼Œè¾“å‡ºä¸€ä¸ª0-1çš„æ•°ï¼Œè¶ŠæŽ¥è¿‘1è¶Šæ„å‘³ç€æ¨¡åž‹è®¤ä¸ºå°è½¦è¦æ’žå¢™äº†ã€‚ä½†æ˜¯å½“ä»–å¤§äºŽ0.5çš„æ—¶å€™å°±ä¼šè§¦å‘è½¬å‘ï¼Œä¹Ÿå°±å®žçŽ°äº†è‡ªåŠ¨é¿éšœã€‚&lt;/p>
&lt;blockquote>
&lt;p>AlexNetæ˜¯2012å¹´æå‡ºçš„ä¸€ç§å·ç§¯ç¥žç»ç½‘ç»œï¼ˆå³CNNï¼‰ç®—æ³•ã€‚é¦–æ¬¡å®žçŽ°gpuåŠ é€Ÿã€‚&lt;/p>
&lt;p>ä¸»æµæ·±åº¦å­¦ä¹ æ¡†æž¶ï¼šTensorFlowï¼›PyTorchï¼›Keras&lt;/p>
&lt;/blockquote>
&lt;p>è¿˜æŒºå¥½çŽ©çš„ðŸ˜€&lt;/p>
&lt;h3 id="demo2ç›®æ ‡è¿½è¸ª">demo2ï¼šç›®æ ‡è¿½è¸ª&lt;/h3>
&lt;p>åŸºäºŽä¸Šä¸€ä¸ªdemoï¼Œæˆ‘ä»¬è¿˜è¦ä¸‹è½½ä¸€ä¸ªæ¨¡åž‹ï¼Œ&lt;a class="link" href="http://cocodataset.org/#home" target="_blank" rel="noopener"
>cocoæ•°æ®é›†&lt;/a>ç¥žç»ç½‘ç»œï¼Œå¯ä»¥æ£€æµ‹90ç§ä¸åŒçš„ç‰©ä½“ã€‚æŒ‰æ•™ç¨‹æŠŠ.engineæ–‡ä»¶ä¸‹è½½åˆ°æŒ‡å®šä½ç½®ï¼Œé¡ºç€è·‘å°±å®Œäº‹äº†ã€‚ï¼ˆå¼•å…¥æ¨¡åž‹ä¹Ÿè¦èŠ±æŒºé•¿æ—¶é—´ï¼‰&lt;/p>
&lt;p>å¦‚æžœæœ‰æ•°æ®é›†é‡Œçš„ç‰©å“ï¼Œä»Žè¾“å‡ºé‡Œèƒ½çœ‹åˆ°è“æ¡†æ ‡å‡ºï¼Œå°è½¦ä¼šè‡ªåŠ¨è½¬å‘ç‰©ä½“ï¼ŒåŒæ—¶è¿˜ä¿ç•™äº†è‡ªåŠ¨é¿éšœçš„ç¨‹åºã€‚&lt;/p>
&lt;p>é‡åˆ°bugï¼šç¨‹åºä»…èƒ½è¯»å–ä¸€å¼ å›¾åƒè¿›è¡Œè¯†åˆ«ï¼Œæ‘„åƒå¤´æ›´æ–°çš„åŠŸèƒ½æ— æ³•æ‰§è¡Œã€‚&lt;/p>
&lt;h3 id="ä¿®bugæ‘„åƒå¤´é—®é¢˜">ä¿®bugï¼šæ‘„åƒå¤´é—®é¢˜&lt;/h3>
&lt;p>æè¿°ï¼šæ‘„åƒå¤´åªè¦è°ƒç”¨äº†ä¸€æ¬¡ï¼ŒåŽé¢å°±æ— æ³•åœ¨å…¶ä»–åœ°æ–¹è°ƒç”¨ã€‚ç›´æŽ¥åœ¨jupyterä¸Šå…³é—­è¾“å‡ºå¹¶æ²¡æœ‰ä½œç”¨ã€‚è€Œä¸”åªè¦åœ¨ä¸€ä¸ªnotebooké‡Œå°±èƒ½é‡å¤è°ƒç”¨ï¼Œæ¢ä¸€ä¸ªå°±ä¸è¡Œã€‚è€Œä¸”å¹¶æ²¡æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œç¨‹åºä¸€ç›´å¤„åœ¨busyçŠ¶æ€ã€‚&lt;/p>
&lt;p>æ‰¾åˆ°æºç ï¼Œåœ¨jetbot/jetbot/camera.pyï¼Œä½†æ˜¯æ‰€æœ‰æ ·ä¾‹é‡Œé¢è°ƒç”¨æ‘„åƒå¤´éƒ½æ˜¯ç”¨çš„Camera.instance()æ–¹æ³•ï¼Œè€Œè¿™ä¸ªinstanceæ˜¯åœ¨traitletsåº“é‡Œçš„ï¼ŒäºŽæ˜¯æ‰¾åˆ°trailetså®˜æ–¹æ–‡æ¡£&lt;/p>
&lt;blockquote>
&lt;p>Traitletsæ˜¯ä¸€ä¸ªçº¯ python åº“ï¼Œæ”¯æŒï¼š&lt;/p>
&lt;ul>
&lt;li>å¯¹ python å¯¹è±¡å±žæ€§çš„å¼ºç±»åž‹å®žæ–½( ç±»åž‹å±žæ€§ç§°ä¸º &amp;ldquo;ç‰¹å¾&amp;rdquo; ) ï¼›&lt;/li>
&lt;li>åŠ¨æ€è®¡ç®—çš„é»˜è®¤å€¼ï¼›&lt;/li>
&lt;li>å½“å°è¯•æ”¹å˜æ—¶ï¼Œè‡ªåŠ¨éªŒè¯å’Œå¼ºåˆ¶ç‰¹å¾å±žæ€§ï¼›&lt;/li>
&lt;li>å½“ç‰¹å¾å€¼æ”¹å˜æ—¶æ³¨å†ŒæŽ¥æ”¶é€šçŸ¥ï¼›&lt;/li>
&lt;li>ä»Žæ–‡ä»¶æˆ–è€… å‘½ä»¤è¡Œ å‚æ•°ä¸­è¯»å–å€¼- åœ¨traitletsä¸Šä¸åŒå±‚ï¼Œå› è¿™é‡Œå¯ä»¥åœ¨æ²¡æœ‰é…ç½®æœºå™¨çš„æƒ…å†µä¸‹ä½¿ç”¨ traitletsã€‚&lt;/li>
&lt;/ul>
&lt;p>Traitletsæ”¯æŒIPythonå’ŒJupyterçš„é…ç½®ç³»ç»Ÿï¼Œä»¥åŠIPythonäº¤äº’å°éƒ¨ä»¶çš„å£°æ˜Žæ€§ APIã€‚&lt;/p>
&lt;p>ipythonæ˜¯ä¸€ä¸ª python çš„äº¤äº’å¼ shellï¼Œæ¯”é»˜è®¤çš„python shell å¥½ç”¨å¾—å¤šï¼Œæ”¯æŒå˜é‡è‡ªåŠ¨è¡¥å…¨ï¼Œè‡ªåŠ¨ç¼©è¿›ï¼Œæ”¯æŒ bash shell å‘½ä»¤ï¼Œå†…ç½®äº†è®¸å¤šå¾ˆæœ‰ç”¨çš„åŠŸèƒ½å’Œå‡½æ•°ã€‚å…¶ä¸­å°±åŒ…æ‹¬traitletsåº“ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a class="link" href="https://traitlets.readthedocs.io/en/stable/config.html" target="_blank" rel="noopener"
>https://traitlets.readthedocs.io/en/stable/config.html&lt;/a> åœ¨è¿™é‡Œæ‰¾åˆ°instanceçš„åŠŸèƒ½ï¼šè¿”å›žçŽ°æœ‰çš„ç±»ï¼Œå¦‚æžœæ²¡æœ‰å°±æ–°å»ºä¸€ä¸ªã€‚&lt;/p>
&lt;p>ä¸‹é¢æ˜¯æ ·ä¾‹ä¸­è°ƒç”¨æ‘„åƒå¤´çš„ä»£ç ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">ipywidgets.widgets&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="nn">widgets&lt;/span> &lt;span class="c1">#å›¾åƒæ¨¡å—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">IPython.display&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">display&lt;/span> &lt;span class="c1">#ipyçš„æ˜¾ç¤ºæ¨¡å—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">traitlets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">jetbot&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Camera&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">bgr8_to_jpeg&lt;/span> &lt;span class="c1">#æ‘„åƒå¤´é©±åŠ¨ï¼Œå›¾åƒæ ¼å¼è½¬æ¢&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">camera&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Camera&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">instance&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">width&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">500&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">height&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">500&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#åˆå§‹åŒ–æ‘„åƒå¤´å¯¹è±¡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">image&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">widgets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Image&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">format&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;jpeg&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">width&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">400&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">height&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">400&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#åˆ›å»ºå›¾åƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">camera_link&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">traitlets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">dlink&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">camera&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;value&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">image&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;value&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">transform&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">bgr8_to_jpeg&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#è¿žæŽ¥æ‘„åƒå¤´åˆ°å›¾åƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">display&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">image&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#æ˜¾ç¤ºå›¾åƒ&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å°è¯•ä»Žcamera.pyé‡Œè°ƒç”¨åŽŸå§‹apiã€‚å¾—åˆ°æŠ¥é”™ï¼š&lt;code>Each object must be HasTraits, not &amp;lt;class 'NoneType'&amp;gt;&lt;/code>ï¼Œæ˜¯è¯´å¿…é¡»ä¸ºå¯¹è±¡æŒ‡å®šç±»åž‹ã€‚é‚£ä¹ˆHasTraitsè¿™ä¸ªç±»åž‹æ˜¯å•¥ï¼Ÿæ–‡æ¡£è¯´:ä»»ä½•å…·æœ‰traitå±žæ€§çš„ç±»éƒ½å¿…é¡»ä»Ž &lt;code>HasTraits&lt;/code> ç»§æ‰¿ã€‚&lt;/p>
&lt;p>å†æ¬¡æ¢³ç†è°ƒç”¨æ‘„åƒå¤´çš„æµç¨‹ï¼š&lt;/p>
&lt;ul>
&lt;li>å¼•å…¥æ¨¡åž‹ï¼š&lt;code>model.load_state_dict(torch.load('best_model.pth'))&lt;/code>&lt;/li>
&lt;li>è¿žæŽ¥æ‘„åƒå¤´ï¼šè§ä¸Šæ–‡&lt;/li>
&lt;li>æ¨¡åž‹æ‰§è¡Œï¼š&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">update&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span>&lt;span class="c1">#æ­¤å¤„ä¸ºæ¨¡åž‹æ‰§è¡Œå‡½æ•°ï¼Œå°†è¾“å…¥å›¾åƒé¢„å¤„ç†åŽï¼Œæ‰§è¡Œæ¨¡åž‹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">update&lt;/span>&lt;span class="p">({&lt;/span>&lt;span class="s1">&amp;#39;new&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">camera&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">})&lt;/span> &lt;span class="c1">#åˆå§‹åŒ–è¯¥å‡½æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">camera&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">observe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">update&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">names&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;value&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#å°†updateå‡½æ•°è®¾ä¸ºcamera.valueçš„observer&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç ”ç©¶ä¸€ä¸‹observeç”¨æ³•ï¼šå½“å¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨å‡½æ•°ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://traitlets.readthedocs.io/en/stable/using_traitlets.html#validation" target="_blank" rel="noopener"
>https://traitlets.readthedocs.io/en/stable/using_traitlets.html#validation&lt;/a>&lt;/p>
&lt;p>æ‰§è¡Œå¦‚ä¸‹ä»£ç ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">ipywidgets.widgets&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="nn">widgets&lt;/span> &lt;span class="c1">#å›¾åƒæ¨¡å—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">IPython.display&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">display&lt;/span> &lt;span class="c1">#ipyçš„æ˜¾ç¤ºæ¨¡å—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">traitlets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">jetbot&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Camera&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">bgr8_to_jpeg&lt;/span> &lt;span class="c1">#æ‘„åƒå¤´é©±åŠ¨ï¼Œå›¾åƒæ ¼å¼è½¬æ¢&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">camera&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Camera&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">instance&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">width&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">500&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">height&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">500&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#åˆå§‹åŒ–æ‘„åƒå¤´å¯¹è±¡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">update&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">change&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">change&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;new&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">display&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#æ˜¾ç¤ºå›¾åƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">update&lt;/span>&lt;span class="p">({&lt;/span>&lt;span class="s1">&amp;#39;new&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">camera&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">camera&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">observe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">update&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">names&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;value&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¾“å‡ºä¸€å¤§å †æ•°ç»„ï¼Œè¯´æ˜Žcamera.valueæ˜¯è¿™ä¸€å¤§å †åƒç´ ã€‚è€Œä¸”observeæ­£å¸¸è¿è¡Œï¼Œæ•°æ®ä¸€ç›´å†’å‡ºã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">array([[[122, 116, 130],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [126, 113, 127],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [125, 117, 129],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [ 84, 96, 107],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [ 82, 96, 113],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [ 93, 93, 113]],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [[120, 119, 130],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [122, 120, 119],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [118, 123, 130],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...,
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç„¶è€Œå°±æ˜¯ä¸å®žæ—¶æ›´æ–°æ•°æ®ï¼Œå’ã€‚&lt;/p>
&lt;p>ðŸ‘´ä½›äº†ã€‚&lt;/p>
&lt;h3 id="ç¥žç»ç½‘ç»œç¬”è®°">ç¥žç»ç½‘ç»œç¬”è®°&lt;/h3>
&lt;h3 id="alexnetcnn">AlexNetâ€”â€”CNN&lt;/h3>
&lt;p>2012å¹´ç”±Hintonå­¦ç”ŸAlexæå‡ºï¼Œæ˜¯LenetåŠ å®½ç‰ˆã€‚å…¶é‡‡ç”¨äº†ä¸€ç³»åˆ—çš„æ–°æŠ€æœ¯ï¼šæˆåŠŸçš„å¼•ç”¨äº†reluã€dropoutå’Œlrnç­‰trickï¼Œé¦–æ¬¡é‡‡ç”¨gpuåŠ é€Ÿã€‚å…¶åŒ…å«65ä¸‡ç¥žç»å…ƒï¼Œ5ä¸ªå·ç§¯å±‚ï¼Œä¸‰ä¸ªåŽé¢å¸¦æœ‰æ± åŒ–å±‚ï¼Œæœ€åŽç”¨äº†ä¸‰ä¸ªå…¨é“¾æŽ¥ã€‚&lt;/p></description></item><item><title>å•ç‰‡æœºå…¥é—¨â€”â€”jetbotæ™ºèƒ½å°è½¦å°é²œ(ä¸€)</title><link>https://lonelyuan.github.io/p/%E5%8D%95%E7%89%87%E6%9C%BA%E5%85%A5%E9%97%A8jetbot%E6%99%BA%E8%83%BD%E5%B0%8F%E8%BD%A6%E5%B0%9D%E9%B2%9C%E4%B8%80/</link><pubDate>Fri, 20 Sep 2019 00:25:55 +0000</pubDate><guid>https://lonelyuan.github.io/p/%E5%8D%95%E7%89%87%E6%9C%BA%E5%85%A5%E9%97%A8jetbot%E6%99%BA%E8%83%BD%E5%B0%8F%E8%BD%A6%E5%B0%9D%E9%B2%9C%E4%B8%80/</guid><description>&lt;p>é‚£ä¸ªç”·å­©ä¸æƒ³çŽ©æ ‘èŽ“æ´¾å‘¢ï¼Ÿæœºç¼˜å·§åˆä¹‹ä¸‹ï¼Œæˆ‘å¾—åˆ°äº†ä¸€å°ä»·å€¼ä¸Šç™¾ç¾Žå…ƒçš„æ™ºèƒ½å°è½¦çš„ä½¿ç”¨æƒã€‚&lt;/p>
&lt;p>å°è½¦çš„æ ¸å¿ƒæ˜¯NVIDIAå®¶çš„jetson-nanoå¼€å‘æ¿ï¼Œè¿™æ¬¾19å¹´ä¸‰æœˆæ‰å‘å¸ƒçš„å¾®åž‹AIè®¡ç®—æœºå¯è°“æ˜¯å¹³æ°‘çº§æ ¸å¼¹ï¼Œå››æ ¸A57çš„CPUï¼Œ128æ ¸å¿ƒMaxwellæž¶æž„çš„GPUï¼Œ4gå†…å­˜ï¼Œæ”¯æŒ4kè§†é¢‘è§£ç ï¼Œè€Œä¸”è¿™åªäº”è„ä¿±å…¨çš„éº»é›€åªéœ€è¦5Wçš„ç”µæºæ”¯æŒï¼Œä»»ä½•ä¸€æ”¯å……ç”µå®éƒ½å¯ä»¥èƒœä»»ã€‚è€Œå®ƒçš„å®šä½æ˜¯ç”¨å®ƒç®€å•çš„æ­å»ºäººå·¥æ™ºèƒ½åº”ç”¨ï¼Œéžå¸¸çš„amazingã€‚&lt;/p>
&lt;p>æœ¬æ–‡çš„ç›®çš„,ä¸å®Œå…¨æ˜¯æ–°æ‰‹æ•™ç¨‹,è¿˜æœ‰è‡ªå·±å­¦ä¹ è¿‡ç¨‹çš„è®°å½•å’Œåˆ†äº«.åˆæ¬¡æŽ¥è§¦,å¤šæœ‰ç–æ¼,æ¬¢è¿ŽæŒ‡æ•™.&lt;/p>
&lt;p>ã€å›¾ç‰‡ï¼šä¸»æ¿è¯ä»¶ç…§ã€‘&lt;/p>
&lt;blockquote>
&lt;p>ç»™èŒæ–°ç†æ¸…å‡ ä¸ªæ¦‚å¿µï¼š&lt;/p>
&lt;p>å•ç‰‡æœºï¼šSingle-Chip Microcomputerã€‚&lt;/p>
&lt;p>æ ‘èŽ“æ´¾ï¼šä¸€æ¬¾è‘—åçš„å¾®åž‹ç”µè„‘å“ç‰Œï¼ˆæœ¬æ–‡ä»‹ç»çš„jetson-nanoå¯ä»¥ç†è§£ä¸ºæ˜¯æ ‘èŽ“æ´¾çš„ç«žå“ï¼Œç›¸æ¯”æ ‘èŽ“æ´¾ï¼Œè¿™æ¬¾å•ç‰‡æœºä»·æ ¼æ›´é«˜ï¼Œæ€§èƒ½æ›´å¥½ï¼Œä¸»æ‰“AIåº”ç”¨ï¼‰&lt;/p>
&lt;p>jetbotï¼šä»¥jetson-nanoä¸ºå¹³å°æ­å»ºçš„aiæœºå™¨äººåº”ç”¨ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“æ™ºèƒ½å°è½¦&lt;/p>
&lt;/blockquote>
&lt;h3 id="ç¡¬ä»¶ç»„è£…ç§¯æœ¨å’Œç”µå·¥">ç¡¬ä»¶ç»„è£…:ç§¯æœ¨å’Œç”µå·¥&lt;/h3>
&lt;p>æœ¬äººæ‹¿åˆ°çš„æ˜¯é›¶ä»¶çŠ¶æ€çš„å°è½¦ï¼Œæ‰€ä»¥é¦–å…ˆè®²ä¸€è®²ç»„è£…çš„é—®é¢˜ã€‚æœ‰å…³å…·ä½“æ­¥éª¤ï¼Œå®˜ç½‘æ•™ç¨‹ååˆ†è¯¦ç»†ï¼Œè´´ä¸ªè¿žæŽ¥ç»™æ‡’äººå§ï¼šhttps://www.ncnynl.com/archives/201904/2927.html&lt;/p>
&lt;p>è¿™é‡Œåªè®²ä¸€è®²æˆ‘ä½œä¸ºåˆå­¦è€…çš„ä¸€äº›ç†è§£ã€‚é¦–å…ˆï¼ŒçŽ©å•ç‰‡æœºå’ŒçŽ©ç§¯æœ¨çš„åŒºåˆ«å°±åœ¨äºŽç¼–ç¨‹ã€‚å½“ç„¶ï¼Œå…¥é—¨å•ç‰‡æœºè¿˜éœ€è¦å…¶ä»–æŠ€èƒ½ã€‚æ¯”å¦‚ï¼Œç”µå·¥æŠ€èƒ½ï¼šä½ éœ€è¦è¿›è¡Œçº¿æçš„ç®€å•åŠ å·¥ï¼Œå¼•è„šçš„ç„ŠæŽ¥ï¼Œå‡†å¤‡åŸºæœ¬çš„å·¥å…·å°±å¥½ï¼Œæ¯•ç«Ÿé‚£ä¸ªç”·å­©æ²¡æœ‰ä¸€æ ¹çƒ­çƒ­çš„æ£’å­å‘¢ï¼ˆæŒ‡&lt;strong>ç”µçƒ™é“&lt;/strong>ï¼‰ã€‚ç„¶åŽï¼Œå„ä¸ªéƒ¨ä»¶çš„æ‹¼æŽ¥å›ºå®šéœ€è¦ä¸€äº›åšæ‰‹å·¥çš„æŠ€å·§ï¼Œè¿™ä¸ªä¹Ÿä¸ç”¨æ€•ï¼Œèµ«é²æ™“å¤«æ›¾ç»è¯´è¿‡ï¼š&lt;strong>çƒ­ç†”èƒ¶&lt;/strong>å¯ä»¥è®©æˆ‘ä»¬åˆ›é€ å¥‡è¿¹ã€‚&lt;/p>
&lt;p>åœ¨è¿™ä¸ªå±‚é¢ä¸Šï¼Œåˆå­¦è€…ä¼šæµªè´¹è®¸å¤šè€—æï¼Œè¿™æ˜¯å¿…è¦çš„ç»ƒä¹ æ‰‹æ®µï¼Œæ‰€ä»¥åˆå­¦è€…ä¹Ÿå¯ä»¥ä»Žæœ€ç®€å•çš„èŠ¯ç‰‡å…¥æ‰‹ã€‚åŒæ—¶ä½ è¿˜è¦å­¦ä¹ è¯Šæ–­ç¡¬ä»¶æ–¹é¢çš„é—®é¢˜ï¼Œ&lt;strong>ä¸‡ç”¨è¡¨&lt;/strong>ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚å…³äºŽæ›´è¯¦ç»†çš„å·¥å…·å’Œè€—æçš„éœ€è¦ï¼Œè¯·è‡ªè¡ŒæŸ¥é˜…å•ç‰‡æœºå…¥é—¨æœ‰å…³èµ„æ–™ã€‚&lt;/p>
&lt;p>åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œç„ŠæŽ¥å·¥ä½œå·²ç»å®Œæˆï¼Œå‰©ä¸‹çš„è¿žæŽ¥éƒ½æ˜¯å¯æ’æ‹”å¼çš„ã€‚æˆ‘ä»¬åªéœ€è¦ä¸¤æŠŠèžºä¸åˆ€å³å¯å®Œæˆç»„è£…ã€‚å³ä¾¿å¦‚æ­¤ï¼Œæœ¬äººè¿˜æ˜¯èŠ±äº†ä¸€æ™šä¸Šæ‰æŠŠå°è½¦ç‚¹äº®ï¼ŒåŽŸå› æ˜¯æˆ‘å¾—åˆ°çš„çº¿ææŸåè¿‘åŠï¼Œåªå¾—è‡ªå·±å¯»æ‰¾å’Œä¿®ç†ã€‚&lt;/p>
&lt;p>ä¸‹é¢åˆ†æžä¸€ä¸‹å°è½¦çš„ç»“æž„:&lt;/p>
&lt;ul>
&lt;li>jetson-nanoå¼€å‘æ¿:å³æœ¬æœºçš„ä¸»æ¿,å¯ä»¥çœ‹åˆ°æœ‰ä¸¤å±‚èŠ¯ç‰‡,ä¸Šå±‚ä¸ºæ ¸å¿ƒå±‚,åŒ…æ‹¬cpu,gpuå’Œå†…å­˜å¯ä»¥åƒç¬”è®°æœ¬å†…å­˜æ¡ä¸€æ ·æ‹†å¸;ä¸‹å±‚ä¸ºä¸»æ¿,ç”¨äºŽè¿žæŽ¥å„ç§è®¾å¤‡&lt;/li>
&lt;li>intelæ— çº¿ç½‘å¡:å°†ä¸Šå±‚æ‹†ä¸‹å³å¯å®‰è£….ä»¤è¿žå‡ºä¸¤æ ¹å¤©çº¿,ç¼ ç»•æœºèº«å³å¯.&lt;/li>
&lt;li>PiOLEDæ˜¾ç¤ºå™¨å’Œæ‹“å±•ç‰ˆ:è¿žæŽ¥åœ¨I2Cä¸»çº¿ä¸Š&lt;/li>
&lt;li>ç›¸æœºæ¨¡å—:å®˜æ–¹æ ·ä¾‹å±•ç¤ºäº†åªç”¨ä¸€ä¸ªæ‘„åƒå¤´é€šè¿‡æ·±åº¦å­¦ä¹ è¿›è¡Œè‡ªåŠ¨é¿éšœçš„demo.&lt;/li>
&lt;li>é©¬è¾¾å’Œå…¶é©±åŠ¨æ¿:ä¸‹æ–‡é‡ç‚¹è®²è§£&lt;/li>
&lt;/ul>
&lt;p>å¼€å‘æ¿å°±å¯ä»¥è¿è¡Œä¸€ä¸ªå®Œæ•´çš„Ubuntuç³»ç»Ÿ,å…¶ä½™è®¾å¤‡æ˜¯ä¸ºå…¶æ‹“å±•åŠŸèƒ½çš„.&lt;/p>
&lt;h3 id="ç¡¬ä»¶æž¶æž„é©±åŠ¨èŠ¯ç‰‡å’Œi2cä¸»çº¿">ç¡¬ä»¶æž¶æž„ï¼šé©±åŠ¨èŠ¯ç‰‡å’ŒI2Cä¸»çº¿&lt;/h3>
&lt;p>æˆ‘åœ¨çŽ©å°è½¦çš„è¿‡ç¨‹ä¸­è€½è¯¯æœ€é•¿æ—¶é—´çš„å°±æ˜¯ç”µæœºï¼ˆå³é©¬è¾¾ï¼‰é©±åŠ¨äº†ï¼Œå€Ÿæ­¤è®²ä¸€è®²ç³»ç»Ÿæž¶æž„çš„äº‹ã€‚&lt;/p>
&lt;p>è®©è½®å­å‰è¿›è¦é é©¬è¾¾ï¼Œç»™é©¬è¾¾ä¾›ç”µä¸èƒ½ç›´æŽ¥è®©ä¸»æ¿æ¥åšï¼Œè¦è®©ä¸»æ¿ç»™å¦ä¸€å—å°èŠ¯ç‰‡å‘é€æŒ‡ä»¤ï¼Œè¿™å—å°èŠ¯ç‰‡è¿žæŽ¥ç€ç‹¬ç«‹çš„ç”µæºï¼Œæ”¶åˆ°æŒ‡ä»¤æ‰ä¼šç»™é©¬è¾¾é€šç”µã€‚è¿™å—å°èŠ¯ç‰‡å³æ˜¯ç”µæœºé©±åŠ¨æ¿ã€‚&lt;/p>
&lt;p>é©±åŠ¨èŠ¯ç‰‡æ˜¯ä»Žç¡¬ä»¶èµ°å‘è½¯ä»¶çš„ç¬¬ä¸€é“æ¡¥æ¢ï¼Œå¯ä»¥ç±»æ¯”PCçš„IOè®¾å¤‡æ¥ç†è§£ã€‚å’Œç‰©ç†ä¸–ç•Œäº¤äº’çš„å„ç§åŠŸèƒ½ï¼Œéƒ½éœ€è¦æœ‰ä¸“é—¨çš„é©±åŠ¨èŠ¯ç‰‡ã€‚åŒ…æ‹¬é©¬è¾¾ï¼Œæ‘„åƒå¤´ï¼Œæ‰¬å£°å™¨ï¼Œæœºæ¢°è‡‚ç­‰ç­‰ï¼Œåªä¸è¿‡æœ‰çš„å¯ä»¥é›†æˆåœ¨ä¸€èµ·ï¼Œå¦‚ï¼šå°è½¦ä¸Šçš„æ‘„åƒå¤´ï¼ŒPiOLEDæ˜¾ç¤ºå™¨ç­‰ï¼›æœ‰çš„å‡ºäºŽä½“ç§¯ï¼Œå®‰å…¨æ€§ï¼Œæ¨¡å—åŒ–çš„è€ƒè™‘éœ€è¦åˆ†å¼€ï¼Œå¦‚ç”µæœºå’Œé©±åŠ¨æ¿ã€‚&lt;/p>
&lt;h4 id="ç”µæœºé©±åŠ¨æ¿">ç”µæœºé©±åŠ¨æ¿&lt;/h4>
&lt;p>å®˜æ–¹ç»™å‡ºçš„ç”µæœºé©±åŠ¨æ¿åž‹å·ä¸º:DC-Stepper-Motor PCA9685+TB6612.å¯ä»¥é©±åŠ¨ä¸¤ä¸ªæ­¥è¿›ç”µæœºæˆ–å››ä¸ªç›´æµç”µæœºã€‚ï¼ˆå››è½´é£žè¡Œå™¨gkdï¼‰æœ¬é¡¹ç›®åªç”¨åˆ°äº†ä¸¤ä¸ªç›´æµç”µæœºã€‚&lt;/p>
&lt;p>å„ä¸ªå¼•è„šçš„è®²è§£ï¼šhttps://learn.adafruit.com/adafruit-stepper-dc-motor-featherwing/pinouts&lt;/p>
&lt;p>ç”µæœºé©±åŠ¨æ¿ä¸Šå…±è¿žæŽ¥æœ‰10æ ¹è·³çº¿ã€‚ä¸€å¯¹ç”µæºè¾“å…¥ï¼Œä¸¤å¯¹ä¸ºé©¬è¾¾è¾“å‡ºã€‚è¿˜éœ€å››æ ¹æ¯-æ¯æœé‚¦çº¿æ¥è¿žæŽ¥è‡³ä¸»æ¿çš„&lt;strong>I2Cæ€»çº¿&lt;/strong>,å…·ä½“æ¥è¯´,æ˜¯åœ¨LEDå±æ—è¾¹çš„æ‹“å±•æ¿ã€‚åˆ†åˆ«æ˜¯ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:center">é©±åŠ¨æ¿å¼•è„š&lt;/th>
&lt;th style="text-align:center">ä¸»æ¿I2Cå¼•è„š&lt;/th>
&lt;th style="text-align:center">åŠŸèƒ½&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:center">3V3&lt;/td>
&lt;td style="text-align:center">3V3&lt;/td>
&lt;td style="text-align:center">ä¸ºé©±åŠ¨æ¿ä¾›ç”µ,å³ç”µæºæ­£æž&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">GND&lt;/td>
&lt;td style="text-align:center">GND&lt;/td>
&lt;td style="text-align:center">æŽ¥åœ°,å³ç”µæºè´Ÿæž&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">SDA&lt;/td>
&lt;td style="text-align:center">3&lt;/td>
&lt;td style="text-align:center">ä¸²è¡Œæ•°æ®çº¿ï¼Œä¼ è¾“æ•°æ®&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">SCL&lt;/td>
&lt;td style="text-align:center">5&lt;/td>
&lt;td style="text-align:center">ä¸²è¡Œæ—¶é’Ÿçº¿ï¼Œä¼ è¾“æŽ§åˆ¶ä¿¡å·&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>ã€å›¾ç‰‡ï¼šé©±åŠ¨æ¿å¼•è„šã€‘&lt;/p>
&lt;p>æŽ¥é”™äº†æœ‰å¯èƒ½çƒ§åæ¿å­å“¦&lt;/p>
&lt;h4 id="i2cæ€»çº¿">I2Cæ€»çº¿&lt;/h4>
&lt;p>æ‰€è°“æ€»çº¿,å¯ä»¥ç†è§£ä¸ºä¸€æ¡è¡—é“,æ¯ä¸ªè®¾å¤‡å°±æ˜¯è¡—é“ä¸¤æ—çš„æˆ¿å­,æˆ¿å†…çš„ä½æˆ·å‡ºé—¨èµ°äº²è®¿å‹å°±æ˜¯æ•°æ®åœ¨ä¸åŒè®¾å¤‡é—´çš„ä¼ è¾“ã€‚&lt;/p>
&lt;p>I2Cæ€»çº¿æ˜¯å¸¸ç”¨äºŽåµŒå…¥å¼ç³»ç»Ÿçš„ä¸€ç§ç®€æ˜“ä¸²è¡Œæ€»çº¿.ä»–æœ‰ç®€æ´çš„åŒçº¿ç»“æž„(SCL+SDA),æ¯ä¸ªè®¾å¤‡éƒ½æœ‰ä¸€ä¸ªåœ°å€ç ,ä»¥æ­¤å®žçŽ°å¤šä¸ªè®¾å¤‡ç›¸äº’é€šè®¯ã€‚è®¾å¤‡æœ‰ä¸»ä»Žä¹‹åˆ†ï¼Œä¸»è®¾å¤‡/ä¸»ç«¯å¿…é¡»æ˜¯å¸¦æœ‰CPUçš„é€»è¾‘æ¨¡å—ï¼Œåœ¨åŒä¸€æ€»çº¿ä¸ŠåŒä¸€æ—¶åˆ»ä½¿èƒ½æœ‰ä¸€ä¸ªä¸»ç«¯ï¼Œå¯ä»¥æœ‰å¤šä¸ªä»Žç«¯ï¼Œä»Žç«¯çš„æ•°é‡å—åœ°å€ç©ºé—´å’Œæ€»çº¿çš„æœ€å¤§ç”µå®¹ 400pFçš„é™åˆ¶ã€‚&lt;/p>
&lt;p>å¯ä»¥ä½¿ç”¨i2c-toolsè°ƒè¯•i2cæ€»çº¿:&lt;/p>
&lt;ul>
&lt;li>æ£€æµ‹æœ‰å‡ ç»„i2cæ€»çº¿åœ¨ç³»ç»Ÿä¸Š&lt;code>i2cdetect -l&lt;/code>&lt;/li>
&lt;li>æ£€æµ‹æŒ‚è½½åœ¨i2c-1ä¸Šçš„è®¾å¤‡&lt;code>i2cdetect -r -y 1&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> 0 1 2 3 4 5 6 7 8 9 a b c d e f
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 00: -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 30: -- -- -- -- -- -- -- -- -- -- -- -- 3c -- -- --ï¼ˆledï¼‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 60: 60 -- -- -- -- -- -- -- -- -- -- -- -- -- -- --ï¼ˆç”µæœºé©±åŠ¨ï¼‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 70: 70 -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>
&lt;p>æŸ¥çœ‹è®¾å¤‡(åœ°å€ä¸º0x20)ä¸Šæ‰€æœ‰å¯„å­˜å™¨çš„å€¼i2cdump -f -y 1 0x20&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¯¹å•ä¸ªå¯„å­˜å™¨è¿›è¡Œè¯»å†™:&lt;/p>
&lt;p>&lt;code>i2cset -f -y 1 0x20 0x77 0x3f &lt;/code>ï¼ˆè®¾ç½®i2c-1ä¸Š0x20å™¨ä»¶çš„0x77å¯„å­˜å™¨å€¼ä¸º0x3fï¼‰&lt;/p>
&lt;p>&lt;code>i2cget -f -y 1 0x20 0x77 &lt;/code> ï¼ˆè¯»å–i2c-1ä¸Š0x20å™¨ä»¶çš„0x77å¯„å­˜å™¨å€¼ï¼‰&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>jetson-nanoå¼€å‘æ¿æä¾›äº†6æ¡I2Cä¸»çº¿,ä»¥åŠå…¶ä»–ä¸°å¯Œçš„æŽ¥å£ã€‚ç†è§£è¿™äº›æŽ¥å£æ˜¯æ‹“å±•å„ç§è®¾å¤‡çš„å‰æã€‚&lt;/p>
&lt;h3 id="è½¯ä»¶è¿žæŽ¥sshè¿œç¨‹æ¡Œé¢">è½¯ä»¶è¿žæŽ¥:sshè¿œç¨‹æ¡Œé¢&lt;/h3>
&lt;p>ä»Žå¤´å¼€å§‹çš„è¯ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¾€sdå¡é‡Œçƒ§å†™ç³»ç»Ÿé•œåƒï¼Œä¸è¿‡æˆ‘æ‹¿åˆ°çš„å·²ç»å®Œæˆäº†è¿™ä¸€æ­¥éª¤ï¼Œæ•…ä¸å†èµ˜è¿°ã€‚&lt;/p>
&lt;p>åœ¨å®˜æ–¹æ•™ç¨‹ä¸­,éœ€è¦hdmiçº¿è¿žæŽ¥æ˜¾ç¤ºå±,usbè¿žæŽ¥é¼ æ ‡é”®ç›˜,æ¥è¿›å…¥jetson-nanoçš„Ubuntuç³»ç»Ÿ.å…¶ç›®çš„åœ¨äºŽé¦–æ¬¡è¿žæŽ¥ä¸€ä¸ªæ— çº¿ç½‘ç»œ(æ‰‹æœºçƒ­ç‚¹),ä¹‹åŽåªè¦ç”µè„‘å’Œnanoåœ¨åŒä¸€ç½‘ç»œ,å³å¯ç”¨ç”µè„‘è®¿é—®nanoçš„IP(8888ç«¯å£),ç›´æŽ¥æ“çºµjetbot.&lt;/p>
&lt;p>ç”±äºŽæˆ‘å¹¶æ²¡æœ‰hdmiçº¿,åªæœ‰ä¸€æ ¹ç½‘çº¿,åæ­£éƒ½èƒ½æ’,æ’è°ä¸ä¸€æ ·?æ‰€ä»¥ç”¨ç½‘çº¿æŠŠå°è½¦å’Œç¬”è®°æœ¬è¿žæŽ¥èµ·æ¥ç»„æˆå±€åŸŸç½‘.ç”¨sshçš„æ–¹å¼è¿›å…¥nanoçš„ç³»ç»Ÿ.å…·ä½“æ­¥éª¤å¦‚ä¸‹:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ipå‘çŽ°:åœ¨æ’å…¥ç½‘çº¿å‰åŽæ‰§è¡Œä¸¤æ¬¡:&lt;code>arp -a&lt;/code>,æ¯”è¾ƒä¸åŒ,ä¼šå‘çŽ°å¤šå‡ºä¸€ä¸ªåœ°å€,ç±»åž‹ä¸ºåŠ¨æ€,æ­¤å³ä¸ºå°è½¦çš„å†…ç½‘IP.å°è½¦çš„ledå±ä¹Ÿä¼šè‡ªåŠ¨æ˜¾ç¤ºå…¶ip.å¦‚&lt;code>eth0:192.168.x.x&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>(å¦‚æ­¤,æˆ‘ä»¬å¯ä»¥ç›´æŽ¥ä»Žæµè§ˆå™¨è®¿é—®è¿™ä¸ªipçš„8888ç«¯å£,å¹¶èƒ½è¿è¡Œjupyter notebookäº†.ä½†æˆ‘ä»¬ä¸èƒ½è®©å°è½¦æ‹–ç€ç½‘çº¿è·‘å•Š,æ‰€ä»¥è¿˜æ˜¯è¦é…ç½®æ— çº¿ç½‘ç»œ.)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å°†ç¬”è®°æœ¬çš„wifiè¿žæŽ¥è®¾ä¸ºå¯¹ä»¥å¤ªç½‘å¯å…±äº«,è¿™ä¸€æ­¥æ˜¯ä¸ºäº†è®©å°è½¦èƒ½é€šè¿‡ç¬”è®°æœ¬è”ç½‘&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç«¯å£æ‰«æ:&lt;code>nmap -sT 192.168.x.x&lt;/code>å‘çŽ°22ç«¯å£å¼€æ”¾,æ•…è¿žæŽ¥ä¹‹:&lt;code>ssh jetbot@192.168.x.x&lt;/code>,å°±ç”¨å®˜æ–¹æ•™ç¨‹ç»™çš„è´¦æˆ·å¯†ç .&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¿žæŽ¥æˆåŠŸåŽ,å°±å¯ä»¥ç”¨å‘½ä»¤è¡Œå·¥å…·è¿žæŽ¥WiFiäº†,ä½†è¿˜æ˜¯å®‰è£…ä¸€ä¸‹è¿œç¨‹æ¡Œé¢å§.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é…ç½®è¿œç¨‹æ¡Œé¢:æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo apt-get install tightvncserver
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get install xrdp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get install vnc4server tightvncserver
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>ä¹‹åŽåœ¨ä½ çš„ä¸»æœºwin+Rï¼Œè¾“å…¥mstsc,è¿›å…¥è¿œç¨‹ç™»å½•æ¡Œé¢ï¼Œè¾“å…¥å°è½¦çš„ipåœ°å€ï¼Œç‚¹å‡»è¿žæŽ¥&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åœ¨xrdpçš„ç™»é™†ç•Œé¢è¾“å…¥ç”¨æˆ·åå¯†ç å³å¯æ‰“å¼€è¿œç¨‹æ¡Œé¢&lt;/p>
&lt;p>(è¿™é‡Œæˆ‘ç”¨jetbotç”¨æˆ·ç™»é™†é­é‡é—ªé€€,ç”¨rootå°±å¯ä»¥,ä¸æ¸…æ¥šåŽŸå› )(å¦å¤–å¼€äº†è¿œç¨‹æ¡Œé¢å†…å­˜ç–¯æ¶¨,å°±å¾ˆç¦»è°±)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¿žæŽ¥ä¸ŠwifiåŽ,ä½ èƒ½åœ¨å°è½¦çš„ledæ¿ä¸Šçœ‹åˆ°å¦ä¸€ä¸ªip:&lt;code>wlan0:192.168.x.x&lt;/code>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>ä¸ç®¡æ€Žæ ·,è¿žæŽ¥ä¸Šwifiä¹‹åŽçš„æ“ä½œå°±å¾ˆç®€å•äº†.è·Ÿç€æ•™ç¨‹,è·‘ä¸€è·‘demo,è¿˜æ˜¯å¾ˆæœ‰æˆå°±æ„Ÿçš„.&lt;/p>
&lt;h3 id="æŽ’æŸ¥bug">æŽ’æŸ¥bug&lt;/h3>
&lt;p>ç„¶è€Œdemoå¹¶æ²¡æœ‰è®©æˆ‘è·‘å‡ºæ¥,ä¸”æŒ‡å‘åŒä¸€ä¸ªé”™è¯¯:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">OSError: [Errno 121] Remote I/O error
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ²¿ç€jupyter notebookçš„æŠ¥é”™ä¸€ç›´èµ°,ä¸€ç›´åˆ°äº†æœ€åº•å±‚,å‘è®¾å¤‡å†™å…¥æ•°æ®æŠ¥é”™,&lt;code>remote IO error&lt;/code>.&lt;/p>
&lt;p>çœ‹èµ·æ¥åƒæ˜¯ç¡¬ä»¶çš„é—®é¢˜ã€‚ä¸€æ­¥ä¸€æ­¥æŽ’æŸ¥å‘—&lt;/p>
&lt;ul>
&lt;li>
&lt;p>æ€€ç–‘è·³çº¿é”™è¯¯&lt;/p>
&lt;ul>
&lt;li>æ›´æ¢è·³çº¿â€”â€”æ— æžœ&lt;/li>
&lt;li>ç”¨ä¸‡ç”¨è¡¨æµ‹é‡çº¿ä¸¤ç«¯çš„ä¿¡å·â€”â€”æ­£å¸¸ï¼ŒæŽ’é™¤è¿žæŽ¥é—®é¢˜
&lt;ul>
&lt;li>æ—¶é’Ÿçº¿ä¿æŒ3.3væ¯éš”å‡ ç§’è·³åˆ°2.2våˆå›žæ¥ï¼Œç»“åˆi2cçš„åŽŸç†åº”è¯¥æ˜¯æ­£å¸¸çŽ°è±¡ï¼Ÿ&lt;/li>
&lt;li>æ•°æ®çº¿åŒæ ·ä¿æŒ3.3vï¼Œé—´æ–­è·³è‡³2.3ï¼Œ2.0&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>è½¯ä»¶æ–¹æ³•æ£€éªŒè®¾å¤‡è¿žæŽ¥æ€§&lt;/p>
&lt;ul>
&lt;li>ç”¨i2ctoolså¯ä»¥æ£€æµ‹åˆ°è®¾å¤‡ï¼Œæ‹”ä¸‹4æ ¹æŽ¥çº¿ï¼Œåœ¨0x60,0x70å¤„çš„è®¾å¤‡æ¶ˆå¤±ï¼ˆä¸€ä¸ªæ˜¯i2cçº¿ï¼Œä¸€ä¸ªæ˜¯é€»è¾‘ä¾›ç”µï¼Ÿï¼‰&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> 0 1 2 3 4 5 6 7 8 9 a b c d e f
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">00: -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">30: -- -- -- -- -- -- -- -- -- -- -- -- 3c -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">70: -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;p>ç„¶è€Œï¼Œåœ¨é€šç”µçŠ¶æ€ä¸‹ï¼ŒæŠŠè¿žçº¿æ‹”ä¸‹åˆæ’ä¸Šä¹‹åŽï¼Œi2cåˆèƒ½æ£€æµ‹åˆ°è®¾å¤‡ï¼Œç„¶åŽç¤ºä¾‹ä»£ç å°±èƒ½è¿è¡Œäº†ï¼Ÿï¼Ÿï¼Ÿ&lt;/p>
&lt;p>è¿·æƒ‘ã€‚æ‰€ä»¥å¼€æœºæ—¶æœºå™¨å¹¶æ²¡èƒ½æ­£ç¡®è½½å…¥è®¾å¤‡ï¼Œåå€’æ˜¯é‡æ–°è¿žæŽ¥åŽèƒ½è¯†åˆ«äº†ï¼Ÿï¼Ÿï¼Ÿæœ¬æ¥æˆ‘éƒ½è¦æ¢é©±åŠ¨æ¿äº†ï¼Œorzã€‚&lt;/p>
&lt;p>åˆæˆ–è€…æ˜¯å’Œé©±åŠ¨æ¿ä¸Šçš„resetæŒ‰é’®æœ‰å…³ï¼Ÿç­‰ä¸‹æ¬¡é‡åˆ°é—®é¢˜å†è¯´å§ã€‚&lt;/p>
&lt;h3 id="æ‹¾é—">æ‹¾é—&lt;/h3>
&lt;h4 id="linuxå†…å­˜å ç”¨">linuxå†…å­˜å ç”¨&lt;/h4>
&lt;p>ledå±ä¼šæ˜¾ç¤ºå†…å­˜å ç”¨ï¼Œç„¶é¹…æ—¶é—´é•¿äº†æ€»ä¼šåˆ°90%ä»¥ä¸Šï¼Œå¯æˆ‘å¹¶æ²¡æœ‰è¿è¡Œä»€ä¹ˆç¨‹åºã€‚&lt;/p>
&lt;p>ç»æŸ¥é˜…æ­¤å¤„æ˜¾ç¤ºçš„æ˜¯å®žé™…å æœ‰çš„åŠ ä¸Šbufferå’Œcached meméƒ¨åˆ†ï¼Œå¯ä»¥ç†è§£ä¸ºç¼“å­˜çš„ï¼Œéšæ—¶æ¸…ç†ï¼Œå¹¶ä¸å ç”¨å®žé™…å†…å­˜ã€‚&lt;/p>
&lt;p>å¯ç”¨topå‘½ä»¤æŸ¥çœ‹å†…å­˜è¯¦æƒ…ã€‚&lt;/p>
&lt;h4 id="ä¾›ç”µé—®é¢˜">ä¾›ç”µé—®é¢˜&lt;/h4>
&lt;p>ç”¨å……ç”µå®ä¾›ç”µæ–¹ä¾¿ï¼Œä½†æ˜¯åªè¦ä¸€æ–­ç”µç³»ç»Ÿå°±ä¼šé‡å¯ï¼Œè¿™å¯¹linuxç³»ç»Ÿè€Œè¨€ä¼¤å®³å¾ˆå¤§ã€‚&lt;/p>
&lt;p>è€Œåœ¨å……ç”µå®ç”µé‡ä¸æ»¡æ—¶ï¼Œç»å¸¸å‘ç”Ÿå¼€ä¸äº†æœºçš„é—®é¢˜ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºç”µé‡ä¸è¶³å¯¼è‡´ç”µåŽ‹ä¸ç¨³ã€‚&lt;/p>
&lt;h5 id="å…³æœºå‘½ä»¤">å…³æœºå‘½ä»¤ï¼š&lt;/h5>
&lt;p>&lt;code>sudo shutdown -h now&lt;/code>&lt;/p>
&lt;h5 id="é‡å¯">é‡å¯ï¼š&lt;/h5>
&lt;p>&lt;code>shutdown -h now -r&lt;/code>&lt;/p>
&lt;p>&lt;em>ä¸‹ä¸€ç¯‡ï¼šæ“çºµå°è½¦å’ŒAIåˆæŽ¢&lt;/em>&lt;/p>
&lt;h3 id="å‚è€ƒé“¾æŽ¥">å‚è€ƒé“¾æŽ¥&lt;/h3>
&lt;p>&lt;a class="link" href="https://github.com/NVIDIA-AI-IOT/jetbot/wiki/Hardware-Setup" target="_blank" rel="noopener"
>https://github.com/NVIDIA-AI-IOT/jetbot/wiki/Hardware-Setup&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://robocarstore.cn/" target="_blank" rel="noopener"
>https://robocarstore.cn/&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="http://www.gpus.cn/gpus_list_page_techno_support_content?id=50" target="_blank" rel="noopener"
>http://www.gpus.cn/gpus_list_page_techno_support_content?id=50&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://www.jianshu.com/p/789944463fd7" target="_blank" rel="noopener"
>https://www.jianshu.com/p/789944463fd7&lt;/a>&lt;/p></description></item><item><title>Archives</title><link>https://lonelyuan.github.io/archives/</link><pubDate>Tue, 28 May 2019 00:00:00 +0000</pubDate><guid>https://lonelyuan.github.io/archives/</guid><description/></item><item><title>TODO</title><link>https://lonelyuan.github.io/todo/</link><pubDate>Tue, 28 May 2019 00:00:00 +0000</pubDate><guid>https://lonelyuan.github.io/todo/</guid><description>&lt;p>TODO&lt;/p></description></item><item><title>About Me</title><link>https://lonelyuan.github.io/about-me/</link><pubDate>Thu, 28 Feb 2019 00:00:00 +0000</pubDate><guid>https://lonelyuan.github.io/about-me/</guid><description>&lt;blockquote>
&lt;p>Do not go gentle into that good night,&lt;/p>
&lt;p>Old age should burn and rave at close of day;&lt;/p>
&lt;p>Rage, rage against the dying of the light.&lt;/p>
&lt;/blockquote>
&lt;h1 id="æˆ‘æ˜¯è°">ðŸ­æˆ‘æ˜¯è°&lt;/h1>
&lt;ul>
&lt;li>CSç ”ç©¶ç”Ÿï¼Œ&lt;a class="link" href="https://blue-whale.me/" target="_blank" rel="noopener"
>Blue-Whale&lt;/a> æˆå‘˜
&lt;ul>
&lt;li>æƒ³ç†è§£è®¡ç®—æœºçš„ä¸€åˆ‡ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>MBTIï¼šä»€ä¹ˆèµ›åšæ˜Ÿåº§ã€‚
&lt;ul>
&lt;li>ï¼ˆä¸ä¿¡è¿™çŽ©æ„çš„å±žäºŽä»€ä¹ˆç±»åž‹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ‹–å»¶ç—‡æ™šæœŸã€‚
&lt;ul>
&lt;li>yysyï¼Œä¸æ‹–å»¶ä½ ä¹Ÿä¸ä¼šå˜æˆxxã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å­˜åœ¨ä¸»ä¹‰è€…ã€‚
&lt;ul>
&lt;li>æ„ŸçŸ¥å³å­˜åœ¨ï¼Œå­˜åœ¨å…ˆäºŽæ„ä¹‰ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;img src="https://lonelyuan.github.io/about-me/1623380216575.png"
width="300"
height="92"
srcset="https://lonelyuan.github.io/about-me/1623380216575_hu2593cce796e5ebe456dceba028d22bcd_10011_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/about-me/1623380216575_hu2593cce796e5ebe456dceba028d22bcd_10011_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="326"
data-flex-basis="782px"
>&lt;/li>
&lt;/ul>
&lt;h1 id="æœ¬åšå®¢å®—æ—¨">ðŸŒæœ¬åšå®¢å®—æ—¨&lt;/h1>
&lt;ul>
&lt;li>å°½é‡ä¸åˆ¶é€ åžƒåœ¾ã€‚
&lt;ul>
&lt;li>ä»€ä¹ˆæ˜¯åžƒåœ¾ï¼šè¿‡æ—¶çš„ï¼Œæ— è¶£çš„ï¼Œä¿¡æ¯å¯†åº¦ä½Žçš„&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>äº‰å–å‘¨æ›´ã€‚
&lt;ul>
&lt;li>è‰ç¨¿ä¹Ÿç®—å‘¨æ›´ï¼ç¨‹åºå‘˜çš„äº‹ï¼Œèƒ½å«æ‹–æ›´å—ï¼Ÿ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h1 id="åŒå¥½æ£€æµ‹å™¨">ðŸ¤ºåŒå¥½æ£€æµ‹å™¨&lt;/h1>
&lt;ul>
&lt;li>&lt;strong>æ–‡&lt;/strong>ï¼šå¤§åˆ˜ã€çŽ‹å°æ³¢ã€â€¦â€¦&lt;/li>
&lt;li>&lt;strong>å½±&lt;/strong>ï¼šRe:0ã€çˆ±æ­»æœºã€R&amp;amp;Mã€æ— èŒè½¬ç”Ÿã€çµèƒ½ç™¾åˆ†ç™¾ã€é€²æ’ƒã®å·¨äººâ€¦â€¦&lt;/li>
&lt;li>&lt;strong>æ¸¸&lt;/strong>ï¼šMinecraftã€Bioshock: Infinityã€Celesteã€Outer Wildsã€æˆ´æ£®çƒè®¡åˆ’ã€oxygen not includeã€ã€ŠåŽŸã€‹ã€ã€Šå´©ã€‹â€¦â€¦&lt;/li>
&lt;/ul>
&lt;!-- # ðŸŒŒä¸‰è§‚
### world view | æ”¾çœ¼å¯°å®‡
> èµ„æœ¬ä¸»ä¹‰ç§©åºä¸‹çš„ä¸–ç•Œæ— å¯é¿å…åœ°èµ°åˆ°å‘¨æœŸçš„æœ«å°¾ï¼Œè€Œç¬¬å››æ¬¡å·¥ä¸šé©å‘½ä¾ç„¶å‰é€”æ¸ºèŒ«ï¼Œæ‰€è°“ç™¾å¹´æœªæœ‰ä¹‹å¤§å˜é©ï¼Œäººç±»æ–‡æ˜Žæ­£èµ°å‘æ··æ²Œçš„è·¯å£ã€‚
### outlook on life and value | èšç„¦ä¸ªäººï¼š
> å½“èµ›åšæœ‹å…‹æ‚„ç„¶æˆä¸ºçŽ°å®žï¼Œå½“æ‰‹æœºæˆä¸ºä¸å¯æˆ–ç¼ºçš„å™¨å®˜ï¼Œå½“æ¶ˆè´¹ä¸»ä¹‰æš´æ‰“äº†ç†æƒ³ã€è’™éª—äº†çˆ±æƒ…ï¼Œå½“è®°å½•äº†ä½ çš„å–œæ€’å“€ä¹çš„æ•°æ®æ¯”ä½ æ›´å€¼é’±ï¼›
> ä½œä¸ºä¿¡æ¯æ—¶ä»£åŽŸä½æ°‘çš„æˆ‘ä»¬ï¼Œä½œä¸ºè¢«èµ„æœ¬ä¸»ä¹‰å¼‚åŒ–ã€è¢«äº’è”ç½‘åŽŸå­åŒ–äº†çš„ä¸ªä½“ï¼Œä½œä¸ºåœ¨å†…å·æˆ–è¢«å†…å·ä¸­ç„¦è™‘æŒ£æ‰Žçš„æ™®é€šäººâ€”â€”
- æ˜¯å¦æœ‰å‹‡æ°”èµ°å‡ºèˆ’é€‚åŒºï¼Œå‘æ— å¤„ä¸åœ¨çš„ä¿¡æ¯èŒ§æˆ¿è¯´ä¸ï¼Ÿ
- æ˜¯å¦æ„¿æ„å®¡è§†è‡ªæˆ‘çš„æˆè§ï¼Œå°è¯•ç†è§£ä»–äººï¼Ÿ
- æ˜¯å¦æ•¢äºŽèµ°å‡ºè‡ªé—­ï¼Œå»ºç«‹çœŸå®žæ·±åˆ»çš„ç¤¾ä¼šå…³ç³»ï¼Ÿ
- æ˜¯å¦ç›¸ä¿¡äººç±»æ„å¿—çš„æˆé•¿æ€§ï¼Œä¸æ–­é€¼è¿‘ç”Ÿç†å’Œå¿ƒç†çš„æžé™ï¼Ÿ
- æ˜¯å¦æ•¢äºŽè‡ªæˆ‘è§£æž„ï¼Œè€Œä¸æ”¾å¼ƒæŽ¢æ±‚ç”Ÿæ´»çš„çœŸç›¸ï¼Ÿ
- æ˜¯å¦æŽ¥å—äººç”Ÿçš„æ— æ„ä¹‰ï¼Œå¹¶é€‰æ‹©ç»§ç»­çƒ­çˆ±è¿™ä¸€åˆ‡ï¼Ÿ --></description></item><item><title>Links</title><link>https://lonelyuan.github.io/links/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://lonelyuan.github.io/links/</guid><description/></item><item><title>Search</title><link>https://lonelyuan.github.io/search/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://lonelyuan.github.io/search/</guid><description/></item></channel></rss>