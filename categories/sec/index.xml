<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Sec on lonelyuan's Blog</title><link>https://lonelyuan.github.io/categories/sec/</link><description>Recent content in Sec on lonelyuan's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Tue, 28 May 2019 00:00:00 +0000</lastBuildDate><atom:link href="https://lonelyuan.github.io/categories/sec/index.xml" rel="self" type="application/rss+xml"/><item><title>libAFLé€Ÿé€šFuzzing101 (3)</title><link>https://lonelyuan.github.io/p/libafl-fuzzing101-3/</link><pubDate>Wed, 02 Aug 2023 02:00:36 +0800</pubDate><guid>https://lonelyuan.github.io/p/libafl-fuzzing101-3/</guid><description>&lt;blockquote>
&lt;p>æœ¬ç³»åˆ—æ˜¯å­¦ä¹ &lt;a class="link" href="https://epi052.gitlab.io/notes-to-self/blog/2021-11-01-fuzzing-101-with-libafl/" target="_blank" rel="noopener"
>ã€ŠFuzzing101 with LibAFLã€‹&lt;/a>ç³»åˆ—åšå®¢ï¼ˆåŽæ–‡ç»Ÿç§°ï¼šåŽŸåšå®¢ï¼‰çš„ç¬”è®°åˆ†äº«ï¼Œåœ¨å­¦ä¹ ä»‹ç» LibAFL ç”¨æ³•çš„åŒæ—¶æ€»ç»“ Rust çŸ¥è¯†ç‚¹ã€‚&lt;br>
&lt;strong>å‰ç½®çŸ¥è¯†&lt;/strong>ï¼š fuzzåŸºæœ¬æ¦‚å¿µã€AFLåŸºæœ¬ä½¿ç”¨ &lt;br>
&lt;strong>æœ¬ç¯‡è¦ç‚¹&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>LibAFL
&lt;ul>
&lt;li>Forkserveræ¨¡å¼: Sugar API&lt;/li>
&lt;li>AFL toolsï¼šafl-cminã€optminã€afl-tminã€afl-cov&lt;/li>
&lt;li>å­—æ®µå›ºå®š&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Rust
&lt;ul>
&lt;li>Builder&lt;/li>
&lt;li>clap&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h2 id="execise-3">Execise-3&lt;/h2>
&lt;h3 id="source--corpus">source &amp;amp; corpus&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># tcpdump&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://github.com/the-tcpdump-group/tcpdump/archive/refs/tags/tcpdump-4.9.1.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar -xzvf tcpdump-4.9.1.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv tcpdump-tcpdump-4.9.1 tcpdump
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm tcpdump-4.9.1.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># tcpdumpçš„ä¾èµ–pcap&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://github.com/the-tcpdump-group/libpcap/archive/refs/tags/libpcap-1.8.0.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar -xzvf libpcap-1.8.0.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv libpcap-libpcap-1.8.0/ libpcap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm libpcap-1.8.0.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ç”¨scapyç”Ÿæˆcorpus&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## åŽŸæ–‡ä½¿ç”¨poetry,ç›´æŽ¥pipä¹Ÿå¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pip install scapy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">python create-bootp.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æœ¬ç¯‡æ²¡ç”¨åˆ°qemuï¼Œä½†ä¾ç„¶éœ€è¦è¿™ä¸ªä¾èµ–&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt-get install -y ninja-build
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="makefiletoml">Makefile.toml&lt;/h3>
&lt;p>è¿˜æ˜¯ç†Ÿæ‚‰çš„é…æ–¹ï¼Œè¿˜æ˜¯ç†Ÿæ‚‰çš„&lt;code>cargo make build&lt;/code>ã€‚è¿˜æ˜¯ä¸ç†Ÿæ‚‰çš„bugã€‚ã€‚ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">dependencies&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;build-cargo&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;copy-project-to-build&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;build-libpcap&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;build-tcpdump&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-cargo&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">command&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;cargo&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">args&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;build&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;--release&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">copy-project-to-build&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">script&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">mkdir -p build/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">cp ../target/release/exercise-3 build/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">sudo setcap cap_sys_admin+epi build/exercise-3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-libpcap&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">env&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="s2">&amp;#34;CC&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;afl-clang-lto&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;LLVM_CONFIG&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;llvm-config-15&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;AFL_MAP_SIZE&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;86217&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;AFL_USE_ASAN&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cwd&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;libpcap&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">script&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">./configure --enable-shared=no --prefix=&amp;#34;&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">CARGO_MAKE_WORKING_DIRECTORY&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="nx">build&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="s2">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make install
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-tcpdump&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cwd&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;tcpdump&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">script&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">./configure --prefix=&amp;#34;&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">CARGO_MAKE_WORKING_DIRECTORY&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="nx">build&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="s2">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make install
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">sudo setcap cap_sys_admin+epi ../build/sbin/tcpdump
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">mkdir -p ../solutions
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-tcpdump&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">env&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;CC&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;afl-clang-lto&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;LLVM_CONFIG&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;llvm-config-15&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;AFL_USE_ASAN&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;AFL_MAP_SIZE&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;86217&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;CFLAGS&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;-I${CARGO_MAKE_WORKING_DIRECTORY}/../build/include/&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;LDFLAGS&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;-L${CARGO_MAKE_WORKING_DIRECTORY}/../build/lib/&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h5 id="è¡¥å……linuxä¸­çš„capabilityæœºåˆ¶">è¡¥å……ï¼šLinuxä¸­çš„Capabilityæœºåˆ¶&lt;/h5>
&lt;p>åªæœ‰rootå’Œæ™®é€šè¿›ç¨‹çš„æƒé™ç®¡ç†ä¸å¤Ÿçµæ´»ï¼Œæ™®é€šè¿›ç¨‹è¦ä¹ˆä»€ä¹ˆéƒ½ä¸èƒ½åšï¼Œè¦ä¹ˆsudoä»€ä¹ˆéƒ½èƒ½åšã€‚äºŽæ˜¯å°†rootç‰¹æƒåˆ†å‰²æˆè¯¸å¤šèƒ½åŠ›Capabilityã€‚&lt;/p>
&lt;p>è¿›ç¨‹æ‹¥æœ‰ä¸‰ç»„èƒ½åŠ›é›†ï¼š&lt;/p>
&lt;ul>
&lt;li>cap_effectiveï¼šå¯ç”¨èƒ½åŠ›é›†&lt;/li>
&lt;li>cap_inheritableï¼šå¯ç»§æ‰¿èƒ½åŠ›é›†&lt;/li>
&lt;li>cap_permittedï¼šæœ€å¤§èƒ½åŠ›é›†&lt;/li>
&lt;/ul>
&lt;p>å¯æ‰§è¡Œæ–‡ä»¶ä¹Ÿæœ‰ä¸‰ç»„èƒ½åŠ›é›†ï¼Œä¸Žè¿›ç¨‹å¯¹åº”ï¼š&lt;/p>
&lt;ul>
&lt;li>cap_effectiveï¼š&lt;/li>
&lt;li>cap_allowedï¼šå¯ç»§æ‰¿çš„èƒ½åŠ›é›†&lt;/li>
&lt;li>cap_forcedï¼šå¿…é¡»æ‹¥æœ‰æ‰èƒ½æ‰§è¡Œçš„èƒ½åŠ›é›†&lt;/li>
&lt;/ul>
&lt;p>å‡å¯ç®€è®°ä¸ºeipã€‚setcapæ˜¯é…ç½®Capabilityçš„å·¥å…·ï¼Œå…¶æ“ä½œç±»ä¼¼chmodã€‚&lt;/p>
&lt;h4 id="debug-build-libpcap">Debug: build-libpcap&lt;/h4>
&lt;h5 id="å•¥å«--ldw">å•¥å« -ldw&lt;/h5>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">= note: /usr/bin/ld: cannot find -ldw: No such file or directory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> collect2: error: ld returned 1 exit status
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>-ldw&lt;/code>ä»£è¡¨&lt;code>libdw.so&lt;/code>ï¼Œaptå®‰è£…å³å¯&lt;/li>
&lt;/ul>
&lt;h5 id="æˆ‘afl-clang-ltoå‘¢">æˆ‘afl-clang-ltoå‘¢&lt;/h5>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">configure:2853: afl-clang-lto --version &amp;gt;&amp;amp;5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./configure: line 2855: afl-clang-lto: command not found
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configure:2864: $? = 127
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>è®©CCæŒ‡å‘AFLpulsplusé‡Œé¢çš„afl-clang-ltoã€‚åˆ‡è®°è¦ç»å¯¹è·¯å¾„&lt;/li>
&lt;/ul>
&lt;h5 id="ä½ æ ¹æœ¬ä¸åœ¨bpfnet">ä½ æ ¹æœ¬ä¸åœ¨bpf/net&lt;/h5>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">$ make --debug
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Reading makefiles...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Updating makefiles....
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Updating goal targets....
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &amp;#39;all&amp;#39; does not exist.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &amp;#39;libpcap.a&amp;#39; does not exist.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Prerequisite &amp;#39;grammar.c&amp;#39; is newer than target &amp;#39;grammar.h&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Must remake target &amp;#39;grammar.h&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Successfully remade target file &amp;#39;grammar.h&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &amp;#39;bpf_filter.o&amp;#39; does not exist.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &amp;#39;bpf_filter.c&amp;#39; does not exist.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> File &amp;#39;bpf/net/bpf_filter.c&amp;#39; does not exist.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Must remake target &amp;#39;bpf/net/bpf_filter.c&amp;#39;.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make: *** No rule to make target &amp;#39;bpf/net/bpf_filter.c&amp;#39;, needed by &amp;#39;bpf_filter.c&amp;#39;. Stop.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¥½ç†Ÿæ‚‰çš„bugï¼ŒðŸ‘´æ¨¡ç³Šçš„è®°å¾—ä¹‹å‰æ£é¼“åˆ«çš„fuzzerçš„æ—¶å€™å¥½åƒä¹Ÿé‡åˆ°è¿‡ï¼Œä½†æ˜¯ðŸ‘´æ¸…æ¥šçš„è®°å¾—å½“æ—¶æˆ‘æ²¡è§£å†³ã€‚&lt;/p>
&lt;p>äºŽæ˜¯ï¼ŒðŸ‘´å¼€å§‹æŽ’æŸ¥æ˜¯å¦æœ‰ä¾èµ–ç¼ºå¤±ï¼Œ&lt;code>sudo apt-get install libpcap-dev&lt;/code>ï¼Œæ²¡ç”¨ã€‚æ€»ä¸èƒ½æ˜¯ WSL å†…æ ¸å°±å°‘ç‚¹ä¸œè¥¿å§ï¼Œæˆ‘éƒ½WSL2äº†ã€‚&lt;/p>
&lt;p>åˆå›žå¤´çœ‹äº†çœ‹æºç ï¼Œå‘çŽ° libpcap çš„ Github ä¸Šæœ‰ä¸€ä»½&lt;code>bpf_filter.c&lt;/code>ï¼Œè€Œä½œè€…ç»™çš„&lt;code>fuzzing-101-solution&lt;/code>é‡Œé¢æ²¡æœ‰ã€‚ðŸ‘´ç›´æŽ¥ä¸Šlibpacpä»“åº“å¤åˆ¶ï¼Œæ²¡ç”¨ã€‚&lt;/p>
&lt;p>å†çœ‹çœ‹ fuzzing-101 ä»“åº“ï¼Œä»–ç”¨çš„æ˜¯ libpacp1.80 ç‰ˆæœ¬ï¼ŒðŸ‘´åŽ»ç¿»ä»“åº“çš„æ ‡ç­¾ï¼Œæžœç„¶1.8ç‰ˆæœ¬æœ‰&lt;code>bpf/net/bpf_filter.c&lt;/code>ã€‚ç ´æ¡ˆäº†ã€‚ðŸ‘´ç›´æŽ¥è¿›è¡Œä¸€ä¸ªissueçš„æã€‚&lt;/p>
&lt;p>åŽé¢ä¸€æ­¥æ²¡æŠ¥é”™ã€‚å¶å‰‹~&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">$ ./build/sbin/tcpdump --h
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcpdump version 4.9.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">libpcap version 1.8.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">OpenSSL 3.0.2 15 Mar 2022
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Compiled with AddressSanitizer/CLang.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ ./build/sbin/tcpdump -r corpus/bootp-testcase.pcap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reading from file corpus/bootp-testcase.pcap, link-type IPV4 (Raw IPv4)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">15:11:03.147545 IP localhost.bootps &amp;gt; 127.1.1.1.bootpc: BOOTP/DHCP, Request from 00:00:00:00:00:00 (oui Ethernet), length 236
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="fuzzer">fuzzer&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">parser&lt;/span>::&lt;span class="n">parse_args&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">cores&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Cores&lt;/span>::&lt;span class="n">from_cmdline&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">cores&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">expect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Failed to parse cores&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">ForkserverBytesCoverageSugar&lt;/span>::&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="mi">86217&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>::&lt;span class="n">builder&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">input_dirs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">output_dir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">cores&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cores&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">program&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">debug_output&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">debug&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">arguments&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">parsed_opts&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">build&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>Sugar API to simplify the life of the naive user of LibAFL&lt;/p>
&lt;/blockquote>
&lt;p>LibAFLè´´å¿ƒçš„ä¸ºæˆ‘è¿™ç§ naive user å‡†å¤‡äº†ä¸€æ¡é¾™æœåŠ¡ï¼Œæä¾›äº† Sugar API å°†å‰ä¸¤ç¯‡çš„æ ·æ¿ä»£ç è¿›ä¸€æ­¥ç®€åŒ–ã€‚å¥½çš„ï¼Œfuzzerå†™å®Œäº†ã€‚&lt;/p>
&lt;h4 id="rust-åŸºç¡€ä¹‹-builder">Rust åŸºç¡€ä¹‹ Builder&lt;/h4>
&lt;h3 id="parserrs">parser.rs&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#[derive(Parser, Debug)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">struct&lt;/span> &lt;span class="nc">FuzzerOptions&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cp">#[clap(short, long, default_value = &lt;/span>&lt;span class="s">&amp;#34;solutions&amp;#34;&lt;/span>&lt;span class="cp">)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">output&lt;/span>: &lt;span class="nc">PathBuf&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cp">#[clap(short, long, default_value = &lt;/span>&lt;span class="s">&amp;#34;corpus&amp;#34;&lt;/span>&lt;span class="cp">, multiple_values = true)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">input&lt;/span>: &lt;span class="nc">PathBuf&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cp">#[clap(short, long)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">cores&lt;/span>: &lt;span class="nb">String&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cp">#[clap(short, long, required = true, takes_value = true)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">target&lt;/span>: &lt;span class="nb">String&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cp">#[clap(short, long)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">debug&lt;/span>: &lt;span class="kt">bool&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="cp">#[clap(
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> short,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> long,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> allow_hyphen_values = true,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> multiple_values = true,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> takes_value = true
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp"> )]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">args&lt;/span>: &lt;span class="nb">Vec&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">parse_args&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nc">FuzzerOptions&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">FuzzerOptions&lt;/span>::&lt;span class="n">parse&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œä½¿ç”¨äº† clap åº“æ¥è§£æžå‘½ä»¤è¡Œå‚æ•°ï¼Œè½¬æ¢ä¸ºæ•°æ®ç»“æž„&lt;code>FuzzerOptions&lt;/code>ã€‚&lt;/p>
&lt;h4 id="rust-åŸºç¡€ä¹‹-æ³¨è§£">Rust åŸºç¡€ä¹‹ æ³¨è§£&lt;/h4>
&lt;h3 id="è·‘">è·‘ðŸƒâ€&lt;/h3>
&lt;p>ç›´æŽ¥è·‘æ˜¯å¾ˆdumbçš„ï¼Œè¿Ÿè¿Ÿè·‘ä¸å‡ºç»“æžœã€‚è¿™é‡Œå…ˆæŠ„ä¸ª&lt;a class="link" href="https://github.com/the-tcpdump-group/tcpdump/blob/tcpdump-4.9.2/tests/bootp_asan.pcap" target="_blank" rel="noopener"
>ç­”æ¡ˆ&lt;/a>&lt;/p>
&lt;!-- ```
cp `find -name "cve*.pcap"|xargs` ../../corpus
cp `find -name "*heapoverflow*.pcap"|xargs` ../../corpus
https://github.com/the-tcpdump-group/tcpdump/commit/29e5470e6ab84badbc31f4532bb7554a796d9d52
``` -->
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> $ ./build/sbin/tcpdump -r corpus/bootp_asan.pcap -v [2:27:14]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">reading from file corpus/bootp_asan.pcap, link-type EN10MB (Ethernet)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">08:00:00.000000 IP (tos 0x0, ttl 252, id 40207, offset 0, flags [+, DF, rsvd], proto UDP (17), length 60951, bad cksum ff (-&amp;gt;8336)!)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">=================================================================
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">==23730==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6060000000b4 at pc 0x56339a3e4010 bp 0x7fffaf70f850 sp 0x7fffaf70f848
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">READ of size 2 at 0x6060000000b4 thread T0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #0 0x56339a3e400f in bootp_print /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./print-bootp.c:325:2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #1 0x56339a46960a in ip_print_demux /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./print-ip.c:387:3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #2 0x56339a47008b in ip_print /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./print-ip.c:658:3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #3 0x56339a4207c2 in ethertype_print /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./print-ether.c:333:10
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #4 0x56339a41e731 in ether_print /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./print-ether.c:236:7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #5 0x56339a36bff1 in pretty_print_packet /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./print.c:339:18
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #6 0x56339a36bff1 in print_packet /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./tcpdump.c:2506:2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #7 0x56339a74458a in pcap_offline_read /home/czy/fuzzing-101-solutions/exercise-3/libpcap/./savefile.c:507:4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #8 0x56339a362050 in pcap_loop /home/czy/fuzzing-101-solutions/exercise-3/libpcap/./pcap.c:875:8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> #9 0x56339a362050 in main /home/czy/fuzzing-101-solutions/exercise-3/tcpdump/./tcpdump.c:2009:12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç­”æ¡ˆæ˜¯ç®¡ç”¨çš„ï¼Œä½†æ˜¯ç›´æŽ¥ä¸¢è¿› Libafl å´æ²¡æœ‰crashã€‚&lt;/p>
&lt;h3 id="ä¼˜åŒ–">ä¼˜åŒ–&lt;/h3>
&lt;p>ç›®å‰çš„fuzzeråŽŸä½œè€…è·‘äº†ä¸€æ™šä¸Šå•¥ä¹Ÿæ²¡è·‘å‡ºæ¥ï¼Œç”±æ­¤å¼•å…¥ä¸€äº›ä¼˜åŒ–æ–¹æ³•ã€‚&lt;/p>
&lt;h4 id="è¯­æ–™åº“åŽ‹ç¼©optmin">è¯­æ–™åº“åŽ‹ç¼©ï¼šoptmin&lt;/h4>
&lt;p>optmin æ˜¯ afl-tmin çš„ä¼˜åŒ–ç‰ˆã€‚å°†è¯­æ–™åº“ä¸­è§¦å‘é‡å¤è·¯å¾„çš„éƒ¨åˆ†æœ€å°åŒ–ï¼Œæœ‰åŠ©äºŽfuzzerå‡å°‘é‡å¤å°è¯•ã€‚è¿™é‡Œçš„è¯­æ–™åº“åœ¨&lt;code>/solutions/queue&lt;/code>ï¼Œä¹Ÿå°±æ˜¯AFLæ‰§è¡Œè¿‡è‹¥å¹²è½®åŽçš„ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># build&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> AFLplusplus/utils/optimin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./build_optimin.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv optimin ../../../exercise-3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># run&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp -r solutions/queue/* queue_for_cmin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">AFL_MAP_SIZE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">86217&lt;/span> &lt;span class="nv">ASAN_OPTIONS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">abort_on_error&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> ./optimin -f -i queue_for_cmin -o cminnified ./build/sbin/tcpdump -vr @@
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="æ ·ä¾‹åŽ‹ç¼©afl-tmin">æ ·ä¾‹åŽ‹ç¼©ï¼šafl-tmin&lt;/h4>
&lt;p>å¦ä¸€æ–¹é¢ï¼Œtminå¯¹å•ä¸ªè¾“å…¥è¿›è¡ŒåŽ‹ç¼©ï¼Œå‡å°æ–‡ä»¶å¤§å°ä¹Ÿæœ‰åŠ©äºŽæé«˜æ•ˆçŽ‡ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># build&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> AFLplusplus/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make afl-tmin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv afl-tmin ../exercise-3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># run&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp -r solutions/queue/* queue_for_cmin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">AFL_MAP_SIZE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">86217&lt;/span> &lt;span class="nv">ASAN_OPTIONS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">abort_on_error&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> ./optimin -f -i queue_for_cmin -o cminnified ./build/sbin/tcpdump -vr @@
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="è¦†ç›–çŽ‡è§‚å¯Ÿafl-cov">è¦†ç›–çŽ‡è§‚å¯Ÿï¼šafl-cov&lt;/h4>
&lt;p>ç„¶è€Œè¿™ç§å¸¸è§„ä¼˜åŒ–è¿˜æ˜¯æ²¡èƒ½æœ‰çªç ´ï¼ŒåŽŸä½œè€…å†³å®šè§‚å¯Ÿä¸€ä¸‹é‚£äº›ä»£ç è¿˜æ²¡æœ‰è¢«è¦†ç›–ã€‚å®‰è£…è¦†ç›–çŽ‡å·¥å…·afl-covç›¸å¯¹æ¯”è¾ƒç¹çï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">export HOME=/fuzzing-101-solutions/exercise-3/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd $home
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># å®‰è£…afl-cov
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt install lcov
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git clone https://github.com/vanhauser-thc/afl-cov.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># ç§»åŠ¨æºä»£ç 
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir exercise-3-gcov exercise-3-gcov/build
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp -r exercise-3/libpcap exercise-3-gcov
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp -r exercise-3/tcpdump exercise-3-gcov
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp -r exercise-3/solutions exercise-3-gcov
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># æ¸…ç†lockæ–‡ä»¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd exercise-3-gcov/solutions/queue
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find * -empty -delete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># lcov éœ€è¦æ–‡ä»¶åä»…ä¸º6ä½
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">## åŽŸåšå®¢ç”¨çš„pythonè„šæœ¬ï¼ŒðŸ‘´ç›´æŽ¥è¯·æ•™ new bing
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">for i in *; do
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mv -v &amp;#34;$i&amp;#34; &amp;#34;${i: -6}&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">done
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># ç¼–è¯‘å¸¦ cov çš„ libpcap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd $home/exercise-3-gcov/libpcap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make clean
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/opt/afl-cov/afl-cov-build.sh -c ./configure --prefix=$(pwd)/../build; make
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># ç¼–è¯‘å¸¦ cov çš„ tcpdump
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cd $home/exercise-3-gcov/tcpdump
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make clean
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CFLAGS=-I$(pwd)/../build/include/ LDFLAGS=-L$(pwd)/../build/lib/ /opt/afl-cov/afl-cov-build.sh -c ./configure --prefix=$(pwd)/../build ; make
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo setcap cap_sys_admin+epi ../build/sbin/tcpdump
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"># æ‰§è¡Œ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/opt/afl-cov/afl-cov.sh -c solutions &amp;#34;./build/sbin/tcpdump -vr @@&amp;#34;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è§‚å¯Ÿåˆ°æ ¹æœ¬è¿è¡Œä¸åˆ°ç›®æ ‡CVEæ‰€åœ¨çš„æ–‡ä»¶ã€‚&lt;/p>
&lt;h4 id="å›ºå®šè¾“å…¥">å›ºå®šè¾“å…¥&lt;/h4>
&lt;p>æœ€åŽåŽŸä½œè€…å†³å®šæ”¹ Libafl æºç ï¼Œåœ¨å˜å¼‚ä¹‹å‰å¾€é‡Œå¡žå›ºå®šäº†çš„ BOOTY å¤´ã€‚ä½†æ˜¯ðŸ‘´çš„ LibAFL æºä»£ç å’ŒåŽŸåšå®¢ä¸­æœ‰äº›å¾®åŒºåˆ«ï¼Œè™½ç„¶ç‰ˆæœ¬å·ä¸€æ ·ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="sd">///libafl/src/executors/forkserver.rs:438
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd">&lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">executor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">uses_shmem_testcase&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">shmem&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">unsafe&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">executor&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">shmem_mut&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">as_mut&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">unwrap_unchecked&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">target_bytes&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">target_bytes&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">target_bytes&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_slice&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">len&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">size_in_bytes&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">to_ne_bytes&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c1">// The first four bytes tells the size of the shmem.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">shmem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_mut_slice&lt;/span>&lt;span class="p">()[&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="n">copy_from_slice&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">size_in_bytes&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">]);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">shmem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_mut_slice&lt;/span>&lt;span class="p">()[&lt;/span>&lt;span class="no">SHMEM_FUZZ_HDR_SIZE&lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">SHMEM_FUZZ_HDR_SIZE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="p">)]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">copy_from_slice&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">target_bytes&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_slice&lt;/span>&lt;span class="p">());&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">executor&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">input_file_mut&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">write_buf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">target_bytes&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">as_slice&lt;/span>&lt;span class="p">())&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸è¿‡è¿˜æ˜¯æ‰¾åˆ°äº†å¯¹åº”çš„ä½ç½®ï¼Œå‘&lt;code>write_buf()&lt;/code>æ’å…¥å›ºå®šçš„å¤´éƒ¨å³å¯ã€‚&lt;/p>
&lt;p>ðŸ‘´è§‰å¾—è¿™æ ·ä¸å¤Ÿä¼˜é›…ï¼ŒäºŽæ˜¯å¯»æ€èƒ½å¦è¿›è¡Œä¸€ä¸ªç±»é‡å†™ã€‚&lt;/p>
&lt;p>ã€To be continueã€‘&lt;/p></description></item><item><title>libAFLé€Ÿé€šFuzzing101 (2)</title><link>https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/</link><pubDate>Sun, 30 Jul 2023 02:45:31 +0800</pubDate><guid>https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/</guid><description>&lt;img src="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/final.png" alt="Featured image of post libAFLé€Ÿé€šFuzzing101 (2)" />&lt;blockquote>
&lt;p>æœ¬ç³»åˆ—æ˜¯å­¦ä¹ &lt;a class="link" href="https://epi052.gitlab.io/notes-to-self/blog/2021-11-01-fuzzing-101-with-libafl/" target="_blank" rel="noopener"
>ã€ŠFuzzing101 with LibAFLã€‹&lt;/a>ç³»åˆ—åšå®¢ï¼ˆåŽæ–‡ç»Ÿç§°ï¼šåŽŸåšå®¢ï¼‰çš„ç¬”è®°åˆ†äº«ï¼Œåœ¨å­¦ä¹ ä»‹ç» LibAFL ç”¨æ³•çš„åŒæ—¶æ€»ç»“ Rust çŸ¥è¯†ç‚¹ã€‚&lt;br>
&lt;strong>å‰ç½®çŸ¥è¯†&lt;/strong>ï¼š fuzzåŸºæœ¬æ¦‚å¿µã€AFLåŸºæœ¬ä½¿ç”¨ &lt;br>
&lt;strong>æœ¬ç¯‡è¦ç‚¹&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>LibAFL
&lt;ul>
&lt;li>Inprocessæ¨¡å¼
&lt;ul>
&lt;li>Harness&lt;/li>
&lt;li>ç¼–è¯‘å™¨wrapper&lt;/li>
&lt;li>LLPMï¼Œå¤šæ ¸å¹¶è¡Œ&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ¼æ´žåˆ†ç±»ï¼šAFLTriage&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Rust
&lt;ul>
&lt;li>å‡½æ•°ã€é—­åŒ…&lt;/li>
&lt;li>match æ¨¡å¼è¯†åˆ«&lt;/li>
&lt;li>Optionã€Result&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;h2 id="execise-15">Execise-1.5&lt;/h2>
&lt;p>Execise-1 ä¸­ç¼–å†™çš„fuzzerååˆ†ç”šè‡³ä¹åˆ†çš„ç®€é™‹ï¼Œè·ç¦»å®žé™…åº”ç”¨è¿˜ç›¸å·®ç”šè¿œã€‚åŽŸåšå®¢åœ¨&lt;a class="link" href="https://epi052.gitlab.io/notes-to-self/blog/2021-11-07-fuzzing-101-with-libafl-part-1.5" target="_blank" rel="noopener"
>1.5é›†&lt;/a>ä¸­åˆ—ä¸¾äº†ä¸‰ç§ä¼˜åŒ–æ–¹æ³•ï¼š&lt;/p>
&lt;ul>
&lt;li>ä½¿ç”¨&lt;code>afl-clang-lto&lt;/code> ä»£æ›¿ &lt;code>afl-clang-fast&lt;/code>â€”â€” fast 1.1x
&lt;ul>
&lt;li>afl-clang-lto(link time optimization): å®žçŽ°æ— ç¢°æ’žæ’æ¡©&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä½¿ç”¨ å…±äº«å†…å­˜ å¹²æŽ‰ æ–‡ä»¶I/O â€”â€” fast 3x
&lt;ul>
&lt;li>patchæºä»£ç ï¼ŒåŠ å…¥&lt;code>__AFL_FUZZ_INIT();&lt;/code>å®&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä½¿ç”¨&lt;code>InProcessExecutor&lt;/code> æ¢æŽ‰ &lt;code>ForkserverExecutor&lt;/code>â€”â€” fast 10x
&lt;ul>
&lt;li>patchæºä»£ç ï¼Œç¼–å†™harness functionå’Œcompiler wraper&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>ç”±äºŽ Execise-1 çš„ç›®æ ‡xpdfæ˜¯å‘½ä»¤è¡Œç¨‹åºï¼Œä¸æ˜¯åº“ï¼Œæ•…éœ€è¦åšä¸€å®šä¿®æ”¹ä½¿å…¶æ”¯æŒé™æ€é“¾æŽ¥ã€‚å…¶æ“ä½œè¾ƒä¸ºç¹çï¼Œæ¶‰åŠmakeè¿ç§»åˆ°cmakeç­‰ï¼Œå»ºè®®æœ‰éœ€æ±‚æ—¶è‡ªè¡Œç ”ç©¶ã€‚&lt;/p>
&lt;p>è€Œ Execise-2 çš„ç›®æ ‡libexifæœ¬èº«æ˜¯ä¸€ä¸ªåº“ï¼Œä¸å¦‚å€ŸåŠ© Execise-2 å­¦ä¹ harnessã€‚&lt;/p>
&lt;h3 id="æ‰€ä»¥ä»€ä¹ˆæ˜¯harness">æ‰€ä»¥ä»€ä¹ˆæ˜¯harnessï¼Ÿ&lt;/h3>
&lt;blockquote>
&lt;p>Harness &lt;br>
v. æŽ§åˆ¶å¹¶åˆ©ç”¨ï¼›ï¼ˆæŠŠåŠ¨ç‰©ï¼‰æ‹´åœ¨ä¸€èµ·ï¼ˆæˆ–æ‹´åˆ°æŸç‰©ä¸Šï¼‰ï¼›ç»™ï¼ˆé©¬ï¼‰å¥—ä¸ŠæŒ½å…·ï¼›è¿žæŽ¥ï¼Œä¸²è” &lt;br>
n. ï¼ˆé©¬çš„ï¼‰æŒ½å…·ï¼Œé©¬å…·ï¼›ç³»å¸¦ï¼ŒåŠå¸¦ï¼›æ—¥å¸¸å·¥ä½œ&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨é¢å¯¹ä¸€ä¸ªåº“æ—¶ï¼Œå¹¶æ²¡æœ‰çŽ°æˆçš„å…¥å£ç‚¹ï¼Œå› æ­¤éœ€è¦å†™ä¸€ä¸ªå‡½æ•°æ¥è°ƒç”¨å®ƒï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯ harnessã€‚æ­¤æ—¶ï¼Œharnessæˆä¸ºäº†ä¸Žfuzzerç›´æŽ¥äº¤äº’çš„ç›®æ ‡ã€‚
ä¹Ÿå°±æ˜¯è¯´ï¼Œfuzzeræ˜¯æ¨ªå†²ç›´æ’žçš„é‡Žé©¬ï¼Œtargetæ˜¯ä¸€æœ›æ— é™…çš„è‰åŽŸï¼Œharnessåˆ™æ˜¯æŒ‡å¼•æ–¹å‘çš„ç¼°ç»³ã€‚&lt;/p>
&lt;p>ä½¿ç”¨harnessæ—¶ï¼Œfuzzerçš„æ‰€æœ‰å·¥ä½œå°†åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­å®Œæˆï¼Œå³InProcessã€‚è¿™å¯¹æ€§èƒ½æœ‰ä»¥ä¸‹å¥½å¤„ï¼š&lt;/p>
&lt;ul>
&lt;li>å¯ä»¥ç›´æŽ¥é€šè¿‡harnessçš„ç¼–å†™ä¿ƒä½¿fuzzeræŽ¢ç´¢æˆ‘ä»¬æ„Ÿå…´è¶£çš„éƒ¨åˆ†&lt;/li>
&lt;li>ä¸Žfork-serverä¸åŒï¼Œè¿›ç¨‹å†…æ‰§è¡Œå…åŽ»äº†è¿›ç¨‹ç®¡ç†çš„è´Ÿæ‹…ï¼Œè¿™ä¸€ç‚¹æ˜¾è‘—æå‡äº†æ€§èƒ½&lt;/li>
&lt;li>å•è¿›ç¨‹æ¨¡å¼å¤©ç„¶æ”¯æŒå¤šæ ¸ï¼Œï¼ˆä¸€ä¸ªfuzzerå®žä¾‹ä¸€ä¸ªcpuæ ¸å¿ƒï¼‰å¯¹çŽ°ä»£å¤šæ ¸å¤„ç†å™¨å‹å¥½&lt;/li>
&lt;/ul>
&lt;p>é‚£ä¹ˆä»£ä»·æ˜¯ä»€ä¹ˆï¼Ÿç”±äºŽharnesså°†åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­è¢«åå¤æ‰§è¡Œï¼Œharnessåº”æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸èƒ½æœ‰å†…å­˜æ³„æ¼ï¼Œå¦åˆ™å°†ä¼šå¯¹fuzzeræœ¬èº«é€ æˆç ´åã€‚&lt;/li>
&lt;li>ä¸è¦æ‰§è¡Œexit()ã€‚è¿™ä¼šç»“æŸå½“å‰è¿›ç¨‹ï¼Œåº”è¯¥å‘é€abortä»¥ä¾›fuzzeré‡å¯&lt;/li>
&lt;li>é¿å…é«˜ç®—æ³•å¤æ‚åº¦ï¼Œé¿å…å¤§é‡å†…å­˜å ç”¨ï¼Œé¿å…æ—¥å¿—è¾“å‡ºç­‰æ‹–æ…¢é€Ÿåº¦çš„è¡Œä¸º&lt;/li>
&lt;/ul>
&lt;p>æ˜¯ä¸æ˜¯æ‘©æ‹³æ“¦æŽŒäº†å‘¢ï¼Ÿè®©æˆ‘ä»¬é‡æ–°åŠ å…¥æˆ˜æ–—å§ï¼&lt;/p>
&lt;h2 id="execise-2-libexif">Execise-2 libexif&lt;/h2>
&lt;h3 id="source--corpus">source &amp;amp; corpus&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># libexifçš„ä¾èµ–&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt-get install autopoint libtool gettext libpopt-dev
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ä¸‹è½½æºç &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://github.com/libexif/libexif/archive/refs/tags/libexif-0_6_14-release.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar -xf libexif-0_6_14-release.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv libexif-libexif-0_6_14-release libexif
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># å‡†å¤‡corpus&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir corpus solutions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> corpus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git clone --no-checkout --filter&lt;span class="o">=&lt;/span>blob:none https://github.com/libexif/libexif.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> libexif
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## åªç•™å›¾ç‰‡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git checkout master -- test/testdata
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv test/testdata/*.jpg ../
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ..
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm -rvf libexif
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="cargotoml">Cargo.toml&lt;/h3>
&lt;p>åœ¨InProcessæ¨¡å¼ä¸­ï¼Œéœ€è¦ç¼–è¯‘å™¨æŠŠfuzzerï¼Œtargetï¼Œharnesså…¨éƒ¨é“¾æŽ¥åˆ°ä¸€èµ·ã€‚æ•…ä»¥åº“çš„å½¢å¼åˆ›å»ºé¡¹ç›®ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>cargo new --lib exercise-2&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>åŒæ—¶ï¼Œæœ¬ç¯‡ä¹Ÿç”¨åˆ°äº†Libaflçš„å…¨éƒ¨ç»„ä»¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># execise-2/Cargo.toml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">package&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;exercise-2&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;0.1.0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">edition&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;2021&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">dependencies&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">libafl&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;0.10.1&amp;#34;&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="c"># libafl core&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">libafl_cc&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;0.10.1&amp;#34;&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="c"># compiler wrapper&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">libafl_targets&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;0.10.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">features&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;libfuzzer&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;sancov_pcguard_hitcounts&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;sancov_cmplog&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">]&lt;/span> &lt;span class="p">}&lt;/span> &lt;span class="c"># common code for targets instrumentation&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">lib&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;exercisetwo&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">crate-type&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;staticlib&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ç”Ÿæˆ libexercisetwo.a&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="cargo-make">cargo-make&lt;/h3>
&lt;p>ä½¿ç”¨&lt;code>build.rs&lt;/code>èƒ½å¤Ÿå¢žåŠ è‡ªåŠ¨åŒ–ç¨‹åº¦ï¼Œä½†ç”¨rustå†™shellä¾æ—§ç•¥æ˜¾ç¹çã€‚äºŽæ˜¯åŽŸåšå®¢å¼•å…¥äº† cargo-make å·¥å…·ï¼Œåœ¨cargoåŽŸæœ¬çš„&lt;code>Cargo.toml&lt;/code>åŸºç¡€ä¸ŠåŠ å…¥äº†&lt;code>Makefile.toml&lt;/code>ï¼Œç”¨ä»¥è‡ªå®šä¹‰é…ç½®ï¼Œæž„å»ºè‡ªåŠ¨åŒ–å·¥ä½œæµã€‚
ç±»ä¼¼äºŽ&lt;code>Makefile&lt;/code>ï¼Œåˆæœ‰ç‚¹åƒ&lt;code>docker-compose.yml&lt;/code>ã€‚&lt;/p>
&lt;ul>
&lt;li>å®‰è£…ï¼š&lt;code>cargo install --force cargo-make&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>å¦‚ä¸‹æ‰€ç¤ºï¼Œæ—¢å¯ä»¥æ‰§è¡Œ&lt;code>cargo make build&lt;/code>ä¸€å¥è¯è·‘é€šå…¨éƒ¨ï¼Œä¹Ÿå¯å•ç‹¬æ‰§è¡Œ&lt;code>cargo make build-libexif&lt;/code>ï¼Œååˆ†çµæ´»ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># execise-2/Makefile.toml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">dependencies&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;clean&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;build-compilers&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;copy-project-to-build&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;build-libexif&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;build-fuzzer&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-compilers&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">command&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;cargo&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">args&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;build&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;--release&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">copy-project-to-build&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">script&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">mkdir -p build/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">cp ${CARGO_MAKE_WORKING_DIRECTORY}/../target/release/ex2_compiler build/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">cp ${CARGO_MAKE_WORKING_DIRECTORY}/../target/release/libexercisetwo.a build/
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-fuzzer&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cwd&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;build&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">command&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;./ex2_compiler&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">args&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;-I&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;../libexif/libexif&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-I&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;../libexif&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-o&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;fuzzer&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;../harness.c&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;lib/libexif.a&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># -Idir å¢žåŠ dirä¸ºå¤´æ–‡ä»¶çš„æœç´¢è·¯å¾„&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-libexif&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cwd&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;libexif&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">env&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="s2">&amp;#34;CC&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;/fuzzing101/exercise-2/build/ex2_compiler&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;LLVM_CONFIG&amp;#34;&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;llvm-config-15&amp;#34;&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">script&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">autoreconf -fi
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">./configure --enable-shared=no --prefix=&amp;#34;&lt;/span>&lt;span class="err">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">CARGO_MAKE_WORKING_DIRECTORY&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="p">..&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="nx">build&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="s2">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make -i
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">make install -i
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>çœ‹èµ·æ¥æ¸…çˆ½å¤šäº†ï¼ˆæ­¤æ—¶ðŸ‘´è¿˜æ²¡æœ‰æ„è¯†åˆ°é—®é¢˜çš„ä¸¥é‡æ€§ï¼‰ã€‚&lt;/p>
&lt;h4 id="è¡¥å……linuxå¼€å‘å·¥å…·é“¾">è¡¥å……ï¼šLinuxå¼€å‘å·¥å…·é“¾&lt;/h4>
&lt;blockquote>
&lt;p>./configure é…ç½®: æ ¹æ®Makefile.inæ¨¡æ¿å’Œç³»ç»Ÿä¿¡æ¯ç”ŸæˆMakefile &lt;br>
make ç¼–è¯‘ï¼šæ ¹æ®Makefileå°†æºä»£ç ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ &lt;br>
make install å®‰è£…ï¼šå°†å¯æ‰§è¡Œæ–‡ä»¶å¤åˆ¶åˆ°æ­£ç¡®çš„åœ°æ–¹&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;code>autoreconf&lt;/code>ï¼šå±žäºŽ autotools å·¥å…·é“¾ï¼Œä¹Ÿæ˜¯ç”Ÿæˆmakefileçš„è‡ªåŠ¨åŒ–å·¥å…·ã€‚åŽé€æ¸è¢«cmakeå–ä»£ã€‚ï¼ˆçŽ°åœ¨æµè¡Œçš„æ˜¯Antï¼Ÿï¼‰&lt;/li>
&lt;/ul>
&lt;h3 id="harness--compiler">harness &amp;amp; compiler&lt;/h3>
&lt;h4 id="harnessc">harness.c&lt;/h4>
&lt;p>harnessçš„æ ¸å¿ƒï¼Œä¹Ÿå°±æ˜¯è¢«fuzzerè°ƒç”¨çš„ä½ç½®ï¼Œæ˜¯&lt;code>LLVMFuzzerTestOneInput()&lt;/code>å‡½æ•°ã€‚
å…¶è¾“å…¥æ˜¯ä¸€ä¸ªå­—èŠ‚æ•°ç»„å’Œå…¶å°ºå¯¸ã€‚ä¸»æµfuzzeréƒ½æŽ¥å—è¿™ä¸ªå‡½æ•°å£°æ˜Žï¼Œæˆ–è®¸æ˜¯å› ä¸ºä»–ä»¬åŽç«¯éƒ½ç”¨çš„LLVMçš„Libfuzzerå§ã€‚&lt;/p>
&lt;p>åœ¨Libexifçš„testç›®å½•ä¸‹æœ‰&lt;code>test-fuzzer-persistent.c&lt;/code>ï¼Œæ˜¯ä¸€ä¸ªé€‚ç”¨äºŽAFLæŒä¹…æ¨¡å¼çš„harnessã€‚ç¨åŠ æ”¹é€ å³å¯ï¼š&lt;/p>
&lt;ul>
&lt;li>åˆ é™¤ AFL å®&lt;/li>
&lt;li>åˆ é™¤ä»»ä½•æ‰“å°/æ—¥å¿—è¯­å¥&lt;/li>
&lt;li>å°† &lt;code>main()&lt;/code> é‡å‘½åä¸º &lt;code>LLVMFuzzerTestOneInput()&lt;/code>&lt;/li>
&lt;li>ä¿®å¤å…¶ä»–ç‰ˆæœ¬é—®é¢˜&lt;/li>
&lt;/ul>
&lt;h4 id="compilerrs">compiler.rs&lt;/h4>
&lt;p>æ˜¾ç„¶ï¼Œè¿™éƒ¨åˆ†å¹¶æ²¡æœ‰è®©æˆ‘ä»¬å†™ä¸€ä¸ªç¼–è¯‘å™¨ï¼Œè€Œæ˜¯ä¸€ä¸ªå¥—å£³ï¼Œä¸€å±‚åŒ…è£…(wrapper)ã€‚
è¿™é‡Œå°†targetä¸Žfuzzeré™æ€é“¾æŽ¥åœ¨ä¸€èµ·ï¼Œå¹¶åŠ å…¥&lt;code>-fsanitize=address&lt;/code>å‚æ•°ä»¥ä½¿ç”¨ASANã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// exercise-2/src/bin/ex2_compiler.rs
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">fn&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">cwd&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">env&lt;/span>::&lt;span class="n">current_dir&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">unwrap&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">args&lt;/span>: &lt;span class="nb">Vec&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nb">String&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">env&lt;/span>::&lt;span class="n">args&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="n">collect&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">cc&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">ClangWrapper&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">if&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">code&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">cc&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">cpp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">silence&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">parse_args&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">expect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Failed to parse the command line&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">link_staticlib&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cwd&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s">&amp;#34;exercisetwo&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">add_arg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;-fsanitize-coverage=trace-pc-guard&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">add_arg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;-fsanitize=address&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">run&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">expect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Failed to run the wrapped compiler&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">std&lt;/span>::&lt;span class="n">process&lt;/span>::&lt;span class="n">exit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">code&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¼€å§‹ç¼–å†™fuzzerä¹‹å‰ï¼Œæ ¹æ®é¡¹ç›®çš„æ–‡ä»¶ç»“æž„æ¢³ç†ä¸€ä¸‹ç¼–è¯‘é€»è¾‘ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>build-compilers&lt;/code>: ç”Ÿæˆè‡ªå·±çš„ç¼–è¯‘å™¨ï¼šç¼–è¯‘æ—¶é“¾æŽ¥fuzzeråº“ã€‚&lt;/li>
&lt;li>&lt;code>build-libexif&lt;/code>ï¼šç”¨è‡ªå·±çš„ç¼–è¯‘å™¨ç¼–è¯‘target&lt;/li>
&lt;li>&lt;code>build-fuzzer&lt;/code>ï¼šç”¨è‡ªå·±çš„ç¼–è¯‘å™¨ç¼–è¯‘harnessï¼Œå¹¶é“¾æŽ¥targetåº“&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">|-- Cargo.toml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- Makefile.toml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- corpus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- harness.c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- libexif
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- solutions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">`-- src
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |-- bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> | `-- ex2_compiler.rs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> `-- lib.rs
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="libafl-inprocessæ¨¡å¼">Libafl: Inprocessæ¨¡å¼&lt;/h3>
&lt;h4 id="ç»„ä»¶observer--feedback">ç»„ä»¶ï¼šObserver &amp;amp; Feedback&lt;/h4>
&lt;p>ç”±äºŽæˆ‘ä»¬ä½¿ç”¨çš„ä¸å†æ˜¯&lt;code>afl-clang-fast&lt;/code>ï¼Œè€Œæ˜¯ä½¿ç”¨è‡ªå·±çš„ç¼–è¯‘å™¨wrapperã€‚æ•…&lt;code>__AFL_SHM_ID&lt;/code>å·²ç»ä¸å¥½ä½¿äº†ã€‚å¥½åœ¨&lt;code>libafl_targets&lt;/code>æä¾›äº†EDGES_MAPï¼š&lt;code>std_edges_map_observer&lt;/code>ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">HitcountsMapObserver&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">unsafe&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">std_edges_map_observer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;edges&amp;#34;&lt;/span>&lt;span class="p">)});&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ­¤å¤–ï¼Œç®€å•çš„è¶…æ—¶åé¦ˆä¹Ÿæ”¹ä¸ºäº†çœŸæ­£çš„å´©æºƒåé¦ˆï¼š&lt;code>CrashFeedback&lt;/code>ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">objective&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">feedback_and_fast!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">CrashFeedback&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">MaxMapFeedback&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="ç»„ä»¶monitor--eventmanager--status">ç»„ä»¶ï¼šMonitor &amp;amp; EventManager &amp;amp; Status&lt;/h4>
&lt;p>EventManager åœ¨ Inprocess æ¨¡å¼ä¸­æ‰çœŸæ­£å‘æŒ¥åŠŸç”¨ã€‚å¯¹äºŽå¤šå®žä¾‹çŽ¯å¢ƒï¼Œé€šä¿¡é—®é¢˜å¿…é¡»è§£å†³ã€‚LibAFLè®¾è®¡äº†ä¸€å¥—ä½Žçº§æ¶ˆæ¯ä¼ é€’åè®®(LLMP)ï¼Œä½¿ç”¨C-Sæž¶æž„ï¼Œç¬¬ä¸€ä¸ªæ‰§è¡Œçš„fuzzerä½œä¸ºä»£ç†(Broker)ï¼ŒåŽç»­æ‰§è¡Œçš„å‡ä½œä¸ºå®¢æˆ·ç«¯(Client)ã€‚Clientè´Ÿè´£ä¸æ–­æ‰§è¡Œï¼Œå°†ä¿¡æ¯æ±‡æ€»ä¸ŽBrokerç»¼åˆå±•ç¤ºã€‚&lt;/p>
&lt;p>æ­¤å¤–ï¼Œ Inprocess æ¨¡å¼è¿˜å¿…é¡»è®¾å®šè¿›ç¨‹çš„é‡å¯ï¼Œ&lt;code>setup_restarting_mgr_std&lt;/code>ç¬¬ä¸€æ¬¡æ‰§è¡Œä¸­è¿”å›ž&lt;code>(None, LlmpRestartingEventManager)&lt;/code>ï¼ŒåŽç»­åˆ™è¿”å›žä¸Šä¸€ä¸ªè¿›ç¨‹ç•™ä¸‹çš„çŠ¶æ€ï¼Œä»¥æ­¤å®žçŽ°çŠ¶æ€çš„æ°¸ç»­ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">monitor&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">MultiMonitor&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">});&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// MultiMonitor: åŒæ—¶æ”¯æŒBrokeræ¨¡å¼æˆ–Clientæ¨¡å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">state&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">mgr&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">match&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">setup_restarting_mgr_std&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">monitor&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1337&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">EventConfig&lt;/span>::&lt;span class="n">AlwaysUnique&lt;/span>&lt;span class="p">){&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">err&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">match&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">err&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">Error&lt;/span>::&lt;span class="n">ShuttingDown&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(());&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">_&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">panic!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Failed to setup the restarting manager: &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">err&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">},&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">state&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">state&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">unwrap_or_else&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">||&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">StdState&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">StdRand&lt;/span>::&lt;span class="n">with_seed&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">current_nanos&lt;/span>&lt;span class="p">()),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">input_corpus&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">solutions_corpus&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">feedback&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">objective&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">unwrap&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">});&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="rust-åŸºç¡€ä¹‹å‡½æ•°è¿”å›žå€¼æ¨¡å¼åŒ¹é…ä¸Žé”™è¯¯å¤„ç†">Rust åŸºç¡€ä¹‹å‡½æ•°è¿”å›žå€¼ã€æ¨¡å¼åŒ¹é…ä¸Žé”™è¯¯å¤„ç†&lt;/h4>
&lt;p>æœ¬ä¾‹ä¸­çš„&lt;code>mgr&lt;/code>æ˜¯ä¸€ä¸ªç»å…¸çš„matchç”¨æ³•ï¼Œç”¨matchå¤„ç†å‡½æ•°çš„è¿”å›žå€¼ã€‚ä¸‹é¢æŠŠæ¦‚å¿µå’Œç¬¦å·æ‹ä¸€éï¼š&lt;/p>
&lt;h5 id="å‡½æ•°">å‡½æ•°&lt;/h5>
&lt;p>Rust çš„å‡½æ•°ä½“ç”±ä¸€ç³»åˆ—è¯­å¥ç»„æˆï¼Œæœ€åŽç”±è¡¨è¾¾å¼ç»“å°¾ã€‚å¿…é¡»ä¸¥æ ¼åˆ†åˆ«è¡¨è¾¾å¼å’Œè¯­å¥ã€‚å› ä¸ºè¡¨è¾¾å¼ä»£è¡¨ä¸€ä¸ªè¿”å›žå€¼ï¼Œè€Œè¯­å¥ä¸è¿”å›žã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">fn&lt;/span> &lt;span class="nf">FUNC&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">PARAM&lt;/span>: &lt;span class="nc">TYPE&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">PARAM&lt;/span>: &lt;span class="nc">TYPE&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="p">.)&lt;/span>&lt;span class="w"> &lt;/span>-&amp;gt; &lt;span class="nc">RETURN_TYPE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="no">STATEMANT&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="no">EXPRESSION&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>;&lt;/code>: æ ‡è¯†ä¸€æ¡è¯­å¥ã€‚è¡¨è¾¾å¼æ²¡æœ‰åˆ†å·ã€‚&lt;/li>
&lt;li>&lt;code>!&lt;/code>: æ ‡è¯†å‘æ•£å‡½æ•°(diverge function)ï¼Œæ²¡æœ‰è¿”å›žå€¼ã€‚å¦‚&lt;code>println!(&amp;quot;{}&amp;quot;, s)&lt;/code>ï¼Œ&lt;code>panic!()&lt;/code>
&lt;ul>
&lt;li>&lt;code>panic!()&lt;/code>: çº¿ç¨‹ææ…Œã€‚å•çº¿ç¨‹ç¨‹åºå³æŠ¥é”™é€€å‡ºã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>()&lt;/code>: ç©ºå…ƒç»„ï¼Œä¸å ç”¨å†…å­˜ã€‚æ— è¿”å›žå€¼æ—¶çš„è¿”å›žå€¼ã€‚&lt;/li>
&lt;/ul>
&lt;h5 id="æ¨¡å¼åŒ¹é…">æ¨¡å¼åŒ¹é…&lt;/h5>
&lt;p>matchç›¸å½“äºŽswitchçš„åŠ å¼ºç‰ˆï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">match&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">VALUE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="no">PATTERN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">EXPRESSION&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="no">PATTERN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">EXPRESSION&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">..&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>&lt;code>_&lt;/code>: è¡¨ç¤ºå‰©ä½™æƒ…å†µçš„PATTERNã€‚&lt;/li>
&lt;li>exhaustiveç‰¹æ€§ï¼šå˜é‡çš„æ‰€æœ‰å¯èƒ½æ€§å¿…é¡»å…¨éƒ¨è¢«è¦†ç›–ã€‚&lt;/li>
&lt;/ul>
&lt;h5 id="é”™è¯¯å¤„ç†">é”™è¯¯å¤„ç†&lt;/h5>
&lt;p>å‡½æ•°è¿”å›žå€¼å¸¸ç”¨ä¸¤ç±»æ³›åž‹æžšä¸¾è¿›è¡ŒåŒ…è£…ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="k">pub&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">enum&lt;/span> &lt;span class="nb">Option&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// å¯é€‰å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">None&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// å¯ä»¥æ²¡æœ‰å€¼ã€‚é€‚ç”¨äºŽè®¸å¤šæƒ…å†µï¼šåˆå§‹å€¼ï¼Œå¯é€‰å‚æ•°ï¼Œé”™è¯¯(ä¸ä¼španic!)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Some&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// å¿…é¡»æœ‰å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">enum&lt;/span> &lt;span class="nb">Result&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">E&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// è¿”å›žå€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">E&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// Errå¯ä»¥ä¸panic!
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Rustå¯¹Resultå®žçŽ°äº†è®¸å¤šæ–¹ä¾¿çš„æ–¹æ³•ï¼Œè¯¦æƒ…è¯·å‚é˜…æ–‡æ¡£ã€‚&lt;/p>
&lt;ul>
&lt;li>&lt;code>unwrap()&lt;/code>ï¼šè§£åŒ…Resultï¼Œæ‰èƒ½èŽ·å–å€¼
&lt;ul>
&lt;li>å¯¹&lt;code>None&lt;/code>æ‰§è¡Œåˆ™panic!&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>?&lt;/code>ï¼šè¯­æ³•ç³–ï¼Œå°†Errå¯¹è±¡ä¼ æ’­å‡ºæ¥ï¼Œè¿›ä¸€æ­¥ä½¿ä»£ç ç®€æ´ã€‚&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">match&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">FUNC&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">return&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">Err&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nb">Ok&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&amp;gt;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">f&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">result&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="no">FUNC&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">//ç­‰ä»·å†™æ³•
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å‚è€ƒæ–‡æ¡£ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a class="link" href="https://rustwiki.org/zh-CN/std/option/index.html" target="_blank" rel="noopener"
>https://rustwiki.org/zh-CN/std/option/index.html&lt;/a>&lt;/li>
&lt;li>&lt;a class="link" href="https://rustwiki.org/zh-CN/std/result/index.html" target="_blank" rel="noopener"
>https://rustwiki.org/zh-CN/std/result/index.html&lt;/a>&lt;/li>
&lt;/ul>
&lt;h4 id="ç»„ä»¶harness--executor">ç»„ä»¶ï¼šHarness &amp;amp; Executor&lt;/h4>
&lt;p>åœ¨fuzzerä¾§ï¼Œ&lt;code>LLVMFuzzerTestOneInput()&lt;/code>å¯¹åº”&lt;code>libfuzzer_test_one_input()&lt;/code>å‡½æ•°&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">harness&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">input&lt;/span>: &lt;span class="kp">&amp;amp;&lt;/span>&lt;span class="nc">BytesInput&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">input&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">target_bytes&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">buffer&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">as_slice&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">libfuzzer_test_one_input&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buffer&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">ExitKind&lt;/span>::&lt;span class="nb">Ok&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">in_proc_executor&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">InProcessExecutor&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">harness&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">tuple_list!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">time_observer&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">fuzzer&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">state&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">mgr&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="n">unwrap&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>fuzzerå†™å®Œäº†ï¼Œå–„ï¼&lt;/p>
&lt;h4 id="rust-åŸºç¡€ä¹‹é—­åŒ…">Rust åŸºç¡€ä¹‹é—­åŒ…&lt;/h4>
&lt;p>é—­åŒ…(closure)ï¼Œä¸€èˆ¬è¯­è¨€çš„é—­åŒ…å°±æ˜¯ lambda è¡¨è¾¾å¼æˆ–åŒ¿åå‡½æ•°ï¼Œåœ¨Rustä¸­è¿˜è¦åŠ ä¸Šæ•èŽ·å¤–éƒ¨çŽ¯å¢ƒä¸­çš„å˜é‡çš„èƒ½åŠ›ã€‚&lt;/p>
&lt;p>é—­åŒ…æ•èŽ·å˜é‡çš„æ–¹å¼åˆ†ä¸ºä¸‰ç±»ï¼šæŒ‰é¡ºåºæ•èŽ·&lt;/p>
&lt;ul>
&lt;li>Fnï¼šè¡¨ç¤ºæ•èŽ·æ–¹å¼ä¸ºé€šè¿‡ä¸å¯å˜å¼•ç”¨ï¼ˆ&amp;amp;Tï¼‰çš„é—­åŒ…&lt;/li>
&lt;li>FnMutï¼šè¡¨ç¤ºæ•èŽ·æ–¹å¼ä¸ºé€šè¿‡å¯å˜å¼•ç”¨ï¼ˆ&amp;amp;mut Tï¼‰çš„é—­åŒ…&lt;/li>
&lt;li>FnOnceï¼šè¡¨ç¤ºæ•èŽ·æ–¹å¼ä¸ºé€šè¿‡å€¼ï¼ˆTï¼‰çš„é—­åŒ…&lt;/li>
&lt;/ul>
&lt;p>å®žé™…ä¸Šï¼Œé—­åŒ…å°±æ˜¯è¿™ä¸‰ç§Traitçš„è¯­æ³•ç³–ã€‚å…³äºŽTraitç›®å‰å¤§è‡´ç†è§£æˆæŸç§è§„å®šæ³›åž‹å¯¹è±¡çš„è¡Œä¸ºçš„ä¸œè¥¿ã€‚å¦‚ä¸Šé¢çš„ä¸‰ç±»å‡½æ•°ï¼Œä¸åŒç¨‹åº¦ä¸Šçº¦æŸäº†æ³›åž‹ã€‚æ·±åº¦å†…å®¹ç•™å¾…åŽæ–‡å­¦ä¹ ã€‚&lt;/p>
&lt;p>ç©¶ç«Ÿä½•ä¸ºâ€œæ•èŽ·â€ï¼ŸRustæ˜¯æ²¡æœ‰åžƒåœ¾å›žæ”¶çš„è¯­è¨€ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ç”Ÿå‘½å‘¨æœŸã€‚å¼•ç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ†æžå˜é‡ç”Ÿå‘½å‘¨æœŸï¼Œä»¥å†³å®šä½¿ç”¨å“ªä¸ªTraitã€‚&lt;/p>
&lt;p>è¿˜å¯ä»¥ä½¿ç”¨å…³é”®å­—&lt;code>move&lt;/code>å¼ºåˆ¶è½¬ç§»æ‰€æœ‰æƒåˆ°é—­åŒ…ä¸­&lt;/p>
&lt;p>å‚è€ƒæ–‡æ¡£ï¼šhttps://rustwiki.org/zh-CN/rust-by-example/fn/closures/capture.html&lt;/p>
&lt;h3 id="è·‘">è·‘ðŸƒâ€&lt;/h3>
&lt;p>ä½¿ç”¨ASANå¾ˆå¿«å°±å‘çŽ°äº†å´©æºƒï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[AFL++ ae703a5ce157] /fuzzing101/exercise-2 # taskset -c 4 ./build/fuzzer
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Broker #0] (GLOBAL) run time: 0h-0m-57s, clients: 0, corpus: 0, objectives: 0, executions: 0, exec/sec: 0.000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> (CLIENT) corpus: 0, objectives: 0, executions: 0, exec/sec: 0.000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------------8&amp;lt;-------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Stats #3] (GLOBAL) run time: 0h-1m-0s, clients: 4, corpus: 3, objectives: 0, executions: 6, exec/sec: 0.000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> (CLIENT) corpus: 3, objectives: 0, executions: 6, exec/sec: 0.000, edges: 9/10 (90%)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[Testcase #3] (GLOBAL) run time: 0h-1m-0s, clients: 4, corpus: 4, objectives: 0, executions: 8, exec/sec: 0.000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> (CLIENT) corpus: 4, objectives: 0, executions: 8, exec/sec: 0.000, edges: 9/10 (90%)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;img src="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/crash.png"
width="1533"
height="1012"
srcset="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/crash_hu8fed232e790a612be86a124f44e3115c_224593_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/crash_hu8fed232e790a612be86a124f44e3115c_224593_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="151"
data-flex-basis="363px"
>&lt;/p>
&lt;h4 id="debugæˆ‘logåŽ»å“ªäº†">Debugï¼šæˆ‘logåŽ»å“ªäº†&lt;/h4>
&lt;p>ä½†ç»“æžœå¹¶ä¸è®©äººæ»¡æ„ï¼Œèµ·å› æ˜¯&lt;code>cargo make build&lt;/code>æ‰§è¡Œå¹¶æœªæˆåŠŸï¼Œä¸Šè¿°ç»“æžœæ˜¯æ‰‹åŠ¨ç¼–è¯‘å¾—åˆ°ã€‚æŠ¥é”™å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[cargo-make] INFO - Running Task: build-libexif
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------------8&amp;lt;-------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking for a BSD-compatible install... /usr/bin/install -c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking whether build environment is sane... yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking for a race-free mkdir -p... /usr/bin/mkdir -p
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking for gawk... no
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking for mawk... mawk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking whether make sets $(MAKE)... yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking whether make supports nested variables... yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking for POSIX sh $() command substitution... yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking for gcc... /fuzzing101/exercise-2/build/ex2_compiler
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checking whether the C compiler works... no
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configure: error: in `/fuzzing101/exercise-2/libexif&amp;#39;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configure: error: C compiler cannot create executables
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">See `config.log&amp;#39; for more details
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[cargo-make] ERROR - Error while executing command, exit code: 77
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[cargo-make] WARN - Build Failed.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å®ƒæç¤ºæˆ‘ï¼Œæˆ‘çš„ç¼–è¯‘å™¨ä¸å¤§å¥½ä½¿ã€‚ä½†æ˜¯è¾ƒä¸ºç¦»è°±çš„æ˜¯æ‰‹åŠ¨æ‰§è¡Œç¼–è¯‘å´æ²¡é—®é¢˜ã€‚
é‚£ä¹ˆæˆ‘ä»¬çœ‹çœ‹&lt;code>config.log&lt;/code>å§ï¼Œç„¶åŽå°±æœ‰ä¸ªé—®é¢˜ï¼Œ&lt;code>config.log&lt;/code>åˆ°åº•è—å“ªäº†ã€‚&lt;/p>
&lt;blockquote>
&lt;p>ðŸ‘´ï¼šä½ æ ¹æœ¬ä¸åœ¨å·¥ä½œç›®å½•ï¼Œä½ èº²å“ªåŽ»äº† &lt;br>
cargo make: æˆ‘ä¸åˆ°å•Š&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/daoge.png"
width="480"
height="532"
srcset="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/daoge_hucb44c3664558582803009d3f384168af_251000_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/daoge_hucb44c3664558582803009d3f384168af_251000_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="90"
data-flex-basis="216px"
>&lt;/p>
&lt;p>è¿™ä¸ªå¹½çµé—®é¢˜æŠ˜ç£¨äº†æˆ‘è®¸ä¹…ï¼Œç›´åˆ°æˆ‘æ„è¯†åˆ°&lt;code>Makefile.toml&lt;/code>é‡Œé¢çš„cleané€‰é¡¹ã€‚ã€‚ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">... rest of stderr output deleted ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configure:3778: $? = 0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configure:3767: /fuzzing101/exercise-2/build/ex2_compiler -V &amp;gt;&amp;amp;5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">clang: error: unsupported option &amp;#39;-V -g&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">clang: error: no such file or directory: &amp;#39;/fuzzing101/exercise-2/libexif/libexercisetwo.a&amp;#39;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è™½ç„¶è¿˜æ˜¯ä¸ç†è§£ä¸ºä»€ä¹ˆï¼Œä½†æ˜¯ç…§çŒ«ç”»è™ŽæŠŠ&lt;code>libexercisetwo.a&lt;/code>æ”¾å…¥å°±ç¼–è¯‘æˆåŠŸäº†ã€‚&lt;/p>
&lt;h4 id="debugå†…å­˜çˆ†äº†">Debugï¼šå†…å­˜çˆ†äº†ï¼&lt;/h4>
&lt;p>å°½ç®¡å¾ˆå¿«è·‘å‡ºcrashï¼Œä½†fuzzerç»å¸¸å´©æºƒé€€å‡ºï¼Œå¯¼è‡´å¹¶æ²¡æœ‰crashä¿å­˜ã€‚æŠ¥é”™å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">thread &amp;#39;&amp;lt;unnamed&amp;gt;&amp;#39; panicked at &amp;#39;Fuzzer-respawner: Storing state in crashed fuzzer instance did not work, no point to spawn the next client! This can happen if the child calls `exit()`, in that case make sure it uses `abort()`, if it got killed unrecoverable (OOM), or if there is a bug in the fuzzer itself. (Child exited with: 9)&amp;#39;, /root/.cargo/registry/src/index.crates.io-6f17d22bba15001f/libafl-0.10.1/src/events/llmp.rs:1071:21
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fatal runtime error: failed to initiate panic, error 5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Aborted
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æŠ¥é”™å‘Šè¯‰æˆ‘ä»¬å¯èƒ½æœ‰ä»¥ä¸‹åŽŸå› ï¼š&lt;/p>
&lt;ul>
&lt;li>child calls &lt;code>exit()&lt;/code>ï¼šæˆ‘è·‘çš„ç¡®å®žæ˜¯&lt;code>ASAN_OPTIONS=abort_on_error=1 taskset -c 6 ./build/fuzzer&lt;/code>&lt;/li>
&lt;li>fuzzeræœ‰bugï¼šæˆ‘å¯ä»¥ä¸ç›¸ä¿¡æˆ‘è‡ªå·±ï¼Œä½†æˆ‘ä¸èƒ½ä¸ç›¸ä¿¡ Rustã€‚&lt;/li>
&lt;li>OOMï¼šå†…å­˜æº¢å‡ºã€‚è§‚å¯Ÿä¸‹ä»»åŠ¡ç®¡ç†å™¨ï¼Œå¯ä»¥å‘çŽ°fuzzeræ‰§è¡ŒåŽå†…å­˜å ç”¨è¿…é€Ÿé£™å‡ï¼Œåœ¨è¾¾åˆ°90%åŽfuzzerç¨³å®šå´©æºƒé€€å‡ºã€‚&lt;/li>
&lt;/ul>
&lt;p>é‚£ä¹ˆåŸºæœ¬ç¡®è®¤æ˜¯å†…å­˜æº¢å‡ºçš„é—®é¢˜ã€‚ðŸ‘´çš„16Gå±žå®žä¸å ªå¤§ç”¨ï¼Œè¿™ä¸‹ä¸å¾—ä¸ä¹°å†…å­˜æ¡äº†ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆåŸºæœ¬ç¡®è®¤é—®é¢˜æ— è§£äº†å—ï¼ŸðŸ‘´å¼€å§‹æ€€ç–‘é—®é¢˜å‡ºåœ¨Dockerä¸Šã€‚äºŽæ˜¯ðŸ‘´å›žåˆ°å®¿ä¸»æœº WSL2 ä¸Šé‡æ–°é…çŽ¯å¢ƒã€‚è¿˜æ˜¯åœ¨æ‰§è¡Œ&lt;code>cp build/libexercisetwo.a libexif&lt;/code>ä¹‹åŽæˆåŠŸç¼–è¯‘ã€‚&lt;/p>
&lt;p>è¿™æ¬¡èƒ½å¤Ÿç¨³å®šè¿è¡Œä¸€æ®µæ—¶é—´äº†ï¼Œå¹¶ä¸”æˆåŠŸèŽ·å¾—objectiveã€‚ðŸ‘´å°±æ˜¯ä¸ªç¿æ™ºã€‚&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/final.png"
width="1366"
height="584"
srcset="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/final_hu189931506a8648410d5552fb49660c91_955953_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/final_hu189931506a8648410d5552fb49660c91_955953_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="233"
data-flex-basis="561px"
>&lt;/p>
&lt;p>ðŸ‘´å®£å¸ƒå®žéªŒ2å®Œæˆã€‚&lt;/p>
&lt;h3 id="æˆæžœè½åœ°">æˆæžœè½åœ°&lt;/h3>
&lt;p>å¥½å§è¿˜æœ‰æœ€åŽä¸€æ­¥ã€‚åœ¨è¯¸å¤šcrashä¸­å¯èƒ½æœ‰å¤§é‡å‡é˜³æ€§ï¼Œå¤§é‡é‡å¤æ¼æ´žï¼Œä¸ºäº†èŽ·å¾—æœ€ç»ˆçš„CVEç¼–å·ï¼Œè¿˜éœ€è¦è´¹æ—¶è´¹åŠ›çš„è¾¨åˆ«ã€‚AFLTriage å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„è‡ªåŠ¨åŒ–å·¥å…·ï¼Œå®ƒä½¿ç”¨ GDB å¹¶è¡Œçš„æ‰§è¡Œæ¼æ´žåˆ†ç±»ã€ ASAN è§£æžå’Œ crash åŽ»é‡ç­‰å·¥ä½œã€‚&lt;/p>
&lt;p>AFLTriage çš„å·¥ä½œæµç¨‹ååˆ†ç®€å•ï¼šå°†crashä¾æ¬¡ä¸¢è¿›targetæ‰§è¡Œï¼Œå¹¶è§£è¯»æ‰§è¡ŒæŠ¥å‘Šã€‚
å› æ­¤ï¼Œé¦–å…ˆè¦ä¸ºharnessæ·»åŠ ä¸€ä¸ªmainå‡½æ•°ï¼Œä½¿å…¶è°ƒç”¨ä¸€æ¬¡&lt;code>LLVMFuzzerTestOneInput()&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// harness.c
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cp">#ifdef TRIAGE_TESTER
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">argv&lt;/span>&lt;span class="p">[])&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="nc">stat&lt;/span> &lt;span class="n">st&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">filename&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">stat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">st&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">FILE&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">fd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">filename&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;rb&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">buffer&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">st&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">st_size&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buffer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">st&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">st_size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">LLVMFuzzerTestOneInput&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buffer&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">st&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">st_size&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buffer&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fclose&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#endif
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œé€šè¿‡&lt;code>#ifdef&lt;/code>å®æŒ‡ä»¤å’Œbuildé€‰é¡¹å¯¹åº”ï¼Œæ‰§è¡Œ&lt;code>cargo make build-triager&lt;/code>å³å¯è¿›å…¥åˆ†ç±»æµç¨‹ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">tasks&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">build-triager&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">cwd&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;build&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">command&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;./ex2_compiler&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">args&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;-D&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;TRIAGE_TESTER&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-I&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;../libexif/libexif&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-I&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;../libexif&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;-o&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;triager&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;../harness.c&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;lib/libexif.a&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æœ€åŽæ‰§è¡ŒAFLTriageï¼š&lt;code>../AFLTriage/target/release/afltriage -i ./solutions/ -o ./reports/ ./build/triager @@&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/traige.png"
width="1252"
height="587"
srcset="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/traige_hu377d03d0596fd3cb6672fca4fa7c6181_590421_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-2/traige_hu377d03d0596fd3cb6672fca4fa7c6181_590421_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="213"
data-flex-basis="511px"
>&lt;/p>
&lt;p>å¾—åˆ°3ä¸ªreportï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">afltriage_ASAN_heap-buffer-overflow_READ_exif_entry_get_value_f8a5a368646cf8484298dd0549da6e12.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">afltriage_ASAN_unknown-crash_WRITE_exif_mnote_data_olympus_save_1e4a69a1a4d7585d8ae1e143a3b5eb94.txt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">afltriage_SIGSEGV___memmove_sse2_unaligned_erms_b1cfe4f5c38c4991e7c55dccdfb06372.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ðŸ‘´è¿˜æœ‰ç‚¹æ€€ç–‘ASANçš„è¾“å‡ºå¥½åƒéƒ½æ˜¯fuzzeré‡Œé¢çš„bugï¼Œä½†æ˜¯é˜…è¯»æŠ¥å‘Šä¹‹åŽå‘çŽ°ç¡®å®žæ˜¯targeté‡Œé¢çš„ã€‚åªæ˜¯åŽŸåšå®¢çš„ASANèƒ½å¤ŸæŒ‡å‡ºTargetæºä»£ç çš„è¡Œå·ï¼ŒðŸ‘´çš„åªèƒ½æ‹¿åˆ°äºŒè¿›åˆ¶åœ°å€ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">Summary: ASAN detected heap-buffer-overflow in exif_entry_get_value after a READ leading to SIGABRT (si_signo=6) / SI_TKILL (si_code=-6)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------------8&amp;lt;-------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">#10 0x0000555555695c85 in exif_entry_get_value (/home/czy/fuzzing-101-solutions/exercise-2/build/triager)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 542: const exif_entry_get_value(e = (ExifEntry *)0x604000000350, val = (char *)&amp;lt;optimized out&amp;gt;, maxlen = (unsigned int)1999) {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |||:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |||: /* Local reference: ExifEntry * e = 0x604000000350; */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 682: */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 683: if (e-&amp;gt;size &amp;amp;&amp;amp; e-&amp;gt;data &amp;amp;&amp;amp;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 684: (strspn ((char *)e-&amp;gt;data, &amp;#34; &amp;#34;) != strlen ((char *) e-&amp;gt;data)))
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |||:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ---: }
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> at exif-entry.c:684
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åªèƒ½è¯´ðŸ‘´çš„çŽ¯å¢ƒè¿˜æ˜¯æœ‰ç‚¹æ¯›ç—…ï¼Œ WSL2 é‡Œé¢è·‘æ¯” WSL2+Docker é‡Œé¢è·‘ï¼Œç¨³å®šè¿è¡Œæ—¶é—´é•¿ï¼Œä½†ä¹Ÿä¸è¶…è¿‡ä¸‰åˆ†é’Ÿã€‚ðŸ‘´åªèƒ½æ‰‹åŠ¨æ–­æ–­ç»­ç»­çš„é‡æ–°è·‘ï¼Œè¿™æ ·fuzzerçš„çŠ¶æ€å…¶å®žæ˜¯ä¸¢å¤±äº†çš„ã€‚åŽé¢çš„å®žéªŒè¿˜æ˜¯åˆ«æŠ˜è…¾æˆ‘è¿™ä¸ªç ´æœ¬å­äº†ã€‚&lt;/p>
&lt;p>è€Œä¸”è·‘å‡ºæ¥çš„crashðŸ‘´çœ‹ç€ä¹Ÿä¸åƒé¢„æœŸè¦æŒ–çš„é‚£ä¿©CVEã€‚ä½†æ˜¯è¿™äº›éƒ½ä¸å½±å“ðŸ‘´å†æ¬¡å®£å¸ƒå®žéªŒ2å®Œæˆã€‚&lt;/p></description></item><item><title>libAFLé€Ÿé€šFuzzing101 (1)</title><link>https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-1/</link><pubDate>Wed, 26 Jul 2023 02:54:55 +0800</pubDate><guid>https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-1/</guid><description>&lt;img src="https://lonelyuan.github.io/p/libafl%E9%80%9F%E9%80%9Afuzzing101-1/exe1.png" alt="Featured image of post libAFLé€Ÿé€šFuzzing101 (1)" />&lt;blockquote>
&lt;p>æœ¬ç³»åˆ—æ˜¯å­¦ä¹ &lt;a class="link" href="https://epi052.gitlab.io/notes-to-self/blog/2021-11-01-fuzzing-101-with-libafl/" target="_blank" rel="noopener"
>ã€ŠFuzzing101 with LibAFLã€‹&lt;/a>ç³»åˆ—åšå®¢ï¼ˆåŽæ–‡ç»Ÿç§°ï¼šåŽŸåšå®¢ï¼‰çš„ç¬”è®°åˆ†äº«ï¼Œåœ¨å­¦ä¹ ä»‹ç» LibAFL ç”¨æ³•çš„åŒæ—¶æ€»ç»“ Rust çŸ¥è¯†ç‚¹ã€‚&lt;br>
&lt;strong>å‰ç½®çŸ¥è¯†&lt;/strong>ï¼š fuzzåŸºæœ¬æ¦‚å¿µã€AFLåŸºæœ¬ä½¿ç”¨ &lt;br>
&lt;strong>æœ¬ç¯‡è¦ç‚¹&lt;/strong>ï¼š&lt;/p>
&lt;ul>
&lt;li>LibAFL
&lt;ul>
&lt;li>9å¤§ç»„ä»¶&lt;/li>
&lt;li>Forkserveræ¨¡å¼ï¼šç®€å•ç»„è£…&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Rust
&lt;ul>
&lt;li>Cargo åŸºæœ¬ä½¿ç”¨&lt;/li>
&lt;li>å˜é‡æ‰€æœ‰æƒï¼š
&lt;ul>
&lt;li>è½¬ç§»(move) å’Œ æ‹·è´(copy)&lt;/li>
&lt;li>å¼•ç”¨(reference) å’Œ å€Ÿç”¨(borrowing)&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;hr>
&lt;h2 id="æ˜¯ä¸æ˜¯æžfuzzçš„éƒ½åœ¨æžrust">æ˜¯ä¸æ˜¯æžfuzzçš„éƒ½åœ¨æžrust&lt;/h2>
&lt;p>&lt;a class="link" href="https://github.com/antonio-morales/Fuzzing101" target="_blank" rel="noopener"
>Fuzzing101&lt;/a>æ˜¯å¤§åé¼Žé¼Žçš„ Fuzzing å…¥é—¨æ•™ç¨‹ã€‚ðŸ‘´ä¹‹å‰æžè¿‡ä¸€ç‚¹ï¼Œæ•…è¿™æ¬¡æ•´ç‚¹èŠ±æ´»ã€‚çœ‹åˆ°æœ‰ä¸ªå«&lt;a class="link" href="https://epi052.gitlab.io/notes-to-self/blog/" target="_blank" rel="noopener"
>epi052&lt;/a>çš„å¤§ä½¬ç”¨ LibAFL åš Fuzzing101ï¼ŒäºŽæ˜¯ðŸ‘´ä¹Ÿè·Ÿç€å­¦ä¸€æ³¢rustã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/AFLplusplus/LibAFL" target="_blank" rel="noopener"
>LibAFL&lt;/a>æ˜¯ç”¨ Rust å†™çš„ Fuzzing æ¡†æž¶ï¼Œä¸»è¦è´¡çŒ®åœ¨äºŽç»™å‡ºäº†ä¸€å¥— Fuzzer çš„æ ‡å‡†åŒ–å®šä¹‰ï¼Œä»¥æ­¤è¯•å›¾æ”¹å–„å½“ä»Š Fuzzing ç ”ç©¶ç•Œæˆæžœå€å‡ºä½†äº’ä¸å…¼å®¹ï¼Œç»å¸¸é‡å¤é€ è½®å­çš„çŽ°è±¡ã€‚&lt;/p>
&lt;p>LibAFL éš¶å±žäºŽ AFL++ é¡¹ç›®ç»„ï¼Œæ•…éœ€è¦å…ˆé…ç½® AFL++ ã€‚è€Œ AFL++ çš„å®˜æ–¹ Docker é•œåƒå°±åŒ…å«äº† Rust çŽ¯å¢ƒï¼Œæ‰€ä»¥ä½¿ç”¨ Docker é… LibAFL çŽ¯å¢ƒå°±åªéœ€ä¸€å¥è¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker pull aflplusplus/aflplusplus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker run -ti -v ./Fuzzing101:/fuzzing101 aflplusplus/aflplusplus
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="execise-1-xpdf">Execise-1 xpdf&lt;/h2>
&lt;p>ç»ƒä¹ ä¸€ä¸»è¦æ˜¯ç†Ÿæ‚‰åŸºæœ¬æµç¨‹ã€‚ä½¿ç”¨AFLä¸»è¦æœ‰ä»¥ä¸‹æ­¥éª¤ï¼š&lt;/p>
&lt;ul>
&lt;li>ç›®æ ‡ç¼–è¯‘æ’æ¡©ã€‚å¦‚ï¼š&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">LLVM_CONFIG&lt;/span>&lt;span class="o">=&lt;/span>llvm-config-15
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CC&lt;/span>&lt;span class="o">=&lt;/span>afl-clang-fast &lt;span class="nv">CXX&lt;/span>&lt;span class="o">=&lt;/span>afl-clang-fast++ ./configure --prefix&lt;span class="o">=&lt;/span>./install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make install
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>è¯­æ–™åº“å‡†å¤‡&lt;/li>
&lt;li>æ‰§è¡Œafl-fuzz&lt;/li>
&lt;/ul>
&lt;p>Let&amp;rsquo;s see å¦‚ä½•ç”¨Rustå®Œæˆä¸Šè¿°æ­¥éª¤ã€‚&lt;/p>
&lt;h3 id="rust-åŸºç¡€ä¹‹cargo">Rust åŸºç¡€ä¹‹cargo&lt;/h3>
&lt;p>åœ¨ Rust ä¸­ï¼Œå¯ä»¥ç”¨&lt;code>rustc&lt;/code>ç¼–è¯‘å•ä¸ªæ–‡ä»¶ï¼Œæ›´å¸¸è§çš„æ˜¯ä½¿ç”¨åŒ…ç®¡ç†å™¨&lt;code>cargo&lt;/code>ã€‚&lt;/p>
&lt;h4 id="cargotoml">Cargo.toml&lt;/h4>
&lt;p>è¿è¡Œ&lt;code>cargo new&lt;/code>åˆ›å»ºä¸€ä¸ª package ï¼Œå…¶ä¸­å¿…æœ‰&lt;code>Cargo.toml&lt;/code>ï¼Œæè¿° package å¦‚ä½•æž„å»ºã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># execise-1/Cargo.toml&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">package&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">name&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;exercise-1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">version&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;0.1.0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">edition&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;2021&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">build&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;build.rs&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">[&lt;/span>&lt;span class="nx">dependencies&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">libafl&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;0.10.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æœ¬é¡¹ç›®é¦–å…ˆè§„å®šäº†æž„å»ºè„šæœ¬ä¸º&lt;code>build.rs&lt;/code>ï¼Œç„¶åŽå¼•å…¥äº† libafl ä¾èµ–ã€‚
è¿è¡Œ&lt;code>cargo build&lt;/code>æ—¶ï¼ŒCargo ä¼šè‡ªåŠ¨å¤„ç†ä¾èµ–ã€‚(åŒ…æ‹¬ crates.io ä¸‹è½½å®‰è£…ï¼Œæˆ‘è§‰å¾—è¿™å°±æ˜¯çŽ°ä»£è¯­è¨€çš„ä¸€ç§è‡ªä¿¡)&lt;/p>
&lt;h4 id="buildrs">build.rs&lt;/h4>
&lt;p>æž„å»ºè„šæœ¬æ˜¯ä¸ºäº†æ–¹ä¾¿ Rust é¡¹ç›®ä¸Žç¬¬ä¸‰æ–¹å·¥å…·çš„é›†æˆã€‚æ¯”å¦‚ä¸Šæ–‡ä¸­ç›®æ ‡ç¼–è¯‘çš„å‡ æ¡æŒ‡ä»¤ï¼Œå°±å¯ä»¥ç”¨ Rust std åº“ä¸­çš„Commandç±»æ¥æ‰§è¡Œã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// make clean;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="n">Command&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;make&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">arg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;clean&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">current_dir&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">xpdf_dir&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">clone&lt;/span>&lt;span class="p">())&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">status&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">expect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Couldn&amp;#39;t clean xpdf directory&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä½¿ç”¨æž„å»ºè„šæœ¬è¿˜æœ‰è®¸å¤šå¥½å¤„ï¼Œå¯ä»¥åˆ©ç”¨ Cargo é‡‡å–æ›´çµæ´»çš„æž„å»ºç­–ç•¥ã€‚æž„å»ºè„šæœ¬çš„è¾“å‡ºå¯ä»¥è¢« Cargo è§£é‡Šï¼Œåªéœ€æ‰“å°ä»¥&lt;code>cargo:&lt;/code> å¼€å¤´çš„æŒ‡ä»¤ã€‚å¦‚ä¸‹é¢ä¸¤è¡Œè¾“å‡ºå‘ Cargo è¡¨æ˜Žä»…åœ¨è¿™ä¸¤ä¸ªæ–‡ä»¶å‘ç”Ÿæ”¹åŠ¨æ—¶æ‰§è¡Œæž„å»ºè„šæœ¬ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;cargo:rerun-if-changed=build.rs&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;cargo:rerun-if-changed=src/main.rs&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="libafl-ç»„è£…">LibAFL ç»„è£…&lt;/h3>
&lt;p>ä¸Šè¿°è¿˜æ˜¯ç”œç‚¹ï¼Œä¸‹é¢è¿›å…¥æ­£èœçŽ¯èŠ‚ã€‚ LibAFL å°† Fuzzer å®šä¹‰ä¸º9ä¸ªç»„ä»¶ï¼Œåˆ†åˆ«æ˜¯ï¼š&lt;/p>
&lt;blockquote>
&lt;p>æ‘˜è‡ª&lt;a class="link" href="https://chinggg.github.io/post/libafl/" target="_blank" rel="noopener"
>è¿™ç¯‡åšå®¢&lt;/a>ã€‚&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>Inputï¼šç¨‹åºçš„è¾“å…¥ã€‚
&lt;ul>
&lt;li>é‡ç‚¹æ˜¯æ ¼å¼ï¼Œæœ€å¸¸è§çš„å°±æ˜¯ byte arrayï¼Œä¹Ÿæœ‰ASTç­‰ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Corpusï¼šè¾“å…¥å’Œå…¶é™„å±žå…ƒæ•°æ®çš„å­˜å‚¨ã€‚
&lt;ul>
&lt;li>å­˜å‚¨æœ‰ä½äºŽå†…å­˜å’Œä½äºŽç¡¬ç›˜ä¸¤ç§ï¼ŒåŽè€…æ›´å¹¿æ³›ã€‚è¾“å…¥ä¹Ÿå¯åˆ†ä¸ºæœ‰åŠ©äºŽè¿›åŒ–çš„ interesting testcase å’Œæœ€ç»ˆè§¦å‘ crash çš„ solutionã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Schedulerï¼šä»Ž corpus ä¸­é€‰å– testcase çš„è°ƒåº¦ç­–ç•¥ã€‚
&lt;ul>
&lt;li>æœ€æœ´ç´ çš„å³å…ˆè¿›å…ˆå‡ºæˆ–éšæœºé€‰æ‹©ï¼Œä¹Ÿå¯å¼•å…¥ä¼˜å…ˆçº§ç®—æ³•ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Stageï¼šå®šä¹‰å¯¹ testcase è¿›è¡Œçš„æ“ä½œï¼ˆactionï¼‰ã€‚
&lt;ul>
&lt;li>å¾€å¾€ä¼šè¿›è¡Œå¤šé˜¶æ®µçš„æ“ä½œã€‚å¦‚ AFL ä¸­çš„ random havoc stageã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Observerï¼šæä¾›ä¸€æ¬¡æ‰§è¡Œç›®æ ‡ç¨‹åºçš„ä¿¡æ¯ã€‚
&lt;ul>
&lt;li>å¸¸ç”¨çš„ coverage map å°±æ˜¯ä¸€ç§ observerã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Executorï¼šç”¨ fuzzer çš„è¾“å…¥æ¥æ‰§è¡Œç›®æ ‡ç¨‹åºã€‚
&lt;ul>
&lt;li>ä¸åŒ fuzzer åœ¨è¿™æ–¹é¢åŒºåˆ«å¾ˆå¤§ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Feedbackï¼šå°†ç¨‹åºæ‰§è¡Œçš„ç»“æžœåˆ†ç±»ä»¥å†³å®šæ˜¯å¦å°†å…¶åŠ å…¥ corpusã€‚
&lt;ul>
&lt;li>feedback é€šå¸¸å¤„ç†ä¸€ä¸ªæˆ–å¤šä¸ª observer æŠ¥å‘Šçš„ä¿¡æ¯æ¥åˆ¤æ–­ execution æ˜¯å¦ â€œinterestingâ€ï¼Œæ˜¯å¦æ˜¯æ»¡è¶³æ¡ä»¶çš„ solutionï¼Œæ¯”å¦‚å¯è§‚æµ‹çš„ crashã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Mutatorï¼šä»Žä¸€ä¸ªæˆ–å¤šä¸ªè¾“å…¥ç”Ÿæˆæ–°çš„ testcaseã€‚
&lt;ul>
&lt;li>é€šå¸¸æ˜¯æœ€å¸¸æ”¹åŠ¨çš„ï¼Œä¸åŒ mutator å¯ä»¥ç»„åˆï¼Œå¾€å¾€è¿˜å’Œç‰¹å®šçš„è¾“å…¥ç±»åž‹ç»‘å®šã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Generatorï¼šå‡­ç©ºäº§ç”Ÿæ–°çš„è¾“å…¥ã€‚
&lt;ul>
&lt;li>æœ‰éšæœºç”Ÿæˆçš„ï¼Œä¹Ÿæœ‰ Nautilus è¿™ç§åŸºäºŽè¯­æ³•çš„ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ LibAFL å®žçŽ°ä¸­è¿˜æœ‰è‹¥å¹²é‡è¦ç»„ä»¶ï¼š&lt;/p>
&lt;blockquote>
&lt;p>&lt;a class="link" href="https://docs.rs/libafl/0.10.1/libafl/" target="_blank" rel="noopener"
>APIæ–‡æ¡£&lt;/a> &lt;br>
è¯· å‚é˜…&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>State: åŒ…å«äº†è¿è¡Œæ—¶çš„æ‰€æœ‰å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬ Corpusã€RNG ç­‰ã€‚&lt;/li>
&lt;li>Bolts: å·¥å…·åº“ï¼Œå®žçŽ°äº†è¯¸å¦‚å…±äº«å†…å­˜çš„æ”¯æŒã€‚&lt;/li>
&lt;li>Monitor: å‘ç”¨æˆ·æ‰“å°logä¹‹ç±»ã€‚&lt;/li>
&lt;li>Events: ç»„ä»¶ä¹‹é—´é€šä¿¡&lt;/li>
&lt;li>Fuzzer: é¡¶å±‚ç»„ä»¶ï¼ŒæŠŠä¸€åˆ‡ç»„ç»‡èµ·æ¥&lt;/li>
&lt;/ul>
&lt;p>å› åŽŸåšå®¢çš„è®²è§£å¾ˆè¯¦ç»†ï¼Œä¸”æä¾›äº†å®Œæ•´ä»£ç ã€‚æ•…æœ¬æ–‡è¯•å›¾åˆ‡æ¢è§†è§’ï¼Œä»Žè‡ªé¡¶å‘ä¸‹çš„è§’åº¦æ‹†è§£ä»£ç ï¼š&lt;/p>
&lt;h4 id="ç»„ä»¶fuzzer">ç»„ä»¶ï¼šFuzzer&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">monitor&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">SimpleMonitor&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{s}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">mgr&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">SimpleEventManager&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">monitor&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">scheduler&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">IndexesLenTimeMinimizerScheduler&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">QueueScheduler&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">());&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">mutator&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">StdScheduledMutator&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">havoc_mutations&lt;/span>&lt;span class="p">());&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">stages&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">tuple_list!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">StdMutationalStage&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mutator&lt;/span>&lt;span class="p">));&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">-------------&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="o">&amp;lt;-------------&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">fuzzer&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">StdFuzzer&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">scheduler&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">feedback&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">objective&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">fuzzer&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">fuzz_loop&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">stages&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">executor&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">state&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">mgr&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¯ä»¥çœ‹åˆ° &lt;code>StdFuzzer&lt;/code> ä¸²è”èµ·äº†å…¨éƒ¨ç»„ä»¶ã€‚&lt;code>mgr&lt;/code>ã€&lt;code>scheduler&lt;/code>ã€&lt;code>mutator&lt;/code>ã€&lt;code>stages&lt;/code> éƒ½æ˜¯ä½¿ç”¨åº“è‡ªå¸¦çš„ç±»ï¼Œå›ºçœç•¥ä¹‹ï¼Œä¸‹é¢è¯¦è¿°å¤æ‚äº›çš„ç»„ä»¶ã€‚&lt;/p>
&lt;h4 id="ç»„ä»¶state">ç»„ä»¶ï¼šState&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">state&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">StdState&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">StdRand&lt;/span>::&lt;span class="n">with_seed&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">current_nanos&lt;/span>&lt;span class="p">()),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">input_corpus&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">timeouts_corpus&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">feedback&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">objective&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æŸ¥é˜…æ–‡æ¡£å¯çŸ¥&lt;code>StdState&lt;/code>çš„æˆå‘˜å«ä¹‰ï¼Œè¿™äº›æˆå‘˜å°±æ˜¯Fuzzerçš„å…¨éƒ¨çŠ¶æ€äº†ã€‚ä¸€ä¸ªå¯èƒ½çš„ç–‘æƒ‘æ˜¯ä¸ºä»€ä¹ˆä¼šæœ‰&lt;code>feedback&lt;/code>ã€&lt;code>objective&lt;/code>ä¸¤ç§ Feedbackï¼Œè®©æˆ‘ä»¬ç»§ç»­å‘ä¸Šæ£€é˜…ä»£ç ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">pub fn new&amp;lt;F, O&amp;gt;(
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rand: R,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> corpus: C,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> solutions: SC,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> feedback: &amp;amp;mut F,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> objective: &amp;amp;mut O
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">) -&amp;gt; Result&amp;lt;Self, Error&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">where
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> F: Feedback&amp;lt;Self&amp;gt;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> O: Feedback&amp;lt;Self&amp;gt;,
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="rust-åŸºç¡€ä¹‹æ‰€æœ‰æƒ">Rust åŸºç¡€ä¹‹æ‰€æœ‰æƒ&lt;/h4>
&lt;p>æ‰€æœ‰æƒï¼Œæ˜¯ Rust ç‰¹æœ‰çš„è®¾è®¡ï¼Œåœ¨æ— GCçš„å‰æä¸‹å®žçŽ°å†…å­˜å®‰å…¨ä¸Žé«˜æ€§èƒ½ã€‚åŸºæœ¬è§„åˆ™ï¼š&lt;/p>
&lt;ol>
&lt;li>Rust ä¸­æ¯ä¸€ä¸ªå€¼éƒ½è¢«ä¸€ä¸ªå˜é‡æ‰€æ‹¥æœ‰ï¼Œè¯¥å˜é‡è¢«ç§°ä¸ºå€¼çš„æ‰€æœ‰è€…&lt;/li>
&lt;li>ä¸€ä¸ªå€¼åŒæ—¶åªèƒ½è¢«ä¸€ä¸ªå˜é‡æ‰€æ‹¥æœ‰ï¼Œæˆ–è€…è¯´ä¸€ä¸ªå€¼åªèƒ½æ‹¥æœ‰ä¸€ä¸ªæ‰€æœ‰è€…&lt;/li>
&lt;li>å½“æ‰€æœ‰è€…(å˜é‡)ç¦»å¼€ä½œç”¨åŸŸèŒƒå›´æ—¶ï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒ(drop)&lt;/li>
&lt;/ol>
&lt;p>åŸºäºŽè¿™äº›åŽŸåˆ™ï¼Œå½“ä¸€ä¸ªå€¼è¢«å¦ä¸€ä¸ªå˜é‡ä½¿ç”¨æ—¶ï¼Œä¼šå‘ç”Ÿæ‰€æœ‰æƒçš„è½¬ç§»ï¼Œå…ˆå‰çš„å˜é‡ä¾¿ä¸èƒ½è®¿é—®è¯¥å€¼ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;hello&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s2&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s1&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">, world!&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s1&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// æŠ¥é”™ï¼
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">String&lt;/span>::&lt;span class="n">from&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;hello&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s2&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">clone&lt;/span>&lt;span class="p">();&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">, world!&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">s1&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// ä¸æŠ¥é”™
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="fm">println!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;x = &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">, y = &lt;/span>&lt;span class="si">{}&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">// ä¸æŠ¥é”™
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>è½¬ç§»(move) å’Œ æ‹·è´(copy)&lt;/li>
&lt;/ul>
&lt;p>&lt;code>let s2 = s1;&lt;/code>åœ¨ Rust ä¸­è¢«ç§°ä¸ºå˜é‡ç»‘å®šï¼Œä»£è¡¨s1è¢«ç§»åŠ¨åˆ°äº†s2ã€‚&lt;/p>
&lt;p>å¦‚æžœæƒ³è¦è®¿é—®ç›¸åŒå€¼ï¼Œéœ€è¦å¯¹å˜é‡è¿›è¡Œæ‹·è´ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œintç±»åž‹æ²¡æœ‰æ‹·è´ä¹Ÿä¸æŠ¥é”™ï¼Œè¿™æ˜¯å› ä¸ºåŸºæœ¬ç±»åž‹çš„å¤§å°æ˜¯å·²çŸ¥çš„ï¼Œä¸”åˆ†é…åœ¨æ ˆä¸Šï¼Œå¯¹ä»–çš„æ‹·è´æ¯”è¾ƒç®€å•ï¼Œæ•… Rust è‡ªåŠ¨å®žçŽ°äº†æ‹·è´ã€‚è€ŒStringæ˜¯å¤æ‚ç±»åž‹ï¼Œå¿…é¡»æ˜¾å¼çš„æ‹·è´ã€‚&lt;/p>
&lt;ul>
&lt;li>å¼•ç”¨(reference) å’Œ å€Ÿç”¨(borrowing)&lt;/li>
&lt;/ul>
&lt;p>å°†å€¼åœ¨å˜é‡ä¹‹é—´ä¼ æ¥ä¼ åŽ»ç¡®å®žæ¯”è¾ƒéº»çƒ¦ã€‚ Rustå®žçŽ°äº†2ç§å¼•ç”¨ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>&amp;amp;&lt;/code>: ä¸å¯å˜å¼•ç”¨ï¼Œå…è®¸ä½¿ç”¨å€¼ä½†ä¸èŽ·å–æ‰€æœ‰æƒã€‚å¯ä»¥æœ‰å¤šä¸ªã€‚&lt;/li>
&lt;li>&lt;code>&amp;amp;mut&lt;/code>: å¯å˜å¼•ç”¨ã€‚ä»…èƒ½å­˜åœ¨ä¸€ä¸ªã€‚&lt;/li>
&lt;li>å¯å˜å¼•ç”¨ä¸Žä¸å¯å˜å¼•ç”¨ä¸èƒ½åŒæ—¶å­˜åœ¨ã€‚&lt;/li>
&lt;/ul>
&lt;p>èŽ·å–å˜é‡çš„å¼•ç”¨ï¼Œå°±ç§°ä¸ºå€Ÿç”¨ã€‚æ˜¾ç„¶ï¼Œåœ¨ç¦»å¼€ä½œç”¨åŸŸåŽæ‰€æœ‰æƒå°†è¢«å½’è¿˜ã€‚å¼•ç”¨çš„ä½œç”¨åŸŸä»Žåˆ›å»ºä¸€ç›´æŒç»­åˆ°å®ƒæœ€åŽä¸€æ¬¡ä½¿ç”¨ï¼Œè€Œå˜é‡çš„ä½œç”¨åŸŸä»Žåˆ›å»ºæŒç»­åˆ°æŸä¸€ä¸ªèŠ±æ‹¬å·&lt;code>}&lt;/code>ã€‚&lt;/p>
&lt;p>å¯¹å¼•ç”¨æœ‰æ•ˆæ€§çš„æ£€æŸ¥æ˜¯ Rust è§£å†³æ•°æ®ç«žäº‰ï¼Œæ‚¬åž‚æŒ‡é’ˆç­‰å®‰å…¨é—®é¢˜çš„é‡è¦æœºåˆ¶ã€‚&lt;/p>
&lt;p>åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œéœ€è¦&lt;code>feedback&lt;/code>å’Œ&lt;code>objective&lt;/code>éšç€&lt;code>state&lt;/code>æ›´æ–°è€Œä¸æ–­ç§¯ç´¯ï¼Œå› æ­¤ä½¿ç”¨å¯å˜å¼•ç”¨ã€‚è€Œå…¶ä»–æˆå‘˜å’Œ&lt;code>state&lt;/code>ç›¸å…³ï¼Œæ•…ç›´æŽ¥å°†æ‰€æœ‰æƒç§»äº¤ç»™&lt;code>state&lt;/code>ã€‚&lt;/p>
&lt;p>å‚è€ƒæ–‡æ¡£ï¼šhttps://course.rs/basic/ownership/ownership.html&lt;/p>
&lt;h4 id="ç»„ä»¶observer--feedback">ç»„ä»¶ï¼šObserver &amp;amp; Feedback&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">time_observer&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">TimeObserver&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;time&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">unsafe&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">HitcountsMapObserver&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">StdMapObserver&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;shared_mem&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">shmem_buf&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">};&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">feedback&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="fm">feedback_or!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">MaxMapFeedback&lt;/span>::&lt;span class="n">tracking&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">TimeFeedback&lt;/span>::&lt;span class="n">with_observer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">time_observer&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">objective&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="fm">feedback_and_fast!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">TimeoutFeedback&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(),&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">MaxMapFeedback&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚å®šä¹‰æ‰€è¨€ï¼ŒObserver ä»…æä¾›ä¿¡æ¯ï¼ŒFeedback å°†è§‚å¯Ÿåˆ°çš„ä¿¡æ¯è¿›è¡Œåˆ¤æ–­ã€‚
åœ¨æœ¬ä¾‹ä¸­ï¼Œé¦–å…ˆå®šä¹‰çš„ä¸¤ä¸ªObserveråˆ†åˆ«æä¾›äº†ä»£ç è¿è¡Œæ—¶é—´å’Œä¾¿è¦†ç›–çŽ‡çš„ä¿¡æ¯ã€‚
ç„¶åŽåˆ†å¸ƒå¯¹ä»–ä»¬è¿›è¡Œäº†ä¸åŒçš„åé¦ˆåˆ¤æ–­ã€‚&lt;code>feedback_or&lt;/code>å’Œ&lt;code>feedback_and_fast&lt;/code>æ˜¯é€»è¾‘åˆ¤æ–­å®ã€‚å› æ­¤å¯ä»¥è§£è¯»ä»–ä»¬çš„é€»è¾‘ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>feedback&lt;/code>çš„æ¡ä»¶æ˜¯è¦†ç›–äº†æ–°çš„åˆ†æ”¯ æˆ– â€œè¿è¡Œæ—¶é—´åé¦ˆâ€ã€‚æ•…åé¦ˆçš„æ˜¯æœ‰è¶£çš„æ ·ä¾‹(interesting testcase)
&lt;ul>
&lt;li>å®žé™…ä¸Šï¼Œâ€œè¿è¡Œæ—¶é—´åé¦ˆâ€æ°¸è¿œä¸ä¼šçœŸçš„åé¦ˆï¼Œéœ€è¦é…åˆå…¶ä»–åé¦ˆä½¿ç”¨ã€‚è¿™é‡Œä»…ä½œç¤ºä¾‹ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>objective&lt;/code>çš„æ¡ä»¶æ˜¯è¦†ç›–äº†æ–°çš„åˆ†æ”¯ ä¸” è¿è¡Œè¶…æ—¶ã€‚æ•…åé¦ˆçš„æ˜¯èƒ½è§¦å‘æ— é™é€’å½’æ¼æ´žçš„æ ·ä¾‹ï¼Œå³æˆ‘ä»¬æƒ³è¦çš„ç»“æžœï¼ˆsolutionï¼‰&lt;/li>
&lt;/ul>
&lt;h4 id="ç»„ä»¶executor">ç»„ä»¶ï¼šExecutor&lt;/h4>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-rust" data-lang="rust">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">fork_server&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">ForkserverExecutor&lt;/span>::&lt;span class="n">builder&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">program&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;./xpdf/install/bin/pdftotext&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">parse_afl_cmdline&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="s">&amp;#34;@@&amp;#34;&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">coverage_map_size&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="no">MAP_SIZE&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">build&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="fm">tuple_list!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">time_observer&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">edges_observer&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">timeout&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">Duration&lt;/span>::&lt;span class="n">from_secs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="kd">let&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">mut&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">executor&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">TimeoutForkserverExecutor&lt;/span>::&lt;span class="n">new&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fork_server&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">timeout&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æˆ‘ä»¬çš„ Executor è¿˜æ˜¯é‡‡ç”¨ç»å…¸çš„ forkserver æž¶æž„ï¼Œæž„å»º Executor æ—¶ï¼Œé¦–å…ˆåŠ å…¥äº†ä¸¤ä¸ª Observer ï¼Œç„¶åŽæŒ‡å®šäº†è¶…æ—¶æ—¶é—´ï¼Œæœ‰åŠ©äºŽå¢žåŠ fuzzåžåé‡ã€‚&lt;/p>
&lt;h3 id="è·‘">è·‘ðŸƒâ€&lt;/h3>
&lt;p>æ€»ä¹‹å€ŸåŠ© LibAFL çš„æ¡†æž¶ï¼Œå†™ä¸€ä¸ª Fuzzer è¿˜æ˜¯å¾ˆæ¸…æ™°çš„ã€‚ï¼ˆæˆ–è®¸è‹¥å¹²å¹´åŽçš„ Fuzzing å­¦ä¹ è€…å°±ä¸ç”¨å•ƒAFLçš„1000è¡Œæºç äº†ðŸ˜­ï¼‰&lt;/p>
&lt;p>æœ€åŽè·‘å‡ºæ¥ä¸€ä¸ªæ­»å¾ªçŽ¯ã€‚ðŸ‘´å®£å¸ƒå®žéªŒä¸€å®Œæˆã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">[AFL++ 798a8ebfa8a4] /fuzzing101/exercise-1 # ./xpdf/install/bin/pdftotext ./timeouts/c497979e26a808e9
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error: PDF file is damaged - attempting to reconstruct xref table...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2459): Dictionary key must be a name object
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2465): Illegal character &amp;#39;&amp;gt;&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2468): Dictionary key must be a name object
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2471): Dictionary key must be a name object
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2486): Dictionary key must be a name object
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2488): Illegal character &amp;lt;2f&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2489): Illegal character &amp;lt;78&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2490): Illegal character &amp;lt;6d&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2491): Illegal character &amp;lt;70&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2492): Illegal character &amp;lt;3a&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2493): Illegal character &amp;lt;4d&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2494): Illegal character &amp;lt;6f&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2496): Illegal character &amp;lt;69&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2498): Illegal character &amp;lt;79&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2501): Illegal character &amp;lt;74&amp;gt; in hex string
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Error (2503): Dictionary key must be a name object
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-------------8&amp;lt;-------------
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item></channel></rss>