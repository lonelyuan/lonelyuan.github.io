<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>CS on lonelyuan's Blog</title><link>https://lonelyuan.github.io/HugoBlog/categories/cs/</link><description>Recent content in CS on lonelyuan's Blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Tue, 28 May 2019 00:00:00 +0000</lastBuildDate><atom:link href="https://lonelyuan.github.io/HugoBlog/categories/cs/index.xml" rel="self" type="application/rss+xml"/><item><title>CSAPP - Proxylab</title><link>https://lonelyuan.github.io/HugoBlog/p/csapp-proxylab/</link><pubDate>Thu, 05 Oct 2023 00:00:03 +0000</pubDate><guid>https://lonelyuan.github.io/HugoBlog/p/csapp-proxylab/</guid><description>&lt;p>æŒ‚æ¢¯å­æ¯ä¸ªäººéƒ½çŽ©è¿‡ï¼Œä½†ä½ çŸ¥é“æ¢¯å­çš„åŽŸç†å—ã€‚æœ€åŽä¸€ä¸ªlabï¼Œå®žçŽ°ä¸€ä¸ªHTTPä»£ç†æœåŠ¡å™¨ã€‚æœ¬å®žéªŒéš¾åº¦ç›¸å¯¹å‰é¢ä¸¤ä¸ªlabæœ‰æ‰€ä¸‹é™ï¼Œä½†ç»¼åˆæ€§æ¯”è¾ƒå¼ºï¼Œæ¶‰åŠæ•™ææœ€åŽä¸‰ç« çš„æ‰€æœ‰å†…å®¹ä»¥åŠmallocå’Œcacheä¸¤ä¸ªlabã€‚&lt;/p>
&lt;h2 id="é¡¹ç›®ç»“æž„">é¡¹ç›®ç»“æž„&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- csapp.c /*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- csapp.h * è¿™ä¸‰ä¸ªæ–‡ä»¶æ˜¯é¡¹ç›®ä¸»ä½“ï¼Œå¯ä»¥éšæ„ä¿®æ”¹
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- proxy.c */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- driver.sh # æµ‹è¯„è„šæœ¬
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- free-port.sh /*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- nop-server.py * å·¥å…·è„šæœ¬
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|-- port-for-user.pl */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">`-- tiny
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |-- cgi-bin/ # åŠ¨æ€ç¨‹åº
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |-- static/ # é™æ€æ–‡ä»¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |-- csapp.c /*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> |-- csapp.h * è¯¾æœ¬ä¸­æåˆ°çš„tinyå®žçŽ°ï¼Œå»ºè®®è¯¦ç»†é˜…è¯»
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> `-- tiny.c */
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="csappc">csapp.c&lt;/h3>
&lt;p>&lt;code>csapp.c&lt;/code>å’Œ&lt;code>csapp.h&lt;/code>æ˜¯è¯¾æœ¬åŽä¸‰ç« æåˆ°çš„å‡½æ•°ä»£ç å®žä¾‹ï¼ŒåŒ…æ‹¬ä»¥ä¸‹å‡ ç»„å‡½æ•°å®žçŽ°ï¼š&lt;/p>
&lt;ul>
&lt;li>è¿›ç¨‹æŽ§åˆ¶ï¼š&lt;code>Fork()&lt;/code>,&lt;code>Execve()&lt;/code>,&lt;code>Wait()&lt;/code>,&lt;code>Kill()&lt;/code>,&lt;code>Sleep()&lt;/code>,&lt;code>Pause()&lt;/code>&amp;hellip;&lt;/li>
&lt;li>ä¿¡å·æŽ§åˆ¶ï¼š&lt;code>Signal()&lt;/code>,&lt;code>Sigprocmask()&lt;/code>,&lt;code>Sig***set()&lt;/code>&lt;/li>
&lt;li>I/Oæ“ä½œï¼š&lt;code>Open()&lt;/code>,&lt;code>Read()&lt;/code>,&lt;code>Write()&lt;/code>,&lt;code>Lseek()&lt;/code>,&lt;code>Close()&lt;/code>&amp;hellip;
&lt;ul>
&lt;li>Signal-safe I/O&lt;/li>
&lt;li>Standard I/O&lt;/li>
&lt;li>Robust I/O&lt;/li>
&lt;li>ç›®å½•æ“ä½œï¼š&lt;code>Opendir()&lt;/code>,&lt;code>Readdir()&lt;/code>,&lt;code>Closedir()&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åŠ¨æ€å†…å­˜åˆ†é…ï¼š&lt;code>Malloc()&lt;/code>,&lt;code>Realloc()&lt;/code>,&lt;code>Calloc()&lt;/code>,&lt;code>Free()&lt;/code>
&lt;ul>
&lt;li>å†…å­˜æ˜ å°„ï¼š&lt;code>Mmap()&lt;/code>,&lt;code>Nunmap()&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>SocketæŽ¥å£ï¼š&lt;code>Socket()&lt;/code>,&lt;code>Bind()&lt;/code>,&lt;code>Listen()&lt;/code>,&lt;code>Accept()&lt;/code>,&lt;code>Connect()&lt;/code>
&lt;ul>
&lt;li>ç½‘ç»œä¿¡æ¯ï¼š&lt;code>Getaddrinfo()&lt;/code>,&lt;code>Gethostbyname()&lt;/code>,&lt;code>Inet_ntop()&lt;/code>&amp;hellip;&lt;/li>
&lt;li>å¯é‡å…¥æŽ¥å£ï¼š&lt;code>Open_clientfd()&lt;/code>,&lt;code>Open_listenfd()&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Pthreadså¤šçº¿ç¨‹ï¼š&lt;code>create()&lt;/code>,&lt;code>join()&lt;/code>,&lt;code>cancel()&lt;/code>,&lt;code>detach()&lt;/code>,&lt;code>exit()&lt;/code>,&lt;code>self()&lt;/code>,&lt;code>once()&lt;/code>&lt;/li>
&lt;li>POSIXä¿¡å·é‡ï¼š&lt;code>Sem_init()&lt;/code>,&lt;code>P()&lt;/code>,&lt;code>V()&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>è¿™ä¹Ÿå¤ªå¤šäº†8ã€‚å®žé™…ä¸Šè¿™äº›éƒ½æ˜¯ç³»ç»Ÿå‡½æ•°çš„å°è£…ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦ç”¨åˆ°æ‰€æœ‰å‡½æ•°ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæœ¬å®žéªŒå°†åŽä¸‰ç« è®²è¿°çš„å†…å®¹å…¨éƒ¨æŠ›å‡ºï¼Œè®©æˆ‘ä»¬è‡ªå·±æ€è€ƒå¹¶é€‰ç”¨è¿™äº›å·¥å…·æ¥å®Œæˆç›®æ ‡ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥éšæ„ä¿®æ”¹è¿™äº›å°è£…æˆ–è€…ç›´æŽ¥ä½¿ç”¨ç³»ç»ŸæŽ¥å£ã€‚&lt;/p>
&lt;h3 id="tinyc">tiny.c&lt;/h3>
&lt;p>æ­¤å¤–ï¼Œtinyç›®å½•ä¸‹ä¹Ÿæœ‰ç›¸åŒçš„&lt;code>csapp.c&lt;/code>å’Œ&lt;code>csapp.h&lt;/code>ï¼Œè€Œ&lt;code>tiny.c&lt;/code>æ˜¯è¯¾æœ¬ä¸Šæåˆ°çš„ç®€æ˜“webæœåŠ¡å™¨å®žçŽ°ï¼ŒäºŽæ˜¯æˆ‘ä»¬å¯ä»¥å°†å…¶ä½œä¸ºproxyçš„åˆå§‹ä»£ç æ¡†æž¶ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">argc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span> &lt;span class="o">**&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">listenfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">connfd&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">hostname&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">socklen_t&lt;/span> &lt;span class="n">clientlen&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="n">sockaddr_storage&lt;/span> &lt;span class="n">clientaddr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">listenfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Open_listenfd&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">argv&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">clientlen&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">clientaddr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">connfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Accept&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">listenfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">SA&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientaddr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientlen&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Getnameinfo&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">SA&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">clientaddr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">clientlen&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">hostname&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Accepted from (%s, %s)&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">hostname&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">doit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">connfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">connfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;blockquote>
&lt;p>SocketæŽ¥å£æ˜¯ä¸€åˆ‡ç½‘ç»œç¨‹åºçš„åº•å±‚ï¼Œæœ‰å…³socketæ¨¡åž‹è¯·éšä¾¿æœç´¢é‚£ä¸€å¼ æµç¨‹å›¾å¹¶ç†Ÿè®°äºŽå¿ƒï¼ˆæˆ–è€…å‚è€ƒ&lt;a class="link" href="https://lonelyuan.github.io/p/%E4%BB%8Escapy%E5%92%8Cwireshark%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/#guidelines" target="_blank" rel="noopener"
>ðŸ‘´çš„æ–‡ç« &lt;/a>ï¼‰ã€‚è¿™é‡Œç®€å•æ€»ç»“ä¸€ä¸‹è¦ç‚¹ï¼š&lt;/p>
&lt;ul>
&lt;li>åœ°å€æ ‡è®°ä¸»æœºï¼Œç«¯å£æ ‡è®°è¿›ç¨‹ã€‚&lt;/li>
&lt;li>å®¢æˆ·ç«¯æ‰§è¡Œ&lt;code>Connect()&lt;/code>ï¼ŒæœåŠ¡å™¨æ‰§è¡Œ&lt;code>Bind()&lt;/code>,&lt;code>Listen()&lt;/code>,&lt;code>Accept()&lt;/code>ã€‚&lt;/li>
&lt;li>unixç³»ç»Ÿä¸­ä¸€åˆ‡çš†æ–‡ä»¶ï¼Œæ‰“å¼€çš„æ–‡ä»¶é€šè¿‡æ–‡ä»¶æè¿°ç¬¦fdæ ‡è®°ã€‚&lt;/li>
&lt;li>ç½‘ç»œè¿žæŽ¥ä¹Ÿæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå³&lt;code>Socket()&lt;/code>ä¹Ÿè¿”å›žä¸€ä¸ªfdã€‚&lt;/li>
&lt;li>äºŽæ˜¯å¯¹è¯¥fdä½¿ç”¨ä¼ ç»ŸI/Oå‡½æ•°å³å¯è¿›è¡Œé€šä¿¡å†…å®¹çš„è¯»å†™ã€‚æœ¬è´¨ä¸Šå°±æ˜¯è¯»å†™Socketæä¾›çš„ç¼“å†²åŒº&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>äºŽæ˜¯æœåŠ¡å™¨éœ€è¦ç»´æŠ¤&lt;code>listenfd&lt;/code>,&lt;code>connfd&lt;/code>ä¸¤ä¸ªfdåˆ†åˆ«ä»£è¡¨ç›‘å¬ç«¯å£å’Œå®¢æˆ·ç«¯ç«¯å£ã€‚
è€ŒæœåŠ¡å™¨æ˜¯ä¸€ä¸ªéœ€è¦é•¿ä¹…è¿è¡Œçš„ç¨‹åºï¼Œå› æ­¤ä»–çš„æ ¸å¿ƒè¿›ç¨‹å¾€å¾€è¿è¡Œç€ä¸€ä¸ªæ­»å¾ªçŽ¯ï¼Œä¹Ÿç§°ä¸ºä¸»äº‹ä»¶å¾ªçŽ¯ã€‚
åœ¨å¾ªçŽ¯ä¸­æœåŠ¡å™¨ä¸æ–­æŽ¥å—ç€å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼ŒäºŽæ˜¯&lt;code>connfd&lt;/code>åœ¨å¾ªçŽ¯ä¸­ä¸æ–­åœ°åˆ›å»ºå’Œé”€æ¯ï¼Œè€Œ&lt;code>listenfd&lt;/code>ä¿æŒä¸å˜ã€‚
è€Œå…·ä½“åˆ°å•ä¸ªè¯·æ±‚çš„å¤„ç†ï¼Œtinyå°†å…¶äº¤ç»™äº†&lt;code>doit()&lt;/code>å‡½æ•°ã€‚å…¶åŠŸèƒ½åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š&lt;/p>
&lt;ul>
&lt;li>ä»Žç¼“å†²åŒºä¸­è¯»å–HTTPæŠ¥æ–‡
&lt;ul>
&lt;li>tinyåªé’ˆå¯¹GETè¯·æ±‚åšå‡ºå“åº”&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è¯»ç¬¬ä¸€è¡Œï¼Œåˆ¤æ–­HTTPæ–¹æ³•&lt;/li>
&lt;li>è¯»å–å¤„ç†å‰©ä½™çš„HTTPé¦–éƒ¨&lt;/li>
&lt;li>åˆ¤æ–­è¯·æ±‚çš„æ˜¯é™æ€æ–‡ä»¶è¿˜æ˜¯åŠ¨æ€ç¨‹åºï¼ˆcgi-binï¼‰
&lt;ul>
&lt;li>é™æ€è¯·æ±‚ï¼Œè¯»å–æ–‡ä»¶å†…å®¹&lt;/li>
&lt;li>åŠ¨æ€è¯·æ±‚ï¼Œè°ƒç”¨cgiç¨‹åº&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>æ­¤å¤–ï¼Œé¢å¯¹é”™è¯¯æƒ…å†µè¦è¿”å›žç›¸åº”çš„çŠ¶æ€ç ï¼Œè€ŒæœåŠ¡å™¨è¿›ç¨‹ä¸èƒ½ç»“æŸã€‚&lt;/li>
&lt;/ul>
&lt;h3 id="å¾—åˆ†ç‚¹">&lt;strong>å¾—åˆ†ç‚¹&lt;/strong>&lt;/h3>
&lt;ul>
&lt;li>BasicCorrectness: 40 ï¼ˆåŸºæœ¬ä»£ç†ï¼‰&lt;/li>
&lt;li>Concurrency: 15 ï¼ˆå¹¶å‘æ€§ï¼‰&lt;/li>
&lt;li>Cache: 15 ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰&lt;/li>
&lt;/ul>
&lt;h2 id="part1-basic-proxy">Part1: Basic Proxy&lt;/h2>
&lt;p>proxyåœ¨clienté¢å‰æ‰®æ¼”æœåŠ¡å™¨ï¼Œåœ¨serveré¢å‰æ‰®æ¼”å®¢æˆ·ç«¯ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨proxyä¸­éœ€è¦åŒæ—¶å®žçŽ°è¿™ä¸¤ä¸ªåŠŸèƒ½ï¼Œè€Œtinyå·²ç»æœ‰äº†æœåŠ¡å™¨ç«¯çš„å®žçŽ°ï¼Œæ•…è€Œåªéœ€è¦è€ƒè™‘å®¢æˆ·ç«¯çš„å®žçŽ°å³å¯ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> â”Œâ”€â”€â”€â”€â”€â”€â” (2) â”Œâ”€â”€â”€â”€â”€â” (1) â”Œâ”€â”€â”€â”€â”€â”€â”
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚â—„â”€â”€â”€â”€â”€â”€â”¤ â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚Serverâ”‚ (3) â”‚Proxyâ”‚ (4) â”‚Clientâ”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”œâ”€â”€â”€â”€â”€â”€â–ºâ”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å…·ä½“æ¥è¯´ï¼Œåªéœ€è¦ä¿®æ”¹doitå‡½æ•°ã€‚é¦–å…ˆå»ºç«‹æœ€ç®€å•çš„æ¨¡åž‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// v0.1: score 16/40
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="nf">doit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">cfd&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">response&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (1) client -&amp;gt; proxy */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">read_req&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (2) proxy -&amp;gt; server */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Open_clientfd&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">request&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (3) server -&amp;gt; proxy */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">read_res&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">response&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (4) proxy -&amp;gt; client */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">response&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">response&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>read_req()&lt;/code>å’Œ&lt;code>read_res()&lt;/code>å°è£…äº†ä»ŽRioç¼“å†²åŒºè¯»å–æŠ¥æ–‡çš„ç»†èŠ‚ã€‚ä¸‹é¢è¯¦ç»†ä»‹ç»ï¼š&lt;/p>
&lt;h3 id="åœ¨clienté¢å‰æ‰®æ¼”server">åœ¨clienté¢å‰æ‰®æ¼”server&lt;/h3>
&lt;p>å¯¹äºŽè¯·æ±‚æŠ¥æ–‡ï¼Œé¦–å…ˆéœ€è¦è§£æžå‡ºåœ°å€å’Œç«¯å£ä»¥ä¾¿æ‰¾åˆ°ç›®çš„æœåŠ¡å™¨ï¼Œå…¶æ¬¡éœ€è¦æ³¨æ„&lt;code>curl --proxy&lt;/code>çš„ç¬¬ä¸€è¡Œå‘åŒ…ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">GET http://localhost:81/ HTTP/1.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œè·¯å¾„å˜æˆäº†æœåŠ¡å™¨çš„å®Œæ•´åœ°å€ï¼Œç›´æŽ¥ä¸¢ç»™tinyæ˜¯ä¼šæŠ¥404çš„ã€‚å› æ­¤ï¼ŒðŸ‘´ç›´æŽ¥å¯¹ç¬¬ä¸€è¡Œæå–host,port,pathã€‚ï¼ˆæ³¨æ„åˆ†æ¸…&lt;code>sscanf()&lt;/code>å’Œ&lt;code>sprintf()&lt;/code>ï¼‰&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">read_req&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">message&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">rio_t&lt;/span> &lt;span class="n">rio&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_readinitb&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">rio&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">memset&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXBUF&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">host_port_path&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="n">host_port&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">path_line&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Receive: &amp;#34;GET http://host:port/path HTTP/1.1&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nf">Rio_readlineb&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">rio&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;GET %s HTTP/1.1&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host_port_path&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host_port_path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;http://%[^/]%s&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host_port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">sscanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host_port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;%[^:]:%s&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">port&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;80&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Send: &amp;#34;GET /path HTTP/1.1&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nf">sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path_line&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;GET %s HTTP/1.1&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">strcat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path_line&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;&lt;/span>&lt;span class="se">\r\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_readlineb&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">rio&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">strcat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="åœ¨serveré¢å‰æ‰®æ¼”client">åœ¨serveré¢å‰æ‰®æ¼”client&lt;/h3>
&lt;p>å¯¹äºŽå“åº”æŠ¥æ–‡ï¼Œåˆ™éœ€è¦è€ƒè™‘åŒ…ä½“é•¿åº¦é—®é¢˜ã€‚ä»£ç ä¸­è®¾ç½®äº†&lt;code>MAXBUF&lt;/code>å¸¸é‡ä¸º8192ï¼Œåœ¨æµ‹è¯„è„šæœ¬ä¸­æœ‰å‡ ä¸ªæ ·ä¾‹æ˜¯è¿œè¶…è¿‡è¿™ä¸ªæ•°å­—çš„ã€‚å› æ­¤éœ€è¦è€ƒè™‘æµå¼ä¼ è¾“ï¼Œä¸€è¾¹æŽ¥å—ä¸€è¾¹å‘é€ã€‚äºŽæ˜¯&lt;code>doit()&lt;/code>ä¹Ÿéœ€è¦è¿›è¡Œä¿®æ”¹&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// v0.2: score 40/40
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kt">void&lt;/span> &lt;span class="nf">doit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">cfd&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">res_buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXBUF&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (1) client -&amp;gt; proxy */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">read_req&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (2) proxy -&amp;gt; server */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">sfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Open_clientfd&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">request&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (3) server -&amp;gt; proxy */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">n&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Rio_readn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">res_buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span> &lt;span class="n">res_buf&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (4) proxy -&amp;gt; client */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">res_buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="part2-concurrency">Part2: Concurrency&lt;/h2>
&lt;p>åœ¨å¹¶å‘æ€§æµ‹è¯•ä¸­ï¼Œæµ‹è¯„è„šæœ¬ä¼šè°ƒç”¨&lt;code>nop-server.py&lt;/code>ï¼Œå…¶æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-py" data-lang="py">&lt;span class="line">&lt;span class="cl">&lt;span class="n">serversocket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">channel&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">details&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">serversocket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">accept&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">continue&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œnop-serveråœ¨æŽ¥å—è¯·æ±‚ä¹‹åŽä¼šè¿›å…¥æ­»å¾ªçŽ¯ï¼Œä¹Ÿå°±æ˜¯è¯´è¿žæŽ¥è¢«æ°¸è¿œé˜»å¡žäº†ã€‚è¿™è¦æ±‚proxyèƒ½å¤ŸåŒæ—¶æŽ¥å—å¤šä¸ªè¿žæŽ¥ã€‚Pthreadåº“çš„å¤šçº¿ç¨‹æŽ¥å£è¾ƒä¸ºç®€å•ï¼Œåªéœ€è¦å°†ä¸»äº‹ä»¶å¾ªçŽ¯ä¸­æ’å…¥&lt;code>Pthread_create()&lt;/code>ï¼Œè€Œ&lt;code>doit()&lt;/code>åˆ™è¢«å°è£…è¿›çº¿ç¨‹çš„å…¥å£å‡½æ•°ä¸­ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nf">Pthread_create&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">tid&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kr">thread&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">connfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">thread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">fd&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Pthread_detach&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">pthread_self&lt;/span>&lt;span class="p">());&lt;/span> &lt;span class="c1">// è®¾ç½®ä¸ºå¯åˆ†ç¦»çŠ¶æ€ï¼Œè‡ªåŠ¨å›žæ”¶èµ„æº
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nf">doit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="part3-cache">Part3: Cache&lt;/h2>
&lt;p>åœ¨ç¼“å­˜æµ‹è¯•ä¸­ï¼Œæµ‹è¯„è„šæœ¬ä¼šåœ¨æ‰§è¡Œè¿‡ä¸€å®šçš„è¯·æ±‚ä¹‹åŽæ€æ­»tinyæœåŠ¡å™¨ï¼Œè¦æ±‚æœåŠ¡å™¨å¯¹ä¹‹å‰çš„è¯·æ±‚è¿›è¡Œä¿å­˜ã€‚ç»“åˆä¸Šä¸€æ­¥çš„å¤šçº¿ç¨‹ï¼Œè¿™é‡Œä¾¿å­˜åœ¨ç€å¹¶å‘è¯»å†™çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>è€Œç¼“å­˜çš„å®žçŽ°ç»†èŠ‚æœ‰éžå¸¸å¤šå¯è¯´çš„éƒ¨åˆ†ï¼Œè¿™é‡Œé¦–å…ˆæŠ½è±¡å‡ºæŽ¥å£ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">doit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">cfd&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="n">port&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">response&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXLINE&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (1) client -&amp;gt; proxy */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">read_req&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">path&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (1.1) proxy -&amp;gt; cache */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">read_cache&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (1.2) cache -&amp;gt; client */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (2) proxy -&amp;gt; server */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">n&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sfd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Open_clientfd&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">host&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">port&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">request&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">strlen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">request&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (3) server -&amp;gt; proxy */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAXBUF&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="n">res&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">MAX_CACHE_SIZE&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="n">n&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">Rio_readn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">sizeof&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (4) proxy -&amp;gt; client */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Rio_writen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">cfd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">strncat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">buf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">char&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* (4.1) proxy -&amp;gt; cache */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">write_cache&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">res&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Close&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">sfd&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å…·ä½“åˆ°ç¼“å­˜è®¾è®¡è¿™é‡Œå¯ä»¥è‡ªç”±å‘æŒ¥ã€‚å¦‚æžœé¢å‘è¯„æµ‹è„šæœ¬ç¼–ç¨‹ï¼Œåªéœ€è¦ç¼“å­˜å®¹é‡ä¸º3ï¼Œè¿žç¼“å­˜åˆ é™¤çš„ç­–ç•¥éƒ½ä¸ç”¨å®žçŽ°ã€‚ä¸è¿‡è€ƒè¯•å°±è€ƒè¿™ä¸ªLRUã€OPTå•¥çš„ï¼Œè¿˜æ˜¯å¾—ç†è§£ä¸€ä¸‹ã€‚ä¸‹é¢æ˜¯åŸºäºŽå¾ªçŽ¯é“¾è¡¨çš„LRUç­–ç•¥å®žçŽ°ï¼š&lt;/p>
&lt;ul>
&lt;li>æ•°æ®ç»“æž„&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="k">typedef&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="n">CacheEntry&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">next&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">struct&lt;/span> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">prev&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">typedef&lt;/span> &lt;span class="k">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">size&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">capacity&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">head&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">tail&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">pthread_mutex_t&lt;/span> &lt;span class="n">lock&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span> &lt;span class="n">Cache&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>åˆå§‹åŒ–&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="n">Cache&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nf">createCache&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">capacity&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Cache&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">cache&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">Cache&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="nf">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Cache&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">capacity&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">capacity&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_init&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>è¯»ç¼“å­˜&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="nf">read_cache&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Cache&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_lock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ç›¸åŒçš„ key
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">current&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">head&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">current&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_unlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">current&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">next&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_unlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>å†™ç¼“å­˜&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">void&lt;/span> &lt;span class="nf">write_cache&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Cache&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="k">const&lt;/span> &lt;span class="kt">char&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// åˆå§‹åŒ–Entry
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">entry&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="nf">malloc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">sizeof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">CacheEntry&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">entry&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">key&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">strdup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">entry&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">strdup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">entry&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">next&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">entry&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">prev&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_lock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æŸ¥æ‰¾æ˜¯å¦å·²å­˜åœ¨ç›¸åŒçš„ key
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">current&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">head&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">current&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nf">strcmp&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">key&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="c1">// æ›´æ–°å€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nf">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">strdup&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_unlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">current&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">current&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">next&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æ’å…¥æ–°èŠ‚ç‚¹åˆ°é“¾è¡¨å¤´éƒ¨
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">entry&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">next&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">head&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">head&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">head&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">prev&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">entry&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">tail&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">entry&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">head&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">entry&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// å¦‚æžœè¶…è¿‡å®¹é‡é™åˆ¶ï¼Œåˆ é™¤å°¾éƒ¨èŠ‚ç‚¹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">size&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">capacity&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">CacheEntry&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">tail&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">tail&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">tail&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">tail&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">prev&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">tail&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">next&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tail&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">key&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tail&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">free&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tail&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">size&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">pthread_mutex_unlock&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">cache&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">lock&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¯„ä»·ï¼šæœ€åŽä¸€ä¸ªå®žéªŒæ»¡åˆ†çš„è¦æ±‚è¿˜æ˜¯å¾ˆä½Žçš„ã€‚ç”±äºŽcè¯­è¨€ç¼–ç¨‹å®žåœ¨ç¹çï¼ŒðŸ‘´è¿™ä¸ªå®žéªŒè¿½æ±‚çš„æ˜¯æ»¡åˆ†åŸºç¡€ä¸‹çš„ä»£ç æžç®€ä¸»ä¹‰ã€‚å¦‚æžœæƒ³å­¦åˆ°è·Ÿå¤šå¯ä»¥è‡ªå·±å¢žåŠ è¦æ±‚ï¼Œå¦‚ï¼š&lt;/p>
&lt;ul>
&lt;li>tinyä»…æ”¯æŒGETâ€”â€”å¢žåŠ å¯¹ä¸åŒHTTPæ–¹æ³•çš„æ”¯æŒ&lt;/li>
&lt;li>æ”¯æŒå¯¹é•¿æŠ¥æ–‡åˆ†å—(chunk)çš„å¤„ç†&lt;/li>
&lt;li>å¢žå¼ºå¹¶å‘æ€§èƒ½ï¼Œä½¿ç”¨ä¿¡å·é‡ä»£æ›¿äº’æ–¥é”ï¼Œä½¿ç”¨çº¿ç¨‹æ± ç­‰ç­‰&lt;/li>
&lt;li>å¢žå¼ºç¼“å­˜æ€§èƒ½ï¼Œä½¿ç”¨å“ˆå¸Œè¡¨ç­‰é«˜æ•ˆæ•°æ®ç»“æž„&lt;/li>
&lt;/ul>
&lt;p>å®žé™…ä¸Šï¼Œç”Ÿäº§çº§ä»£ç†æœåŠ¡å™¨è€ƒè™‘çš„è¿œæ¯”è¿™äº›å¤æ‚ã€‚è·¯ç”±è§„åˆ™ï¼ŒåŠ å¯†åè®®ç­‰ç­‰&lt;/p></description></item><item><title>MOSPI-ChCore lab (1)</title><link>https://lonelyuan.github.io/HugoBlog/p/mospi-chcore-lab-1/</link><pubDate>Fri, 29 Oct 2021 17:03:14 +0000</pubDate><guid>https://lonelyuan.github.io/HugoBlog/p/mospi-chcore-lab-1/</guid><description>&lt;p>ç”±äºŽðŸ‘´è§‰å¾—ðŸ‘´å­¦æ ¡çš„æ“ä½œç³»ç»Ÿè®²äº†ä¸ªðŸ”¨ï¼Œæ…•åè€Œæ¥å­¦ä¹ ä¸Šäº¤çš„ MOSPI è¯¾ç¨‹ã€‚é“¶æä¹¦çœ‹å®Œä¹‹åŽðŸ‘´å‘çŽ°ðŸ‘´å­¦æ ¡çš„OSç¡®å®žè®²äº†ä¸ªðŸ”¨ã€‚æˆ‘ç›´æŽ¥å½“åœºæ¥ä¸€æ®µåœ£ç»åŸå”±ï¼š&lt;/p>
&lt;p>é‚£ä¸ªé¢è¥¿ç”µæ“ä½œç³»ç»Ÿå—·ï¼Œä¸ä¼šå†™æ•™æå¯ä»¥ä¸å†™ï¼Œå®³ç‰¹ä¹ˆåœ¨å¼„ä½ é‚£ä¸ªç®¡ç¨‹ï¼Œæ¥æˆ‘æ•™ä½ å•Šï¼Œçœ‹å¥½äº†å•Šã€‚é¦–å…ˆ M.A.L.H. åŽŸåˆ™ï¼Œçœ‹æ‡‚äº†å—ï¼Œç„¶åŽå¼€è®²&lt;strong>è™šæ‹Ÿå†…å­˜&lt;/strong>ï¼Œå“Žæˆ‘å°±ä¸è™šæ‹Ÿï¼Œæˆ‘å°±è®²é‚£ä¸ªç©ºé—²é“¾è¡¨ã€‚å“Žï¼Œå†æ‰Žä¸ª&lt;strong>å¤šçº¿ç¨‹&lt;/strong>ï¼Œçœ‹åˆ°æ²¡ï¼Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢äº†ã€‚æˆ‘ç‰¹ä¹ˆç›´æŽ¥ä¸‰æ®µ&lt;strong>ç³»ç»Ÿè°ƒåº¦&lt;/strong>ï¼ˆçŸ­æœŸï¼Œä¸­æœŸï¼Œé•¿æœŸï¼‰ï¼Œç„¶åŽæˆ‘ç›´æŽ¥~å°±ä¸€ä¸ªå¤šæ ¸è°ƒåº¦ï¼Œæˆ‘å°±è°ƒåº¦åˆ°&lt;strong>IPC&lt;/strong>ï¼Œè¿›ç¨‹çŽ°åœ¨å·²ç»å¯ä»¥é€šä¿¡äº†å•Šï¼åˆ«æ€ªæˆ‘æ²¡æœ‰æ•™å¥½ä½ ï¼Œè¿›ç¨‹é€šä¿¡äº†ä¹‹åŽå¹²ä»€ä¹ˆï¼Œæ†‹ç‰¹ä¹ˆè®²ä½ é‚£ç ´å‡ æŠŠå¤„ç†æœºäº†ã€‚çœ‹å¥½å•Šï¼Œè®²å‡ºé”ï¼ˆå¬‰çš®ç¬‘è„¸ï¼‰ï¼Œè®²å‡º&lt;strong>ä¿¡å·é‡&lt;/strong>ç›´æŽ¥å°±æ‰”åˆ°äº’æ–¥èµ„æºèº«ä¸Šï¼Œå°±ç–¯ç‹‚çš„è¿›å…¥ä»–çš„ä¸´ç•ŒåŒºã€‚ç„¶åŽæˆ‘å†ä¸€ä¸ªï¼Œ&lt;strong>æ–‡ä»¶ç³»ç»Ÿ&lt;/strong>ï¼åŠ ä¸‰æ®µç³»ç»Ÿ&lt;strong>è™šæ‹ŸåŒ–&lt;/strong>ï¼ˆCPUè™šæ‹ŸåŒ–ã€å†…å­˜è™šæ‹ŸåŒ–ã€IOè™šæ‹ŸåŒ–ï¼‰ï¼Œå…¨éƒ¨åƒæ»¡ï¼Œå®Œæˆå¼ºæ€ï¼Œä½ å”›ç’§ä½ æ‡‚ä¸ªderï¼Œè®²å¯„å§OSï¼Œæˆ‘çˆ±ä½ ã€‚&lt;/p>
&lt;p>&lt;em>åœ£ç»åŽŸæ–‡ï¼š&lt;/em>&lt;a class="link" href="https://www.bilibili.com/video/BV1Jf4y1L7EZ" target="_blank" rel="noopener"
>æ‹–æ›´äº‘çš„é¹°ä½æ•™å­¦&lt;/a>&lt;/p>
&lt;hr>
&lt;blockquote>
&lt;p>æœ¬ç³»åˆ—ä¸º ChCore lab å®žéªŒæŠ¥å‘Šã€‚
Labæºç ï¼šhttps://gitee.com/ipads-lab/chcore-lab
MOSPIåœ¨çº¿ç½‘ç«™ï¼šhttps://ipads.se.sjtu.edu.cn/mospi/&lt;/p>
&lt;/blockquote>
&lt;h2 id="å®žéªŒçŽ¯å¢ƒ">å®žéªŒçŽ¯å¢ƒ&lt;/h2>
&lt;p>éœ€è¦dockerå’Œqemuï¼Œdockerä¸èµ˜è¿°ã€‚linuxä¸‹å®‰è£…qemuï¼š
&lt;code>sudo apt-get install qemu-system-arm&lt;/code>
å®‰è£…å®Œæˆä¹‹åŽæŸ¥çœ‹ç‰ˆæœ¬å·ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-plain" data-lang="plain">&lt;span class="line">&lt;span class="cl">$ qemu-system-aarch64 --version
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">QEMU emulator version 4.2.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Copyright (c) 2003-2019 Fabrice Bellard and the QEMU Project developers
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>5ä¸ªå®žéªŒåœ¨æºç ä»“åº“åˆ†åˆ«ä»¥5ä¸ªåˆ†æ”¯å­˜åœ¨ã€‚ git clone -bå³å¯ã€‚&lt;/p>
&lt;p>å†…æ ¸æž„å»ºå’Œè°ƒè¯•ï¼š&lt;/p>
&lt;ul>
&lt;li>ç”¨dockeräº¤å‰ç¼–è¯‘å†…æ ¸ï¼š&lt;code>make build&lt;/code>&lt;/li>
&lt;li>å¯åŠ¨qemuï¼š&lt;code>make qemu&lt;/code>
&lt;ul>
&lt;li>è¿™é‡Œé‡åˆ°æŠ¥é”™ï¼š&lt;code> Unable to init server: Could not connect: Connection refused gtk initialization failed&lt;/code>&lt;/li>
&lt;li>è§£å†³æ–¹æ³•ï¼šä¿®æ”¹ Makefile ï¼Œåœ¨&lt;code>QEMUOPTS&lt;/code>å‚æ•°åŽåŠ &lt;code>-nographic&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å¯åŠ¨qemuï¼š&lt;code>make qemu-gdb&lt;/code>
&lt;ul>
&lt;li>å°†ç›‘å¬1234ç«¯å£ä»¥ä¾›gdbè¿œç¨‹è°ƒç”¨&lt;/li>
&lt;li>é€€å‡ºï¼š&lt;code>ctrl+a&lt;/code>ï¼Œç„¶åŽæŒ‰xã€‚&lt;/li>
&lt;li>å¦‚æžœæ„å¤–é€€å‡ºï¼Œè¦æ€æ­»è¿›ç¨‹ï¼š&lt;code>kill $(ps -ef | grep qemu | grep 1234 | awk '{print $2}')&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åœ¨å¦ä¸€ä¸ªç»ˆç«¯å¯åŠ¨gdbè°ƒè¯•ï¼š&lt;code>make gdb&lt;/code>
&lt;ul>
&lt;li>è¿™é‡Œå¯èƒ½éœ€è¦å®‰è£…gdb-multiarchï¼š&lt;code>sudo apt-get install gdb-multiarch&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œæœ¬é¡¹ç›®ä¸­ Makefile ä¸»è¦æ˜¯å°è£…äº†ä¸€äº›å‘½ä»¤ã€‚&lt;/p>
&lt;hr>
&lt;h2 id="lab1">Lab1&lt;/h2>
&lt;h3 id="ç»ƒä¹ 3-åŠ è½½å…¥å£å®šä¹‰">ç»ƒä¹ 3-åŠ è½½å…¥å£å®šä¹‰&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@lastyear:~/chcore-lab# readelf -S build/kernel.img
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">There are &lt;span class="m">9&lt;/span> section headers, starting at offset 0x20cd8:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Section Headers:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>Nr&lt;span class="o">]&lt;/span> Name Type Address Offset
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Size EntSize Flags Link Info Align
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 0&lt;span class="o">]&lt;/span> NULL &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">00000000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 1&lt;span class="o">]&lt;/span> init PROGBITS &lt;span class="m">0000000000080000&lt;/span> &lt;span class="m">00010000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 000000000000b5b0 &lt;span class="m">0000000000000008&lt;/span> WAX &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">4096&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 2&lt;span class="o">]&lt;/span> .text PROGBITS ffffff000008c000 0001c000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 00000000000011dc &lt;span class="m">0000000000000000&lt;/span> AX &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 3&lt;span class="o">]&lt;/span> .rodata PROGBITS ffffff0000090000 &lt;span class="m">00020000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 00000000000000f8 &lt;span class="m">0000000000000001&lt;/span> AMS &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 4&lt;span class="o">]&lt;/span> .bss NOBITS ffffff0000090100 000200f8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0000000000008000&lt;/span> &lt;span class="m">0000000000000000&lt;/span> WA &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 5&lt;span class="o">]&lt;/span> .comment PROGBITS &lt;span class="m">0000000000000000&lt;/span> 000200f8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0000000000000032&lt;/span> &lt;span class="m">0000000000000001&lt;/span> MS &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 6&lt;span class="o">]&lt;/span> .symtab SYMTAB &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">00020130&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0000000000000858&lt;/span> &lt;span class="m">0000000000000018&lt;/span> &lt;span class="m">7&lt;/span> &lt;span class="m">46&lt;/span> &lt;span class="m">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 7&lt;span class="o">]&lt;/span> .strtab STRTAB &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">00020988&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 000000000000030f &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> 8&lt;span class="o">]&lt;/span> .shstrtab STRTAB &lt;span class="m">0000000000000000&lt;/span> 00020c97
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 000000000000003c &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>çœ‹åˆ°initæ®µçš„èµ·å§‹åœ°å€æ˜¯&lt;code>0x80000&lt;/code>ï¼Œå’Œ&lt;code>readelf -h&lt;/code>ä¸­çš„ Entry point address ä¸€è‡´ï¼Œä¹Ÿå’Œ GDB åˆšè¿›å…¥æ—¶&lt;code>where&lt;/code>çš„è¾“å‡ºä¸€è‡´ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">0x0000000000080000 in ?? &lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>gdb&lt;span class="o">)&lt;/span> where
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#0 0x0000000000080000 in _start ()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸‹é¢å¯»æ‰¾&lt;code>_start&lt;/code>çš„å®šä¹‰ï¼Œåœ¨&lt;code>CMakeLists.txt&lt;/code>ä¸­æ‰¾åˆ°&lt;code>_start&lt;/code>ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">set_property&lt;span class="o">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> TARGET kernel.img
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> APPEND_STRING
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PROPERTY
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> LINK_FLAGS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;-T &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">CMAKE_CURRENT_BINARY_DIR&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">link_script&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> -e _start&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œä¸º&lt;code>kernel.img&lt;/code>æŒ‡å®šäº†é“¾æŽ¥å™¨è„šæœ¬(-T)å’Œå…¥å£å‡½æ•°(-e)ã€‚&lt;/p>
&lt;p>äºŽæ˜¯è·Ÿéšlink_scriptï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">set&lt;span class="o">(&lt;/span>link_script &lt;span class="s2">&amp;#34;linker.lds&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">configure_file&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;./scripts/linker-aarch64.lds.in&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;linker.lds.S&amp;#34;&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿›å…¥è„šæœ¬linker-aarch64.lds.inï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;#34;../boot/image.h&amp;#34;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">SECTIONS&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">TEXT_OFFSET&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_start&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">.;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nl">init&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">init_object&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å…¶ä¸­&lt;code>init&lt;/code>æ®µæŒ‡å®šäº†åŠ è½½&lt;code>init_object&lt;/code>ï¼Œå®ƒè¡¨ç¤ºbootloaderçš„æ‰€æœ‰ç›®æ ‡æ–‡ä»¶é›†åˆã€‚å…¶å®šä¹‰å›žåˆ°&lt;code>CmakeLists.txt&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">set&lt;span class="o">(&lt;/span>init_object
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BINARY_KERNEL_IMG_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BOOTLOADER_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/start.S.o
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BINARY_KERNEL_IMG_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BOOTLOADER_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/mmu.c.o
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BINARY_KERNEL_IMG_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BOOTLOADER_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/tools.S.o
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BINARY_KERNEL_IMG_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BOOTLOADER_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/init_c.c.o
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2"> &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BINARY_KERNEL_IMG_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">BOOTLOADER_PATH&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">/uart.c.o&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¯å‘çŽ°&lt;code>/boot/start.S&lt;/code>å®šä¹‰äº†&lt;code>_start&lt;/code>ã€‚&lt;/p>
&lt;p>ä¸‹é¢ç»§ç»­å¯»æ‰¾åœ°å€ï¼Œåœ¨é“¾æŽ¥å™¨è„šæœ¬å¼•ç”¨äº†&lt;code>image.h&lt;/code>ï¼Œå…¶ä¸­æœ‰&lt;code>TEXT_OFFSET&lt;/code>çš„å®šä¹‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#pragma once
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define SZ_16K 0x4000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define SZ_64K 0x10000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define KERNEL_VADDR 0xffffff0000000000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define TEXT_OFFSET 0x80000
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸€åˆ‡ç»ˆäºŽä¸²èµ·æ¥äº†ï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;code>CMakeLists.txt&lt;/code>ï¼šæ˜¯CMakeçš„è„šæœ¬æ–‡ä»¶ã€‚ CMake æ˜¯è·¨å¹³å°çš„C/C++å»ºæž„å·¥å…·ã€‚
&lt;ul>
&lt;li>ä½œç”¨ï¼š
&lt;ul>
&lt;li>æŒ‡å®šæºæ–‡ä»¶é›†åˆ&lt;code>init_object&lt;/code>&lt;/li>
&lt;li>å®šä¹‰é“¾æŽ¥å™¨è„šæœ¬&lt;code>link_script&lt;/code>&lt;/li>
&lt;li>æŒ‡å®šå…¥å£å‡½æ•°&lt;code>_start&lt;/code>å¹¶æŒ‡å®šé“¾æŽ¥å™¨è„šæœ¬&lt;/li>
&lt;li>æœ€ç»ˆç”Ÿæˆ&lt;code>kernel.img&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>//æœ€è¿‘çœ‹åˆ°çš„æŒºå¥½çš„CMakeæ•™ç¨‹ï¼šhttps://www.bilibili.com/video/BV1rR4y1E7n9&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;code>linker-aarch64.lds.in&lt;/code>ï¼šldsæ˜¯é“¾æŽ¥å™¨è„šæœ¬æ–‡ä»¶ï¼Œè´Ÿè´£æŽ§åˆ¶è¾“å‡ºçš„ELFæ–‡ä»¶çš„ç»†èŠ‚ã€‚
&lt;ul>
&lt;li>ä½œç”¨ï¼šæŒ‡å®šäº†èµ·å§‹åœ°å€&lt;code>0x80000&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="ç»ƒä¹ 3-å¤šå¤„ç†å™¨æŒ‚èµ·">ç»ƒä¹ 3-å¤šå¤„ç†å™¨æŒ‚èµ·&lt;/h3>
&lt;p>&lt;code>start.S&lt;/code>ä¸­æ³¨é‡Šçš„å¾ˆæ˜Žç™½äº†ï¼Œé€šè¿‡æ£€æŸ¥&lt;code>mpidr_el1&lt;/code>å¯„å­˜å™¨æ¥åˆ¤æ–­ cpuid ï¼Œå¦‚æžœä¸æ˜¯0åˆ™è¿›å…¥æ­»å¾ªçŽ¯ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">BEGIN_FUNC&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">_start&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mrs&lt;/span> &lt;span class="n">x8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">mpidr_el1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">and&lt;/span> &lt;span class="n">x8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">x8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="err">#&lt;/span>&lt;span class="mh">0xFF&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cbz&lt;/span> &lt;span class="n">x8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">primary&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* hang all secondary processors before we intorduce multi-processors */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nl">secondary_hang&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bl&lt;/span> &lt;span class="n">secondary_hang&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nl">primary&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* Turn to el1 from other exception levels. */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bl&lt;/span> &lt;span class="n">arm64_elX_to_el1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* Prepare stack pointer and jump to C. */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">adr&lt;/span> &lt;span class="n">x0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">boot_cpu_stack&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">add&lt;/span> &lt;span class="n">x0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">x0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="err">#&lt;/span>&lt;span class="mh">0x1000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mov&lt;/span> &lt;span class="n">sp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">x0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bl&lt;/span> &lt;span class="n">init_c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* Should never be here */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">b&lt;/span> &lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">END_FUNC&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">_start&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ç»ƒä¹ 4-lmaå’Œvma">ç»ƒä¹ 4-LMAå’ŒVMA&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root@lastyear:~/chcore-lab# objdump -h build/kernel.img
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">build/kernel.img: file format elf64-little
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Sections:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Idx Name Size VMA LMA File off Algn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">0&lt;/span> init 0000b5b0 &lt;span class="m">0000000000080000&lt;/span> &lt;span class="m">0000000000080000&lt;/span> &lt;span class="m">00010000&lt;/span> 2**12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> CONTENTS, ALLOC, LOAD, CODE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1&lt;/span> .text 000011dc ffffff000008c000 000000000008c000 0001c000 2**3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> CONTENTS, ALLOC, LOAD, READONLY, CODE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">2&lt;/span> .rodata 000000f8 ffffff0000090000 &lt;span class="m">0000000000090000&lt;/span> &lt;span class="m">00020000&lt;/span> 2**3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> CONTENTS, ALLOC, LOAD, READONLY, DATA
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">3&lt;/span> .bss &lt;span class="m">00008000&lt;/span> ffffff0000090100 &lt;span class="m">0000000000090100&lt;/span> 000200f8 2**4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ALLOC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">4&lt;/span> .comment &lt;span class="m">00000032&lt;/span> &lt;span class="m">0000000000000000&lt;/span> &lt;span class="m">0000000000000000&lt;/span> 000200f8 2**0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> CONTENTS, READONLY
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¯ä»¥å‘çŽ°åªæœ‰initæ®µçš„VMAå’ŒLMAç›¸åŒã€‚å…¶èµ‹å€¼è¿˜æ˜¯å›žåˆ°ldsè„šæœ¬ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="n">SECTIONS&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">TEXT_OFFSET&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_start&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">.;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nl">init&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">//initæ®µVMA==VMA
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="n">init_object&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">ALIGN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">SZ_16K&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// å¯¹é½16k
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">init_end&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">ABSOLUTE&lt;/span>&lt;span class="p">(.);&lt;/span> &lt;span class="c1">// initæ®µç»“æŸ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// KERNEL_VADDRåœ¨image.hå®šä¹‰ä¸º0xffffff0000000000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="n">text&lt;/span> &lt;span class="n">KERNEL_VADDR&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nl">init_end&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="nf">AT&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">init_end&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="c1">// ATæŒ‡å®šLMA
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(.&lt;/span>&lt;span class="n">text&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="c1">// .textæ®µï¼šVMA = KERNEL_VADDR + init_end; LMA = init_end
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// åŽé¢çš„æ®µï¼Œå…¨éƒ¨æŒ‰é¡ºåºå¯¹é½å¹¶é€’å¢žï¼Œæ­¤æ—¶VMAå’ŒLMAå·²ç»ä¸åŒï¼Œæ•…åŽé¢çš„æ®µä¹Ÿå…¨éƒ½ä¸åŒ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">.&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">ALIGN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">SZ_64K&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nl">data&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="p">(.&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">ALIGN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">SZ_64K&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nl">rodata&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="p">(.&lt;/span>&lt;span class="n">rodata&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">_edata&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">.&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">KERNEL_VADDR&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// è¿™äº›å¤–éƒ¨å˜é‡æŒ‡çš„æ˜¯LMAï¼Œåˆ™å‡åŽ»è™šæ‹Ÿåœ°å€å¤´
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">_bss_start&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">.&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">KERNEL_VADDR&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span>&lt;span class="nl">bss&lt;/span> &lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">*&lt;/span>&lt;span class="p">(.&lt;/span>&lt;span class="n">bss&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">_bss_end&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">.&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">KERNEL_VADDR&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">.&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">ALIGN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">SZ_64K&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">img_end&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">.&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">KERNEL_VADDR&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å›žç­”é—®é¢˜ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ä¸ºä»€ä¹ˆLMAå’ŒVMAä¸åŒ&lt;/p>
&lt;ul>
&lt;li>VMAæ˜¯å¯¹åº”è™šæ‹Ÿå†…å­˜çš„åœ°å€ï¼Œä½†åœ¨å†…æ ¸å¯åŠ¨æ—¶è¿˜å¤„äºŽç‰©ç†åœ°å€æ¨¡å¼ï¼ŒVMAå¯èƒ½è¶…å‡ºç‰©ç†å†…å­˜èŒƒå›´ã€‚æ‰€ä»¥åªèƒ½å…ˆåŠ è½½ï¼Œå†æ˜ å°„åˆ°è™šæ‹Ÿåœ°å€ã€‚&lt;/li>
&lt;li>ä¸ºä»€ä¹ˆå†…æ ¸æ®µçš„VMAè¦æ˜ å°„åˆ°é«˜ä½ï¼Œåº”è¯¥æ˜¯ä¸€ç§æƒ¯ä¾‹ã€‚&lt;/li>
&lt;li>ä¸ºä»€ä¹ˆbootloaderä¸ç”¨VMAï¼Œå› ä¸ºä»–è´Ÿè´£åˆå§‹åŒ–é¡µè¡¨ï¼Œä»–ä¸èƒ½ç”¨ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>LMAåˆ°VMAåœ¨ä½•æ—¶è½¬æ¢&lt;/p>
&lt;ul>
&lt;li>ç”±ä¸Šä¸€é—®å¯çŸ¥ï¼Œé¡µè¡¨åˆå§‹åŒ–ä¹‹åŽä¾¿å¯è½¬æ¢ä¸ºVMAã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="ç»ƒä¹ 5-cè¯­è¨€è¿›åˆ¶è½¬æ¢">ç»ƒä¹ 5-cè¯­è¨€è¿›åˆ¶è½¬æ¢&lt;/h3>
&lt;p>ä»ŽåŽå¾€å‰å–ä½™å³å¯ã€‚&lt;/p>
&lt;h3 id="ç»ƒä¹ 6-å‡½æ•°æ ˆ">ç»ƒä¹ 6-å‡½æ•°æ ˆ&lt;/h3>
&lt;p>&lt;code>start.S&lt;/code>ä¸­èµ‹å€¼äº†spï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> /* Prepare stack pointer and jump to C. */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> adr x0, boot_cpu_stack
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add x0, x0, #0x1000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mov sp, x0 /* sp = boot_cpu_stack + 0x1000 */
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>boot_cpu_stack&lt;/code>åœ¨&lt;code>init.c&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#define INIT_STACK_SIZE 0x1000
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="kt">char&lt;/span> &lt;span class="n">boot_cpu_stack&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">PLAT_CPU_NUMBER&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">INIT_STACK_SIZE&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="nf">ALIGN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç”±äºŽ&lt;code>PLAT_CPU_NUMBER&lt;/code>è¢«å®šä¹‰ä¸º4ï¼Œæ•…&lt;code>boot_cpu_stack&lt;/code>å¤§å°ä¸º4*4096ï¼Œå¯ä¾›å››ä¸ªCPUä½¿ç”¨ã€‚spåˆå§‹åŒ–åŽæŒ‡å‘ç¬¬ä¸€ä¸ª4069ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªcpuå†…æ ¸æ ˆçš„æœ€é«˜ä½ã€‚åˆå§‹åŒ–æ—¶ï¼Œfp=spã€‚&lt;/p>
&lt;p>ä½†è¿™æ˜¯bootloaderçš„æ ˆã€‚åŽç»­è¿›å…¥å†…æ ¸åŽï¼Œä¼šé‡æ–°åˆ†é…å†…æ ¸æ ˆï¼Œå‚è§&lt;code>head.S&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">BEGIN_FUNC(start_kernel)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mov x3, #0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> msr TPIDR_EL1, x3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ldr x2, =kernel_stack
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> add x2, x2, KERNEL_STACK_SIZE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mov sp, x2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bl main
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">END_FUNC(start_kernel)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>äºŽæ˜¯å†…æ ¸æ ˆçš„å®šä¹‰åœ¨start_kernelå‡½æ•°ã€‚&lt;/p>
&lt;p>æœ‰å…³å†…æ ¸æ ˆçš„ä½ç½®ï¼Œå› ä¸ºkernel_stackæ˜¯å…¨å±€æ•°ç»„ï¼Œä¸”æœªåˆå§‹åŒ–ï¼Œå› è€Œä½äºŽ.bssã€‚åŒæ—¶æ²¡æœ‰å…¶ä»–æœªåˆå§‹åŒ–å˜é‡ï¼Œå› æ­¤é¦–åœ°å€åœ¨&lt;code>.bss + KERNEL_STACK_SIZE&lt;/code>ã€‚&lt;/p>
&lt;p>é€šè¿‡readelfå¾—åˆ°.bssçš„VMAä¸º0xffffff0000090100ï¼ŒKERNEL_STACK_SIZEä¸º0x2000ï¼Œè¿›å…¥gdbè°ƒè¯•å¯ä»¥éªŒè¯&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">gefâž¤ x/g $sp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff0000092100 &amp;lt;kernel_stack+8192&amp;gt;: 0x0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ç»ƒä¹ 7-è°ƒç”¨æƒ¯ä¾‹">ç»ƒä¹ 7-è°ƒç”¨æƒ¯ä¾‹&lt;/h3>
&lt;p>å…ˆçœ‹stack_testå‡½æ•°ã€‚è¿™é‡Œgdbå®‰è£…äº†gefæ’ä»¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">gefâž¤ b stack_test
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Breakpoint 1 at 0xffffff000008c020
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gefâž¤ disas
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Dump of assembler code for function stack_test:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">=&amp;gt; 0xffffff000008c020 &amp;lt;+0&amp;gt;: stp x29, x30, [sp, #-32]! /* FPã€LR å…¥æ ˆ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c024 &amp;lt;+4&amp;gt;: mov x29, sp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c028 &amp;lt;+8&amp;gt;: str x19, [sp, #16] /* x å…¥æ ˆ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c02c &amp;lt;+12&amp;gt;: mov x19, x0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c030 &amp;lt;+16&amp;gt;: mov x1, x0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c034 &amp;lt;+20&amp;gt;: adrp x0, 0xffffff0000090000 # è®¡ç®—åç§»
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c038 &amp;lt;+24&amp;gt;: add x0, x0, #0x0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c03c &amp;lt;+28&amp;gt;: bl 0xffffff000008c620 &amp;lt;printk&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c040 &amp;lt;+32&amp;gt;: cmp x19, #0x0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c044 &amp;lt;+36&amp;gt;: b.gt 0xffffff000008c068 &amp;lt;stack_test+72&amp;gt; # greater than /* é€’å½’ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c048 &amp;lt;+40&amp;gt;: bl 0xffffff000008c0dc &amp;lt;stack_backtrace&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c04c &amp;lt;+44&amp;gt;: mov x1, x19
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c050 &amp;lt;+48&amp;gt;: adrp x0, 0xffffff0000090000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c054 &amp;lt;+52&amp;gt;: add x0, x0, #0x20
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c058 &amp;lt;+56&amp;gt;: bl 0xffffff000008c620 &amp;lt;printk&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c05c &amp;lt;+60&amp;gt;: ldr x19, [sp, #16] # x19 = sp + 16 /* x å‡ºæ ˆ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c060 &amp;lt;+64&amp;gt;: ldp x29, x30, [sp], #32 # load pair /* FPã€LR å‡ºæ ˆ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c064 &amp;lt;+68&amp;gt;: ret
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c068 &amp;lt;+72&amp;gt;: sub x0, x19, #0x1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c06c &amp;lt;+76&amp;gt;: bl 0xffffff000008c020 &amp;lt;stack_test&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c070 &amp;lt;+80&amp;gt;: mov x1, x19
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c074 &amp;lt;+84&amp;gt;: adrp x0, 0xffffff0000090000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c078 &amp;lt;+88&amp;gt;: add x0, x0, #0x20
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c07c &amp;lt;+92&amp;gt;: bl 0xffffff000008c620 &amp;lt;printk&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c080 &amp;lt;+96&amp;gt;: ldr x19, [sp, #16]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c084 &amp;lt;+100&amp;gt;: ldp x29, x30, [sp], #32
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 0xffffff000008c088 &amp;lt;+104&amp;gt;: ret
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">End of assembler dump.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿è¡Œï¼Œè§‚å¯Ÿæ ˆçš„å˜åŒ–ï¼Œè¿™é‡Œçœç•¥éƒ¨åˆ†è¾“å‡ºï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">gefâž¤ c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ registers â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x0 : 0x0000000000000005 # è¿™ä¸€å±‚å‡½æ•°çš„è¾“å…¥å€¼
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x19 : 0x0000000000000000 # ä¸Šä¸€å±‚å‡½æ•°çš„è¿”å›žå€¼
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x29 : 0xffffff00000920f0 # FP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x30 : 0xffffff000008c0d4 â†’ &amp;lt;main+72&amp;gt; # LR
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$sp : 0xffffff00000920f0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ stack â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920f0â”‚+0x0000: 0x0000000000000000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920f8â”‚+0x0008: 0xffffff000008c018 # æ ˆå¤´ï¼Œå¯èƒ½æ˜¯æ ˆåˆå§‹åŒ–çš„æ•°æ®ç»“æž„
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ trace â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#0] 0xffffff000008c020 â†’ stack_test()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#1] 0xffffff000008c0d4 â†’ main()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gefâž¤ c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ registers â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x0 : 0x0000000000000004
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x19 : 0x0000000000000005
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x29 : 0xffffff00000920d0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x30 : 0xffffff000008c070 #â†’ &amp;lt;stack_test+80&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$sp : 0xffffff00000920d0 â†’ 0xffffff00000920f0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ stack â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920d0â”‚+0x0000: 0xffffff00000920f0 â”€â” # FP
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920d8â”‚+0x0008: 0xffffff000008c0d4 â”‚ # LR
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920e0â”‚+0x0010: 0x0000000000000000 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920e8â”‚+0x0018: 0x00000000ffffffc0 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920f0â”‚+0x0020: 0x0000000000000000 â—„â”˜
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920f8â”‚+0x0028: 0xffffff000008c018
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ trace â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#0] 0xffffff000008c020 â†’ stack_test()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#1] 0xffffff000008c070 â†’ stack_test()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#2] 0xffffff000008c0d4 â†’ main()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">gefâž¤ c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ registers â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x0 : 0x0000000000000003
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x19 : 0x0000000000000004
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x29 : 0xffffff00000920b0 â†’ 0xffffff00000920d0 â†’ 0xffffff00000920f0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$x30 : 0xffffff000008c070
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$sp : 0xffffff00000920b0 â†’ 0xffffff00000920d0 â†’ 0xffffff00000920f0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ stack â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920b0â”‚+0x0000: 0xffffff00000920d0 â”€â” # [#1]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920b8â”‚+0x0008: 0xffffff000008c070 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920c0â”‚+0x0010: 0x0000000000000005 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920c8â”‚+0x0018: 0x00000000ffffffc0 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920d0â”‚+0x0020: 0xffffff00000920f0 â—„â”˜ # [#2]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920d8â”‚+0x0028: 0xffffff000008c0d4 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920e0â”‚+0x0010: 0x0000000000000000 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920e8â”‚+0x0018: 0x00000000ffffffc0 â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920f0â”‚+0x0020: 0x0000000000000000 â—„â”˜ # [#3]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0xffffff00000920f8â”‚+0x0028: 0xffffff000008c018
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ trace â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#0] 0xffffff000008c020 â†’ stack_test()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#1] 0xffffff000008c070 â†’ stack_test()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#2] 0xffffff000008c070 â†’ stack_test()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">[#3] 0xffffff000008c0d4 â†’ main()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¯ä»¥çœ‹åˆ°æ¯æ¬¡é€’å½’è°ƒç”¨åŽ‹æ ˆ4ä¸ª64ä½å­—ï¼Œåˆ†åˆ«æ˜¯ï¼šä¸Šä¸€å±‚FPï¼ŒLRï¼Œå‚æ•°xå’Œ0x00000000ffffffc0ã€‚æœ€åŽä¸€ä¸ª64ä½å­—ç”¨é€”æœªçŸ¥ã€‚&lt;/p>
&lt;h3 id="ç»ƒä¹ 9-backtrace">ç»ƒä¹ 9-backtrace&lt;/h3>
&lt;p>æä¾›&lt;code>read_fp()&lt;/code>æŽ¥å£ï¼Œæˆ‘ä»¬çŸ¥é“fpæ°¸è¿œæŒ‡å‘çˆ¶å‡½æ•°çš„fpï¼Œæ•…é€’å½’è°ƒç”¨å³å¯ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl"> &lt;span class="n">u64&lt;/span>&lt;span class="o">*&lt;/span> &lt;span class="n">fp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">u64&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">u64&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="nf">read_fp&lt;/span>&lt;span class="p">());&lt;/span> &lt;span class="c1">// åŒå±‚æŒ‡é’ˆï¼Œå› ä¸ºç¬¬ä¸€å±‚æ˜¯æœ¬å‡½æ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">while&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">printk&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;LR %lx FP %lx Args %d %d %d %d %d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">fp&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fp&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">));&lt;/span> &lt;span class="c1">//ä¸ºä»€ä¹ˆ5ä¸ªå‚æ•°æ˜¯fp-2åˆ°fp+2ï¼Ÿæ ·ä¾‹åªåŒ…æ‹¬ä¸€ä¸ªå‚æ•°ï¼Œåªè¦å‡ºçŽ°fp+2å°±èƒ½æµ‹è¯•é€šè¿‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">fp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">u64&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="n">fp&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">//ä¸‹ä¸€å±‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ»¡åˆ†é€šè¿‡ï¼Œæ‡’å¾—è´´å›¾äº†ã€‚&lt;/p>
&lt;hr>
&lt;p>çœ‹åˆ°å¤§ä½¬å†™çš„ï¼Œçž¬é—´ä¸æƒ³å†™äº†ï¼Œå¯„ã€‚
&lt;a class="link" href="https://www.cnblogs.com/kangyupl/p/chcore_lab1.html" target="_blank" rel="noopener"
>https://www.cnblogs.com/kangyupl/p/chcore_lab1.html&lt;/a>&lt;/p></description></item><item><title>ä»Žscapyå’Œwiresharkå­¦è®¡ç®—æœºç½‘ç»œ</title><link>https://lonelyuan.github.io/HugoBlog/p/%E4%BB%8Escapy%E5%92%8Cwireshark%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</link><pubDate>Fri, 22 Oct 2021 23:55:54 +0000</pubDate><guid>https://lonelyuan.github.io/HugoBlog/p/%E4%BB%8Escapy%E5%92%8Cwireshark%E5%AD%A6%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</guid><description>&lt;p>ä¼—æ‰€å‘¨çŸ¥ï¼Œè®¡ç½‘è¢«è¯„ä¸ºæœ€å›°çš„è®¡ç®—æœºä¸“ä¸šè¯¾ï¼Œä¿—ç§°è®¡ç®—æœºä¸­çš„è¯­æ–‡ã€‚ðŸ‘´çœ‹äº†ã€Šè®¡ç®—æœºç½‘ç»œï¼è‡ªé¡¶å‘ä¸‹æ–¹æ³•ã€‹ï¼ˆåŽæ–‡ç®€ç§°CNTDAï¼‰ä¹‹åŽï¼Œè§‰å¾—ç¿»è¯‘å°±åƒæ±¤å§†å”å”çš„çƒ‚è‹¹æžœæ´¾ä¸€æ ·ç³Ÿç³•ï¼Œä¸Šå¸å•Šï¼Œæˆ‘å‘èª“ä¼šç‹ ç‹ è¸¢ä»–çš„å±è‚¡ã€‚å»ºè®®å¸¦ðŸ”¥åŽ»çœ‹è‹±æ–‡åŽŸç‰ˆã€‚&lt;/p>
&lt;p>ä½†æ˜¯ðŸ‘´æœ€è¿‘æŽ¥è§¦çš„è®¸å¤šå®žéªŒè¿˜æ˜¯å¾ˆå¥½çŽ©çš„ï¼ŒäºŽæ˜¯æœ¬æ–‡è¯•å›¾é€šè¿‡å…¨ç¨‹åŠ¨æ‰‹å®žæ“å­¦ä¹ è®¡ç½‘ã€‚&lt;/p>
&lt;hr>
&lt;p>ä¸»è¦å·¥å…·ï¼š&lt;/p>
&lt;ul>
&lt;li>wiresharkæ˜¯å nbçš„ç½‘ç»œå°åŒ…åˆ†æžè½¯ä»¶ã€‚å°±æ˜¯ç”¨æ¥æŠ“åŒ…çš„ã€‚&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>ä¸‹è½½ï¼š&lt;a class="link" href="https://www.wireshark.org/download.html" target="_blank" rel="noopener"
>https://www.wireshark.org/download.html&lt;/a>
æ•™ç¨‹ï¼š&lt;a class="link" href="https://www.javatpoint.com/wireshark" target="_blank" rel="noopener"
>https://www.javatpoint.com/wireshark&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>scapyåº“æ˜¯pythonçš„ç½‘ç»œç¼–ç¨‹åº“ï¼Œå¯ä»¥è®©ä½ ç»†è‡´å…¥å¾®çš„æ“çºµç½‘ç»œæµé‡ã€‚å°±æ˜¯ç”¨æ¥å‘åŒ…çš„ã€‚
&lt;ul>
&lt;li>//ä¸è¦å’Œçˆ¬è™«åº“scrapyæ··æ·†&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>scapyæ–‡æ¡£ï¼š&lt;a class="link" href="https://scapy.readthedocs.io/en/latest/" target="_blank" rel="noopener"
>https://scapy.readthedocs.io/en/latest/&lt;/a>
ä¸­æ–‡ç‰ˆï¼š&lt;a class="link" href="https://www.osgeo.cn/scapy/introduction.html" target="_blank" rel="noopener"
>https://www.osgeo.cn/scapy/introduction.html&lt;/a> //æœ‰äº›ç¿»è¯‘é”™è¯¯&lt;/p>
&lt;/blockquote>
&lt;hr>
&lt;h2 id="è®¡ç½‘åŸºæœ¬æ¦‚å¿µ">è®¡ç½‘åŸºæœ¬æ¦‚å¿µ&lt;/h2>
&lt;h3 id="åŒ…package">ðŸ’£åŒ…(package)&lt;/h3>
&lt;p>ç­‰ç­‰ï¼Œå•¥æ˜¯â€œæŠ“åŒ…â€ï¼Ÿå•¥æ˜¯â€œå‘åŒ…â€ï¼Ÿå•¥æ˜¯â€œåŒ…â€ï¼Ÿ&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/post-images/1635925682452.png"
loading="lazy"
alt="åŽŸæ¥è¿™å°±æ˜¯â€œåŒ…â€"
>&lt;/p>
&lt;p>å½“ç„¶ï¼ŒåŒ…ä¸ä»…ä»…æ˜¯ä¸€ä¸ª CSGO æœ¯è¯­ï¼Œåœ¨è®¡ç®—æœºç½‘ç»œä¸­ï¼ŒåŒ…(package)æœ‰å¤šä¸ªè¿‘ä¹‰è¯ï¼ŒåŒ…æ‹¬ï¼šæŠ¥æ–‡/æ•°æ®æŠ¥(Datagram)ï¼Œåˆ†ç»„/å°åŒ…(Packet)â€¦â€¦æ ¹æ®è¯­å¢ƒä¸åŒè€ŒåŒºåˆ†ï¼Œä½†å¤§è‡´æŒ‡çš„æ˜¯åŒä¸€ä»¶äº‹æƒ…ï¼šå³ç½‘ç»œä¸­çœŸæ­£æµåŠ¨ç€çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬å¸Œæœ›ç½‘ç»œæ¥ä¼ é€’çš„ä¸œè¥¿ã€‚åªä¸è¿‡â€œåŒ…â€æ˜¯æœ€é€šä¿—çš„å«æ³•ï¼Œé‚£ä¹ˆæŠ“åŒ…å’Œå‘åŒ…å°±ä¸éš¾ç†è§£äº†ã€‚&lt;/p>
&lt;p>ä½ è¿˜æƒ³é—®ï¼ŒåŒ…åˆ°åº•é•¿ä»€ä¹ˆæ ·ï¼Ÿä¼—æ‰€å‘¨çŸ¥ï¼Œå¿«é€’ç”±åŒ…è£…å’Œé‡Œé¢çš„ä¸œè¥¿ç»„æˆï¼Œå…¶å®žç½‘ç»œä¸Šçš„å°åŒ…ä¹Ÿå·®ä¸å¤šï¼Œä¹Ÿå¤§è‡´éƒ½æœ‰ä¸¤éƒ¨åˆ†ï¼š&lt;/p>
&lt;ul>
&lt;li>åŒ…å¤´ï¼Œå­¦åé¦–éƒ¨(Header)â€”â€”å¿«é€’åŒ…è£…ä¸Šçš„æ ‡ç­¾ï¼Œå†™ç€ç›®çš„åœ°å€ï¼Œè”ç³»ç”µè¯ï¼Œå¿«é€’å·ç­‰ä¿¡æ¯&lt;/li>
&lt;li>åŒ…ä½“ï¼Œå­¦åè½½è·(Payload)â€”â€”å¿«é€’è¦è¿è¾“çš„è´§ç‰©æœ¬èº«ã€‚æŸäº›è¯­å¢ƒä¸‹ä¹Ÿå–œæ¬¢ç§°ä¸ºæŠ¥æ–‡ã€‚&lt;/li>
&lt;/ul>
&lt;p>å½“ç„¶ï¼Œç½‘ç»œå°åŒ…å½’æ ¹ç»“åº•è¿˜æ˜¯çº¿æ€§çš„æ¯”ç‰¹åºåˆ—ï¼ŒäºŽæ˜¯æˆ‘ä»¬éœ€è¦åŒ…å¤´æ¥è¯†åˆ«è¿™ä¸ªå°åŒ…çš„ç›¸å…³ä¿¡æ¯ï¼Œå°±åƒçœ‹å¿«é€’å…ˆçœ‹æ ‡ç­¾ä¸€æ ·ã€‚&lt;/p>
&lt;p>å¦å¤–ï¼Œä¸€ä¸ªåè®®çš„å°åŒ…ä¹Ÿå¯ä»¥æˆä¸ºå¦ä¸€ä¸ªåè®®çš„è½½è·ï¼ŒåŽé¢ä½ ä¼šçœ‹åˆ°è¯¸å¦‚&lt;code>pkt.payload.payload.payload.payload&lt;/code>çš„å¥—å¨ƒç”¨æ³•ï¼Œè¦ç†è§£è¿™ç§å¥—å¨ƒï¼Œè¿˜éœ€è¦çŸ¥é“åˆ†å±‚æ€æƒ³ã€‚&lt;/p>
&lt;h3 id="åˆ†å±‚layering">ðŸ°åˆ†å±‚(layering)&lt;/h3>
&lt;p>CNTDA ä¸­ç”¨é‚®æ”¿ç³»ç»Ÿç±»æ¯”è®¡ç®—æœºç½‘ç»œï¼Œè¿™æ˜¯æœ€å¸¸ç”¨çš„ä¾‹å­ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨å¿«é€’ç‰©æµç½‘æ¥ä¸¾ä¾‹ã€‚éšä¾¿æ‰“å¼€ä½ çš„ç½‘è´­è®°å½•ï¼Œä½ ä¼šå‘çŽ°å¿«é€’ç‰©æµå¤§æ¦‚ç»è¿‡ä»¥ä¸‹è¿‡ç¨‹ï¼š&lt;/p>
&lt;blockquote>
&lt;ul>
&lt;li>&lt;strong>å®¢æˆ·&lt;/strong>å‘è´§ï¼šæŠŠ&lt;em>è´§ç‰©&lt;/em>å’Œ&lt;em>åœ°å€&lt;/em>äº¤ç»™å¿«é€’ç‚¹
&lt;ul>
&lt;li>&lt;strong>å¿«é€’ç½‘ç‚¹&lt;/strong>æ½ä»¶ï¼š&lt;em>åŒ…è£…&lt;/em>è´§ç‰©è€Œå˜æˆåŒ…è£¹ï¼›åŒ…è£¹è¢«é€å¾€æœ€è¿‘çš„ä¸­è½¬ä¸­å¿ƒ
&lt;ul>
&lt;li>&lt;strong>ä¸­è½¬ä¸­å¿ƒ&lt;/strong>è¿è¾“ï¼šæ ¹æ®åŒ…è£¹ç›®çš„åœ°ä¸åŒï¼Œ&lt;em>åˆ†æ‹£&lt;/em>å¹¶&lt;em>è£…è½¦&lt;/em>è¿è¾“ç»™ä¸åŒçš„ä¸­è½¬ä¸­å¿ƒï¼›è‹¥æ”¶åˆ°æœ¬ç‰‡åŒºçš„åŒ…è£¹ï¼Œ&lt;em>å¸è½¦&lt;/em>å¹¶&lt;em>åˆ†æ‹£&lt;/em>ç»™ä¸åŒçš„ç½‘ç‚¹&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>å¿«é€’ç½‘ç‚¹&lt;/strong>æ´¾é€ï¼šæŒ‰åŒ…è£¹çš„&lt;em>åœ°å€&lt;/em>ï¼Œå¿«é€’å‘˜é€è´§ä¸Šé—¨&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>å®¢æˆ·&lt;/strong>å–ä»¶ï¼š&lt;em>æ‹†ç®±&lt;/em>ï¼Œæ‹¿åˆ°è´§ç‰©ï¼Œç¡®è®¤æ— è¯¯ç­¾æ”¶&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>ä½ çŸ¥é“å‘ä¸€ä¸ªå¿«é€’è¦ç»åŽ†æ€Žæ ·çš„å›°éš¾å—ï¼Ÿä½ ä¸çŸ¥é“ï¼Œä½ åªå…³å¿ƒä½ è‡ªå·±ã€‚è¿™é‡Œçš„é‡ç‚¹æ˜¯ï¼Œå®¢æˆ·ä¸éœ€è¦å…³å¿ƒä¸­è½¬ä¸­å¿ƒå¦‚ä½•æŒ‡æŒ¥é‡åž‹è´§è½¦æˆ–é£žæœºï¼Œç½‘ç‚¹ä¹Ÿåªéœ€è¦å…³å¿ƒå¦‚ä½•åŒ…è£…å¥½å®¢æˆ·çš„è´§ç‰©ã€‚å¿«é€’ç½‘ç»œæ˜Žæ˜¾çš„å‘ˆçŽ°å‡ºä¸‰å±‚çš„åˆ†å±‚æž¶æž„ï¼Œ&lt;strong>æ¯ä¸€å±‚ä¹‹é—´åªéœ€è¦å…³å¿ƒè‡ªå·±çš„å·¥ä½œï¼Œå¹¶å’Œç›¸é‚»çš„å±‚äº¤äº’&lt;/strong>ã€‚è¿™å°±æ˜¯åº”å¯¹å¤æ‚ç³»ç»Ÿçš„ç»„ç»‡æ–¹æ³•â€”â€”åˆ†å±‚ã€‚&lt;/p>
&lt;p>è¯¾æœ¬ä¸Šä¼šæåˆ°OSIä¸ƒå±‚æ¨¡åž‹æˆ–è€…TCP/IPäº”å±‚æ¨¡åž‹ï¼Œè¿™é‡Œçš„æ¨¡åž‹å…¨ç§°æ˜¯&lt;strong>åè®®åˆ†å±‚æ¨¡åž‹&lt;/strong>ï¼Œåˆæ¥æ–°è¯äº†ï¼Œåˆ«æ€¥ï¼ŒåŽé¢è¿˜æœ‰ï¼š&lt;/p>
&lt;ul>
&lt;li>åè®®(Protocol)ï¼šåŒä¸€å±‚çº§å†…çš„äº¤äº’è§„åˆ™ã€‚//æ¨ªå‘&lt;/li>
&lt;li>æœåŠ¡(Service)ï¼šä¸åŒå±‚çº§é—´çš„äº¤äº’è§„åˆ™ã€‚//çºµå‘&lt;/li>
&lt;/ul>
&lt;p>æ¯ä¸€å±‚çš„å·¥ä½œï¼Œå°±æ˜¯è°ƒç”¨ä¸‹å±‚çš„æŽ¥å£ï¼Œå¹¶ä¸ºä¸Šå±‚æä¾›æœåŠ¡ã€‚æŽ¥å£(Interface)å’ŒæœåŠ¡çš„åŒºåˆ«æ˜¯ï¼ŒæœåŠ¡ä½œä¸ºå®žä½“ï¼Œç”±æœ¬å±‚è´Ÿè´£å®žçŽ°ï¼Œæš´éœ²å‡ºæŽ¥å£ä¾›ä¸Šå±‚è°ƒç”¨ï¼›è€ŒæŽ¥å£åˆ™æ˜¯æŠ½è±¡çš„ï¼Œæœ¬å±‚å¹¶ä¸çŸ¥é“ä¸‹ä¸€å±‚çš„å¯é æ€§ã€‚&lt;/p>
&lt;p>ç”±æ­¤ä½ èƒ½å¦çœ‹å‡ºåˆ†å±‚æ€æƒ³çš„ä¼˜è¶Šæ€§ï¼Ÿæ¯ä¸€å±‚åªå…³æ³¨è‡ªå·±çš„å®žçŽ°ï¼ŒäºŽæ˜¯å¤§é—®é¢˜è¢«åˆ†è§£æˆäº†å°é—®é¢˜ã€‚å¥½æ¯”ä¸€ä¸ªæ€»å·¥ä½œé‡100çš„é—®é¢˜ï¼Œä¸äº†è§£åˆ†å±‚æ€æƒ³çš„ä½ åªèƒ½10+10+10+â€¦â€¦=100ï¼›è€Œåˆ†å±‚æ€æƒ³æä¾›äº†ä¹˜æ³•æ³•åˆ™ï¼ŒäºŽæ˜¯ä½ å¯ä»¥é€šè¿‡10*10=100ï¼Œåªéœ€è¦å®Œæˆ20å·¥ä½œé‡ã€‚//ä¸ªä¸­æ€æƒ³ä¹Ÿä½“çŽ°äº†OOPä¸­çš„è§£è€¦ã€‚&lt;/p>
&lt;p>ä¸Šè¿°ç±»æ¯”ä¸­æ ‡æ³¨äº†ä¸€äº›å¯¹åº”å…³ç³»ï¼š&lt;/p>
&lt;ul>
&lt;li>å°åŒ…(Packaging)ï¼šåŒ…è£…ï¼Œè´§ç‰©â†’åŒ…è£¹ã€‚ä¿¡æ¯åœ¨å±‚æ¬¡é—´ä¼ é€’çš„è¿‡ç¨‹å°±æ˜¯å°åŒ…/è§£å°çš„è¿‡ç¨‹ã€‚&lt;/li>
&lt;li>è·¯ç”±(Routing)ï¼šåˆ†æ‹£ã€‚æ ¹æ®åŒ…è£¹ä¸Šçš„æ ‡ç­¾ï¼Œå†³å®šåŒ…è£…çš„åŽ»å‘ã€‚&lt;/li>
&lt;/ul>
&lt;p>å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸€å±‚éƒ½æœ‰è‡ªå·±çš„â€œè´§ç‰©â€ï¼Œæ¯”å¦‚ä¸­è½¬ä¸­å¿ƒçš„è½½è·æ˜¯æ»¡è½½åŒ…è£¹çš„é•¿é€”è´§è½¦è€Œä¸æ˜¯å•ä¸ªåŒ…è£¹ã€‚æŠ¥æ–‡åœ¨æ¯ä¸€å±‚éƒ½è¢«å°è£…å¹¶äº¤ç»™ä¸‹ä¸€å±‚ï¼Œè¦æƒ³å¾—åˆ°åŽŸå§‹æŠ¥æ–‡åªèƒ½ä¸€å±‚ä¸€å±‚è§£å¼€ï¼Œæ“ä½œæ¨¡å¼ç±»ä¼¼æ ˆã€‚ç”±æ­¤åè®®åˆ†å±‚æ¨¡åž‹ä¹Ÿè¢«ç®€ç§°ä¸º&lt;strong>åè®®æ ˆ&lt;/strong>(Protocol stack)ã€‚&lt;/p>
&lt;p>æœ€åŽç®€å•è§£é‡Šäº”å±‚æ¨¡åž‹æ¯ä¸€å±‚çš„åˆ†å·¥ï¼Œè‡ªåº•å‘ä¸Šé¡ºåºï¼š&lt;/p>
&lt;ul>
&lt;li>ç‰©ç†å±‚ï¼šå¯¹æŽ¥ç‰©ç†ä»‹è´¨ï¼Œè¿è¾“æ¯”ç‰¹
&lt;ul>
&lt;li>æä¾›åŸºäºŽæ¯”ç‰¹çš„é€šä¿¡è·¯å¾„&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>é“¾è·¯å±‚ï¼šå°†è·¯å¾„ä¸²è”æˆé“¾
&lt;ul>
&lt;li>æä¾›åŸºäºŽé“¾è·¯çš„æŽ¥å…¥ã€äº¤ä»˜ã€å’Œä¼ è¾“æœåŠ¡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ç½‘ç»œå±‚ï¼šå°†é“¾è·¯ç¼–ç»‡æˆç½‘
&lt;ul>
&lt;li>æä¾›ä»»æ„ä¸¤ä¸»æœºä¹‹é—´çš„é€šä¿¡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>è¿è¾“å±‚ï¼šå°†ä¸»æœºçš„é€šä¿¡åˆ†è§£ä¸ºè¿›ç¨‹çš„é€šä¿¡
&lt;ul>
&lt;li>æä¾›è¿›ç¨‹é—´çš„é€»è¾‘é€šä¿¡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åº”ç”¨å±‚ï¼šå®žçŽ°ç”¨æˆ·éœ€æ±‚
&lt;ul>
&lt;li>å‘ç”¨æˆ·æä¾›é€æ˜Žå¯é çš„ç½‘ç»œæœåŠ¡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>å¶å‰‹ï¼ä½ å·²ç»äº†è§£äº†åˆ†å±‚æ€æƒ³ï¼Œä¸‹é¢æ¥è®¾è®¡äº’è”ç½‘å§ï¼ï¼ˆè¿«çœŸï¼‰&lt;/p>
&lt;h2 id="å¼€å§‹å®žéªŒ">âŒšï¸å¼€å§‹å®žéªŒ&lt;/h2>
&lt;p>æœ‰å…³è®¡ç½‘çš„å­¦ä¹ é¡ºåºè‡ªå¤å°±æœ‰è‡ªé¡¶å‘ä¸‹è¿˜æ˜¯è‡ªåº•å‘ä¸Šçš„åˆ†æ­§ï¼Œä½™ä»¥ä¸ºåªè¦ç†è§£äº†åˆ†å±‚æ€æƒ³ï¼Œé¡ºåºä¾¿ä¸ç®—å¾ˆé‡è¦ã€‚æœ¬ç³»åˆ—å®žéªŒå°†éµä»Žæµ…å…¥æ·±å‡ºçš„åŽŸåˆ™ï¼Œä»Žåº”ç”¨å±‚é€æ­¥æ·±å…¥åˆ°é“¾è·¯å±‚å†è¿”å›žåº”ç”¨å±‚ï¼ŒåŒæ—¶éš¾åº¦ä¸æ–­åŠ å¤§ã€‚&lt;/p>
&lt;p>å®žéªŒæ¥æºï¼š&lt;/p>
&lt;ul>
&lt;li>ðŸ‘´è‡ªå·±ï¼š0x10, 0x20&lt;/li>
&lt;li>SEEDLabï¼Œé›ªåŸŽå¤§å­¦çš„ä¿¡æ¯å®‰å…¨è¯¾é…å¥—å®žéªŒï¼Œç½‘ç»œå®‰å…¨éƒ¨åˆ†ã€‚å›½å†…çŸ¥ååº¦ä¸é«˜æ‰€ä»¥å€¼å¾—ä¸€åšã€‚&lt;a class="link" href="https://seedsecuritylabs.org/Labs_20.04" target="_blank" rel="noopener"
>å®˜æ–¹ç½‘ç«™&lt;/a>&lt;/li>
&lt;li>CNTDA å®žéªŒï¼š&lt;a class="link" href="https://github.com/moranzcw/Computer-Networking-A-Top-Down-Approach-NOTES" target="_blank" rel="noopener"
>GIthubä¸ŠæŠ„çš„ä½œä¸š&lt;/a>&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>å®žéªŒä»£ç ä»“åº“ï¼š&lt;a class="link" href="https://github.com/lonelyuan/ComputerNetwork-exp" target="_blank" rel="noopener"
>lonelyuan/ComputerNetwork-exp (github.com)&lt;/a>&lt;/p>
&lt;p>å®žéªŒç¼–å·è§„åˆ™ï¼š0xabn&lt;/p>
&lt;ul>
&lt;li>aï¼šå±‚çº§ï¼š1 - åº”ç”¨å±‚ï¼›2 - ä¼ è¾“å±‚ï¼›3 - ç½‘ç»œå±‚ï¼›4 - é“¾è·¯å±‚ï¼›5 - ç‰©ç†å±‚&lt;/li>
&lt;li>bï¼šéš¾åº¦ï¼š0 - â­ï¼›1 - â­â­ï¼›2 - â­â­â­ï¼›3 - â­â­â­â­ï¼›4 - â­â­â­â­â­ï¼›&lt;/li>
&lt;li>nï¼šé‡å¤éš¾åº¦åˆ™å†åŠ ä¸€ä½ç¼–å·&lt;/li>
&lt;/ul>
&lt;p>//ã€æƒ³çœ‹å“ªä¸ªæ²¡æ›´æ–°çš„å¯ä»¥å‚¬ðŸ‘´ã€‘&lt;/p>
&lt;/blockquote>
&lt;h3 id="0x10-åº”ç”¨å±‚-server--">0x10 åº”ç”¨å±‚: Server | â­&lt;/h3>
&lt;h4 id="intro">Intro&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>ç›®æ ‡ï¼šç”¨scapy/socketåšä¸€ä¸ªé™æ€æœåŠ¡å™¨ã€‚&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å®žé™…ä¸Šï¼Œpython3å·²ç»è‡ªå¸¦äº†ä¸€ä¸ªç®€æ˜“httpæœåŠ¡å™¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">$ python3 -m http.server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Serving HTTP on 0.0.0.0 port &lt;span class="m">8000&lt;/span> &lt;span class="o">(&lt;/span>http://0.0.0.0:8000/&lt;span class="o">)&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">127.0.0.1 - - &lt;span class="o">[&lt;/span>10/Nov/2021 14:51:57&lt;span class="o">]&lt;/span> &lt;span class="s2">&amp;#34;GET / HTTP/1.1&amp;#34;&lt;/span> &lt;span class="m">200&lt;/span> -
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æµè§ˆå™¨è®¿é—®ï¼š&lt;code>localhost:8000&lt;/code>ï¼Œå¦‚æžœå½“å‰ç›®å½•ä¸‹æœ‰&lt;code>index.html&lt;/code>æ–‡ä»¶ï¼Œæµè§ˆå™¨å³å¯æ˜¾ç¤ºè¯¥htmlæ–‡æ¡£ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¯¥httpæœåŠ¡å™¨ä¹Ÿæ˜¯åŸºäºŽå¦ä¸€ä¸ªpythonæ ‡å‡†åº“socketç¼–å†™çš„ï¼Œæœ¬å®žéªŒæˆ‘ä»¬ç›´æŽ¥ç”¨socketå®žçŽ°ä¸€ä¸ªæ›´ç®€å•çš„httpæœåŠ¡å™¨ã€‚&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>å‰ç½®ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>æœ¯è¯­ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;p>C/Sæž¶æž„(client-server)ï¼šäº’è”ç½‘çš„åŸºæœ¬æ¨¡åž‹ã€‚é€šä¿¡çš„åŒæ–¹é€šå¸¸åˆ†æˆä¸¤ä¸ªè§’è‰²ï¼š&lt;/p>
&lt;ul>
&lt;li>å‘èµ·çš„ä¸€æ–¹ç§°ä¸ºå®¢æˆ·ç«¯(C)ï¼Œå³å‰ç«¯ã€‚&lt;/li>
&lt;li>æŽ¥æ”¶çš„ä¸€æ–¹ç§°ä¸ºæœåŠ¡ç«¯(C)ï¼Œå³åŽç«¯ã€‚ä¸ºäº†ä¿è¯éšæ—¶æŽ¥æ”¶è¯·æ±‚ï¼ŒæœåŠ¡ç«¯éœ€è¦æŒä¹…ç›‘å¬æŸé€šä¿¡ç«¯å£&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>URLï¼šç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ã€‚ä¹Ÿå°±æ˜¯äº’è”ç½‘ä¸Šçš„åœ°å€ï¼Œç½‘å€ã€‚&lt;/p>
&lt;ul>
&lt;li>å®Œæ•´è¯­æ³•ï¼š&lt;code>[åè®®å]://[ç”¨æˆ·å]:[å¯†ç ]@[æœåŠ¡å™¨åœ°å€]:[æœåŠ¡å™¨ç«¯å£å·]/[è·¯å¾„]?[æŸ¥è¯¢å­—ç¬¦ä¸²]#[ç‰‡æ®µ]&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>HTTPåè®®ï¼šåº”ç”¨å±‚æœ€æ™®éçš„æ–‡æœ¬åè®®ä¹‹ä¸€ã€‚æ–‡æœ¬åè®®è¡¨ç¤ºå…¶æ‰€æœ‰å†…å®¹éƒ½æ˜¯å¯è¯»çš„ï¼Œå…¶ä¸»è¦æ ¼å¼å¦‚ä¸‹ï¼š&lt;/p>
&lt;ul>
&lt;li>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">GET / HTTP/1.1\r\n /* ä¸€ä¸ªçŠ¶æ€è¡Œ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Host: localhost\r\n /* å¤šä¸ªé¦–éƒ¨è¡Œ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Connection: close\r\n\r\n /* ä»¥ä¸¤ä¸ªCRLF(å›žè½¦æ¢è¡Œï¼Œç¼–ç¨‹æ—¶ç”¨\r\nè¡¨ç¤º)éš”æ–­ */
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&amp;lt;html&amp;gt;... &amp;lt;/html&amp;gt; /* payload */
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>HTMLï¼šæ ‡è®°è¯­è¨€ï¼Œç”¨&amp;lt;&amp;gt;ç»„ç»‡èµ·ç½‘é¡µçš„éª¨æž¶ã€‚æµè§ˆå™¨ä¼šæŠŠHTMLæºç æ¸²æŸ“æˆå¥½çœ‹çš„ç½‘é¡µã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>socketï¼šé€»è¾‘é€šä¿¡çš„ç«¯ç‚¹ã€‚&lt;/p>
&lt;ul>
&lt;li>socketæ˜¯é€»è¾‘é€šä¿¡çš„æŽ¥å£ã€‚ä¸Šæ–‡æåˆ°ç½‘ç»œå±‚ä¸ºè¿è¾“å±‚å’Œåº”ç”¨å±‚æä¾›äº†ç‚¹åˆ°ç‚¹çš„é€»è¾‘é€šä¿¡æœåŠ¡ï¼Œè¯¥æœåŠ¡çš„åŸºæœ¬æŽ¥å£å°±æ˜¯socketã€‚&lt;/li>
&lt;li>socketæ˜¯é€šä¿¡ç«¯ç‚¹çš„æŠ½è±¡ã€‚å®ƒå°†è¿›ç¨‹/åº”ç”¨å’Œ&lt;code>(ä¸»æœºhost,ç«¯å£port)&lt;/code> äºŒå…ƒç»„ç»‘å®šï¼ŒäºŽæ˜¯é€šè¿‡ &lt;code>(host,port)&lt;/code> å³å¯æ ‡è®°ç½‘ç»œä¸Šçš„è¿›ç¨‹ã€‚
&lt;ul>
&lt;li>ä¸€ä¸ªä¸»æœºæœ‰ä¸€ä¸ªåœ°å€å’Œå¤šä¸ªç«¯å£ã€‚åœ°å€å’Œç«¯å£çš„å…³ç³»ï¼Œå°±åƒæˆ¿å­å’Œçª—æˆ·çš„å…³ç³»ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>socketç”±æ“ä½œç³»ç»Ÿæä¾›ã€‚æœ¬å®žéªŒç”¨åˆ°çš„æ˜¯pythonå¯¹socketçš„å°è£…ï¼Œä½†ä¸ç®¡æ¢ä»€ä¹ˆè¯­è¨€æœ¬è´¨ä¸Šéƒ½æ˜¯ç³»ç»Ÿè°ƒç”¨ã€‚&lt;/li>
&lt;li>//å…¶ç¿»è¯‘â€œå¥—æŽ¥å­—â€éžå¸¸å…·æœ‰è¯¯å¯¼æ€§ï¼Œå»ºè®®ç›´æŽ¥ç”¨è‹±æ–‡å•è¯ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>å»ºè®®èŠ±5åˆ†é’Ÿé€šè¯»ã€Šå›¾è§£HTTPã€‹å‰6ç« ï¼ˆæˆ–è€…ã€ŠCNTDAã€‹2.1-2.2èŠ‚ï¼‰ï¼Œä»¥ç†è§£ä¸Šè¿°æœ¯è¯­&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h4 id="guidelines">Guidelines&lt;/h4>
&lt;ol>
&lt;li>
&lt;h5 id="socketé€šä¿¡">Socketé€šä¿¡&lt;/h5>
&lt;/li>
&lt;/ol>
&lt;p>è¦ä½¿ç”¨socketé€šä¿¡ï¼Œé€šä¿¡åŒæ–¹éƒ½éœ€è¦æŒæœ‰ä¸€ä¸ªsocketå¯¹è±¡ï¼Œå…¶ä¸»è¦æ–¹æ³•å’Œç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> SERVER CLIENT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> socket() socket()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â–¼ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bind((host,port)) â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â–¼ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listen(num) â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â–¼ â–¼
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> accept() connect((host,port))
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€â–ºsend()â”€â”€â–ºrecv()â—„â”€â”€â”¤
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€â–ºrecv()â—„â”€â”€send()â—„â”€â”€â”¤
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â–¼ â–¼
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> close() close()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>äºŽæ˜¯æˆ‘ä»¬å¯ä»¥å»ºç«‹èµ·æœåŠ¡å™¨ä»£ç çš„æ¡†æž¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">socket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">socket&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">socket&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">bind&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="s1">&amp;#39;0.0.0.0&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">8000&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1"># ç»‘å®šåœ°å€å’Œç«¯å£&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># å¼€å§‹ç›‘å¬ï¼Œnumè¡¨ç¤ºæœ€å¤§è¿žæŽ¥æ•°é‡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="kc">True&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">c&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">accept&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="c1"># cæ˜¯å®¢æˆ·ç«¯socket&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;[+] accepted:&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">addr&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">req&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">recv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1024&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;[+] recieved:&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">req&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">decode&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;utf-8&amp;#39;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="c1"># æŽ¥æ”¶ç±»åž‹ä¸ºå­—èŠ‚å¯¹è±¡bytesï¼Œè¦æ‰“å°åˆ™åº”å½“ç¼–ç ä¸ºå­—ç¬¦ä¸²&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">http_handler&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">req&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># è§£æžè¯·æ±‚ï¼Œè¿”å›žå“åº”&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">c&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">c&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>It&amp;rsquo;s worth noting thatï¼ŒæœåŠ¡ç«¯socketå¹¶æ²¡æœ‰å‘é€ä»»ä½•æ•°æ®ï¼&lt;code>accept()&lt;/code>æ–¹æ³•å°†è¿”å›žä¸€ä¸ªå®¢æˆ·ç«¯socketå¯¹è±¡ï¼Œç”±è¿™ä¸ªsocketæ‰§è¡Œæ•°æ®çš„æ”¶å‘ã€‚è¿™æ ·åšçš„åŽŸå› æ˜¯ä¸ºäº†å®žçŽ°å¤šè·¯å¤ç”¨ï¼Œå³è®©æœåŠ¡å™¨æ”¯æŒå¤šä¸ªè¿žæŽ¥åŒæ—¶é€šä¿¡ã€‚&lt;/li>
&lt;li>äºŽæ˜¯æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¯¹æ¯ä¸ªTCPè¿žæŽ¥ï¼Œéƒ½æœ‰ä¸€å¯¹socketå­˜åœ¨äºŽé€šä¿¡çš„ä¸¤ç«¯ã€‚è€ŒæœåŠ¡ç«¯socketä»…ä»…åšäº†ç®¡ç†è¿žæŽ¥çš„å·¥ä½œï¼Œä»–ä»¬æ”¾åœ¨ä¸€ä¸ªç±»é‡Œï¼Œæ˜¯å‡ºäºŽç®€åŒ–ä»£ç çš„è€ƒè™‘ã€‚ï¼ˆå½“ç„¶å®žçŽ°å¤šè·¯å¤ç”¨çš„æ–¹å¼ä¸åªæœ‰ä¸€ç§ã€‚&lt;/li>
&lt;/ul>
&lt;p>çŽ°åœ¨ï¼Œä½ å¯ä»¥è‡ªå·±å°è¯•ç¼–å†™socketå®¢æˆ·ç«¯è·Ÿè¯¥æœåŠ¡å™¨è¿›è¡Œæ˜Žæ–‡çš„é€šä¿¡ã€‚ä¸è¿‡æˆ‘ä»¬çš„ç›®æ ‡æ˜¯HTTPæœåŠ¡å™¨ï¼Œå…ˆå¤ä¹ ä¸€ä¸‹HTTPåè®®æ ¼å¼ï¼ŒçŠ¶æ€ç ï¼Œé¦–éƒ¨ç­‰çŸ¥è¯†å§ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>
&lt;h5 id="httpè§£æž">HTTPè§£æž&lt;/h5>
&lt;/li>
&lt;/ol>
&lt;p>å¦‚æžœç¼–ç¨‹èƒ½åŠ›å°šå¯ï¼Œä½ å¯ä»¥è‡ªå·±å†™HTTPç±»æ¥æŠŠæŠ¥æ–‡è§£æžæˆå¯¹è±¡ã€‚è¿™é‡Œè¿˜æ˜¯ç”¨çŽ°æˆçš„ï¼Œscapyåº“æä¾›çš„&lt;code>HTTPRequest&lt;/code>å’Œ&lt;code>HTTPResponse&lt;/code>ç±»ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">scapy.layers.http&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="o">*&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">scapy.all&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="o">*&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">http_handler&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">req_str&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">req&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">HTTPRequest&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">req&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">do_dissect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">req_str&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># è§£æžè¯·æ±‚&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;[+] req: &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">req&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">summary&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># body = route(req.Path.decode()) # è·¯ç”±å‡½æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">body&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;h1&amp;gt;Hello~~~&amp;lt;/h1&amp;gt;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">HTTPResponse&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">HTTP&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">res&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">body&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;[+] res: &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">res&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">summary&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">raw&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>
&lt;p>&lt;code>do_dissect()&lt;/code>æ–¹æ³•å°†å­—ç¬¦ä¸²è§£æžä¸ºå¯¹è±¡&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>HTTP()/res/body&lt;/code>ï¼šscapyæ ¸å¿ƒè¯­æ³•&lt;code>/&lt;/code>ï¼Œè¡¨ç¤ºåè®®æ ˆçš„å †å ï¼Œå¯ä»¥é“¾å¼è°ƒç”¨ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¿™é‡Œçš„ç±»åž‹ä¸ºï¼š&lt;code>HTTP / HTTPResponse / Raw&lt;/code>ï¼Œä¹‹æ‰€ä»¥è¦è¿™æ ·ä¸‰å±‚è¡¨ç¤ºï¼Œæ˜¯å› ä¸ºHTTPResponse/HTTPRequestç±»ä»…ä»…æ˜¯ä¸€ä¸ªä¸­é—´å±‚ï¼Œå¦‚æžœæ²¡æœ‰HTTPå±‚ï¼Œscapyä¼šæŠ¥warningã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>raw()&lt;/code>æ–¹æ³•è¿”å›žå°åŒ…çš„å­—èŠ‚æ•°ç»„ï¼Œå¯ä»¥çœ‹åˆ°åœ¨socketä¹‹ä¸Šï¼Œæˆ‘ä»¬å…ˆæŠŠæŠ¥æ–‡è½¬åŒ–ä¸ºå¯¹è±¡ï¼Œè§£æžä¹‹åŽå†è¿”å›žæŠ¥æ–‡ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è§‚å¯Ÿå°åŒ…çš„å¸¸ç”¨æ–¹æ³•è¿˜æœ‰ï¼š&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">In [2]: a = Ether()/IP(dst=&amp;#34;www.wsnd.com&amp;#34;)/TCP()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In [3]: a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Out[3]: &amp;lt;Ether type=IPv4 |&amp;lt;IP frag=0 proto=tcp dst=Net(&amp;#34;www.wsnd.com/32&amp;#34;) |&amp;lt;TCP |&amp;gt;&amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In [4]: a.summary()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Out[4]: &amp;#39;Ether / IP / TCP 0.0.0.0:ftp_data &amp;gt; Net(&amp;#34;www.wsnd.com/32&amp;#34;):http S&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In [5]: a.show()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">###[ Ethernet ]###
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dst = ff:ff:ff:ff:ff:ff
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> src = 00:00:00:00:00:00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> type = IPv4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">###[ IP ]###
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> version = 4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proto = tcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> chksum = None
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> src = 0.0.0.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dst = Net(&amp;#34;www.wsnd.com/32&amp;#34;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> \options \
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">###[ TCP ]###
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sport = ftp_data
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dport = http
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In [6]: ls(a)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dst : DestMACField = &amp;#39;ff:ff:ff:ff:ff:ff&amp;#39; (&amp;#39;None&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">src : SourceMACField = &amp;#39;00:00:00:00:00:00&amp;#39; (&amp;#39;None&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">type : XShortEnumField = 2048 (&amp;#39;36864&amp;#39;)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In [7]: raw(a)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Out[7]: b&amp;#39;\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x08\x00E\x00\x00(\x00\x01\x00\x00@\x06\xc9\xa8\x00\x00\x00\x00H\ti\x1e\x00\x14\x00P\x00\x00\x00\x00\x00\x00\x00\x00P\x02 \x00\xdeW\x00\x00&amp;#39;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">In [8]: hexdump(a)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0000 FF FF FF FF FF FF 00 00 00 00 00 00 08 00 45 00 ..............E.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0010 00 28 00 01 00 00 40 06 C9 A8 00 00 00 00 48 09 .(....@.......H.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0020 69 1E 00 14 00 50 00 00 00 00 00 00 00 00 50 02 i....P........P.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">0030 20 00 DE 57 00 00 ..W..
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>çŽ°åœ¨è¿è¡ŒæœåŠ¡å™¨ï¼Œç”¨æµè§ˆå™¨è®¿é—®&lt;code>localhost:8000&lt;/code>ï¼Œä½ å¯ä»¥çœ‹åˆ°å¤§å¤§çš„â€œHelloâ€äº†ï¼&lt;/p>
&lt;h4 id="task">Task&lt;/h4>
&lt;p>ä¸‹é¢çš„ä»»åŠ¡äº¤ç»™ä½ ï¼Œç›®æ ‡æ˜¯å°½é‡æŽ¥è¿‘pythonè‡ªå¸¦httpæœåŠ¡å™¨çš„è¡¨çŽ°ã€‚&lt;/p>
&lt;p>ä¸ºäº†å®žçŽ°é™æ€æœåŠ¡å™¨ï¼Œä½ éœ€è¦æ ¹æ®è®¿é—®çš„è·¯å¾„è¿”å›žå¯¹åº”çš„å†…å®¹ã€‚ä¸ºæ­¤ï¼Œè¯·å®Œå–„&lt;code>route()&lt;/code>å‡½æ•°ï¼š&lt;/p>
&lt;ul>
&lt;li>è®¿é—®æ ¹è·¯å¾„&lt;code>/&lt;/code>å°†è¿”å›ž&lt;code>index.html&lt;/code>&lt;/li>
&lt;li>ä½¿ç”¨osæ¨¡å—è¯»å–æ–‡ä»¶ï¼Œæ³¨æ„æ–‡æœ¬æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¦‚å›¾ç‰‡ï¼‰çš„å¤„ç†&lt;/li>
&lt;li>ç”¨HTTPå“åº”ç è¿›è¡Œé”™è¯¯å¤„ç†ï¼Œæ¯”å¦‚&lt;code>404 NOT FOUND&lt;/code>ï¼Œ&lt;code>302 REDIRECT&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>æœ€åŽï¼Œåœ¨æ ¹ç›®å½•(ä½ åœ¨å“ªé‡Œè¿è¡Œä½ çš„æœåŠ¡å™¨è„šæœ¬ï¼Œé‚£é‡Œå°±æ˜¯ä½ çš„æ ¹ç›®å½•)ä¸‹æ”¾å…¥ä»»æ„æ–‡ä»¶ï¼Œæµè§ˆå™¨éƒ½å¯ä»¥è®¿é—®å…¶å†…å®¹ï¼Œå¦‚æžœä¸å­˜åœ¨åˆ™ä¼šè¿”å›ž404ã€‚&lt;/p>
&lt;h4 id="expand">Expand&lt;/h4>
&lt;ul>
&lt;li>æŠ“åŒ…è§‚å¯Ÿè®¿é—®ä½ çš„ç½‘ç«™å’Œè®¿é—®æ­£å¸¸ç½‘ç«™æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ä½ ä¼šå‘çŽ°ï¼Œæœ¬å®žéªŒå‡ ä¹Žæ²¡æœ‰è®²è§£HTTPé¦–éƒ¨çš„ç»†èŠ‚ï¼Œè¯·è‡ªè¡Œäº†è§£è¯¸å¦‚&lt;code>Content-Type:&lt;/code>ï¼Œ&lt;code>Content-Length:&lt;/code>ï¼Œ&lt;code>Transfer-Encoding:&lt;/code>ç­‰é¦–éƒ¨ï¼Œçœ‹çœ‹ä¼ è¾“å›¾ç‰‡/åŽ‹ç¼©æ–‡ä»¶æ—¶çš„æ ‡å‡†åšæ³•ï¼Œä»¥åŠåœ¨é‡åˆ°å¤§æ–‡ä»¶æ—¶å¦‚ä½•å®žçŽ°åˆ†æ®µè¿è¾“ã€‚ï¼ˆå°½ç®¡æˆ‘ä»¬çš„å®žçŽ°å¾ˆç®€é™‹ï¼Œæµè§ˆå™¨è¿˜æ˜¯èƒ½æ­£å¸¸å·¥ä½œï¼Œè¯´æ˜ŽHTTPæ˜¯ç›¸å½“å¥å£®çš„åè®®ï¼‰&lt;/li>
&lt;li>ä½ çš„æœåŠ¡å™¨æ˜¯å¦æœ‰å®‰å…¨é—®é¢˜ï¼Ÿä½ å¯ä»¥è®¿é—®æ ¹ç›®å½•ä¹‹å¤–çš„æ–‡ä»¶å—ï¼Ÿå¦‚ï¼š &lt;code>/../../../../etc/passwd&lt;/code>ï¼ˆlinuxä¸‹ï¼‰&lt;/li>
&lt;li>æœåŠ¡å™¨æ¦‚å¿µè¾¨æžï¼šWebåˆå­¦è€…å®¹æ˜“å¯¹æœåŠ¡å™¨æ¦‚å¿µæ„Ÿåˆ°è¿·æƒ‘ã€‚è½¯ä»¶è¯­å¢ƒä¸‹ï¼ŒæœåŠ¡å™¨æŒ‡å¯¹å¤–æä¾›æœåŠ¡çš„ç¨‹åºï¼Œå¸¸ç”¨æœåŠ¡å™¨å¦‚apacheã€nginxï¼Œtomcatç­‰ï¼›ç¡¬ä»¶è¯­å¢ƒä¸‹åˆ™æŒ‡è¿è¡Œç€æœåŠ¡å™¨è½¯ä»¶çš„æœºå™¨ã€‚&lt;/li>
&lt;li>æˆ‘ä»¬å®žçŽ°çš„æ˜¯é™æ€ç½‘ç«™ï¼Œä½ å¯èƒ½ç–‘æƒ‘æ˜¯ä¸æ˜¯è¿˜æœ‰åŠ¨æ€ç½‘ç«™ã€‚å½“ç„¶æœ‰ï¼ŒåŒºåˆ†åŠ¨æ€å’Œé™æ€å¹¶ä¸æ˜¯ç½‘é¡µä¼šä¸ä¼šè‡ªå·±åŠ¨ï¼Œè€Œæ˜¯æœåŠ¡å™¨ä¸Šçš„æ•°æ®æ˜¯å¦å¯ä»¥åŠ¨æ€çš„æ”¹å˜ï¼Œè€Œæˆ‘ä»¬çš„æœåŠ¡å™¨åªèƒ½è¢«åŠ¨çš„æ˜¾ç¤ºæ–‡ä»¶ï¼Œå®¢æˆ·ç«¯æ— æ³•åšå‡ºä»»ä½•æ›´æ”¹ã€‚çŽ°ä»£webæ¡†æž¶è¯¸å¦‚Springbootï¼ŒDjangoä¹‹ç±»å½“ç„¶æ˜¯åŠ¨æ€ç½‘ç«™æ¡†æž¶ã€‚&lt;/li>
&lt;/ul>
&lt;p>å®žé™…ä¸Šï¼Œè®¡ç½‘å¹¶ä¸å…³å¿ƒåº”ç”¨å±‚ä»¥ä¸Šçš„ä¸œè¥¿ï¼Œè®©æˆ‘ä»¬å‘ä¸‹çœ‹ï¼ŒæŽ¢ç©¶socketèƒŒåŽçš„åŽŸç†å§ã€‚&lt;/p>
&lt;h3 id="0x20-ä¼ è¾“å±‚socket--">0x20 ä¼ è¾“å±‚ï¼šSocket | â­&lt;/h3>
&lt;h4 id="intro-1">Intro&lt;/h4>
&lt;ul>
&lt;li>ç›®æ ‡ï¼šç”¨ scapy å®žçŽ°TCPåè®®ï¼Œä»¥å°½å¯èƒ½æ›¿æ¢ä¸Šä¸€ä¸ªå®žéªŒä½¿ç”¨çš„socketæ¨¡å—
&lt;ul>
&lt;li>// ä½ å¯èƒ½çŒœåˆ°äº†ï¼Œä¸‹ä¸€ä¸ªå®žéªŒæ˜¯ä¸æ˜¯è¦è‡ªå·±å®žçŽ°IPåè®®å‘€ï¼Ÿæ­å–œä½ çŒœé”™äº†ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å‰ç½®ï¼š
&lt;ul>
&lt;li>æœ¯è¯­
&lt;ul>
&lt;li>TCP/UDP&lt;/li>
&lt;li>TCPæŠ¥æ–‡æ ¼å¼&lt;/li>
&lt;li>æœ‰é™çŠ¶æ€æœº&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>å®Œæˆæœ¬å®žéªŒä»…æ¶‰åŠã€ŠCNTDAã€‹3.4-3.5èŠ‚ï¼Œå¦‚æžœç†è§£æœ‰å›°éš¾ï¼Œå»ºè®®å…ˆå®Œæˆ&lt;em>Wireshark å®žéªŒï¼šTCPè§‚å¯Ÿ&lt;/em>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>åœ¨ä¸Šä¸€ä¸ªå®žéªŒä¸­ï¼Œæˆ‘ä»¬äº†è§£åˆ°socketæ˜¯æ“ä½œç³»ç»Ÿæä¾›çš„ç³»ç»Ÿè°ƒç”¨ï¼Œä¾‹å¦‚ Linux ä¸­ï¼Œåˆ›å»ºsocketå¯¹è±¡è¿”å›žçš„&lt;code>sock_fd&lt;/code>æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå³å»ºç«‹è¿žæŽ¥åŽå¯ä»¥ç›´æŽ¥åƒæ–‡ä»¶ä¸€æ ·è¯»å†™ï¼Œç»‘å®šç«¯å£åŽæ“ä½œç³»ç»Ÿä¼šä¿æŠ¤è¯¥ç«¯å£ä¸è¢«å…¶ä»–è¿›ç¨‹å ç”¨ã€‚è€Œæœ¬å®žéªŒå…³æ³¨è¿è¾“å±‚åŽŸç†ï¼Œæ‰€ä»¥ç»•è¿‡äº†æ“ä½œç³»ç»Ÿï¼Œä½¿ç”¨æ›´åº•å±‚çš„æŽ¥å£å®žçŽ°TCPã€‚å½“ç„¶ï¼Œæ˜¯æœ€ç®€é™‹çš„ä¸€ç§å®žçŽ°ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="guidelines-1">Guidelines&lt;/h4>
&lt;ol>
&lt;li>Socketå®žçŽ°åŽŸç†&lt;/li>
&lt;/ol>
&lt;p>é‚£ä¹ˆï¼Œsocketé‡Œé¢åˆ°åº•æœ‰ä»€ä¹ˆï¼Ÿé¦–å…ˆï¼Œè¦ä¿å­˜åœ°å€ç«¯å£ç­‰ä¿¡æ¯ï¼›å…¶æ¬¡ï¼Œè¦æœ‰æ”¶å‘çš„ä¸¤ä¸ªç¼“å†²åŒºï¼Œè¿™é‡Œå¯ä»¥ç”¨é˜Ÿåˆ—ï¼›ç„¶åŽï¼Œä¸ºäº†å®žçŽ°å¯é è¿è¾“ï¼Œéœ€è¦ç”¨åˆ°è®¡æ—¶å™¨æ¥è§¦å‘é‡ä¼ ï¼Œéœ€è¦å˜é‡æ ‡è®°æ»‘åŠ¨çª—å£ï¼›æˆ‘ä»¬è¿˜ç”¨è‡ªåŠ¨æœºæ€æƒ³æ¥ç®¡ç†è¿žæŽ¥çŠ¶æ€ã€‚Socketåº•å±‚æ¨¡åž‹å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> â”Œâ”€â”€â”€â”€â”€Socketâ”€â”€â”€â”€â”€â”€â”
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”Œâ”€â”€â”€â”€â”€â” â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â”œâ”€â”€â”¼â”€â–º SendQ â”œâ”€â”€â”¼â”€â–ºâ”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ App â”‚ â”‚ Buffers â”‚ â”‚ IP â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”‚ â”‚â—„â”€â”¼â”€â”€â”¤ RecvQ â—„â”€â”¼â”€â”€â”¤ â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â””â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â””â”€â”€â”€â”€â”˜
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€â”€â”€Variablesâ”€â”€â”€â”€â”¤
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ Status â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ Timer â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ SendBase â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”‚ NextSeq â”‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œå°±éœ€è¦é¢å‘å¯¹è±¡ä¸Šåœºäº†&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="k">class&lt;/span> &lt;span class="nc">Socket&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="fm">__init__&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">SendQ&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Queue&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">RecvQ&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Queue&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Status&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Status&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CLOSED&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Timer&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Timer&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">SendBase&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">NextSeq&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># SERVER&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">bind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">addr&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">listen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">accept&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#return c, addr &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># CLIENT&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">connect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># BOTH&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">recv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">length&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#return data&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">send&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">def&lt;/span> &lt;span class="nf">close&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">pass&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸‹é¢é€ä¸ªå®žçŽ°socketæŽ¥å£ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>
&lt;p>å®šåˆ¶TCPæŠ¥æ–‡&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¿žæŽ¥ç®¡ç†&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>äº†è§£äº†ä¸‰æ¬¡æ¡æ‰‹ï¼Œå°±å¯ä»¥å®žçŽ°connectå‡½æ•°äº†&lt;/p>
&lt;h4 id="task-1">Task&lt;/h4>
&lt;ol>
&lt;li>å¤šè·¯å¤ç”¨&lt;/li>
&lt;/ol>
&lt;p>ç›®å‰çš„å®žçŽ°åªèƒ½æ”¯æŒä¸€ä¸ªTCPè¿žæŽ¥ï¼Œè¯·å®žçŽ°&lt;code>listen(num)&lt;/code>å‡½æ•°ï¼Œè°ƒç”¨æ—¶åˆ›å»º num å¯¹è¯»å†™ç¼“å†²åŒºï¼Œå“åº”çš„ä¸º&lt;/p>
&lt;ol>
&lt;li>å®Œå–„TCPåŠŸèƒ½ï¼š&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>RTT&lt;/li>
&lt;li>å¯é è¿è¾“&lt;/li>
&lt;li>æµé‡æŽ§åˆ¶&lt;/li>
&lt;li>é˜»å¡žæŽ§åˆ¶&lt;/li>
&lt;/ul>
&lt;ol start="2">
&lt;li>æ‹“å±•UDPåˆ°ä½ çš„socket&lt;/li>
&lt;/ol>
&lt;h4 id="expand-1">Expand&lt;/h4>
&lt;h3 id="0x30-ç½‘ç»œå±‚-è·¯ç”±è¿½è¸ª--">0x30 ç½‘ç»œå±‚: è·¯ç”±è¿½è¸ª | â­&lt;/h3>
&lt;h4 id="intro-2">Intro&lt;/h4>
&lt;p>æœ¯è¯­ï¼š&lt;/p>
&lt;ul>
&lt;li>IPå±‚ï¼šIPåè®®ï¼ŒICMPåè®®ï¼Œè·¯ç”±åè®®&lt;/li>
&lt;li>è·¯ç”±è¿½è¸ªï¼šè¯·æ±‚æŸåœ°å€ç»è¿‡äº†é‚£äº›è·¯ç”±å™¨ï¼Ÿ&lt;/li>
&lt;/ul>
&lt;h4 id="guidelines-2">Guidelines&lt;/h4>
&lt;p>scapyå®žçŽ°äº†è·¯ç”±è¿½è¸ªå‡½æ•°ï¼Œä½ å¯ä»¥é’»ç ”ä¸€ä¸‹&lt;a class="link" href="https://github.com/secdev/scapy/blob/master/scapy/layers/inet.py#L1740-L1773" target="_blank" rel="noopener"
>æºç &lt;/a>ï¼ˆå¾ˆçŸ­ï¼‰ï¼Œä¸‹é¢å†™ä¸€ä¸ªè‡ªå·±çš„tracerouteã€‚&lt;/p>
&lt;h4 id="task-2">Task&lt;/h4>
&lt;p>ä¸‹é¢ç”¨Ipythonæ¼”ç¤ºï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="n">In&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="kn">from&lt;/span> &lt;span class="nn">scapy.all&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="o">*&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">In&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="n">target&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;www.amazon.com&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">In&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="n">ans&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">unans&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">sr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">IP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dst&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">ttl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">30&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="n">TCP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">flags&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mh">0x2&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Begin&lt;/span> &lt;span class="n">emission&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Finished&lt;/span> &lt;span class="n">sending&lt;/span> &lt;span class="mi">30&lt;/span> &lt;span class="n">packets&lt;/span>&lt;span class="o">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">.*****..**********..........................................................................^&lt;/span>&lt;span class="n">C&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">Received&lt;/span> &lt;span class="mi">92&lt;/span> &lt;span class="n">packets&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">got&lt;/span> &lt;span class="mi">15&lt;/span> &lt;span class="n">answers&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">remaining&lt;/span> &lt;span class="mi">15&lt;/span> &lt;span class="n">packets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">In&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">snd&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rcv&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">ans&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">snd&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ttl&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rcv&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">src&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">isinstance&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rcv&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">payload&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">TCP&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">1&lt;/span> &lt;span class="mf">11.206.119.46&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">2&lt;/span> &lt;span class="mf">11.110.80.173&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">3&lt;/span> &lt;span class="mf">10.102.15.74&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">4&lt;/span> &lt;span class="mf">11.73.2.241&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">5&lt;/span> &lt;span class="mf">124.160.189.101&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">6&lt;/span> &lt;span class="mf">219.158.97.2&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">7&lt;/span> &lt;span class="mf">219.158.34.190&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">8&lt;/span> &lt;span class="mf">69.192.14.38&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">9&lt;/span> &lt;span class="mf">219.158.24.134&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">10&lt;/span> &lt;span class="mf">219.158.10.30&lt;/span> &lt;span class="kc">False&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">11&lt;/span> &lt;span class="mf">69.192.14.38&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">12&lt;/span> &lt;span class="mf">69.192.14.38&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">13&lt;/span> &lt;span class="mf">69.192.14.38&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">14&lt;/span> &lt;span class="mf">69.192.14.38&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ä¸‹é¢è®²è§£æ ¸å¿ƒä»£ç ï¼š&lt;/p>
&lt;p>&lt;code>ans,unans=sr(IP(dst=target,ttl=(1,30),id=RandShort())/TCP(flags=0x2))&lt;/code>&lt;/p>
&lt;ul>
&lt;li>sr()ï¼šsend and receiveï¼Œè¿”å›žçš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯å¾—åˆ°åº”ç­”çš„æ•°æ®åŒ…åˆ—è¡¨å’Œæœªåº”ç­”çš„åŒ…åˆ—è¡¨ã€‚&lt;/li>
&lt;li>ttl=(4,30)ï¼šttlå‚æ•°åœ¨IPå±‚è¡¨ç¤ºICMPåŒ…çš„è½¬å‘æ¬¡æ•°ï¼ˆè·³æ•°ï¼‰ã€‚æ­¤å¤–ï¼Œä¼ å…¥tupleè¡¨ç¤ºä¸€ä¸ªèŒƒå›´ï¼Œsrå‡½æ•°å°†ä¼šä¸ºè¿™ä¸ªèŒƒå›´å†…çš„æ¯ä¸ªå€¼ç”Ÿæˆä¸€ä¸ªå‘åŒ…ã€‚ï¼ˆå¦‚æžœæœ‰å¤šä¸ªtupleå‚æ•°ï¼Œåˆ™ä¼šæŒ‰ç¬›å¡å°”ç§¯è§„åˆ™ç”Ÿæˆå‘åŒ…åˆ—è¡¨ï¼‰&lt;/li>
&lt;li>TCP(flags=0x2)ï¼šåœ¨TCPå¤´éƒ¨è®¾å®šflagå­—æ®µçš„å€¼ï¼Œ0x2å¯¹åº”ACKï¼Œå³ç¡®è®¤æ”¶åˆ°åŒ…ã€‚&lt;/li>
&lt;li>ç»¼åˆèµ·æ¥ï¼Œè¿™æ¡ä»£ç å°†å‘é€30ä¸ªåŒ…ï¼Œå…¶ttlä»Ž1åˆ°30ã€‚å¹¶ç­›é€‰è¿”å›žACKçš„åŒ…ã€‚&lt;/li>
&lt;li>è¿™æ ·æ ¹æ®IPå±‚è·¯ç”±ç®—æ³•ï¼Œåˆ°è¾¾ttlçš„åŒ…æ— è®ºæ˜¯å¦æ‰¾åˆ°ç›®æ ‡éƒ½ä¼šè¿”å›žï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡ï¼ŒTCPå±‚è¿”å›žACKã€‚éåŽ†ttlå½¢æˆçš„åˆ—è¡¨å³æ˜¯ç»è¿‡çš„æ‰€æœ‰è·¯ç”±ã€‚&lt;/li>
&lt;/ul>
&lt;h4 id="expand-2">Expand&lt;/h4>
&lt;h3 id="0x301-ç½‘ç»œå±‚-æ¬ºéª—ping----todo">0x301 ç½‘ç»œå±‚: æ¬ºéª—ping | â­ | TODO&lt;/h3>
&lt;h4 id="intro-3">Intro&lt;/h4>
&lt;ul>
&lt;li>æ¥æºï¼šhttps://seedsecuritylabs.org/Labs_20.04/Files/ICMP_Redirect/ICMP_Redirect.pdf&lt;/li>
&lt;li>æœ¯è¯­ï¼š&lt;/li>
&lt;/ul>
&lt;h4 id="guidelines-3">Guidelines&lt;/h4>
&lt;h4 id="task-3">Task&lt;/h4>
&lt;h4 id="expand-3">Expand&lt;/h4>
&lt;h3 id="0x41-é“¾è·¯å±‚-arpç¼“å­˜æŠ•æ¯’----todo">0x41 é“¾è·¯å±‚: ARPç¼“å­˜æŠ•æ¯’ | â­â­ | TODO&lt;/h3>
&lt;p>&lt;a class="link" href="https://seedsecuritylabs.org/Labs_20.04/Files/ARP_Attack/ARP_Attack.pdf" target="_blank" rel="noopener"
>https://seedsecuritylabs.org/Labs_20.04/Files/ARP_Attack/ARP_Attack.pdf&lt;/a>&lt;/p>
&lt;h3 id="0x21-ä¼ è¾“å±‚-tcpæ”»å‡»----todo">0x21 ä¼ è¾“å±‚: TCPæ”»å‡» | â­â­ | TODO&lt;/h3>
&lt;p>&lt;a class="link" href="https://seedsecuritylabs.org/Labs_20.04/Files/TCP_Attacks/TCP_Attacks.pdf" target="_blank" rel="noopener"
>https://seedsecuritylabs.org/Labs_20.04/Files/TCP_Attacks/TCP_Attacks.pdf&lt;/a>&lt;/p>
&lt;p>TCPåè®®
SYNæ³›æ´ª
TCP reset
TCP session hijackingåå¼¹shell ï¼ˆé‡ç‚¹ï¼‰&lt;/p>
&lt;h3 id="0x31-ç½‘ç»œå±‚-natdhcpå’Œè™šæ‹Ÿæœº-----todo">0x31 ç½‘ç»œå±‚: NATï¼ŒDHCPå’Œè™šæ‹Ÿæœº | â­â­ | TODO&lt;/h3>
&lt;p>ç›¸ä¿¡æŠ˜è…¾è¿‡è™šæ‹Ÿæœºçš„åŒå­¦éƒ½ç»•ä¸è¿‡è¿™ä¸ªé—®é¢˜ï¼šæˆ‘çš„è™šæ‹Ÿæœºæ€Žä¹ˆè¿žä¸ä¸Šç½‘ï¼Ÿæœ¬å®žéªŒåŸºäºŽwmwareè™šæ‹Ÿæœºå¹³å°ï¼Œè®²è§£å‡ ç§è™šæ‹Ÿæœºç½‘ç»œæ¨¡å¼åŠå…¶åŽŸç†ã€‚&lt;/p>
&lt;h3 id="0x13-åº”ç”¨å±‚-dnsæœ¬åœ°æ”»å‡»----todo">0x13 åº”ç”¨å±‚: DNSæœ¬åœ°æ”»å‡» | â­â­â­ | TODO&lt;/h3>
&lt;p>&lt;a class="link" href="https://seedsecuritylabs.org/Labs_20.04/Files/DNS_Local/DNS_Local.pdf" target="_blank" rel="noopener"
>https://seedsecuritylabs.org/Labs_20.04/Files/DNS_Local/DNS_Local.pdf&lt;/a>&lt;/p>
&lt;h3 id="0x14-åº”ç”¨å±‚-sslåè®®å’Œhttps----todo">0x14 åº”ç”¨å±‚: SSLåè®®å’ŒHTTPS | â­â­â­â­ | TODO&lt;/h3>
&lt;h3 id="0x15-åº”ç”¨å±‚-å¤šçº¿ç¨‹webä»£ç†æœåŠ¡å™¨-----todo">0x15 åº”ç”¨å±‚: å¤šçº¿ç¨‹Webä»£ç†æœåŠ¡å™¨ | â­â­â­â­â­ | TODO&lt;/h3>
&lt;h3 id="0x151-åº”ç”¨å±‚-vpn----todo">0x151 åº”ç”¨å±‚: VPN | â­â­â­â­â­ | TODO&lt;/h3>
&lt;p>æŽ¢ç©¶VPNåŽŸç†&lt;/p>
&lt;h3 id="0x152-åº”ç”¨å±‚-v2rayåè®®å­¦ä¹ ----todo">0x152 åº”ç”¨å±‚: V2Rayåè®®å­¦ä¹  | ï¼Ÿï¼Ÿï¼Ÿ | TODO&lt;/h3>
&lt;p>æœ‰ç”Ÿä¹‹å¹´ç ”ç©¶ä¸€ä¸‹Vmessç­‰åè®®&lt;/p>
&lt;!-- çœç•¥çš„ï¼š
- é˜²ç«å¢™iptableså®žéªŒ
- mitnickæ”»å‡»
- BGP
- 802.11
- --></description></item><item><title>åŸºäºŽvivadoçš„åŸºäºŽFPGAçš„ä¸€ç§åŸºäºŽMIPSçš„ä¸€ç§äº”çº§æµæ°´çº¿CPUå®žçŽ°çš„æ³¨é‡Š</title><link>https://lonelyuan.github.io/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/</link><pubDate>Wed, 09 Jun 2021 17:14:19 +0000</pubDate><guid>https://lonelyuan.github.io/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/</guid><description>&lt;img src="https://lonelyuan.github.io/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/mips_pipeline_cpu.jfif" alt="Featured image of post åŸºäºŽvivadoçš„åŸºäºŽFPGAçš„ä¸€ç§åŸºäºŽMIPSçš„ä¸€ç§äº”çº§æµæ°´çº¿CPUå®žçŽ°çš„æ³¨é‡Š" />&lt;blockquote>
&lt;p>æœ¬æ–‡æ‰€è¿°ä¸ºè®¡ç®—æœºç»„æˆåŽŸç†è¯¾æ‹“å±•å®žéªŒçš„ç›¸å…³è®°å½•ï¼ŒåŸºäºŽâ€œé¾™èŠ¯ä½“ç³»ç»“æž„ä¸ŽCPUè®¾è®¡æ•™å­¦å®žéªŒç³»ç»Ÿâ€
é¡¹ç›®å®˜ç½‘ï¼š &lt;a class="link" href="http://www.loongson.cn/business/general/teach/356.html" target="_blank" rel="noopener"
>http://www.loongson.cn/business/general/teach/356.html&lt;/a>ï¼›
ç›¸å…³èµ„æ–™ä»£ç ï¼š#TODO:: githubä»“åº“
PSï¼šæ ‡é¢˜å¯ç®€è®°ä¸ºã€ŠåŸºäºŽåŸºäºŽçš„ä¸€ç§åŸºäºŽçš„ä¸€ç§å®žçŽ°ã€‹&lt;/p>
&lt;/blockquote>
&lt;h2 id="åæ§½æ—¶é—´">ðŸ¤“åæ§½æ—¶é—´&lt;/h2>
&lt;p>å¿«è€ƒè¯•äº†ï¼ŒðŸ‘´å‘è§‰ðŸ‘´è®¡ç»„å­¦äº†ä¸ªðŸ”¨ï¼ŒðŸ‘´åŽ»å¹´ä¹Ÿå­¦äº†ä¸ªðŸ”¨ï¼Œä½†æ˜¯åŽ»å¹´å¯ä»¥å½’å› äºŽæ™¦æ°”çš„æ™¦æ°”ï¼Œä»Šå¹´åªèƒ½è¯´è‡ªå·±æ™¦æ°”ã€‚éš¾é“è¿˜è¦é‡è¹ˆåŽ»å¹´çš„æ™¦æ°”å—ï¼ŸðŸ‘´æœ¬åº”è¯¥å›žåŽ»èƒŒè¯¾æœ¬ï¼Œåˆ·è€ƒç ”é¢˜ï¼Œä½†æ˜¯ðŸ‘´ä¸€çœ‹pptå°±æƒ³èµ·æˆ‘ä»¬æ•¬çˆ±çš„ã€Šè®¡ç®—æœºç»„æˆåŽŸç†ã€‹è¯¾çš„ä»»è¯¾è€å¸ˆï¼Œä¸å“¥åå¤å¼ºè°ƒçš„è‡³ç†åè¨€ï¼šâ€œå¬ä¸æ‡‚çš„ä¸¾æ‰‹ï¼ˆæ— åœé¡¿ï¼‰éƒ½æ²¡ä¸¾æ‰‹ï¼Œéƒ½å¬æ‡‚äº†ï¼Œéžå¸¸å¥½ã€‚â€æœ¬äººååˆ†é’¦ä½©ä¸å“¥è€å¸ˆå¯¹å¹½é»˜æ„Ÿçš„ç‹¬ç‰¹ç†è§£ã€‚&lt;br>&lt;/p>
&lt;p>&lt;em>ï¼ˆä½†æ˜¯ç‰¹æ­¤å£°æ˜Žï¼šæœ¬äººä¸äº†è§£ã€ä¸è®¤åŒå…¶å…³äºŽ&amp;quot;5Gæ˜¯ä¸ªå‡ æŠŠ&amp;quot;ï¼Œ&amp;ldquo;é«˜æ™“æ¾å¾ˆnbè¿™ä¸ªäºº&amp;rdquo;ï¼Œ&amp;ldquo;é’±=æµªæ¼«&amp;quot;ç­‰è®®é¢˜çš„çœ‹æ³•ï¼‰&lt;/em>&lt;br>&lt;/p>
&lt;p>è€Œä¸”ðŸ‘´è¿™äººå¾ˆæ€ªï¼Œè¯¾æœ¬ä¸Šçš„é‡ç‚¹ï¼Œä¸å¥½çŽ©ï¼›é€‰åšçš„å®žéªŒï¼Œå¥½çŽ©ï¼å“Žå°±æ˜¯çŽ©ï¼Œæ€ªä¸å¾—å·ä¸è¿‡åˆ«äººï¼Œä½ ä¹Ÿé…å·ï¼Ÿæ»šåŽ»è€ƒç ”å§ã€‚&lt;br>&lt;/p>
&lt;p>ä¼—æ‰€å‘¨çŸ¥ï¼Œè®¡ç®—æœºå­¦ç”Ÿçš„æœ¬ç§‘ç”Ÿæ¶¯ï¼Œå¦‚æžœèƒ½åšåˆ°åœ¨è‡ªå·±è®¾è®¡çš„CPUä¸Šè¿è¡Œè‡ªå·±å†™çš„æ“ä½œç³»ç»Ÿå¹¶ç”¨è‡ªå·±å†™çš„ç¼–è¯‘å™¨è·‘ä»£ç ï¼Œé‚£å°±éžå¸¸æˆåŠŸäº†ã€‚ðŸ‘´å·®ä¸å¤šï¼ŒðŸ‘´èƒ½åœ¨è‡ªå·±æœçš„ä»£ç ä¸Šå†™è‡ªå·±çš„æ³¨é‡Šå¹¶ç”¨è‡ªå·±çš„ç”µè„‘æˆªå›¾ï¼Œéƒ½æ˜¯ä¸‰ä¸ª&amp;quot;è‡ªå·±&amp;rdquo;ã€‚é‚£ä¹ˆä»Šå¤©ç»™å¤§å®¶çˆ†ä¸ªå•¥æï¼Œæµæ°´çº¿å¥¥ã€‚&lt;br>&lt;/p>
&lt;h2 id="-ç”¨è®¡ç®—æœºé€ è®¡ç®—æœº">ðŸ”§ â€œç”¨â€è®¡ç®—æœºâ†’â€œé€ â€è®¡ç®—æœº&lt;/h2>
&lt;p>ä¸Šå›žä¹¦è¯´åˆ°ï¼ˆ#TODO:: CSAPPå¤§ç¯‡ï¼‰ï¼Œæ±‡ç¼–å™¨(as)è®©æˆ‘ä»¬å¾—åˆ°äº†æœºå™¨èƒ½çœ‹æ‡‚çš„æ¯”ç‰¹æµï¼Œæœ€åŽä¸€æ­¥åªéœ€è¦è¿žæŽ¥å™¨(ld)å°†å…¶å’Œå…¶ä»–è°ƒç”¨ä¸€èµ·è½½å…¥å†…å­˜ã€‚è¿™å›žç­”äº†ç¨‹åºå¦‚ä½•åœ¨CPUè¿™ä¸ªå¹³å°ä¸Šè¿è¡Œçš„é—®é¢˜ï¼Œç„¶è€Œä¸€ä¸ªæ›´åŸºæœ¬çš„é—®é¢˜æ˜¯ï¼Œè¿™ä¸ªçŽ°æœ‰çš„å¹³å°æ˜¯å¦‚ä½•å®žçŽ°çš„ï¼Ÿä¸€ä¸ªç²—ç•¥çš„è®¤è¯†æ˜¯ï¼Œæˆ‘ä»¬çŸ¥é“è¿™äº›è¶³ä»¥å®žçŽ°CPUçš„å¤æ‚çš„é€»è¾‘ï¼Œå…¶æœ€å°å•å…ƒæ€»å¯¹åº”åˆ°ç®€å•çš„è¯¸å¦‚é€»è¾‘é—¨ä¸Šé¢ï¼Œä½†æ˜¯è½å®žåˆ°çœŸæ­£çš„ç‰©ç†å®žçŽ°ä¹‹ä¸Šï¼Œå¦‚ä½•ä½¿æ•ˆçŽ‡æœ€é«˜ï¼ŸåŠŸè€—æœ€å°ï¼Ÿè¿™äº›é—®é¢˜æ‰€è·¨è¶Šçš„å¤æ‚åº¦çš„é‡çº§ä¾ç„¶æ˜¯ä¸€ç‰‡å·¨å¤§çš„è¿·é›¾ã€‚ç…§äº®è¿™ç‰‡è¿·é›¾çš„çŸ¥è¯†ï¼Œå¤§æ¦‚éš¶å±žäºŽICå­¦ç§‘ã€‚&lt;br>&lt;/p>
&lt;p>Howeverï¼Œä½œä¸ºCSä¸“ä¸šè€Œä¸æ˜¯ICä¸“ä¸šï¼Œæˆ‘ä»¬çš„ç›®æ ‡ä»…åœ¨äºŽç†è§£æ‰€è°“â€œç»„æˆåŽŸç†â€ã€‚åœ¨ICäº§ä¸šçš„å¤æ‚åº¦è§„æ¨¡æ•°è½´ä¸Šï¼Œå‘ä¸‹æ˜¯ä¸“æœ‰èŠ¯ç‰‡ï¼ˆåˆç§°åµŒå…¥å¼ï¼Ÿï¼‰ï¼ŒåŠŸèƒ½ä¸“ç”¨ï¼Œè§„æ¨¡è¾ƒå°ï¼›å‘ä¸Šæ˜¯é€šç”¨èŠ¯ç‰‡ï¼Œå³æ‰‹æœºç”µè„‘ç­‰çš„æ ¸å¿ƒï¼Œå…¶éš¾åº¦ä¸è¨€è€Œå–»ã€‚ä½äºŽä¸­é—´çš„FPGAåˆ™æ—¢å…¼é¡¾äº†è‡ªç”±åº¦ä¹Ÿè€ƒè™‘äº†é€Ÿåº¦ï¼Œå› æ­¤ï¼Œè¿™çŽ©æ„èƒ½æ»¡è¶³CSæœ¬ç§‘æ•™å­¦çš„éœ€è¦ï¼ˆä¸»è¦æ˜¯ä¾¿å®œè€æ“ï¼‰ã€‚&lt;br>&lt;/p>
&lt;h2 id="é«˜è´µçš„icå·¥ç¨‹å¸ˆéƒ½ç”¨å•¥è½®å­">ðŸ”®é«˜è´µçš„ICå·¥ç¨‹å¸ˆéƒ½ç”¨å•¥è½®å­&lt;/h2>
&lt;p>Vivadoæ˜¯ä¸€ä¸ªFPGAé›†æˆè®¾è®¡å¹³å°ï¼ˆä¹Ÿç®—ä¸€ä¸ªEDAï¼Ÿï¼‰ï¼Œä»–ä¸»ç•Œé¢å·¦ä¾§çš„å·¥ä½œæµçª—å£å¾ˆå¥½çš„æ¦‚æ‹¬äº†åˆ©ç”¨FPGAå¼€å‘çš„åŸºæœ¬æµç¨‹ã€‚å³&lt;/p>
&lt;ul>
&lt;li>ç¼–å†™è®¾è®¡æºç (Source)ï¼šä½¿ç”¨Verilogè¯­è¨€ç¼–å†™é€»è¾‘æˆ–å¼•å…¥IP
&lt;ul>
&lt;li>è®¾è®¡ä»¿çœŸæ¨¡æ‹Ÿ(Simulation)ï¼šé€šè¿‡è§‚å¯Ÿä»¿çœŸæ³¢å½¢å›¾å’Œç¼–å†™testbenchæ¥å¯¹è®¾è®¡è¿›è¡Œdebug
&lt;ul>
&lt;li>ç»¼åˆ(Systhesis)é—¨çº§ç½‘è¡¨ï¼šä»ŽRTLçº§æè¿°é™ç»´åˆ°é—¨çº§ç½‘è¡¨
&lt;ul>
&lt;li>ç”Ÿæˆ(Implementation)å¸ƒå±€å¸ƒçº¿ï¼šæ ¹æ®ç®¡è„šçº¦æŸï¼Œå°†ä¾ç„¶æ˜¯è™šæ‹Ÿçš„é—¨çº§è¿žçº¿è½å®žä¸ºå®žé™…çš„çº¿è·¯
&lt;ul>
&lt;li>è¿›è¡Œç¡¬ä»¶ç¼–ç¨‹(program)ï¼šç”Ÿæˆæ¯”ç‰¹æµå¹¶å†™å…¥ç›®æ ‡è®¾å¤‡&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623373911775.png"
width="284"
height="898"
srcset="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623373911775_huf28bb0831bd4f5e30206b091a37b5db9_21335_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623373911775_huf28bb0831bd4f5e30206b091a37b5db9_21335_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="31"
data-flex-basis="75px"
>&lt;/p>
&lt;blockquote>
&lt;p>åè¯è§£é‡Šï¼š
ICï¼šé›†æˆç”µè·¯
FPGAï¼šçŽ°åœºå¯ç¼–ç¨‹é—¨é˜µåˆ—
Verilogï¼šä¸€ç§ç¡¬ä»¶æè¿°è¯­è¨€ï¼Œè¯­æ³•æ¶µç›–äº†è‡ªé¡¶å‘ä¸‹äº”ä¸ªæŠ½è±¡å±‚é¢ï¼šç³»ç»Ÿçº§ã€ç®—æ³•çº§ã€RTLçº§ã€é—¨çº§ã€å¼€å…³çº§ã€‚
RTLï¼šå¯„å­˜å™¨ä¼ è¾“çº§ã€‚ä¸€èˆ¬ä½¿ç”¨æœ€å¤šçš„å°±æ˜¯RTLçº§ã€‚
IPï¼šIntellectual Propertyå†…æ ¸æ¨¡å—ï¼Œå¯ä»¥ç†è§£ä¸ºå°†ä»£ç å°è£…ä¸ºå‡½æ•°ã€‚åˆ†ä¸ºï¼Œè½¯IPå†…æ ¸(soft IP core)ï¼Œå›ºIPå†…æ ¸(firm IP core)å’Œç¡¬IPå†…æ ¸(hard IP core)3ä¸ªå±‚æ¬¡ï¼Œç›¸å½“äºŽé›†æˆç”µè·¯çš„æ¯›å¯ã€åŠæˆå“å’Œæˆå“ã€‚
SoCï¼šç‰‡ä¸Šç³»ç»Ÿï¼Œå¤§æ¦‚æ˜¯èŠ¯ç‰‡åŠå…¶è£…è½½çš„ç¬¬ä¸€å±‚è½¯ä»¶æŽ¥å£çš„é›†åˆï¼Œå¾ˆå®½æ³›çš„æ¦‚å¿µã€‚
EDAï¼šç”µå­è®¾è®¡è‡ªåŠ¨åŒ–ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¤§è‡´æŽ¢æ¸…äº†è¿™ç‰‡è¿·é›¾ï¼ŒCPUçš„è®¾è®¡å¦‚ä½•ä»Žé«˜æŠ½è±¡å±‚æ¬¡çš„é€»è¾‘ï¼Œæ¢³ç†æˆæœ€åº•å±‚çš„é€»è¾‘é—¨ï¼Œå†å®žçŽ°ä¸ºå°å°çš„èŠ¯ç‰‡ã€‚é‚£ä¹ˆæˆ‘ä»¬æœ‰äº†è½®å­ï¼Œè¦é€ ä¸€ä¸ªCPUï¼Œè¿˜è¦ç¡®å®šç›®æ ‡æŒ‡ä»¤é›†ã€‚ç”±äºŽæœ¬é¡¹ç›®ç”±é¾™èŠ¯å…¬å¸èµžåŠ©ï¼Œé‚£å¿…ç„¶è¦é€‰MIPSäº†ã€‚&lt;/p>
&lt;h2 id="mipsæŒ‡ä»¤é›†æ ¼å¼">ðŸ“ŒMIPSæŒ‡ä»¤é›†æ ¼å¼&lt;/h2>
&lt;p>å•¥å«æŒ‡ä»¤é›†å‘¢ï¼Œå­¦è¿‡å‡ ç§è¯­è¨€å°±ä¸éš¾ç†è§£ã€‚é«˜çº§ç¨‹åºè¯­è¨€è§„å®šæ¯ä¸ªasciiç çš„ç»„åˆæ‰€å¯¹åº”çš„å«ä¹‰ï¼ŒæŒ‡ä»¤é›†è§„å®š0å’Œ1çš„ç»„åˆæ‰€å¯¹åº”çš„å¯„å­˜å™¨ï¼ŒALUçš„å„ç§ä¿¡å·ã€‚MIPSæŒ‡ä»¤é›†ä»Žå±žäºŽRISCç³»åˆ—ï¼Œæœ€åŸºæœ¬çš„æŒ‡ä»¤æœ‰31æ¡ã€‚&lt;br>&lt;/p>
&lt;p>//è®²åˆ°è¿™é‡Œæœ¬åº”è¯¥æ‰“ä¸ªè¡¨å±•ç¤º31æ¡æŒ‡ä»¤ï¼Œä½†æ˜¯ðŸ‘´æ‡’å¾—æ‰“äº†ã€‚&lt;br>&lt;/p>
&lt;p>Vivadoä¸­ï¼Œ.coeæ–‡ä»¶ç”¨äºŽåˆå§‹åŒ–IPæ ¸ï¼Œæœ¬å®žéªŒç»™å‡ºçš„.coeæ–‡ä»¶ä¸­å­˜æ”¾äº†å‡ æ¡æŒ‡ä»¤ï¼Œä¸è¿‡æ˜¯16è¿›åˆ¶æ•°å­—ï¼Œå†™ä¸ªå°è„šæœ¬æ‰“å°æˆå¯è¯»çš„å½¢å¼ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;span class="lnt">51
&lt;/span>&lt;span class="lnt">52
&lt;/span>&lt;span class="lnt">53
&lt;/span>&lt;span class="lnt">54
&lt;/span>&lt;span class="lnt">55
&lt;/span>&lt;span class="lnt">56
&lt;/span>&lt;span class="lnt">57
&lt;/span>&lt;span class="lnt">58
&lt;/span>&lt;span class="lnt">59
&lt;/span>&lt;span class="lnt">60
&lt;/span>&lt;span class="lnt">61
&lt;/span>&lt;span class="lnt">62
&lt;/span>&lt;span class="lnt">63
&lt;/span>&lt;span class="lnt">64
&lt;/span>&lt;span class="lnt">65
&lt;/span>&lt;span class="lnt">66
&lt;/span>&lt;span class="lnt">67
&lt;/span>&lt;span class="lnt">68
&lt;/span>&lt;span class="lnt">69
&lt;/span>&lt;span class="lnt">70
&lt;/span>&lt;span class="lnt">71
&lt;/span>&lt;span class="lnt">72
&lt;/span>&lt;span class="lnt">73
&lt;/span>&lt;span class="lnt">74
&lt;/span>&lt;span class="lnt">75
&lt;/span>&lt;span class="lnt">76
&lt;/span>&lt;span class="lnt">77
&lt;/span>&lt;span class="lnt">78
&lt;/span>&lt;span class="lnt">79
&lt;/span>&lt;span class="lnt">80
&lt;/span>&lt;span class="lnt">81
&lt;/span>&lt;span class="lnt">82
&lt;/span>&lt;span class="lnt">83
&lt;/span>&lt;span class="lnt">84
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># mips_dump.py&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">with&lt;/span> &lt;span class="nb">open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">path&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;r&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">hex_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">f&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">read&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s1">&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bin_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">list&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">map&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">lambda&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nb">bin&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">)),&lt;/span>&lt;span class="n">hex_list&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># bin_code_list = [&amp;#34;{:0&amp;gt;32}&amp;#34;.format(i[2:],&amp;#39;b&amp;#39;) for i in bin_list]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">bin_code_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zfill&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">bin_list&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">IType_op_dict&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001000&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;addi&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001001&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;addiu&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001100&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;ori&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001101&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;xori&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001111&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;lui&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100011&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;lw&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;101011&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sw&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000100&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;beq&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000101&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;bne&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001010&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;slti&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001011&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sltiu&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">RType_func_dict&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100000&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;add&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100001&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;addu&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100010&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sub&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100011&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;subu&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100100&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;and&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100101&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;or&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100110&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;xor&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;100111&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;nor&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;101010&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;slt&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;101011&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sltu&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000000&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sll&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000010&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;srl&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000011&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sra&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000100&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;sllv&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000110&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;srlv&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;000111&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;srav&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s1">&amp;#39;001000&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="s1">&amp;#39;jr&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">f_hex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ori&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">width&lt;/span>&lt;span class="p">):&lt;/span> &lt;span class="c1"># bin-&amp;gt;hex&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="s2">&amp;#34;0x&amp;#34;&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="nb">hex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ori&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">))[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zfill&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">width&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">f_reg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ori&lt;/span>&lt;span class="p">):&lt;/span> &lt;span class="c1"># print register num&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="s2">&amp;#34;$&amp;#34;&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ori&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zfill&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">code_dump&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">type&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">inst&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nb">list&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">type&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;R&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">inst&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ljust&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s2">&amp;#34;, &amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="n">f_reg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]),&lt;/span>&lt;span class="n">f_reg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]),&lt;/span>&lt;span class="n">f_reg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">]),&lt;/span>&lt;span class="n">f_hex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">elif&lt;/span> &lt;span class="nb">type&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;I&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">inst&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ljust&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s2">&amp;#34;, &amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="n">f_reg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]),&lt;/span>&lt;span class="n">f_reg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]),&lt;/span>&lt;span class="n">f_hex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">)])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">inst&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ljust&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="s1">&amp;#39;0x&amp;#39;&lt;/span>&lt;span class="o">+&lt;/span> &lt;span class="nb">hex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">params&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">],&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">))[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">:]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">zfill&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">assembly_list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="n">_&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">bin_code_list&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">op&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[:&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="c1"># public field&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">try&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">op&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;000000&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="c1"># R-Type&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">11&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">11&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">21&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">shamt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">21&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">func&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">:]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">assembly_list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">code_dump&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;R&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">RType_func_dict&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">func&lt;/span>&lt;span class="p">],[&lt;/span>&lt;span class="n">rs&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">rt&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">rd&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">shamt&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">elif&lt;/span> &lt;span class="n">op&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;000010&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;000011&amp;#39;&lt;/span>&lt;span class="p">]:&lt;/span> &lt;span class="c1"># J-Type&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">target&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">:]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">assembly_list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">code_dump&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;J&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s1">&amp;#39;j&amp;#39;&lt;/span>&lt;span class="p">,[&lt;/span>&lt;span class="n">target&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="c1"># I-Type&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">6&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">18&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">imm&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">_&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">18&lt;/span>&lt;span class="p">:]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">assembly_list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">code_dump&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;I&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">IType_op_dict&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">op&lt;/span>&lt;span class="p">],[&lt;/span>&lt;span class="n">rs&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rt&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">imm&lt;/span>&lt;span class="p">]))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">except&lt;/span> &lt;span class="ne">Exception&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">assembly_list&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;***** decode error! *****&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">head&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;+---hexdump----|--------- assembly ---------+&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">head&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">addr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="nb">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">bin_code_list&lt;/span>&lt;span class="p">)):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;|&amp;#34;&lt;/span>&lt;span class="o">+&lt;/span> &lt;span class="n">f_hex&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">bin&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">addr&lt;/span>&lt;span class="p">),&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="o">+&lt;/span> &lt;span class="n">hex_list&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="s2">&amp;#34; | &amp;#34;&lt;/span>&lt;span class="o">+&lt;/span> &lt;span class="n">assembly_list&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ljust&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">26&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s2">&amp;#34; |&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">addr&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">tail&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;+&amp;#34;&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="s2">&amp;#34;-&amp;#34;&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="mi">43&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="s2">&amp;#34;+&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tail&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ‰“å°å‡ºæ¥ðŸ‘´å‚»äº†ï¼Œæ€Žä¹ˆè¿˜æœ‰ä¸åœ¨31æ¡èŒƒå›´é‡Œçš„ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">+---hexdump----|--------- assembly ---------+
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x00 24010001 | addiu $00, $04, 0x00000001 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x04 00011100 | sll $00, $01, $02, 0x04 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x08 00411821 | addu $02, $01, $03, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x0c 00022082 | srl $00, $02, $04, 0x02 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x10 28990005 | slti $09, $36, 0x00000005 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x14 07210010 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x18 00642823 | subu $03, $04, $05, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x1c AC050014 | sw $00, $20, 0x00000014 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x20 00A23027 | nor $05, $02, $06, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x24 00C33825 | or $06, $03, $07, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x28 00E64026 | xor $07, $06, $08, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x2c AC08001C | sw $00, $32, 0x0000001c |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x30 11030002 | beq $16, $12, 0x00000002 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x34 00C7482A | slt $06, $07, $09, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x38 24010008 | addiu $00, $04, 0x00000008 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x3c 8C2A0014 | lw $02, $40, 0x00000014 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x40 15450004 | bne $20, $20, 0x00000004 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x44 00415824 | and $02, $01, $11, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x48 AC2B001C | sw $02, $44, 0x0000001c |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x4c AC240010 | sw $02, $16, 0x00000010 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x50 0C000019 | j 0x00000019 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x54 3C0C000C | lui $00, $48, 0x0000000c |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x58 004CD007 | srav $02, $12, $26, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x5c 003AD804 | sllv $01, $26, $27, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x60 0360F809 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x64 A07A0005 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x68 0063682B | sltu $03, $03, $13, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x6c 1DA00003 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x70 00867004 | sllv $04, $06, $14, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x74 000E7883 | sra $00, $14, $15, 0x02 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x78 002F8006 | srlv $01, $15, $16, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x7c 1A000008 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x80 002F8007 | srav $01, $15, $16, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x84 240B008C | addiu $00, $44, 0x0000008c |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x88 06000006 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x8c 8D5C0003 | lw $21, $48, 0x00000003 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x90 179D0007 | bne $57, $52, 0x00000007 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x94 A0AF0008 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x98 80B20008 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0x9c 90B30008 | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xa0 2DF8FFFF | sltiu $31, $35, 0x00003fff |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xa4 0185E825 | or $12, $05, $29, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xa8 01600008 | jr $11, $00, $00, 0x00 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xac 31F4FFFF | ori $31, $19, 0x00003fff |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xb0 35F5FFFF | xori $31, $23, 0x00003fff |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xb4 39F6FFFF | ***** decode error! ***** |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">|0xb8 08000000 | j 0x00000000 |
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">+-------------------------------------------+
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ€»ä¹‹ï¼Œä»£ç éƒ½ç»™ä½ äº†ï¼Œä¸‹é¢ç»™å‡ºä¸€ä¸ªvivadoå®žéªŒçš„å®Œæ•´æµç¨‹ï¼Œä¸å…¨é¢ï¼Œä½†æ˜¯éƒ½æ˜¯è¸©å‘ç»éªŒã€‚&lt;/p>
&lt;h2 id="vivadoä½¿ç”¨">ðŸ†’Vivadoä½¿ç”¨&lt;/h2>
&lt;p>æœ¬æµç¨‹çŽ¯å¢ƒï¼šVivado 2020.2&lt;br>
å¼€å‘æ¿åž‹å·ï¼šLS-CPU-EXB-1&lt;br>&lt;/p>
&lt;h3 id="åˆ›å»ºé¡¹ç›®">åˆ›å»ºé¡¹ç›®&lt;/h3>
&lt;p>ä¸‹ä¸€æ­¥ï¼Œä¸‹ä¸€æ­¥ï¼Œä¸‹ä¸€æ­¥ï¼Œï¼Œï¼Œç¡®è®¤ã€‚
è¿™ä¸€æ­¥åªéœ€è¦æ³¨æ„é€‰å™¨ä»¶ï¼Œä¸€å®šè¦é€‰å¯¹ã€‚å¦åˆ™æœ‰å¯èƒ½åœ¨Implementationé‡åˆ°â€œç«¯å£ç”µå¹³ä¸åŒ¹é…â€â€œç«¯å£æ•°é‡ä¸è¶³â€ç­‰ç¡¬ä»¶é—®é¢˜ã€‚å½“ç„¶ï¼Œæœ‰å¯èƒ½åž‹å·ç›¸è¿‘çš„æ€§èƒ½è§„æ ¼ä¹Ÿå·®ä¸å¤šï¼Œè¿™å±žäºŽçŽ„å­¦é—®é¢˜äº†ã€‚å®žéªŒä¹¦ä¸Šé€‰æ‹©çš„çš„åž‹å·åº”è¯¥æ˜¯â€œxc7a200tfbg676-2â€ï¼Œä½†æ˜¯ðŸ‘´ç”¨çš„æ˜¯â€œxc7a200tfbv676-2â€ä¹Ÿèƒ½æˆåŠŸå†™å…¥æ¯”ç‰¹æµã€‚&lt;/p>
&lt;h3 id="ç¼–å†™ä»£ç å¹¶ä»¿çœŸ">ç¼–å†™ä»£ç å¹¶ä»¿çœŸ&lt;/h3>
&lt;p>æœ¬å®žéªŒçš„ä»£ç å¤§å¤šæ¥è‡ªâ€œ2016-04-14â€ï¼Œé‚£å°±æ˜¯é¾™èŠ¯å…¬å¸ç»™çš„æºä»£ç ã€‚åœ¨è¯¥ç³»åˆ—ä»£ç ä¸­æœ‰ä¸€å¤„bugï¼Œä½äºŽâ€œå•å‘¨æœŸCPUå®žéªŒâ€çš„single_cycle_cpu.vä¸­ã€‚214è¡Œï¼Œ&lt;code>resetn&lt;/code>åº”è¯¥ä¸º&lt;code>{4{resetn}}&lt;/code>ï¼Œå†™ä½¿èƒ½ä½å®½åº”ä¸ºä¸º4ã€‚
&lt;img src="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379687932.png"
width="1127"
height="171"
srcset="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379687932_hufe86cef61ae65608cb32f2b7a6318565_35328_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379687932_hufe86cef61ae65608cb32f2b7a6318565_35328_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="659"
data-flex-basis="1581px"
>&lt;/p>
&lt;p>ä¸‹é¢è®²è§£ä¸€ä¸‹é¡¹ç›®ç»“æž„ï¼Œæ‰€æœ‰å®žéªŒéƒ½æ˜¯ç±»ä¼¼çš„ï¼š
&lt;img src="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623374928604.png"
width="685"
height="892"
srcset="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623374928604_hu98bc94ba53dca30899515e8f1ad871e0_210347_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623374928604_hu98bc94ba53dca30899515e8f1ad871e0_210347_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="76"
data-flex-basis="184px"
>
ä¸‰ä¸ªé¡¶å±‚æ–‡ä»¶å¤¹åˆ†åˆ«å¯¹åº”Add Sourceé‡Œçš„ä¸‰ç±»æºæ–‡ä»¶ï¼šæ·»åŠ è®¾è®¡ï¼Œæ·»åŠ ä»¿çœŸï¼Œæ·»åŠ çº¦æŸã€‚å¦‚æžœä¸éœ€è¦ä¸Šæ¿ï¼Œåªå®Œæˆä»¿çœŸï¼Œé‚£ä¹ˆåªéœ€è¦æ·»åŠ è®¾è®¡ï¼ˆå‡ ä¸ª.vï¼‰ï¼Œæ·»åŠ ä»¿çœŸï¼ˆtestbench.v/tb.vï¼‰å°±è¶³å¤Ÿäº†ï¼Œxxx_display.vä¹Ÿæ˜¯ä¸Šæ¿éœ€è¦çš„æ•…è€Œå¯ä»¥å¿½ç•¥ã€‚ï¼ˆå®žé™…ä¸Šï¼Œå›¾ä¸­æˆ‘ç”¨ç®­å¤´æ ‡è®°çš„éƒ½ç”¨ä¸åˆ°ï¼‰ã€‚&lt;/p>
&lt;p>ç¼–å†™tbï¼Œæ— éžæ˜¯ç»™tbé‡Œå£°æ˜Žä¸ºinputçš„ä¿¡å·èµ‹å€¼ï¼Œè¿˜å¯ä»¥ä½¿ç”¨&lt;code>#xx&lt;/code>ï¼Œè®©tbç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚&lt;/p>
&lt;p>ç‚¹å‡»Run Simulationï¼Œç­‰ä¸€ä¼šå°±èƒ½çœ‹åˆ°æ³¢å½¢å›¾ã€‚æ³¢å½¢å›¾æœ‰ä¸‰ç§é¢œè‰²ï¼š&lt;/p>
&lt;ul>
&lt;li>ç»¿è‰²ä»£è¡¨ä¿¡å·æ­£å¸¸æ­£å¸¸ï¼›&lt;/li>
&lt;li>çº¢è‰²çš„Xä»£è¡¨ä¿¡å·ä¸ç¡®å®šï¼›&lt;/li>
&lt;li>è“è‰²çš„Zä»£è¡¨ä¿¡å·ä¼‘çœ ã€‚&lt;/li>
&lt;/ul>
&lt;p>ä¸€èˆ¬é‡åˆ°çº¢Xï¼Œéƒ½æ˜¯æœªåˆå§‹åŒ–é—®é¢˜ã€‚è“Zå¤§æ¦‚æ˜¯æ²¡æœ‰æ¨¡å—è°ƒç”¨è¿™äº›ä¿¡å·ã€‚Vivadoæ³¢å½¢å›¾çš„æ“ä½œæžå…¶éš¾ç”¨ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸ªç›¸å¯¹å¥½ç”¨çš„æ“ä½œï¼šå·¦é”®ä»Žå·¦å‘å³æ°´å¹³åˆ’ï¼Œä¼šç›´æŽ¥ç¼©æ”¾åˆ°é¼ æ ‡æ»‘è¿‡çš„è¿™ä¸€æ®µã€‚å³é”®é€‰æ‹©è¿›åˆ¶ç­‰æ“ä½œç•¥ã€‚&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623378896380.png"
width="1000"
height="757"
srcset="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623378896380_hue25177b2e4edfc44898f590de0dbab08_40422_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623378896380_hue25177b2e4edfc44898f590de0dbab08_40422_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="132"
data-flex-basis="317px"
>&lt;/p>
&lt;p>ä»¿çœŸéœ€è¦æ³¨æ„çš„é—®é¢˜ï¼š&lt;/p>
&lt;ul>
&lt;li>å¦‚æžœæ–‡ä»¶æ²¡é—®é¢˜ï¼Œæ¨¡å—è°ƒç”¨å±‚æ¬¡ä¼šè¢«è‡ªåŠ¨è§£æžä»Žè€Œå‘ˆçŽ°æˆä¸€æ£µæ ‘ï¼Œè€Œä¸æ˜¯å¥½å‡ ä¸ªé¡¶å±‚æ–‡ä»¶ã€‚&lt;/li>
&lt;li>æ³¨æ„set as topï¼Œåº”è¯¥è®¾ä¸ºæ ¹éƒ¨æ¨¡å—ï¼ˆè°ƒç”¨å…¶ä»–æ¨¡å—çš„ï¼‰å’Œtb
&lt;ul>
&lt;li>//å¦‚æžœè®¾é”™äº†å¯èƒ½åœ¨Implementationä¼šå‡ºçŽ°â€œç«¯å£æœªèµ‹åˆå€¼â€çš„æŠ¥é”™ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>ä¸­æ–‡ä¹±ç æ˜¯ç»å…¸å­—ç¬¦é›†é—®é¢˜ï¼Œæœ‰å¯èƒ½åœ¨æ¢è¡Œå¤„å¯¼è‡´è¯­æ³•é”™è¯¯ã€‚å»ºè®®ç»Ÿä¸€æ¢æˆutf-8ã€‚
&lt;ul>
&lt;li>ç®€å•è§£å†³æ–¹æ³•ï¼šä»Žvscodeé‡Œå¤åˆ¶ã€‚&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="å¼•å…¥ipæ ¸">å¼•å…¥IPæ ¸&lt;/h3>
&lt;p>å¯¹äºŽæµæ°´çº¿CPUï¼Œdata_ramå’Œinst_roméœ€è¦åŒæ­¥å†™ï¼Œè‡ªå·±å®žçŽ°æ¯”è¾ƒå¤æ‚ï¼Œæ•…ç›´æŽ¥å®žä¾‹åŒ–å°è£…å¥½çš„å†…å­˜å—IPã€‚å¦‚ä½•å¼•å…¥ï¼Ÿé¦–å…ˆè¯´æ˜Žå‡ ç§æ–‡ä»¶æ ¼å¼ï¼š&lt;/p>
&lt;ul>
&lt;li>.dcp åŽŸæ„ä¸ºcheckpointsæ–‡ä»¶ï¼Œæ˜¯ä¸€ç§åŠ å¯†åŽ‹ç¼©æ–‡ä»¶ã€‚ç”¨äºŽå°è£…æ¨¡å—æ–¹ä¾¿è°ƒç”¨ï¼Œä½†å¯¹ç‰ˆæœ¬è¦æ±‚æžå…¶æ•æ„Ÿã€‚&lt;/li>
&lt;li>.xci/.xcix IPæ ¸é…ç½®æ–‡ä»¶ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªxmlã€‚æ˜¯Vivadoåœ¨æ–°ç‰ˆæœ¬æå€¡ä½¿ç”¨xciè€Œä¸æ˜¯dcpã€‚&lt;/li>
&lt;li>.xdc ç®¡è„šçº¦æŸæ–‡ä»¶ã€‚åœ¨Implementationç”¨åˆ°ï¼Œæ­¤å¤„æŒ‰ä¸‹ä¸è¡¨ã€‚&lt;/li>
&lt;/ul>
&lt;p>è¿™å‡ ç§æ–‡ä»¶æ ¼å¼éƒ½æ˜¯å¯ä»¥ç›´æŽ¥Add Sourceæ·»åŠ è¿›æ¥çš„ã€‚å®žéªŒè€å¸ˆåŒæ—¶æä¾›dcpå’Œxciæ–‡ä»¶ï¼Œæ·»åŠ dcpå´©å±Žäº†ï¼ŒåŽŸå› ä¼°è®¡å¦‚ä¸Šã€‚æ·»åŠ xciä¹‹åŽï¼Œæç¤ºæˆ‘å°†IPæ›´æ–°ä¸ºcore cointainerçš„å½¢å¼&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623377228417.png"
width="669"
height="513"
srcset="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623377228417_hu3723a569f5da7a4a86a5166afb1cfa77_35011_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623377228417_hu3723a569f5da7a4a86a5166afb1cfa77_35011_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="130"
data-flex-basis="312px"
>&lt;/p>
&lt;p>æ›´æ–°å°±å®Œäº†ã€‚ç„¶åŽéœ€è¦ç­‰ä¸€ä¼šï¼ŒIPè¿˜è¦æ‰§è¡Œä¸€æ­¥synthï¼Œè¿™æ®µæ—¶é—´é‡ŒIPå±žäºŽé”ä½çš„çŠ¶æ€ï¼Œä¸èƒ½ä¿®æ”¹é…ç½®ã€‚&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623377562565.png"
width="429"
height="113"
srcset="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623377562565_hu20944bb791fcafc19453988e909e4c86_6875_480x0_resize_box_3.png 480w, https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623377562565_hu20944bb791fcafc19453988e909e4c86_6875_1024x0_resize_box_3.png 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="379"
data-flex-basis="911px"
>&lt;/p>
&lt;p>æ³¨æ„æ›´æ¢å™¨ä»¶åŽï¼ŒIPæ ¸éƒ½ä¼šé”ä½ã€‚è¿™è¡¨ç¤ºIPçš„é…ç½®å’Œå½“å‰çŽ¯å¢ƒä¸åŒ¹é…ã€‚å¯¹æ‰€æœ‰IPé”ä½çš„é—®é¢˜ï¼Œåªéœ€è¦ç‚¹å‡»èœå•æ Reportsâ†’Reports IP Statusï¼Œç„¶åŽç‚¹upgradeå³å¯è§£é™¤é”å®šã€‚&lt;/p>
&lt;h3 id="æˆ‘ç›´æŽ¥ä¸Šæ¿">æˆ‘ç›´æŽ¥ä¸Šæ¿&lt;/h3>
&lt;p>ç›´æŽ¥ç‚¹ç”Ÿæˆæ¯”ç‰¹æµï¼Œä¼šä¸€æ­¥æ­¥çš„æŒ‰å·¥ä½œæµå‘ä¸‹è¿è¡Œï¼Œç­‰å¾…å‡ åˆ†é’Ÿå°±èƒ½æ„‰å¿«çš„æ”¶èŽ·ä½ çš„æŠ¥é”™äº†ï¼&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379096063.jpg"
width="1440"
height="1080"
srcset="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379096063_hu89db98ea66f840c7603fe283c7e8a11b_471271_480x0_resize_q75_box.jpg 480w, https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379096063_hu89db98ea66f840c7603fe283c7e8a11b_471271_1024x0_resize_q75_box.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="133"
data-flex-basis="320px"
>&lt;/p>
&lt;p>åœ¨æŠŠä¸Šæ–‡æåˆ°çš„å‘éƒ½è¸©è¿‡ä¸€éä¹‹åŽï¼Œç»ˆäºŽæ²¡æœ‰critical warningï¼Œæ³ªç›®ã€‚&lt;/p>
&lt;p>ä½†æ˜¯æ­¤æ—¶å®žéªŒè¯¾å·²ç»ç»“æŸäº†ï¼ŒðŸ‘´å·æºœåˆ°æ²¡äººçš„å®žéªŒå®¤ï¼Œå¹¶ç•™ä¸‹ä»¥ä¸‹çè´µç”»é¢&lt;/p>
&lt;p>&lt;img src="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379266894.jpg"
width="2340"
height="1080"
srcset="https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379266894_hu51bb5a7a2a7c819eb623949b43a1f068_1273620_480x0_resize_q75_box.jpg 480w, https://lonelyuan.github.io/HugoBlog/HugoBlog/p/%E5%9F%BA%E4%BA%8Evivado%E7%9A%84%E5%9F%BA%E4%BA%8Efpga%E7%9A%84%E4%B8%80%E7%A7%8D%E5%9F%BA%E4%BA%8Emips%E7%9A%84%E4%B8%80%E7%A7%8D%E4%BA%94%E7%BA%A7%E6%B5%81%E6%B0%B4%E7%BA%BFcpu%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%B3%A8%E9%87%8A/1623379266894_hu51bb5a7a2a7c819eb623949b43a1f068_1273620_1024x0_resize_q75_box.jpg 1024w"
loading="lazy"
class="gallery-image"
data-flex-grow="216"
data-flex-basis="520px"
>&lt;/p>
&lt;p>ç„¶åŽðŸ‘´å‘çŽ°data_ramå†™å…¥å¤±è´¥ã€‚ä½†æ˜¯ðŸ‘´æ²¡æ—¶é—´æžäº†ï¼ŒðŸ‘´è¿˜æ˜¯æ»šåŽ»å¤ä¹ è¯¾æœ¬å§ã€‚&lt;/p>
&lt;h2 id="å¤šå‘¨æœŸæµæ°´çº¿cpuåŽŸç†">ðŸ—¿å¤šå‘¨æœŸæµæ°´çº¿CPUåŽŸç†&lt;/h2>
&lt;p>æœ€åŽï¼Œç»§ç»­å¤ä¹ è®¡ç»„ã€‚&lt;br>&lt;/p></description></item><item><title>CSAPP - Bomblab</title><link>https://lonelyuan.github.io/HugoBlog/p/csapp-bomblab/</link><pubDate>Thu, 27 Feb 2020 22:43:31 +0000</pubDate><guid>https://lonelyuan.github.io/HugoBlog/p/csapp-bomblab/</guid><description>&lt;h1 id="csappbomblab">CSAPPï¼šBomblab&lt;/h1>
&lt;p>é€†å‘çš„ä¼ ç»Ÿè‰ºèƒ½æ‹†ç‚¸å¼¹ï¼ŒðŸ‘´çš„é’æ˜¥å›žæ¥äº†ã€‚&lt;/p>
&lt;p>æ–‡ä»¶ç»“æž„ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">bomb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€ README
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€â”€ bomb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â””â”€â”€ bomb.c
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>åªæœ‰ä¸€ä¸ªç¨‹åºï¼Œç»™çš„æºç åŸºæœ¬æ²¡ç”¨ï¼Œæˆ‘ä»¬è¦ç”¨é€†å‘å·¥ç¨‹çš„æ–¹æ³•ç†è§£ç¨‹åºï¼Œæ‰¾åˆ°æ­£ç¡®çš„å­—ç¬¦ä¸²ã€‚&lt;/p>
&lt;p>è®²åæ±‡ç¼–å™¨çš„ç»“æžœå¯¼å‡ºï¼š&lt;code>objdump -d bomb &amp;gt; bomb.txt&lt;/code>&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°æœ‰6å…³ï¼Œæ¯ä¸€å…³æŽ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè‹¥è·³è½¬åˆ°explode_bombå‡½æ•°ï¼Œåˆ™ç­”æ¡ˆé”™è¯¯ã€‚&lt;/p>
&lt;h3 id="ç¬¬ä¸€å…³å­—ç¬¦ä¸²æ¯”è¾ƒ">ç¬¬ä¸€å…³ï¼šå­—ç¬¦ä¸²æ¯”è¾ƒ&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">0000000000400ee0 &amp;lt;phase_1&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ee0: 48 83 ec 08 sub $0x8,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ee4: be 00 24 40 00 mov $0x402400,%esi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ee9: e8 4a 04 00 00 callq 401338 &amp;lt;strings_not_equal&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>é€»è¾‘æ˜¯ç›´æŽ¥æ¯”è¾ƒå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œä¸è¿‡&lt;code>$0x402400&lt;/code>ä¸æ˜¯ç¨‹åºå†…åœ°å€ï¼Œè¯´æ˜Žç­”æ¡ˆè¢«è—åœ¨äº†æˆ‘ä»¬çœ‹ä¸åˆ°çš„å†…å­˜ä½ç½®ã€‚&lt;/p>
&lt;p>äºŽæ˜¯ä¸ŠGDBï¼Œåœ¨&amp;lt;phase_1&amp;gt;ä¸‹æ–­ç‚¹ï¼Œ&lt;code>stepi&lt;/code>å•æ­¥æ‰§è¡Œåˆ°callqä¹‹å‰ï¼ŒæŸ¥çœ‹å¯„å­˜å™¨:&lt;code>x\s $esi&lt;/code>ï¼Œå¾—åˆ°ç­”æ¡ˆã€‚ï¼ˆæ¯å°ç”µè„‘çš„ç­”æ¡ˆéƒ½ä¸ä¸€æ ·ï¼‰&lt;/p>
&lt;h3 id="ç¬¬äºŒå…³å¾ªçŽ¯">ç¬¬äºŒå…³ï¼šå¾ªçŽ¯&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">0000000000400efc &amp;lt;phase_2&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400efc: 55 push %rbp //åŽ‹æ ˆ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400efd: 53 push %rbx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400efe: 48 83 ec 28 sub $0x28,%rsp //å¼€è¾Ÿæ ˆå¸§
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f02: 48 89 e6 mov %rsp,%rsi//æ ˆé¡¶åœ°å€â†’rsiå‚æ•°äºŒ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f05: e8 52 05 00 00 callq 40145c &amp;lt;read_six_numbers&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¦‚å‡½æ•°åæ‰€ç¤ºï¼Œè¯»6ä¸ªæ•°å­—ï¼Œä¸ºä»€ä¹ˆæ˜¯6å‘¢ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºå­˜æ”¾å‚æ•°çš„å¯„å­˜å™¨æ€»å…±æœ‰6ä¸ªå§ã€‚ï¼ˆç„¶è€Œå¹¶ä¸ï¼‰&lt;/p>
&lt;p>å¯ä»¥çœ‹åˆ°è°ƒç”¨å‰å¼€è¾Ÿäº†0x28çš„æ ˆä¸Šç©ºé—´ï¼Œè¶³å¤Ÿå­˜æ”¾6ä¸ªæ•´æ•°ã€‚æ ˆé¡¶åœ°å€è¢«å­˜å…¥%rsiï¼Œä»¥æ­¤ä¼ é€’è¯¥åœ°å€ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">000000000040145c &amp;lt;read_six_numbers&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">//%rsi:çˆ¶è¿›ç¨‹&amp;lt;phase_2&amp;gt;çš„æ ˆé¡¶åœ°å€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40145c: 48 83 ec 18 sub $0x18,%rsp //æ ˆå¸§é•¿24
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401460: 48 89 f2 mov %rsi,%rdx //rsiâ†’å‚æ•°ä¸‰ï¼šnum1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401463: 48 8d 4e 04 lea 0x4(%rsi),%rcx //rsi+4â†’å‚æ•°å››ï¼šnum2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401467: 48 8d 46 14 lea 0x14(%rsi),%rax //rsi+20â†’rax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40146b: 48 89 44 24 08 mov %rax,0x8(%rsp) //raxâ†’æ ˆé¡¶+8ï¼šnum6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401470: 48 8d 46 10 lea 0x10(%rsi),%rax //rsi+16â†’rax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401474: 48 89 04 24 mov %rax,(%rsp) //raxâ†’æ ˆé¡¶ï¼šnum5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401478: 4c 8d 4e 0c lea 0xc(%rsi),%r9 //rsi+12â†’å‚æ•°å…­ï¼šnum4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40147c: 4c 8d 46 08 lea 0x8(%rsi),%r8 //rsi+8â†’å‚æ•°äº”ï¼šnum3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401480: be c3 25 40 00 mov $0x4025c3,%esi//0x4025c3:&amp;#34;%d %d %d %d %d %d&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401485: b8 00 00 00 00 mov $0x0,%eax //è¿”å›žå€¼èµ‹0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40148a: e8 61 f7 ff ff callq 400bf0 &amp;lt;__isoc99_sscanf@plt&amp;gt; //sscanf()
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40148f: 83 f8 05 cmp $0x5,%eax //è¿”å›žå€¼å’Œ5æ¯”è¾ƒï¼Œå³è¾“å…¥6ä¸ªå€¼æ‰èƒ½é€šè¿‡
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401492: 7f 05 jg 401499 &amp;lt;read_six_numbers+0x3d&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401494: e8 a1 ff ff ff callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401499: 48 83 c4 18 add $0x18,%rsp //å‡ºæ ˆ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40149d: c3 retq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>çœ‹&amp;lt;read_six_numbers&amp;gt;ï¼Œ%rsiä¸­çš„åœ°å€ä»¥4ä¸ºæ­¥é•¿è¢«åˆ†åˆ«å‚¨å­˜ã€‚çŒœæµ‹sscanfå‡½æ•°çš„è¿”å›žå€¼ä¸­ï¼Œç¬¬ä¸€ä¸ªè¡¨ç¤ºè¾“å…¥å‚æ•°çš„ä¸ªæ•°ï¼›ç¨‹åºè¦æ±‚6ä¸ªè¾“å…¥ï¼ŒåŠ ä¸Šrsiè¢«å ç”¨ï¼ŒäºŽæ˜¯å¤šçš„ä¸¤ä¸ªå­˜å…¥æ ˆä¸­ã€‚ä¸”sscanfå‡½æ•°çš„è¿”å›žå€¼æŒ‰å‚æ•°å¯„å­˜å™¨ï¼ˆå¤šçš„åœ°å€åœ¨æ ˆä¸Šï¼‰å­˜æ”¾çš„åœ°å€ä¼ è¾“ï¼Œå³è¾“å…¥å€¼è¢«æŒ‰é¡ºåºå­˜å…¥phase_2çš„æ ˆå¸§ä¸­ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> 400f0a: 83 3c 24 01 cmpl $0x1,(%rsp) //æ ˆé¡¶ä½ç½®å–åŒå­—å’Œ1æ¯”è¾ƒ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f0e: 74 20 je 400f30 &amp;lt;phase_2+0x34&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f10: e8 25 05 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f17: 8b 43 fc mov -0x4(%rbx),%eax //å¾ªçŽ¯å¤´ï¼šnum1â†’eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f1a: 01 c0 add %eax,%eax // eax*2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f1c: 39 03 cmp %eax,(%rbx) //å’Œnum2æ¯”è¾ƒ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f1e: 74 05 je 400f25 &amp;lt;phase_2+0x29&amp;gt; //ç›¸ç­‰æ‰é€šè¿‡
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f20: e8 15 05 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f25: 48 83 c3 04 add $0x4,%rbx //rbxå¢ž4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f29: 48 39 eb cmp %rbp,%rbx //rbxå’Œrsp+24æ¯”è¾ƒï¼Œç›¸ç­‰åˆ™è·³å‡º
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f2c: 75 e9 jne 400f17 &amp;lt;phase_2+0x1b&amp;gt; //å¾ªçŽ¯å°¾ï¼Œå¾ªçŽ¯å…±6è½®
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f2e: eb 0c jmp 400f3c &amp;lt;phase_2+0x40&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f30: 48 8d 5c 24 04 lea 0x4(%rsp),%rbx //num2åœ°å€â†’rbx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f35: 48 8d 6c 24 18 lea 0x18(%rsp),%rbp//rbxåœ°å€â†’rbp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f3a: eb db jmp 400f17 &amp;lt;phase_2+0x1b&amp;gt; //å¼€å§‹å¾ªçŽ¯
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è·³å‡º&amp;lt;read_six_numbers&amp;gt;åŽï¼Œé¦–å…ˆæ£€æŸ¥æ ˆé¡¶åœ°å€æŒ‡å‘çš„å€¼æ˜¯å¦ä¸º1ï¼Œå³ç¬¬ä¸€ä¸ªæ•°å­—æ˜¯1ã€‚&lt;/p>
&lt;p>ä¹‹åŽè¿›å…¥å¾ªçŽ¯ï¼Œå¾ªçŽ¯ä½“æ¯æ¬¡éƒ½ä¼šæŠŠå½“å‰æ•°å­—*2å’Œä¸‹ä¸€ä¸ªæ•°å­—æ¯”è¾ƒï¼Œå³æ¯ä¸ªæ•°å­—éƒ½æ˜¯å‰ä¸€ä¸ªçš„äºŒå€ï¼›%rbxä½œè®¡æ•°å˜é‡ï¼Œå…±å¾ªçŽ¯6æ¬¡ã€‚ç­”æ¡ˆå‘¼ä¹‹æ¬²å‡ºã€‚&lt;/p>
&lt;h3 id="ç¬¬ä¸‰å…³åˆ†æ”¯">ç¬¬ä¸‰å…³ï¼šåˆ†æ”¯&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">0000000000400f43 &amp;lt;phase_3&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f43: 48 83 ec 18 sub $0x18,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f47: 48 8d 4c 24 0c lea 0xc(%rsp),%rcx //rsp+12â†’rcx: mun2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f4c: 48 8d 54 24 08 lea 0x8(%rsp),%rdx //rsp+8â†’rdx: mun1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f51: be cf 25 40 00 mov $0x4025cf,%esi //0x4025cf: &amp;#34;%d %d&amp;#34;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f56: b8 00 00 00 00 mov $0x0,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f5b: e8 90 fc ff ff callq 400bf0 &amp;lt;__isoc99_sscanf@plt&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f60: 83 f8 01 cmp $0x1,%eax //ä¸å°‘äºŽä¸€ä¸ªè¾“å…¥
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f63: 7f 05 jg 400f6a &amp;lt;phase_3+0x27&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f65: e8 d0 04 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f6a: 83 7c 24 08 07 cmpl $0x7,0x8(%rsp) //
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f6f: 77 3c ja 400fad &amp;lt;phase_3+0x6a&amp;gt; //è¶…è¿‡7åˆ™çˆ†ç‚¸
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f71: 8b 44 24 08 mov 0x8(%rsp),%eax //å–num1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400f75: ff 24 c5 70 24 40 00 jmpq *0x402470(,%rax,8)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ­¤å¤„&lt;code>*&lt;/code>ç›¸å½“äºŽcä¸­çš„å–åœ°å€ç¬¦&lt;code>&amp;amp;&lt;/code>ï¼Œ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">400f7c: b8 cf 00 00 00 mov $0xcf,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400f81: eb 3b jmp 400fbe &amp;lt;phase_3+0x7b&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Â·Â·Â·Â·Â·Â·
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¿™é‡Œæœ‰7æ®µå½¢å¼é‡å¤çš„ä»£ç ï¼Œç»“åˆç¬¬ä¸€ä¸ªæ•°å­—ä¸èƒ½å¤§äºŽ7ï¼ŒçŒœæµ‹è¿™é‡Œæ˜¯switchåž‹ç»“æž„ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">400fad: e8 88 04 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fb2: b8 00 00 00 00 mov $0x0,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fb7: eb 05 jmp 400fbe &amp;lt;phase_3+0x7b&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fb9: b8 37 01 00 00 mov $0x137,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fbe: 3b 44 24 0c cmp 0xc(%rsp),%eax //æ¯”è¾ƒnum2å’Œeax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fc2: 74 05 je 400fc9 &amp;lt;phase_3+0x86&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fc4: e8 71 04 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fc9: 48 83 c4 18 add $0x18,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">400fcd: c3 retq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç¬¬äºŒä¸ªæ•°å­—æ˜¯%eaxçš„å€¼ï¼Œç”±ç¬¬ä¸€ä¸ªæ•°å†³å®šã€‚æ•…ç­”æ¡ˆæœ‰7ä¸ªã€‚&lt;/p>
&lt;h3 id="ç¬¬å››å…³é€’å½’">ç¬¬å››å…³ï¼šé€’å½’&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">000000000040100c &amp;lt;phase_4&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">......
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401029: 83 f8 02 cmp $0x2,%eax //åªèƒ½æœ‰2å‚æ•°
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40102c: 75 07 jne 401035 &amp;lt;phase_4+0x29&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40102e: 83 7c 24 08 0e cmpl $0xe,0x8(%rsp) //0 &amp;lt;= num1 &amp;lt;= 14
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401033: 76 05 jbe 40103a &amp;lt;phase_4+0x2e&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401035: e8 00 04 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40103a: ba 0e 00 00 00 mov $0xe,%edx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40103f: be 00 00 00 00 mov $0x0,%esi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401044: 8b 7c 24 08 mov 0x8(%rsp),%edi //num1â†’edi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401048: e8 81 ff ff ff callq 400fce &amp;lt;func4&amp;gt; //
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¾“å…¥è§„åˆ™å’Œä¸Šä¸€å…³ä¸€æ ·ï¼Œç¬¬ä¸€ä¸ªæ•°éœ€åœ¨0åˆ°14ä¹‹é—´ï¼ˆcmplåªèƒ½ç”¨äºŽæ— ç¬¦å·æ•°ï¼Ÿï¼‰&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">0000000000400fce &amp;lt;func4&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">//é¦–æ¬¡è°ƒç”¨æ—¶ï¼š%eax:0x2 %ebx:0 %ecx:0 %edx:0xe %esi:0x0 %edi:num1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fce: 48 83 ec 08 sub $0x8,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fd2: 89 d0 mov %edx,%eax //eax:14
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fd4: 29 f0 sub %esi,%eax //eax:14-0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fd6: 89 c1 mov %eax,%ecx //ecx:14
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fd8: c1 e9 1f shr $0x1f,%ecx //ecx:0 //é€»è¾‘å³ç§»31ï¼Œå³å–ç¬¦å·ä½ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fdb: 01 c8 add %ecx,%eax //eax:14+0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fdd: d1 f8 sar %eax //ç®—æœ¯å³ç§»1ä½ï¼Ÿeax:14/2=7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fdf: 8d 0c 30 lea (%rax,%rsi,1),%ecx //ecx:7+0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fe2: 39 f9 cmp %edi,%ecx //æ¯”è¾ƒnum1å’Œ7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fe4: 7e 0c jle 400ff2 &amp;lt;func4+0x24&amp;gt; //ä¸å¤§äºŽâ†’r17
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fe6: 8d 51 ff lea -0x1(%rcx),%edx //edx:ecx-1=6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fe9: e8 e0 ff ff ff callq 400fce &amp;lt;func4&amp;gt; //é€’å½’â†’r3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400fee: 01 c0 add %eax,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ff0: eb 15 jmp 401007 &amp;lt;func4+0x39&amp;gt; //è·³å‡º
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ff2: b8 00 00 00 00 mov $0x0,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ff7: 39 f9 cmp %edi,%ecx //æ¯”è¾ƒnum1å’Œ7
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ff9: 7d 0c jge 401007 &amp;lt;func4+0x39&amp;gt; //ä¸å°äºŽ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ffb: 8d 71 01 lea 0x1(%rcx),%esi //esi:ecx+1=8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 400ffe: e8 cb ff ff ff callq 400fce &amp;lt;func4&amp;gt; //é€’å½’â†’r3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401003: 8d 44 00 01 lea 0x1(%rax,%rax,1),%eax //eax=2*eax+1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401007: 48 83 c4 08 add $0x8,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40100b: c3 retq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å‰é¢ä¸€é€šç®—æœ¯æ“ä½œï¼ŒåŽé¢è®¾è®¡äº†é€’å½’ã€‚&lt;/p>
&lt;p>è¿™é‡Œä¸€æ­¥ç§»ä½æ“ä½œçœ‹èµ·æ¥åƒæ˜¯å–ç¬¦å·ä½ï¼Œä½†æ˜¯è¾“å…¥ä¸€å®šå¤§äºŽ0ï¼Œç¬¦å·ä½æ˜¯0ï¼Œæ‰€ä»¥è¿™ä¸ªæ“ä½œæ„ä¹‰ä½•åœ¨ï¼Ÿ&lt;/p>
&lt;p>äººè‚‰IDAèµ°èµ·ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">fun4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">num1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">s&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num1&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nf">fun4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">a&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num1&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nf">fun4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">fun4&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">14&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç¬¬ä¸€ä¸ªæ•°è®¾ä¸º7å¯é¿å…é€’å½’è°ƒç”¨ï¼Œä½†è¿”å›žå€¼ä¸æ˜¯0ï¼Œä¸ç¬¦åˆã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">40104d: 85 c0 test %eax,%eax //eax=0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">40104f: 75 07 jne 401058 &amp;lt;phase_4+0x4c&amp;gt;//ä¸ç­‰äºŽ0çˆ†ç‚¸
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">401051: 83 7c 24 0c 00 cmpl $0x0,0xc(%rsp) //mun2å’Œ0æ¯”è¾ƒï¼Ÿ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">401056: 74 05 je 40105d &amp;lt;phase_4+0x51&amp;gt;//ä¸ç­‰äºŽ0çˆ†ç‚¸
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">401058: e8 dd 03 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">40105d: 48 83 c4 18 add $0x18,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">401061: c3 retq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>çœ‹åˆ°&lt;func4>çš„è¿”å›žå€¼å’Œnum2çš†éœ€ä¸º0ï¼Œåˆ™num2ç¡®å®šã€‚&lt;/p>
&lt;p>å¤§ä¸äº†çˆ†ç ´å‘—ï¼Œç´¢æ€§è¯•äº†1æ¬¡å°±æˆäº†ã€‚emm&lt;/p>
&lt;p>ã€åŽé¢ä¸‰å…³æ–½å·¥ä¸­ã€‚ã€‚ã€‚ã€‘&lt;/p>
&lt;h3 id="ç¬¬äº”å…³">ç¬¬äº”å…³&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">0000000000401062 &amp;lt;phase_5&amp;gt;:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401062: 53 push %rbx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401063: 48 83 ec 20 sub $0x20,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401067: 48 89 fb mov %rdi,%rbx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40106a: 64 48 8b 04 25 28 00 mov %fs:0x28,%rax //???
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401073: 48 89 44 24 18 mov %rax,0x18(%rsp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401078: 31 c0 xor %eax,%eax //eax:0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40107a: e8 9c 02 00 00 callq 40131b &amp;lt;string_length&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40107f: 83 f8 06 cmp $0x6,%eax //è¾“å…¥é•¿åº¦ä¸º6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401082: 74 4e je 4010d2 &amp;lt;phase_5+0x70&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401084: e8 b1 03 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401089: eb 47 jmp 4010d2 &amp;lt;phase_5+0x70&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40108b: 0f b6 0c 03 movzbl (%rbx,%rax,1),%ecx //å¾ªçŽ¯å¤´ã€‚æ–°æŒ‡ä»¤
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40108f: 88 0c 24 mov %cl,(%rsp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401092: 48 8b 14 24 mov (%rsp),%rdx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401096: 83 e2 0f and $0xf,%edx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 401099: 0f b6 92 b0 24 40 00 movzbl 0x4024b0(%rdx),%edx //ï¼Ÿï¼Ÿï¼Ÿ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010a0: 88 54 04 10 mov %dl,0x10(%rsp,%rax,1)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010a4: 48 83 c0 01 add $0x1,%rax //è®¡æ•°å˜é‡rax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010a8: 48 83 f8 06 cmp $0x6,%rax //å¾ªçŽ¯6è½®
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010ac: 75 dd jne 40108b &amp;lt;phase_5+0x29&amp;gt; //å¾ªçŽ¯å°¾
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010ae: c6 44 24 16 00 movb $0x0,0x16(%rsp)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010b3: be 5e 24 40 00 mov $0x40245e,%esi //ï¼Ÿï¼Ÿ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010b8: 48 8d 7c 24 10 lea 0x10(%rsp),%rdi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010bd: e8 76 02 00 00 callq 401338 &amp;lt;strings_not_equal&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010c2: 85 c0 test %eax,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010c4: 74 13 je 4010d9 &amp;lt;phase_5+0x77&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010c6: e8 6f 03 00 00 callq 40143a &amp;lt;explode_bomb&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010cb: 0f 1f 44 00 00 nopl 0x0(%rax,%rax,1) //ï¼Ÿï¼Ÿï¼Ÿ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010d0: eb 07 jmp 4010d9 &amp;lt;phase_5+0x77&amp;gt;//è·³å‡º
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010d2: b8 00 00 00 00 mov $0x0,%eax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010d7: eb b2 jmp 40108b &amp;lt;phase_5+0x29&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010d9: 48 8b 44 24 18 mov 0x18(%rsp),%rax
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010de: 64 48 33 04 25 28 00 xor %fs:0x28,%rax //ï¼Ÿï¼Ÿï¼Ÿ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010e7: 74 05 je 4010ee &amp;lt;phase_5+0x8c&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010e9: e8 42 fa ff ff callq 400b30 &amp;lt;__stack_chk_fail@plt&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010ee: 48 83 c4 20 add $0x20,%rsp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010f2: 5b pop %rbx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 4010f3: c3 retq
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ç¬¬å…­å…³">ç¬¬å…­å…³&lt;/h3>
&lt;h3 id="éšè—å…³">éšè—å…³&lt;/h3>
&lt;p>éšè—å…³è—åœ¨æ¯ä¸€å…³çš„åŽé¢ï¼Œ&lt;/p>
&lt;h2 id="gdbä½¿ç”¨">GDBä½¿ç”¨ï¼š&lt;/h2>
&lt;p>åŸºç¡€ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">q : quit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">h : help
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">file prog//åŠ è½½ç¨‹åºï¼Œä¹Ÿå¯ä½œä¸ºgdbå‘½ä»¤çš„å‚æ•°
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">r : run
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">k : kill
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ–­ç‚¹ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">b : breakpoints break
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - func_name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - *0x400522
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - &amp;amp;var
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - main.c:100//æºä»£ç æ–­ç‚¹ï¼Œè¿è¡Œå‰å³å¯
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - if con//æ¡ä»¶æ–­ç‚¹
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">w : watch //è§‚å¯Ÿå¯¹è±¡å˜åŒ–æ—¶æ–­ç‚¹
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">d : delete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - b n
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">disable b n
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ‰§è¡Œï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">c : continue
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">f : finish
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">stepi n
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nexti
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">set args ./a.txt //ä»Žæ–‡ä»¶è¯»å–è¾“å…¥
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ£€æŸ¥ä»£ç ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">disas //å±•ç¤ºæ±‡ç¼–
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - funcname
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - 0x400000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">list
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">edit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ£€æŸ¥æ•°æ®ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">x : examine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">p : print
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">æ ¼å¼æŽ§åˆ¶ï¼š/[n][f][u]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - n:å†…å­˜å•å…ƒä¸ªæ•°
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - f:æ˜¾ç¤ºæ ¼å¼ï¼š
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - x(hex) æŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - d(decimal) æŒ‰åè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - u(unsigned decimal) æŒ‰åè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºæ— ç¬¦å·æ•´åž‹ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - o(octal) æŒ‰å…«è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - t(binary) æŒ‰äºŒè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - a(address) æŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - c(char) æŒ‰å­—ç¬¦æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - f(float) æŒ‰æµ®ç‚¹æ•°æ ¼å¼æ˜¾ç¤ºå˜é‡
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - u:å•å…ƒé•¿åº¦ï¼ˆæŒ‰å­—èŠ‚ï¼‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">i : info
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - r : registers
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - b [n]
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - $rsp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¡¨è¾¾å¼ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å †æ ˆï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">bt : backtrace//æ˜¾ç¤ºå †æ ˆ
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>CSAPP - Datalab</title><link>https://lonelyuan.github.io/HugoBlog/p/csapp-datalab/</link><pubDate>Tue, 21 Jan 2020 00:00:03 +0000</pubDate><guid>https://lonelyuan.github.io/HugoBlog/p/csapp-datalab/</guid><description>&lt;p>ç¬¬ä¸€ä¸ªlabï¼Œå…³äºŽä½è¿ç®—ã€‚é€šè¿‡å—é™åˆ¶çš„cè¯­è¨€ç¼–ç¨‹å®žçŽ°å‡½æ•°åŠŸèƒ½ã€‚è¿™äº›å‡½æ•°éƒ½æ˜¯éžå¸¸åŸºæœ¬çš„åŠŸèƒ½ï¼Œæ­£å¦‚ä¹¦åã€ŠCS:APPã€‹æ‰€ç¤ºï¼Œå¯å‘æˆ‘ä»¬ä»Žç¨‹åºå‘˜è§†è§’ç†è§£è®¡ç®—æœºçš„æ·±å±‚æ›´æ·±å±‚ã€‚&lt;/p>
&lt;p>READMEä¸­è¯´æ˜Žäº†é¡¹ç›®ç»“æž„ã€‚ç›´æŽ¥è¯»&lt;code>bits.c&lt;/code>ï¼Œåªéœ€è¦å¡«å……å…¶ä¸­çš„å‡½æ•°ã€‚æ¯æ¬¡æµ‹è¯•ç¨‹åºéƒ½è¦å…ˆmakeä¸€ä¸‹ã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt"> 10
&lt;/span>&lt;span class="lnt"> 11
&lt;/span>&lt;span class="lnt"> 12
&lt;/span>&lt;span class="lnt"> 13
&lt;/span>&lt;span class="lnt"> 14
&lt;/span>&lt;span class="lnt"> 15
&lt;/span>&lt;span class="lnt"> 16
&lt;/span>&lt;span class="lnt"> 17
&lt;/span>&lt;span class="lnt"> 18
&lt;/span>&lt;span class="lnt"> 19
&lt;/span>&lt;span class="lnt"> 20
&lt;/span>&lt;span class="lnt"> 21
&lt;/span>&lt;span class="lnt"> 22
&lt;/span>&lt;span class="lnt"> 23
&lt;/span>&lt;span class="lnt"> 24
&lt;/span>&lt;span class="lnt"> 25
&lt;/span>&lt;span class="lnt"> 26
&lt;/span>&lt;span class="lnt"> 27
&lt;/span>&lt;span class="lnt"> 28
&lt;/span>&lt;span class="lnt"> 29
&lt;/span>&lt;span class="lnt"> 30
&lt;/span>&lt;span class="lnt"> 31
&lt;/span>&lt;span class="lnt"> 32
&lt;/span>&lt;span class="lnt"> 33
&lt;/span>&lt;span class="lnt"> 34
&lt;/span>&lt;span class="lnt"> 35
&lt;/span>&lt;span class="lnt"> 36
&lt;/span>&lt;span class="lnt"> 37
&lt;/span>&lt;span class="lnt"> 38
&lt;/span>&lt;span class="lnt"> 39
&lt;/span>&lt;span class="lnt"> 40
&lt;/span>&lt;span class="lnt"> 41
&lt;/span>&lt;span class="lnt"> 42
&lt;/span>&lt;span class="lnt"> 43
&lt;/span>&lt;span class="lnt"> 44
&lt;/span>&lt;span class="lnt"> 45
&lt;/span>&lt;span class="lnt"> 46
&lt;/span>&lt;span class="lnt"> 47
&lt;/span>&lt;span class="lnt"> 48
&lt;/span>&lt;span class="lnt"> 49
&lt;/span>&lt;span class="lnt"> 50
&lt;/span>&lt;span class="lnt"> 51
&lt;/span>&lt;span class="lnt"> 52
&lt;/span>&lt;span class="lnt"> 53
&lt;/span>&lt;span class="lnt"> 54
&lt;/span>&lt;span class="lnt"> 55
&lt;/span>&lt;span class="lnt"> 56
&lt;/span>&lt;span class="lnt"> 57
&lt;/span>&lt;span class="lnt"> 58
&lt;/span>&lt;span class="lnt"> 59
&lt;/span>&lt;span class="lnt"> 60
&lt;/span>&lt;span class="lnt"> 61
&lt;/span>&lt;span class="lnt"> 62
&lt;/span>&lt;span class="lnt"> 63
&lt;/span>&lt;span class="lnt"> 64
&lt;/span>&lt;span class="lnt"> 65
&lt;/span>&lt;span class="lnt"> 66
&lt;/span>&lt;span class="lnt"> 67
&lt;/span>&lt;span class="lnt"> 68
&lt;/span>&lt;span class="lnt"> 69
&lt;/span>&lt;span class="lnt"> 70
&lt;/span>&lt;span class="lnt"> 71
&lt;/span>&lt;span class="lnt"> 72
&lt;/span>&lt;span class="lnt"> 73
&lt;/span>&lt;span class="lnt"> 74
&lt;/span>&lt;span class="lnt"> 75
&lt;/span>&lt;span class="lnt"> 76
&lt;/span>&lt;span class="lnt"> 77
&lt;/span>&lt;span class="lnt"> 78
&lt;/span>&lt;span class="lnt"> 79
&lt;/span>&lt;span class="lnt"> 80
&lt;/span>&lt;span class="lnt"> 81
&lt;/span>&lt;span class="lnt"> 82
&lt;/span>&lt;span class="lnt"> 83
&lt;/span>&lt;span class="lnt"> 84
&lt;/span>&lt;span class="lnt"> 85
&lt;/span>&lt;span class="lnt"> 86
&lt;/span>&lt;span class="lnt"> 87
&lt;/span>&lt;span class="lnt"> 88
&lt;/span>&lt;span class="lnt"> 89
&lt;/span>&lt;span class="lnt"> 90
&lt;/span>&lt;span class="lnt"> 91
&lt;/span>&lt;span class="lnt"> 92
&lt;/span>&lt;span class="lnt"> 93
&lt;/span>&lt;span class="lnt"> 94
&lt;/span>&lt;span class="lnt"> 95
&lt;/span>&lt;span class="lnt"> 96
&lt;/span>&lt;span class="lnt"> 97
&lt;/span>&lt;span class="lnt"> 98
&lt;/span>&lt;span class="lnt"> 99
&lt;/span>&lt;span class="lnt">100
&lt;/span>&lt;span class="lnt">101
&lt;/span>&lt;span class="lnt">102
&lt;/span>&lt;span class="lnt">103
&lt;/span>&lt;span class="lnt">104
&lt;/span>&lt;span class="lnt">105
&lt;/span>&lt;span class="lnt">106
&lt;/span>&lt;span class="lnt">107
&lt;/span>&lt;span class="lnt">108
&lt;/span>&lt;span class="lnt">109
&lt;/span>&lt;span class="lnt">110
&lt;/span>&lt;span class="lnt">111
&lt;/span>&lt;span class="lnt">112
&lt;/span>&lt;span class="lnt">113
&lt;/span>&lt;span class="lnt">114
&lt;/span>&lt;span class="lnt">115
&lt;/span>&lt;span class="lnt">116
&lt;/span>&lt;span class="lnt">117
&lt;/span>&lt;span class="lnt">118
&lt;/span>&lt;span class="lnt">119
&lt;/span>&lt;span class="lnt">120
&lt;/span>&lt;span class="lnt">121
&lt;/span>&lt;span class="lnt">122
&lt;/span>&lt;span class="lnt">123
&lt;/span>&lt;span class="lnt">124
&lt;/span>&lt;span class="lnt">125
&lt;/span>&lt;span class="lnt">126
&lt;/span>&lt;span class="lnt">127
&lt;/span>&lt;span class="lnt">128
&lt;/span>&lt;span class="lnt">129
&lt;/span>&lt;span class="lnt">130
&lt;/span>&lt;span class="lnt">131
&lt;/span>&lt;span class="lnt">132
&lt;/span>&lt;span class="lnt">133
&lt;/span>&lt;span class="lnt">134
&lt;/span>&lt;span class="lnt">135
&lt;/span>&lt;span class="lnt">136
&lt;/span>&lt;span class="lnt">137
&lt;/span>&lt;span class="lnt">138
&lt;/span>&lt;span class="lnt">139
&lt;/span>&lt;span class="lnt">140
&lt;/span>&lt;span class="lnt">141
&lt;/span>&lt;span class="lnt">142
&lt;/span>&lt;span class="lnt">143
&lt;/span>&lt;span class="lnt">144
&lt;/span>&lt;span class="lnt">145
&lt;/span>&lt;span class="lnt">146
&lt;/span>&lt;span class="lnt">147
&lt;/span>&lt;span class="lnt">148
&lt;/span>&lt;span class="lnt">149
&lt;/span>&lt;span class="lnt">150
&lt;/span>&lt;span class="lnt">151
&lt;/span>&lt;span class="lnt">152
&lt;/span>&lt;span class="lnt">153
&lt;/span>&lt;span class="lnt">154
&lt;/span>&lt;span class="lnt">155
&lt;/span>&lt;span class="lnt">156
&lt;/span>&lt;span class="lnt">157
&lt;/span>&lt;span class="lnt">158
&lt;/span>&lt;span class="lnt">159
&lt;/span>&lt;span class="lnt">160
&lt;/span>&lt;span class="lnt">161
&lt;/span>&lt;span class="lnt">162
&lt;/span>&lt;span class="lnt">163
&lt;/span>&lt;span class="lnt">164
&lt;/span>&lt;span class="lnt">165
&lt;/span>&lt;span class="lnt">166
&lt;/span>&lt;span class="lnt">167
&lt;/span>&lt;span class="lnt">168
&lt;/span>&lt;span class="lnt">169
&lt;/span>&lt;span class="lnt">170
&lt;/span>&lt;span class="lnt">171
&lt;/span>&lt;span class="lnt">172
&lt;/span>&lt;span class="lnt">173
&lt;/span>&lt;span class="lnt">174
&lt;/span>&lt;span class="lnt">175
&lt;/span>&lt;span class="lnt">176
&lt;/span>&lt;span class="lnt">177
&lt;/span>&lt;span class="lnt">178
&lt;/span>&lt;span class="lnt">179
&lt;/span>&lt;span class="lnt">180
&lt;/span>&lt;span class="lnt">181
&lt;/span>&lt;span class="lnt">182
&lt;/span>&lt;span class="lnt">183
&lt;/span>&lt;span class="lnt">184
&lt;/span>&lt;span class="lnt">185
&lt;/span>&lt;span class="lnt">186
&lt;/span>&lt;span class="lnt">187
&lt;/span>&lt;span class="lnt">188
&lt;/span>&lt;span class="lnt">189
&lt;/span>&lt;span class="lnt">190
&lt;/span>&lt;span class="lnt">191
&lt;/span>&lt;span class="lnt">192
&lt;/span>&lt;span class="lnt">193
&lt;/span>&lt;span class="lnt">194
&lt;/span>&lt;span class="lnt">195
&lt;/span>&lt;span class="lnt">196
&lt;/span>&lt;span class="lnt">197
&lt;/span>&lt;span class="lnt">198
&lt;/span>&lt;span class="lnt">199
&lt;/span>&lt;span class="lnt">200
&lt;/span>&lt;span class="lnt">201
&lt;/span>&lt;span class="lnt">202
&lt;/span>&lt;span class="lnt">203
&lt;/span>&lt;span class="lnt">204
&lt;/span>&lt;span class="lnt">205
&lt;/span>&lt;span class="lnt">206
&lt;/span>&lt;span class="lnt">207
&lt;/span>&lt;span class="lnt">208
&lt;/span>&lt;span class="lnt">209
&lt;/span>&lt;span class="lnt">210
&lt;/span>&lt;span class="lnt">211
&lt;/span>&lt;span class="lnt">212
&lt;/span>&lt;span class="lnt">213
&lt;/span>&lt;span class="lnt">214
&lt;/span>&lt;span class="lnt">215
&lt;/span>&lt;span class="lnt">216
&lt;/span>&lt;span class="lnt">217
&lt;/span>&lt;span class="lnt">218
&lt;/span>&lt;span class="lnt">219
&lt;/span>&lt;span class="lnt">220
&lt;/span>&lt;span class="lnt">221
&lt;/span>&lt;span class="lnt">222
&lt;/span>&lt;span class="lnt">223
&lt;/span>&lt;span class="lnt">224
&lt;/span>&lt;span class="lnt">225
&lt;/span>&lt;span class="lnt">226
&lt;/span>&lt;span class="lnt">227
&lt;/span>&lt;span class="lnt">228
&lt;/span>&lt;span class="lnt">229
&lt;/span>&lt;span class="lnt">230
&lt;/span>&lt;span class="lnt">231
&lt;/span>&lt;span class="lnt">232
&lt;/span>&lt;span class="lnt">233
&lt;/span>&lt;span class="lnt">234
&lt;/span>&lt;span class="lnt">235
&lt;/span>&lt;span class="lnt">236
&lt;/span>&lt;span class="lnt">237
&lt;/span>&lt;span class="lnt">238
&lt;/span>&lt;span class="lnt">239
&lt;/span>&lt;span class="lnt">240
&lt;/span>&lt;span class="lnt">241
&lt;/span>&lt;span class="lnt">242
&lt;/span>&lt;span class="lnt">243
&lt;/span>&lt;span class="lnt">244
&lt;/span>&lt;span class="lnt">245
&lt;/span>&lt;span class="lnt">246
&lt;/span>&lt;span class="lnt">247
&lt;/span>&lt;span class="lnt">248
&lt;/span>&lt;span class="lnt">249
&lt;/span>&lt;span class="lnt">250
&lt;/span>&lt;span class="lnt">251
&lt;/span>&lt;span class="lnt">252
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * bitXor - x^y using only ~ and &amp;amp;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Example: bitXor(4, 5) = 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ~ &amp;amp;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 14
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">bitXor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// x^y
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// = (~x&amp;amp;y)|(x&amp;amp;~y) // å¼‚æˆ–å…¬å¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// = ~(~(~x&amp;amp;y)&amp;amp;~(x&amp;amp;~y)) // å¾·æ‘©æ ¹å¾‹ï¼Œops: 8
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// = ~((x|~y)&amp;amp;(~x|y)) // å¾·æ‘©æ ¹å¾‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// = ~(x&amp;amp;~x|x&amp;amp;y|y&amp;amp;~y|~x&amp;amp;~y) // åˆ†é…å¾‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// = ~(x&amp;amp;y|~x&amp;amp;~y) // å¸æ”¶çŽ‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;amp;~&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;amp;~&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// å¾·æ‘©æ ¹å¾‹ï¼Œops: 7
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * tmin - return minimum two&amp;#39;s complement integer
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">tmin&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">void&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// For negative numbers: complement = inverse + 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">31&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// tmin=0x80, tmax=0x7f
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ä¸ºä»€ä¹ˆæ˜¯è¡¥ç ï¼Ÿ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ä¸ºäº†æ–¹ä¾¿è®¡ç®—æœºå¤„ç†ï¼Œæˆ‘ä»¬å¸Œæœ›è´Ÿæ•°å’Œå…¶ç›¸åæ•°ç›¸åŠ ä¹‹åŽè‡ªç„¶çš„æº¢å‡ºå¾—0ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// x+~x=1, å†åŠ 1åˆ™æº¢å‡ºå¾—0ã€‚å› æ­¤è¡¥ç =åç +1ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// åŒæ—¶ç¬¦å·ä½å¤©ç„¶çš„è•´å«åœ¨æœ€é«˜ä½ä¸Šï¼Œè¿™æœ‰è®¸å¤šå¥½å¤„ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å…¶ä¸€æ˜¯æ­£æ•°çš„è¡¨çŽ°å’Œæ— ç¬¦å·æ•´æ•°ä¸€è‡´ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å…¶äºŒæ˜¯ç”±äºŽï¼‹0å’Œ-0ä¸€è‡´ï¼Œç›¸æ¯”æ˜¾å¼ç¬¦å·ä½èƒ½å¤šè¡¨ç¤ºä¸€ä¸ªæ•°å­—ï¼ŒèŒƒå›´æ˜¯[-2^(n-1),2^(n-1)-1]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * isTmax - returns 1 if x is the maximum, two&amp;#39;s complement number,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * and 0 otherwise
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | +
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 10
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">isTmax&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ! é€»è¾‘å–åï¼Œä»…å…¨0è¿”å›ž1ï¼Œå…¶ä½™æƒ…å†µéƒ½è¿”å›ž0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ~ æŒ‰ä½å–å
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// è¡¥ç ç›¸åæ•° = åç  + 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ä¸¤ä¸ªç‰¹ä¾‹ï¼š~tmin+1=tmin; ~0+1=0. ç›¸åæ•°ä¸ºè‡ªèº«
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å¾—åˆ°å‡ ä¸ªå‡½æ•°ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// negate(x) (~x+1) // å–ç›¸åæ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// iszero(x) (!!x) // ä»…å½“!!0=0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// equal(x,y) !(x^y) // åˆ¤æ–­ç›¸ç­‰
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ~tmax=tmin, è½¬æ¢ä¸ºç­›é€‰tminå’Œ0xff
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å› æ­¤ç­”æ¡ˆä¸º equal(~x,negate(~x)) &amp;amp; iszero(~x)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!!~&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// ops: 8
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * allOddBits - return 1 if all odd-numbered bits in word set to 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * where bits are numbered from 0 (least significant) to 31 (most significant)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Examples allOddBits(0xFFFFFFFD) = 0, allOddBits(0xAAAAAAAA) = 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 12
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">allOddBits&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æŽ©ç : x &amp;amp; 0b1111, ç»“æžœç›¸å½“äºŽåªå–äº†xçš„åŽ4ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å¥‡æ•°ä½å…¨ä¸º1ï¼Œä½¿ç”¨æŽ©ç 0xAAAAAAAAæå–å¥‡æ•°ä½ï¼Œå†ä½¿ç”¨equal(x,0xAAAAAAAA)åˆ¤æ–­å³å¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">mask&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0xAA&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mask&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">mask&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mask&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="n">mask&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">16&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">mask&lt;/span> &lt;span class="o">^&lt;/span> &lt;span class="n">mask&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// ops: 7
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * negate - return -x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Example: negate(1) = -1.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 5
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">negate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * isAsciiDigit - return 1 if 0x30 &amp;lt;= x &amp;lt;= 0x39 (ASCII codes for characters &amp;#39;0&amp;#39; to &amp;#39;9&amp;#39;)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Example: isAsciiDigit(0x35) = 1.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * isAsciiDigit(0x3a) = 0.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * isAsciiDigit(0x05) = 0.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 15
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">isAsciiDigit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// x &amp;gt; y
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// =&amp;gt; x+(~y+1) &amp;gt; 0 // x+(-y)&amp;gt;0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// =&amp;gt; !(x+(~y+1) &amp;gt;&amp;gt; 31) // ä½¿ç”¨ç¬¦å·ä½åˆ¤æ–­&amp;gt;0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å¾—åˆ°æ¯”è¾ƒå‡½æ•°ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// gpos(x, y) !(x+(~y+1) &amp;gt;&amp;gt; 31)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å¸¦å…¥å³å¯ !((0x39 + ~x+1)&amp;gt;&amp;gt;31) &amp;amp; !((x + ~0x30+1)&amp;gt;&amp;gt;31) // ops: 11
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mh">0x3A&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="o">~&lt;/span>&lt;span class="mh">0x30&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// ops: 10
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * conditional - same as x ? y : z
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Example: conditional(2,4,5) = 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 16
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">conditional&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">z&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// æˆ–è¿ç®—ä¸¤ä¾§ä¸åŒæ—¶ä¸º1å³å¯æž„æˆæ¡ä»¶åˆ¤æ–­ï¼Œä½¿ç”¨æŽ©ç æŽ§åˆ¶è¾“å‡ºå†…å®¹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// é”™è¯¯åšæ³•ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// int mask = x &amp;gt;&amp;gt; 31; // ç®—æ•°å³ç§»å–ç¬¦å·ä½å¡«å……å…¨éƒ¨ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// x ? y : z å¯¹xæ˜¯é€»è¾‘åˆ¤æ–­ä¸æ˜¯ç®—æœ¯åˆ¤æ–­
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">mask&lt;/span>&lt;span class="o">=&lt;/span> &lt;span class="o">~!&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// ä»…0è¿”å›ž1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="n">mask&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">|&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mask&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">z&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="c1">// ops: 7
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * isLessOrEqual - if x &amp;lt;= y then return 1, else return 0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Example: isLessOrEqual(4,5) = 1.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 24
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 3
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">isLessOrEqual&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">y&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// gpos(x, y) åœ¨è·¨ç¬¦å·çš„æƒ…å†µä¸‹å¤±çµï¼Œå¢žåŠ ä¸¤ç§æƒ…å†µåˆ¤æ–­:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// 1. x=yï¼šè¿”å›ž1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// 2. xå’Œyä¸åŒç¬¦å·ï¼šxä¸ºè´Ÿæ—¶ä¸€å®šå°äºŽï¼Œè¿”å›ž1ï¼Œxç¬¦å·ä½ä¹Ÿæ˜¯1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// å› æ­¤ç­”æ¡ˆä¸º equal(signx,signy) ? (gpos(y,x) | equal(x,y)) : signx
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">signx&lt;/span>&lt;span class="o">=!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">signy&lt;/span>&lt;span class="o">=!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">mask&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">signx&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="n">signy&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="n">mask&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span>&lt;span class="p">)))&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">mask&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">signx&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// ops: 19
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * logicalNeg - implement the ! operator, using all of
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * the legal operators except !
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Examples: logicalNeg(3) = 0, logicalNeg(0) = 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 12
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">logicalNeg&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ä»…0è¿”å›ž1ï¼Œå…¶ä½™è¿”å›ž0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// è¿˜æ˜¯å€ŸåŠ©ä¸¤ä¸ªç‰¹ä¾‹ï¼š~tmin+1=tmin; ~0+1=0. ç›¸åæ•°ä¸ºè‡ªèº«
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ç­”æ¡ˆä¸º equal(x,~x+1) &amp;amp; !equal(x,tmin)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// !(x^0) &amp;amp; !!(x^(1&amp;lt;&amp;lt;31))
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="o">!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">&amp;lt;&amp;lt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="p">)));&lt;/span> &lt;span class="c1">// ops: 6
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/* howManyBits - return the minimum number of bits required to represent x in
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * two&amp;#39;s complement
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Examples: howManyBits(12) = 5 // [-16,15]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * howManyBits(298) = 10 // [-512,511]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * howManyBits(-5) = 4 // [-8,7]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * howManyBits(0) = 1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * howManyBits(-1) = 1 // [-1,0]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * howManyBits(0x80000000) = 32
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: ! ~ &amp;amp; ^ | + &amp;lt;&amp;lt; &amp;gt;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 90
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">howManyBits&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è´Ÿæ•°å–åï¼Œç»Ÿä¸€å¤„ç†
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// x&amp;gt;&amp;gt;31 ? ~x:x = x&amp;gt;&amp;gt;31 &amp;amp; ~x | ~(x&amp;gt;&amp;gt;31) &amp;amp; x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">31&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ä½å®½å–å†³äºŽæœ€é«˜ä½ï¼Œé—®é¢˜è½¬åŒ–ä¸ºå¯»æ‰¾æœ€é«˜ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// 90ä¸ªæ“ä½œç¬¦ä¸è¶³ä»¥éåŽ†32ä¸ªä½ï¼Œå› æ­¤éœ€è¦ä¼˜åŒ–æœç´¢ç®—æ³•ï¼Œå¦‚äºŒåˆ†ã€‚
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// !!(x&amp;gt;&amp;gt;16) åˆ¤æ–­xçš„é«˜16ä½æ˜¯å¦å­˜åœ¨1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">b16&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">16&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// è‹¥å­˜åœ¨ï¼Œè‡³å°‘éœ€è¦16ä½ï¼Œå› æ­¤b16èµ‹å€¼ä¸º16æˆ–0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">b16&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// é€šè¿‡ç§»ä½å®žçŽ°äºŒåˆ†æœç´¢ï¼š
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// è‹¥é«˜ä½å­˜åœ¨åˆ™èˆå¼ƒä½Žä½ï¼Œé«˜ä½å…¨0åˆ™åˆ¤æ–­ä½Žä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">b8&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">8&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">b8&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">b4&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">b4&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">b2&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">b2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">b1&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">!!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="n">b1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">b16&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">b8&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">b4&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">b2&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">b1&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">//float
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * floatScale2 - Return bit-level equivalent of expression 2*f for
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * floating point argument f.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Both the argument and result are passed as unsigned int&amp;#39;s, but
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * they are to be interpreted as the bit-level representation of
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * single-precision floating point values.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * When argument is NaN, return argument
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: Any integer/unsigned operations incl. ||, &amp;amp;&amp;amp;. also if, while
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 30
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">unsigned&lt;/span> &lt;span class="nf">floatScale2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="n">uf&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">uf&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">31&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">exp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">uf&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x7f800000&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">frac&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">uf&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="mh">0xff800000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">exp&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="n">frac&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// éžè§„æ ¼æ•°ä¹˜2å³å¯
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">exp&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">255&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="n">uf&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// ç‰¹æ®Šå€¼ç›´æŽ¥è¿”å›ž
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="n">exp&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">exp&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">255&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mh">0x7f800000&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">s&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// ä¹˜æ³•ä¸å¯èƒ½å¾—åˆ°NaNï¼Œæ‰€ä»¥è¿”å›žæ— ç©·
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">exp&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="n">frac&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * floatFloat2Int - Return bit-level equivalent of expression (int) f
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * for floating point argument f.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Argument is passed as unsigned int, but
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * it is to be interpreted as the bit-level representation of a
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * single-precision floating point value.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Anything out of range (including NaN and infinity) should return
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * 0x80000000u.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: Any integer/unsigned operations incl. ||, &amp;amp;&amp;amp;. also if, while
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 30
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">floatFloat2Int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">unsigned&lt;/span> &lt;span class="n">uf&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">s&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">uf&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">31&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">exp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">uf&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="mh">0x7f800000&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">frac&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">uf&lt;/span> &lt;span class="o">&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">~&lt;/span>&lt;span class="mh">0xff800000&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">E&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">exp&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">127&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">exp&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">255&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="n">E&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">31&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mh">0x80000000&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// ç‰¹æ®Šå€¼
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">E&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// å°æ•°èˆå…¥ä¸º0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kt">unsigned&lt;/span> &lt;span class="n">M&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">frac&lt;/span> &lt;span class="o">|&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// 1 + frac
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">V&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">E&lt;/span> &lt;span class="o">&amp;gt;&lt;/span> &lt;span class="mi">23&lt;/span> &lt;span class="o">?&lt;/span> &lt;span class="n">M&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">E&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="n">M&lt;/span> &lt;span class="o">&amp;gt;&amp;gt;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="mi">23&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">E&lt;/span>&lt;span class="p">));&lt;/span> &lt;span class="c1">// Må·²ç»è¢«å·¦ç§»äº†23ä½
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">s&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">V&lt;/span> &lt;span class="o">*=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// è´Ÿæ•°
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="n">V&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * floatPower2 - Return bit-level equivalent of the expression 2.0^x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * (2.0 raised to the power x) for any 32-bit integer x.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> *
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * The unsigned value that is returned should have the identical bit
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * representation as the single-precision floating-point number 2.0^x.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * If the result is too small to be represented as a denorm, return
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * 0. If too large, return +INF.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> *
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Legal ops: Any integer/unsigned operations incl. ||, &amp;amp;&amp;amp;. Also if, while
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Max ops: 30
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> * Rating: 4
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kt">unsigned&lt;/span> &lt;span class="nf">floatPower2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// V = (-1)^s * M * 2^E
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// E = e-127 Eâˆˆ[-126,127]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// s=0,f=0, xå¸¦å…¥Eå³å¯å¾—åˆ° 2^x
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// ä¸ºæ­¤ï¼Œåæ¼”ä»ŽEæ±‚eçš„è¿‡ç¨‹
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;=&lt;/span> &lt;span class="mi">128&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mh">0x7f800000&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// +INF
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">126&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">127&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="mi">23&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// [-126,127]: 2^xä¸ºè§„æ ¼æ•°, f=1.0, e=x+127
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">&amp;gt;=&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">150&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="o">&amp;lt;&amp;lt;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">150&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="c1">// [-150,-125]: 2^xä¸ºéžè§„æ ¼æ•°, f=2^(x+150), e=0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1">// too small
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å¤ªå²å…¬æ›°ï¼šå‰é¢å‡ ä¸ªè€ƒå¯Ÿintçš„é¢˜ç›®å±‚å±‚æ·±å…¥ï¼Œä»ŽæŽ©ç æ€æƒ³åˆ°æ¡ä»¶åˆ¤æ–­ï¼Œæ¯ä¸ªæ–°é¢˜ç›®éƒ½å¯ä»¥ç”¨åˆ°å‰é¢é¢˜ç›®çš„æ€è·¯ã€‚åªæœ‰howManyBitséœ€è¦æƒ³åˆ°å¦‚ä½•ç”¨ç§»ä½æž„é€ è¿­ä»£ï¼Œæœ‰ä¸€å®šçš„éš¾åº¦ã€‚ç›¸æ¯”è€Œè¨€æœ€åŽçš„æµ®ç‚¹æ•°é¢˜ç›®ç”±äºŽæ”¾å¼€äº†è¯¸å¤šé™åˆ¶ï¼Œå˜æˆäº†ä¸€èˆ¬çš„ç¼–ç¨‹é¢˜ï¼Œåªéœ€è¦ç†Ÿç»ƒæŽŒæ¡æµ®ç‚¹æ•°è§„åˆ™å³å¯ä½œç­”ã€‚&lt;/p></description></item><item><title>æ·±åº¦å­¦ä¹ å…¥é—¨â€”â€”jetbotæ™ºèƒ½å°è½¦å°é²œï¼ˆäºŒï¼‰</title><link>https://lonelyuan.github.io/HugoBlog/p/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8jetbot%E6%99%BA%E8%83%BD%E5%B0%8F%E8%BD%A6%E5%B0%9D%E9%B2%9C%E4%BA%8C/</link><pubDate>Tue, 01 Oct 2019 00:26:38 +0000</pubDate><guid>https://lonelyuan.github.io/HugoBlog/p/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8jetbot%E6%99%BA%E8%83%BD%E5%B0%8F%E8%BD%A6%E5%B0%9D%E9%B2%9C%E4%BA%8C/</guid><description>&lt;p>é‚£ä¸ªç”·å­©ä¸æƒ³çŽ©äººå·¥æ™ºèƒ½å‘¢ï¼Ÿåœ¨çŽ„å­¦ä¿®bugä¹‹åŽï¼Œæˆ‘ç»ˆäºŽè·‘é€šäº†jetbotè‡ªå¸¦çš„æ·±åº¦å­¦ä¹ demoã€‚&lt;/p>
&lt;p>æ€Žæ ·æ‰èƒ½è®©aiç¨‹åºå‘æŒ¥å¥½çš„æ•ˆæžœå‘¢ï¼Ÿä¼—æ‰€å‘¨çŸ¥ï¼Œæ‰€è°“äººå·¥æ™ºèƒ½ï¼Œæœ‰å¤šå°‘äººå·¥å°±æœ‰å¤šæ™ºèƒ½ã€‚&lt;/p>
&lt;p>AIçš„å‘å±•ç¦»ä¸å¼€ä¸‰ä¸ªè¦ç´ ï¼š&lt;strong>ç®—åŠ›&lt;/strong>ï¼Œ&lt;strong>ç®—æ³•&lt;/strong>å’Œ&lt;strong>ç®—æ&lt;/strong>ã€‚æ ¹æ®æ‘©å°”å®šå¾‹ï¼Œç®—åŠ›çš„å‘å±•æ˜¯ä¸ä¼šåœæ»žçš„ï¼ˆè™½ç„¶å®šå¾‹å¿«å¤±æ•ˆäº†ï¼‰ï¼›è¿›å‡ å¹´æ¥çš„AIçƒ­æ­£æ˜¯ç®—æ³•çš„çªç ´ï¼Œå³æ·±åº¦å­¦ä¹ ç›¸å…³ç®—æ³•çš„çªé£žçŒ›è¿›ï¼›è€Œç®—æå°±æ˜¯ç”¨æ¥è®­ç»ƒæ¨¡åž‹çš„æ•°æ®ï¼Œæœªæ¥å‡ å¹´AIåº”ç”¨çš„è¿›ä¸€æ­¥è½åœ°ç¦»ä¸å¼€ç®—æçš„è¿›ä¸€æ­¥å¼€å‘ï¼ˆä¸­å›½åœ¨AIæ–¹é¢çš„æœ€å¤§ä¼˜åŠ¿æ­£åœ¨äºŽæ­¤ï¼‰ã€‚æ•°æ®é›†çš„ä¸°å¯Œç¨‹åº¦å’Œæœ‰æ•ˆç¨‹åº¦ç›´æŽ¥å½±å“äº†AIåº”ç”¨çš„æ•ˆæžœï¼Œæˆ‘å°†åœ¨ä¸‹æ–‡è¯¦ç»†è¯´æ˜Žã€‚&lt;/p>
&lt;p>åœ¨jetboté¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿèƒ½ä½“éªŒåˆ°ç”¨â€œäººå·¥â€æ¢â€œæ™ºèƒ½â€çš„å¿«ä¹ã€‚ä½œä¸ºè§†è§‰è¯†åˆ«ç±»çš„AIåº”ç”¨ï¼Œæˆ‘ä»¬è¦åœ¨é¢„è®¾çŽ¯å¢ƒé‡Œåˆ›å»ºæ•°æ®é›†ï¼Œå¹¶ä¸ºå…¶æ ‡æ³¨ã€‚æœ‰äº†æ•°æ®é›†ï¼Œjetbotæ­è½½çš„NVIDIAç‰ŒGPUåœ¨æ–¹å¯¸ä¹‹é—´å°±èƒ½å®Œæˆæµ·é‡è®¡ç®—ï¼Œä»…ç”¨ä¸€é¢—æ‘„åƒå¤´å°±èƒ½å®žçŽ°è‡ªåŠ¨é¿éšœï¼Œç›®æ ‡è¿½è¸ªï¼Œè‡ªåŠ¨å·¡çº¿ç­‰ç­‰ç‚«é…·åŠŸèƒ½ï¼ä¸è¦1999ï¼Œä¹Ÿä¸è¦999ï¼Œåªè¦99ï¼99åˆ€NVIDIAè®¡ç®—å¡å¸¦å›žå®¶ï¼ï¼ˆå¦®ç»´é›…æ‰“é’±ï¼‰&lt;/p>
&lt;blockquote>
&lt;p>ç»™èŒæ–°ç†æ¸…å‡ ä¸ªæ¦‚å¿µï¼š&lt;/p>
&lt;p>äººå·¥æ™ºèƒ½ï¼Œæœºå™¨å­¦ä¹ ï¼Œæ·±åº¦å­¦ä¹ çš„å…³ç³»ï¼š&lt;/p>
&lt;ul>
&lt;li>æ·±åº¦å­¦ä¹ ï¼šä¸€ç§å®žçŽ°æœºå™¨å­¦ä¹ çš„æŠ€æœ¯ï¼›æœºå™¨å­¦ä¹ ï¼šä¸€ç§å®žçŽ°äººå·¥æ™ºèƒ½çš„æ–¹æ³•&lt;/li>
&lt;li>ã€åŒ…å«å…³ç³»å›¾ã€‘&lt;/li>
&lt;/ul>
&lt;p>AIçš„å‘å±•è·¯å¾„ï¼š&lt;/p>
&lt;ul>
&lt;li>å¼±AIï¼šå•ç‹¬é¢†åŸŸå·¥ä½œæ•ˆçŽ‡è¶…è¿‡äººç±»â†’&lt;/li>
&lt;li>é€šç”¨AIï¼šå¯ä»¥å¹¿æ³›åº”ç”¨äºŽå¤§éƒ¨åˆ†é¢†åŸŸâ†’&lt;/li>
&lt;li>å¼ºAIï¼šæœ‰è‡ªä¸»æ„è¯†ï¼Œå³å°†ç­ç»äººç±»ï¼ˆä¸æ˜¯ï¼‰â†’&lt;/li>
&lt;/ul>
&lt;p>çŽ°åœ¨AIå‘å±•åˆ°ä»€ä¹ˆåœ°æ­¥äº†ï¼šå¼±AIï¼Œæœ‰ç”Ÿä¹‹å¹´å¯èƒ½è§åˆ°é€šç”¨AI&lt;/p>
&lt;/blockquote>
&lt;p>æŽ¨èä¸€æ³¢æ±‰åŒ–çš„å¾ˆå¥½çš„wikiï¼Œä¹Ÿæœ‰è‡ªå·±åŽŸåˆ›çš„å†…å®¹ï¼šhttp://www.waveshare.net/wiki/JetBot_AI_Kit&lt;/p>
&lt;p>æœ¬ç¯‡è¯¦ç»†ä»‹ç»ä¸¤ä¸ªdemoçš„ä»£ç å’Œå¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼Œæœ€åŽé™„ä¸Šç¥žç»ç½‘ç»œçš„å…¥é—¨ç¬”è®°ã€‚åŒæ ·æ˜¯åˆæ¬¡æŽ¥è§¦ï¼Œå¤§ä½¬è¯·ç»•é“ã€‚&lt;/p>
&lt;h3 id="demo1è‡ªåŠ¨é¿éšœ">demo1ï¼šè‡ªåŠ¨é¿éšœ&lt;/h3>
&lt;p>å°è½¦å¦‚ä½•å®žçŽ°è‡ªåŠ¨é¿éšœçš„å‘¢ï¼Ÿç”¨é€šä¿—çš„ä¸èƒ½å†é€šä¿—çš„è¯´æ³•ï¼ŒAIç¨‹åºé€šè¿‡å­¦ä¹ ä½ ç»™ä»–çš„æ•°æ®é›†ï¼ŒçŸ¥é“äº†ä»€ä¹ˆæ ·çš„å›¾åƒæ˜¯æ­»è·¯ï¼Œä»€ä¹ˆæ ·çš„å›¾åƒæ˜¯é€šè·¯ã€‚å¾—åˆ°æ–°å›¾åƒæ—¶å°±èƒ½åˆ¤æ–­æ˜¯æ­»è·¯çš„æ¦‚çŽ‡æœ‰å¤šå°‘ï¼Œåœ¨ç¨‹åºé‡Œå¯ä»¥å¾ˆç®€å•çš„çœ‹å‡ºï¼Œå½“è¿™ä¸ªæ¦‚çŽ‡å¤§äºŽ0.5çš„æ—¶å€™å°±è§¦å‘å°è½¦è½¬å‘ã€‚&lt;/p>
&lt;p>å…·ä½“è€Œè¨€ï¼Œä½ è¦åœ¨ä½ çš„çŽ¯å¢ƒé‡Œæ‹è‡³å°‘200å¼ ç…§ç‰‡ï¼Œ100å¼ æ ‡è®°ä¸ºé€šè·¯ï¼ˆfreeï¼‰ï¼Œ100å¼ æ ‡è®°ä¸ºæ­»è·¯ï¼ˆblockedï¼‰ã€‚è¿™ä¾¿æ˜¯ä½ çš„æ•°æ®é›†ï¼ˆdatasetï¼‰ã€‚æž„å»ºæ•°æ®é›†çš„æ—¶å€™å°½é‡åˆ†æ•£åœ¨çŽ¯å¢ƒçš„å„ä¸ªä½ç½®å’Œå„ä¸ªæ–¹å‘ï¼Œå¯ä»¥æ²¿è¾¹ç•ŒçŽ¯ç»•ä¸€åœˆï¼Œèµ°ä¸€æ®µè·ç¦»åœä¸‹ï¼Œè½¬ä¸€åœˆï¼Œæ”¶é›†8-10å¼ å›¾ç‰‡ã€‚åæ­£ä½ çš„æ•°æ®è¶Šå¤šï¼Œæ ‡è®°çš„è¶Šå‡†ç¡®ï¼Œæ¨¡åž‹æ•ˆæžœè¶Šå¥½ã€‚&lt;/p>
&lt;p>ä¸‹ä¸€æ­¥å°±å¼€å§‹è®­ç»ƒæ¨¡åž‹äº†ï¼Œä»Žä»£ç é‡Œçœ‹å‡ºï¼Œè¿™ä¸ªdemoä½¿ç”¨AlexNetæ¨¡åž‹ï¼Œç”¨pytorchå®žçŽ°ï¼ˆåºŸè¯ï¼‰ã€‚ç¬¬ä¸€æ¬¡è¿è¡Œä½ ä¼šä¸‹è½½ä¸€ä¸ª244Må·¦å³çš„å¤§æ–‡ä»¶ï¼Œåœ¨&lt;code>/home/jetbot/.torch/models&lt;/code>ç›®å½•ä¸‹ä¼šçœ‹åˆ°è¿™ä¸ª.pthæ–‡ä»¶ã€‚è¿™ä¾¿æ˜¯AlexNetäº†ã€‚&lt;/p>
&lt;p>ç»§ç»­è¿è¡Œç¨‹åºï¼Œå®Œæ•´çš„è¾“å‡ºç»“æžœæœ‰ä¸‰åè¡Œï¼Œæ¯è¡ŒåŽé¢çš„å°æ•°ä»£è¡¨å½“å‰æ¨¡åž‹çš„å‡†ç¡®åº¦ï¼ˆï¼Ÿï¼‰ï¼Œç¨‹åºæœ€åŽä¼šä»Žè¿™30ä¸ªæ¨¡åž‹ä¸­é€‰å–å‡†ç¡®åº¦æœ€é«˜çš„ä½œä¸ºæœ€ç»ˆæ¨¡åž‹ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªpthæ–‡ä»¶ï¼š&lt;code>best_model.pth&lt;/code>&lt;/p>
&lt;p>ä¸‹è½½æ–‡ä»¶å’Œè®­ç»ƒæ¨¡åž‹éƒ½éœ€è¦èŠ±æŒºé•¿æ—¶é—´ï¼Œçœ‹åˆ°kernel busyï¼Œä¹Ÿå°±æ˜¯å³ä¸Šè§’çš„å¤§é»‘ç‚¹ä¸è¦è½»æ˜“æ‰“æ–­ã€‚&lt;/p>
&lt;p>ä»€ä¹ˆæ˜¯æ¨¡åž‹å‘¢ï¼Ÿç¨å¾®è§£é‡Šä¸€ä¸‹æœºå™¨å­¦ä¹ çš„æ¦‚å¿µã€‚&lt;/p>
&lt;p>æ¨¡åž‹å°±æ˜¯å‡½æ•°ï¼Œå…¶è¦ç´ ä¸ºè¾“å…¥ï¼Œè¾“å‡ºï¼Œå’Œå˜æ¢å…³ç³»ã€‚ä¸¾ä¾‹è¯´æ˜Žï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>æ¨¡åž‹&lt;/th>
&lt;th>è¾“å…¥&lt;/th>
&lt;th>è¾“å‡º&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>ç»†èŒå‘å…»åˆ†ç§»åŠ¨&lt;/td>
&lt;td>å¤–ç•ŒçŽ¯å¢ƒçš„åŒ–å­¦ä¿¡å·&lt;/td>
&lt;td>å‚¬åŠ¨éž­æ¯›çš„ç”µä¿¡å·&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>å­¦ç”Ÿå‚åŠ é«˜è€ƒ&lt;/td>
&lt;td>è¯•å·åå°„çš„å…‰ä¿¡å·&lt;/td>
&lt;td>è¯•å·ä¸Šé—®é¢˜çš„ç­”æ¡ˆ&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>å°è½¦è‡ªåŠ¨é¿éšœ&lt;/td>
&lt;td>æ‘„åƒå¤´ä¼ è¾“å›¾åƒä¿¡å·&lt;/td>
&lt;td>å‰æ–¹è¢«å µå¡žçš„æ¦‚çŽ‡&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>å®žé™…ä¸Šï¼ŒçŸ¥è¯†çš„æœ¬è´¨ä¹Ÿæ˜¯å‡½æ•°ï¼Œç”Ÿå‘½å»¶ç»­çš„å…³é”®å°±åœ¨äºŽè¯¥ç”Ÿå‘½çš„æ¨¡åž‹æ˜¯å¦é€‚åº”çŽ¯å¢ƒã€‚è¿™é‡Œä¸æ·±å…¥è§£é‡Šäº†ï¼Œè§‰å¾—æƒŠå¥‡è¯·å‚é˜…Yjangoçš„é¢‘é“https://space.bilibili.com/344849038ä»–ç”¨æœºå™¨å­¦ä¹ çš„è§’åº¦è§£é‡Šç”Ÿç‰©è¿›åŒ–ï¼Œéžå¸¸é¢ è¦†ä¸‰è§‚ã€‚&lt;/p>
&lt;p>æ€»ä¹‹è®­ç»ƒå‡ºæ¥çš„æ¨¡åž‹å°±æ˜¯è¿™æ ·ä¸€ä¸ªå‡½æ•°ã€‚å…¶è¾“å…¥ä¸ºç»è¿‡å¤„ç†çš„æ‘„åƒå¤´çš„å›¾å½¢ä¿¡å·ï¼Œè¾“å‡ºä¸€ä¸ª0-1çš„æ•°ï¼Œè¶ŠæŽ¥è¿‘1è¶Šæ„å‘³ç€æ¨¡åž‹è®¤ä¸ºå°è½¦è¦æ’žå¢™äº†ã€‚ä½†æ˜¯å½“ä»–å¤§äºŽ0.5çš„æ—¶å€™å°±ä¼šè§¦å‘è½¬å‘ï¼Œä¹Ÿå°±å®žçŽ°äº†è‡ªåŠ¨é¿éšœã€‚&lt;/p>
&lt;blockquote>
&lt;p>AlexNetæ˜¯2012å¹´æå‡ºçš„ä¸€ç§å·ç§¯ç¥žç»ç½‘ç»œï¼ˆå³CNNï¼‰ç®—æ³•ã€‚é¦–æ¬¡å®žçŽ°gpuåŠ é€Ÿã€‚&lt;/p>
&lt;p>ä¸»æµæ·±åº¦å­¦ä¹ æ¡†æž¶ï¼šTensorFlowï¼›PyTorchï¼›Keras&lt;/p>
&lt;/blockquote>
&lt;p>è¿˜æŒºå¥½çŽ©çš„ðŸ˜€&lt;/p>
&lt;h3 id="demo2ç›®æ ‡è¿½è¸ª">demo2ï¼šç›®æ ‡è¿½è¸ª&lt;/h3>
&lt;p>åŸºäºŽä¸Šä¸€ä¸ªdemoï¼Œæˆ‘ä»¬è¿˜è¦ä¸‹è½½ä¸€ä¸ªæ¨¡åž‹ï¼Œ&lt;a class="link" href="http://cocodataset.org/#home" target="_blank" rel="noopener"
>cocoæ•°æ®é›†&lt;/a>ç¥žç»ç½‘ç»œï¼Œå¯ä»¥æ£€æµ‹90ç§ä¸åŒçš„ç‰©ä½“ã€‚æŒ‰æ•™ç¨‹æŠŠ.engineæ–‡ä»¶ä¸‹è½½åˆ°æŒ‡å®šä½ç½®ï¼Œé¡ºç€è·‘å°±å®Œäº‹äº†ã€‚ï¼ˆå¼•å…¥æ¨¡åž‹ä¹Ÿè¦èŠ±æŒºé•¿æ—¶é—´ï¼‰&lt;/p>
&lt;p>å¦‚æžœæœ‰æ•°æ®é›†é‡Œçš„ç‰©å“ï¼Œä»Žè¾“å‡ºé‡Œèƒ½çœ‹åˆ°è“æ¡†æ ‡å‡ºï¼Œå°è½¦ä¼šè‡ªåŠ¨è½¬å‘ç‰©ä½“ï¼ŒåŒæ—¶è¿˜ä¿ç•™äº†è‡ªåŠ¨é¿éšœçš„ç¨‹åºã€‚&lt;/p>
&lt;p>é‡åˆ°bugï¼šç¨‹åºä»…èƒ½è¯»å–ä¸€å¼ å›¾åƒè¿›è¡Œè¯†åˆ«ï¼Œæ‘„åƒå¤´æ›´æ–°çš„åŠŸèƒ½æ— æ³•æ‰§è¡Œã€‚&lt;/p>
&lt;h3 id="ä¿®bugæ‘„åƒå¤´é—®é¢˜">ä¿®bugï¼šæ‘„åƒå¤´é—®é¢˜&lt;/h3>
&lt;p>æè¿°ï¼šæ‘„åƒå¤´åªè¦è°ƒç”¨äº†ä¸€æ¬¡ï¼ŒåŽé¢å°±æ— æ³•åœ¨å…¶ä»–åœ°æ–¹è°ƒç”¨ã€‚ç›´æŽ¥åœ¨jupyterä¸Šå…³é—­è¾“å‡ºå¹¶æ²¡æœ‰ä½œç”¨ã€‚è€Œä¸”åªè¦åœ¨ä¸€ä¸ªnotebooké‡Œå°±èƒ½é‡å¤è°ƒç”¨ï¼Œæ¢ä¸€ä¸ªå°±ä¸è¡Œã€‚è€Œä¸”å¹¶æ²¡æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œç¨‹åºä¸€ç›´å¤„åœ¨busyçŠ¶æ€ã€‚&lt;/p>
&lt;p>æ‰¾åˆ°æºç ï¼Œåœ¨jetbot/jetbot/camera.pyï¼Œä½†æ˜¯æ‰€æœ‰æ ·ä¾‹é‡Œé¢è°ƒç”¨æ‘„åƒå¤´éƒ½æ˜¯ç”¨çš„Camera.instance()æ–¹æ³•ï¼Œè€Œè¿™ä¸ªinstanceæ˜¯åœ¨traitletsåº“é‡Œçš„ï¼ŒäºŽæ˜¯æ‰¾åˆ°trailetså®˜æ–¹æ–‡æ¡£&lt;/p>
&lt;blockquote>
&lt;p>Traitletsæ˜¯ä¸€ä¸ªçº¯ python åº“ï¼Œæ”¯æŒï¼š&lt;/p>
&lt;ul>
&lt;li>å¯¹ python å¯¹è±¡å±žæ€§çš„å¼ºç±»åž‹å®žæ–½( ç±»åž‹å±žæ€§ç§°ä¸º &amp;ldquo;ç‰¹å¾&amp;rdquo; ) ï¼›&lt;/li>
&lt;li>åŠ¨æ€è®¡ç®—çš„é»˜è®¤å€¼ï¼›&lt;/li>
&lt;li>å½“å°è¯•æ”¹å˜æ—¶ï¼Œè‡ªåŠ¨éªŒè¯å’Œå¼ºåˆ¶ç‰¹å¾å±žæ€§ï¼›&lt;/li>
&lt;li>å½“ç‰¹å¾å€¼æ”¹å˜æ—¶æ³¨å†ŒæŽ¥æ”¶é€šçŸ¥ï¼›&lt;/li>
&lt;li>ä»Žæ–‡ä»¶æˆ–è€… å‘½ä»¤è¡Œ å‚æ•°ä¸­è¯»å–å€¼- åœ¨traitletsä¸Šä¸åŒå±‚ï¼Œå› è¿™é‡Œå¯ä»¥åœ¨æ²¡æœ‰é…ç½®æœºå™¨çš„æƒ…å†µä¸‹ä½¿ç”¨ traitletsã€‚&lt;/li>
&lt;/ul>
&lt;p>Traitletsæ”¯æŒIPythonå’ŒJupyterçš„é…ç½®ç³»ç»Ÿï¼Œä»¥åŠIPythonäº¤äº’å°éƒ¨ä»¶çš„å£°æ˜Žæ€§ APIã€‚&lt;/p>
&lt;p>ipythonæ˜¯ä¸€ä¸ª python çš„äº¤äº’å¼ shellï¼Œæ¯”é»˜è®¤çš„python shell å¥½ç”¨å¾—å¤šï¼Œæ”¯æŒå˜é‡è‡ªåŠ¨è¡¥å…¨ï¼Œè‡ªåŠ¨ç¼©è¿›ï¼Œæ”¯æŒ bash shell å‘½ä»¤ï¼Œå†…ç½®äº†è®¸å¤šå¾ˆæœ‰ç”¨çš„åŠŸèƒ½å’Œå‡½æ•°ã€‚å…¶ä¸­å°±åŒ…æ‹¬traitletsåº“ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a class="link" href="https://traitlets.readthedocs.io/en/stable/config.html" target="_blank" rel="noopener"
>https://traitlets.readthedocs.io/en/stable/config.html&lt;/a> åœ¨è¿™é‡Œæ‰¾åˆ°instanceçš„åŠŸèƒ½ï¼šè¿”å›žçŽ°æœ‰çš„ç±»ï¼Œå¦‚æžœæ²¡æœ‰å°±æ–°å»ºä¸€ä¸ªã€‚&lt;/p>
&lt;p>ä¸‹é¢æ˜¯æ ·ä¾‹ä¸­è°ƒç”¨æ‘„åƒå¤´çš„ä»£ç ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">ipywidgets.widgets&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="nn">widgets&lt;/span> &lt;span class="c1">#å›¾åƒæ¨¡å—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">IPython.display&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">display&lt;/span> &lt;span class="c1">#ipyçš„æ˜¾ç¤ºæ¨¡å—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">traitlets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">jetbot&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Camera&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">bgr8_to_jpeg&lt;/span> &lt;span class="c1">#æ‘„åƒå¤´é©±åŠ¨ï¼Œå›¾åƒæ ¼å¼è½¬æ¢&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">camera&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Camera&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">instance&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">width&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">500&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">height&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">500&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#åˆå§‹åŒ–æ‘„åƒå¤´å¯¹è±¡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">image&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">widgets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Image&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">format&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;jpeg&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">width&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">400&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">height&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">400&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#åˆ›å»ºå›¾åƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">camera_link&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">traitlets&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">dlink&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">camera&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;value&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">image&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;value&amp;#39;&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">transform&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">bgr8_to_jpeg&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#è¿žæŽ¥æ‘„åƒå¤´åˆ°å›¾åƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">display&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">image&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#æ˜¾ç¤ºå›¾åƒ&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>å°è¯•ä»Žcamera.pyé‡Œè°ƒç”¨åŽŸå§‹apiã€‚å¾—åˆ°æŠ¥é”™ï¼š&lt;code>Each object must be HasTraits, not &amp;lt;class 'NoneType'&amp;gt;&lt;/code>ï¼Œæ˜¯è¯´å¿…é¡»ä¸ºå¯¹è±¡æŒ‡å®šç±»åž‹ã€‚é‚£ä¹ˆHasTraitsè¿™ä¸ªç±»åž‹æ˜¯å•¥ï¼Ÿæ–‡æ¡£è¯´:ä»»ä½•å…·æœ‰traitå±žæ€§çš„ç±»éƒ½å¿…é¡»ä»Ž &lt;code>HasTraits&lt;/code> ç»§æ‰¿ã€‚&lt;/p>
&lt;p>å†æ¬¡æ¢³ç†è°ƒç”¨æ‘„åƒå¤´çš„æµç¨‹ï¼š&lt;/p>
&lt;ul>
&lt;li>å¼•å…¥æ¨¡åž‹ï¼š&lt;code>model.load_state_dict(torch.load('best_model.pth'))&lt;/code>&lt;/li>
&lt;li>è¿žæŽ¥æ‘„åƒå¤´ï¼šè§ä¸Šæ–‡&lt;/li>
&lt;li>æ¨¡åž‹æ‰§è¡Œï¼š&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">update&lt;/span>&lt;span class="p">():&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">...&lt;/span>&lt;span class="c1">#æ­¤å¤„ä¸ºæ¨¡åž‹æ‰§è¡Œå‡½æ•°ï¼Œå°†è¾“å…¥å›¾åƒé¢„å¤„ç†åŽï¼Œæ‰§è¡Œæ¨¡åž‹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">update&lt;/span>&lt;span class="p">({&lt;/span>&lt;span class="s1">&amp;#39;new&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">camera&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">})&lt;/span> &lt;span class="c1">#åˆå§‹åŒ–è¯¥å‡½æ•°&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">camera&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">observe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">update&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">names&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;value&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#å°†updateå‡½æ•°è®¾ä¸ºcamera.valueçš„observer&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç ”ç©¶ä¸€ä¸‹observeç”¨æ³•ï¼šå½“å¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨å‡½æ•°ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://traitlets.readthedocs.io/en/stable/using_traitlets.html#validation" target="_blank" rel="noopener"
>https://traitlets.readthedocs.io/en/stable/using_traitlets.html#validation&lt;/a>&lt;/p>
&lt;p>æ‰§è¡Œå¦‚ä¸‹ä»£ç ï¼š&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">ipywidgets.widgets&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="nn">widgets&lt;/span> &lt;span class="c1">#å›¾åƒæ¨¡å—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">IPython.display&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">display&lt;/span> &lt;span class="c1">#ipyçš„æ˜¾ç¤ºæ¨¡å—&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="nn">traitlets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">jetbot&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Camera&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">bgr8_to_jpeg&lt;/span> &lt;span class="c1">#æ‘„åƒå¤´é©±åŠ¨ï¼Œå›¾åƒæ ¼å¼è½¬æ¢&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">camera&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Camera&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">instance&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">width&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">500&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">height&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">500&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1">#åˆå§‹åŒ–æ‘„åƒå¤´å¯¹è±¡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">update&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">change&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">change&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;new&amp;#39;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">display&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">#æ˜¾ç¤ºå›¾åƒ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">update&lt;/span>&lt;span class="p">({&lt;/span>&lt;span class="s1">&amp;#39;new&amp;#39;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">camera&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">camera&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">observe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">update&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">names&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;value&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>è¾“å‡ºä¸€å¤§å †æ•°ç»„ï¼Œè¯´æ˜Žcamera.valueæ˜¯è¿™ä¸€å¤§å †åƒç´ ã€‚è€Œä¸”observeæ­£å¸¸è¿è¡Œï¼Œæ•°æ®ä¸€ç›´å†’å‡ºã€‚&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">array([[[122, 116, 130],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [126, 113, 127],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [125, 117, 129],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [ 84, 96, 107],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [ 82, 96, 113],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [ 93, 93, 113]],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [[120, 119, 130],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [122, 120, 119],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [118, 123, 130],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...,
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ç„¶è€Œå°±æ˜¯ä¸å®žæ—¶æ›´æ–°æ•°æ®ï¼Œå’ã€‚&lt;/p>
&lt;p>ðŸ‘´ä½›äº†ã€‚&lt;/p>
&lt;h3 id="ç¥žç»ç½‘ç»œç¬”è®°">ç¥žç»ç½‘ç»œç¬”è®°&lt;/h3>
&lt;h3 id="alexnetcnn">AlexNetâ€”â€”CNN&lt;/h3>
&lt;p>2012å¹´ç”±Hintonå­¦ç”ŸAlexæå‡ºï¼Œæ˜¯LenetåŠ å®½ç‰ˆã€‚å…¶é‡‡ç”¨äº†ä¸€ç³»åˆ—çš„æ–°æŠ€æœ¯ï¼šæˆåŠŸçš„å¼•ç”¨äº†reluã€dropoutå’Œlrnç­‰trickï¼Œé¦–æ¬¡é‡‡ç”¨gpuåŠ é€Ÿã€‚å…¶åŒ…å«65ä¸‡ç¥žç»å…ƒï¼Œ5ä¸ªå·ç§¯å±‚ï¼Œä¸‰ä¸ªåŽé¢å¸¦æœ‰æ± åŒ–å±‚ï¼Œæœ€åŽç”¨äº†ä¸‰ä¸ªå…¨é“¾æŽ¥ã€‚&lt;/p></description></item><item><title>å•ç‰‡æœºå…¥é—¨â€”â€”jetbotæ™ºèƒ½å°è½¦å°é²œ(ä¸€)</title><link>https://lonelyuan.github.io/HugoBlog/p/%E5%8D%95%E7%89%87%E6%9C%BA%E5%85%A5%E9%97%A8jetbot%E6%99%BA%E8%83%BD%E5%B0%8F%E8%BD%A6%E5%B0%9D%E9%B2%9C%E4%B8%80/</link><pubDate>Fri, 20 Sep 2019 00:25:55 +0000</pubDate><guid>https://lonelyuan.github.io/HugoBlog/p/%E5%8D%95%E7%89%87%E6%9C%BA%E5%85%A5%E9%97%A8jetbot%E6%99%BA%E8%83%BD%E5%B0%8F%E8%BD%A6%E5%B0%9D%E9%B2%9C%E4%B8%80/</guid><description>&lt;p>é‚£ä¸ªç”·å­©ä¸æƒ³çŽ©æ ‘èŽ“æ´¾å‘¢ï¼Ÿæœºç¼˜å·§åˆä¹‹ä¸‹ï¼Œæˆ‘å¾—åˆ°äº†ä¸€å°ä»·å€¼ä¸Šç™¾ç¾Žå…ƒçš„æ™ºèƒ½å°è½¦çš„ä½¿ç”¨æƒã€‚&lt;/p>
&lt;p>å°è½¦çš„æ ¸å¿ƒæ˜¯NVIDIAå®¶çš„jetson-nanoå¼€å‘æ¿ï¼Œè¿™æ¬¾19å¹´ä¸‰æœˆæ‰å‘å¸ƒçš„å¾®åž‹AIè®¡ç®—æœºå¯è°“æ˜¯å¹³æ°‘çº§æ ¸å¼¹ï¼Œå››æ ¸A57çš„CPUï¼Œ128æ ¸å¿ƒMaxwellæž¶æž„çš„GPUï¼Œ4gå†…å­˜ï¼Œæ”¯æŒ4kè§†é¢‘è§£ç ï¼Œè€Œä¸”è¿™åªäº”è„ä¿±å…¨çš„éº»é›€åªéœ€è¦5Wçš„ç”µæºæ”¯æŒï¼Œä»»ä½•ä¸€æ”¯å……ç”µå®éƒ½å¯ä»¥èƒœä»»ã€‚è€Œå®ƒçš„å®šä½æ˜¯ç”¨å®ƒç®€å•çš„æ­å»ºäººå·¥æ™ºèƒ½åº”ç”¨ï¼Œéžå¸¸çš„amazingã€‚&lt;/p>
&lt;p>æœ¬æ–‡çš„ç›®çš„,ä¸å®Œå…¨æ˜¯æ–°æ‰‹æ•™ç¨‹,è¿˜æœ‰è‡ªå·±å­¦ä¹ è¿‡ç¨‹çš„è®°å½•å’Œåˆ†äº«.åˆæ¬¡æŽ¥è§¦,å¤šæœ‰ç–æ¼,æ¬¢è¿ŽæŒ‡æ•™.&lt;/p>
&lt;p>ã€å›¾ç‰‡ï¼šä¸»æ¿è¯ä»¶ç…§ã€‘&lt;/p>
&lt;blockquote>
&lt;p>ç»™èŒæ–°ç†æ¸…å‡ ä¸ªæ¦‚å¿µï¼š&lt;/p>
&lt;p>å•ç‰‡æœºï¼šSingle-Chip Microcomputerã€‚&lt;/p>
&lt;p>æ ‘èŽ“æ´¾ï¼šä¸€æ¬¾è‘—åçš„å¾®åž‹ç”µè„‘å“ç‰Œï¼ˆæœ¬æ–‡ä»‹ç»çš„jetson-nanoå¯ä»¥ç†è§£ä¸ºæ˜¯æ ‘èŽ“æ´¾çš„ç«žå“ï¼Œç›¸æ¯”æ ‘èŽ“æ´¾ï¼Œè¿™æ¬¾å•ç‰‡æœºä»·æ ¼æ›´é«˜ï¼Œæ€§èƒ½æ›´å¥½ï¼Œä¸»æ‰“AIåº”ç”¨ï¼‰&lt;/p>
&lt;p>jetbotï¼šä»¥jetson-nanoä¸ºå¹³å°æ­å»ºçš„aiæœºå™¨äººåº”ç”¨ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“æ™ºèƒ½å°è½¦&lt;/p>
&lt;/blockquote>
&lt;h3 id="ç¡¬ä»¶ç»„è£…ç§¯æœ¨å’Œç”µå·¥">ç¡¬ä»¶ç»„è£…:ç§¯æœ¨å’Œç”µå·¥&lt;/h3>
&lt;p>æœ¬äººæ‹¿åˆ°çš„æ˜¯é›¶ä»¶çŠ¶æ€çš„å°è½¦ï¼Œæ‰€ä»¥é¦–å…ˆè®²ä¸€è®²ç»„è£…çš„é—®é¢˜ã€‚æœ‰å…³å…·ä½“æ­¥éª¤ï¼Œå®˜ç½‘æ•™ç¨‹ååˆ†è¯¦ç»†ï¼Œè´´ä¸ªè¿žæŽ¥ç»™æ‡’äººå§ï¼šhttps://www.ncnynl.com/archives/201904/2927.html&lt;/p>
&lt;p>è¿™é‡Œåªè®²ä¸€è®²æˆ‘ä½œä¸ºåˆå­¦è€…çš„ä¸€äº›ç†è§£ã€‚é¦–å…ˆï¼ŒçŽ©å•ç‰‡æœºå’ŒçŽ©ç§¯æœ¨çš„åŒºåˆ«å°±åœ¨äºŽç¼–ç¨‹ã€‚å½“ç„¶ï¼Œå…¥é—¨å•ç‰‡æœºè¿˜éœ€è¦å…¶ä»–æŠ€èƒ½ã€‚æ¯”å¦‚ï¼Œç”µå·¥æŠ€èƒ½ï¼šä½ éœ€è¦è¿›è¡Œçº¿æçš„ç®€å•åŠ å·¥ï¼Œå¼•è„šçš„ç„ŠæŽ¥ï¼Œå‡†å¤‡åŸºæœ¬çš„å·¥å…·å°±å¥½ï¼Œæ¯•ç«Ÿé‚£ä¸ªç”·å­©æ²¡æœ‰ä¸€æ ¹çƒ­çƒ­çš„æ£’å­å‘¢ï¼ˆæŒ‡&lt;strong>ç”µçƒ™é“&lt;/strong>ï¼‰ã€‚ç„¶åŽï¼Œå„ä¸ªéƒ¨ä»¶çš„æ‹¼æŽ¥å›ºå®šéœ€è¦ä¸€äº›åšæ‰‹å·¥çš„æŠ€å·§ï¼Œè¿™ä¸ªä¹Ÿä¸ç”¨æ€•ï¼Œèµ«é²æ™“å¤«æ›¾ç»è¯´è¿‡ï¼š&lt;strong>çƒ­ç†”èƒ¶&lt;/strong>å¯ä»¥è®©æˆ‘ä»¬åˆ›é€ å¥‡è¿¹ã€‚&lt;/p>
&lt;p>åœ¨è¿™ä¸ªå±‚é¢ä¸Šï¼Œåˆå­¦è€…ä¼šæµªè´¹è®¸å¤šè€—æï¼Œè¿™æ˜¯å¿…è¦çš„ç»ƒä¹ æ‰‹æ®µï¼Œæ‰€ä»¥åˆå­¦è€…ä¹Ÿå¯ä»¥ä»Žæœ€ç®€å•çš„èŠ¯ç‰‡å…¥æ‰‹ã€‚åŒæ—¶ä½ è¿˜è¦å­¦ä¹ è¯Šæ–­ç¡¬ä»¶æ–¹é¢çš„é—®é¢˜ï¼Œ&lt;strong>ä¸‡ç”¨è¡¨&lt;/strong>ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚å…³äºŽæ›´è¯¦ç»†çš„å·¥å…·å’Œè€—æçš„éœ€è¦ï¼Œè¯·è‡ªè¡ŒæŸ¥é˜…å•ç‰‡æœºå…¥é—¨æœ‰å…³èµ„æ–™ã€‚&lt;/p>
&lt;p>åœ¨æœ¬é¡¹ç›®ä¸­ï¼Œç„ŠæŽ¥å·¥ä½œå·²ç»å®Œæˆï¼Œå‰©ä¸‹çš„è¿žæŽ¥éƒ½æ˜¯å¯æ’æ‹”å¼çš„ã€‚æˆ‘ä»¬åªéœ€è¦ä¸¤æŠŠèžºä¸åˆ€å³å¯å®Œæˆç»„è£…ã€‚å³ä¾¿å¦‚æ­¤ï¼Œæœ¬äººè¿˜æ˜¯èŠ±äº†ä¸€æ™šä¸Šæ‰æŠŠå°è½¦ç‚¹äº®ï¼ŒåŽŸå› æ˜¯æˆ‘å¾—åˆ°çš„çº¿ææŸåè¿‘åŠï¼Œåªå¾—è‡ªå·±å¯»æ‰¾å’Œä¿®ç†ã€‚&lt;/p>
&lt;p>ä¸‹é¢åˆ†æžä¸€ä¸‹å°è½¦çš„ç»“æž„:&lt;/p>
&lt;ul>
&lt;li>jetson-nanoå¼€å‘æ¿:å³æœ¬æœºçš„ä¸»æ¿,å¯ä»¥çœ‹åˆ°æœ‰ä¸¤å±‚èŠ¯ç‰‡,ä¸Šå±‚ä¸ºæ ¸å¿ƒå±‚,åŒ…æ‹¬cpu,gpuå’Œå†…å­˜å¯ä»¥åƒç¬”è®°æœ¬å†…å­˜æ¡ä¸€æ ·æ‹†å¸;ä¸‹å±‚ä¸ºä¸»æ¿,ç”¨äºŽè¿žæŽ¥å„ç§è®¾å¤‡&lt;/li>
&lt;li>intelæ— çº¿ç½‘å¡:å°†ä¸Šå±‚æ‹†ä¸‹å³å¯å®‰è£….ä»¤è¿žå‡ºä¸¤æ ¹å¤©çº¿,ç¼ ç»•æœºèº«å³å¯.&lt;/li>
&lt;li>PiOLEDæ˜¾ç¤ºå™¨å’Œæ‹“å±•ç‰ˆ:è¿žæŽ¥åœ¨I2Cä¸»çº¿ä¸Š&lt;/li>
&lt;li>ç›¸æœºæ¨¡å—:å®˜æ–¹æ ·ä¾‹å±•ç¤ºäº†åªç”¨ä¸€ä¸ªæ‘„åƒå¤´é€šè¿‡æ·±åº¦å­¦ä¹ è¿›è¡Œè‡ªåŠ¨é¿éšœçš„demo.&lt;/li>
&lt;li>é©¬è¾¾å’Œå…¶é©±åŠ¨æ¿:ä¸‹æ–‡é‡ç‚¹è®²è§£&lt;/li>
&lt;/ul>
&lt;p>å¼€å‘æ¿å°±å¯ä»¥è¿è¡Œä¸€ä¸ªå®Œæ•´çš„Ubuntuç³»ç»Ÿ,å…¶ä½™è®¾å¤‡æ˜¯ä¸ºå…¶æ‹“å±•åŠŸèƒ½çš„.&lt;/p>
&lt;h3 id="ç¡¬ä»¶æž¶æž„é©±åŠ¨èŠ¯ç‰‡å’Œi2cä¸»çº¿">ç¡¬ä»¶æž¶æž„ï¼šé©±åŠ¨èŠ¯ç‰‡å’ŒI2Cä¸»çº¿&lt;/h3>
&lt;p>æˆ‘åœ¨çŽ©å°è½¦çš„è¿‡ç¨‹ä¸­è€½è¯¯æœ€é•¿æ—¶é—´çš„å°±æ˜¯ç”µæœºï¼ˆå³é©¬è¾¾ï¼‰é©±åŠ¨äº†ï¼Œå€Ÿæ­¤è®²ä¸€è®²ç³»ç»Ÿæž¶æž„çš„äº‹ã€‚&lt;/p>
&lt;p>è®©è½®å­å‰è¿›è¦é é©¬è¾¾ï¼Œç»™é©¬è¾¾ä¾›ç”µä¸èƒ½ç›´æŽ¥è®©ä¸»æ¿æ¥åšï¼Œè¦è®©ä¸»æ¿ç»™å¦ä¸€å—å°èŠ¯ç‰‡å‘é€æŒ‡ä»¤ï¼Œè¿™å—å°èŠ¯ç‰‡è¿žæŽ¥ç€ç‹¬ç«‹çš„ç”µæºï¼Œæ”¶åˆ°æŒ‡ä»¤æ‰ä¼šç»™é©¬è¾¾é€šç”µã€‚è¿™å—å°èŠ¯ç‰‡å³æ˜¯ç”µæœºé©±åŠ¨æ¿ã€‚&lt;/p>
&lt;p>é©±åŠ¨èŠ¯ç‰‡æ˜¯ä»Žç¡¬ä»¶èµ°å‘è½¯ä»¶çš„ç¬¬ä¸€é“æ¡¥æ¢ï¼Œå¯ä»¥ç±»æ¯”PCçš„IOè®¾å¤‡æ¥ç†è§£ã€‚å’Œç‰©ç†ä¸–ç•Œäº¤äº’çš„å„ç§åŠŸèƒ½ï¼Œéƒ½éœ€è¦æœ‰ä¸“é—¨çš„é©±åŠ¨èŠ¯ç‰‡ã€‚åŒ…æ‹¬é©¬è¾¾ï¼Œæ‘„åƒå¤´ï¼Œæ‰¬å£°å™¨ï¼Œæœºæ¢°è‡‚ç­‰ç­‰ï¼Œåªä¸è¿‡æœ‰çš„å¯ä»¥é›†æˆåœ¨ä¸€èµ·ï¼Œå¦‚ï¼šå°è½¦ä¸Šçš„æ‘„åƒå¤´ï¼ŒPiOLEDæ˜¾ç¤ºå™¨ç­‰ï¼›æœ‰çš„å‡ºäºŽä½“ç§¯ï¼Œå®‰å…¨æ€§ï¼Œæ¨¡å—åŒ–çš„è€ƒè™‘éœ€è¦åˆ†å¼€ï¼Œå¦‚ç”µæœºå’Œé©±åŠ¨æ¿ã€‚&lt;/p>
&lt;h4 id="ç”µæœºé©±åŠ¨æ¿">ç”µæœºé©±åŠ¨æ¿&lt;/h4>
&lt;p>å®˜æ–¹ç»™å‡ºçš„ç”µæœºé©±åŠ¨æ¿åž‹å·ä¸º:DC-Stepper-Motor PCA9685+TB6612.å¯ä»¥é©±åŠ¨ä¸¤ä¸ªæ­¥è¿›ç”µæœºæˆ–å››ä¸ªç›´æµç”µæœºã€‚ï¼ˆå››è½´é£žè¡Œå™¨gkdï¼‰æœ¬é¡¹ç›®åªç”¨åˆ°äº†ä¸¤ä¸ªç›´æµç”µæœºã€‚&lt;/p>
&lt;p>å„ä¸ªå¼•è„šçš„è®²è§£ï¼šhttps://learn.adafruit.com/adafruit-stepper-dc-motor-featherwing/pinouts&lt;/p>
&lt;p>ç”µæœºé©±åŠ¨æ¿ä¸Šå…±è¿žæŽ¥æœ‰10æ ¹è·³çº¿ã€‚ä¸€å¯¹ç”µæºè¾“å…¥ï¼Œä¸¤å¯¹ä¸ºé©¬è¾¾è¾“å‡ºã€‚è¿˜éœ€å››æ ¹æ¯-æ¯æœé‚¦çº¿æ¥è¿žæŽ¥è‡³ä¸»æ¿çš„&lt;strong>I2Cæ€»çº¿&lt;/strong>,å…·ä½“æ¥è¯´,æ˜¯åœ¨LEDå±æ—è¾¹çš„æ‹“å±•æ¿ã€‚åˆ†åˆ«æ˜¯ï¼š&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:center">é©±åŠ¨æ¿å¼•è„š&lt;/th>
&lt;th style="text-align:center">ä¸»æ¿I2Cå¼•è„š&lt;/th>
&lt;th style="text-align:center">åŠŸèƒ½&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:center">3V3&lt;/td>
&lt;td style="text-align:center">3V3&lt;/td>
&lt;td style="text-align:center">ä¸ºé©±åŠ¨æ¿ä¾›ç”µ,å³ç”µæºæ­£æž&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">GND&lt;/td>
&lt;td style="text-align:center">GND&lt;/td>
&lt;td style="text-align:center">æŽ¥åœ°,å³ç”µæºè´Ÿæž&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">SDA&lt;/td>
&lt;td style="text-align:center">3&lt;/td>
&lt;td style="text-align:center">ä¸²è¡Œæ•°æ®çº¿ï¼Œä¼ è¾“æ•°æ®&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">SCL&lt;/td>
&lt;td style="text-align:center">5&lt;/td>
&lt;td style="text-align:center">ä¸²è¡Œæ—¶é’Ÿçº¿ï¼Œä¼ è¾“æŽ§åˆ¶ä¿¡å·&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>ã€å›¾ç‰‡ï¼šé©±åŠ¨æ¿å¼•è„šã€‘&lt;/p>
&lt;p>æŽ¥é”™äº†æœ‰å¯èƒ½çƒ§åæ¿å­å“¦&lt;/p>
&lt;h4 id="i2cæ€»çº¿">I2Cæ€»çº¿&lt;/h4>
&lt;p>æ‰€è°“æ€»çº¿,å¯ä»¥ç†è§£ä¸ºä¸€æ¡è¡—é“,æ¯ä¸ªè®¾å¤‡å°±æ˜¯è¡—é“ä¸¤æ—çš„æˆ¿å­,æˆ¿å†…çš„ä½æˆ·å‡ºé—¨èµ°äº²è®¿å‹å°±æ˜¯æ•°æ®åœ¨ä¸åŒè®¾å¤‡é—´çš„ä¼ è¾“ã€‚&lt;/p>
&lt;p>I2Cæ€»çº¿æ˜¯å¸¸ç”¨äºŽåµŒå…¥å¼ç³»ç»Ÿçš„ä¸€ç§ç®€æ˜“ä¸²è¡Œæ€»çº¿.ä»–æœ‰ç®€æ´çš„åŒçº¿ç»“æž„(SCL+SDA),æ¯ä¸ªè®¾å¤‡éƒ½æœ‰ä¸€ä¸ªåœ°å€ç ,ä»¥æ­¤å®žçŽ°å¤šä¸ªè®¾å¤‡ç›¸äº’é€šè®¯ã€‚è®¾å¤‡æœ‰ä¸»ä»Žä¹‹åˆ†ï¼Œä¸»è®¾å¤‡/ä¸»ç«¯å¿…é¡»æ˜¯å¸¦æœ‰CPUçš„é€»è¾‘æ¨¡å—ï¼Œåœ¨åŒä¸€æ€»çº¿ä¸ŠåŒä¸€æ—¶åˆ»ä½¿èƒ½æœ‰ä¸€ä¸ªä¸»ç«¯ï¼Œå¯ä»¥æœ‰å¤šä¸ªä»Žç«¯ï¼Œä»Žç«¯çš„æ•°é‡å—åœ°å€ç©ºé—´å’Œæ€»çº¿çš„æœ€å¤§ç”µå®¹ 400pFçš„é™åˆ¶ã€‚&lt;/p>
&lt;p>å¯ä»¥ä½¿ç”¨i2c-toolsè°ƒè¯•i2cæ€»çº¿:&lt;/p>
&lt;ul>
&lt;li>æ£€æµ‹æœ‰å‡ ç»„i2cæ€»çº¿åœ¨ç³»ç»Ÿä¸Š&lt;code>i2cdetect -l&lt;/code>&lt;/li>
&lt;li>æ£€æµ‹æŒ‚è½½åœ¨i2c-1ä¸Šçš„è®¾å¤‡&lt;code>i2cdetect -r -y 1&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> 0 1 2 3 4 5 6 7 8 9 a b c d e f
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 00: -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 30: -- -- -- -- -- -- -- -- -- -- -- -- 3c -- -- --ï¼ˆledï¼‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 60: 60 -- -- -- -- -- -- -- -- -- -- -- -- -- -- --ï¼ˆç”µæœºé©±åŠ¨ï¼‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 70: 70 -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ul>
&lt;li>
&lt;p>æŸ¥çœ‹è®¾å¤‡(åœ°å€ä¸º0x20)ä¸Šæ‰€æœ‰å¯„å­˜å™¨çš„å€¼i2cdump -f -y 1 0x20&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¯¹å•ä¸ªå¯„å­˜å™¨è¿›è¡Œè¯»å†™:&lt;/p>
&lt;p>&lt;code>i2cset -f -y 1 0x20 0x77 0x3f &lt;/code>ï¼ˆè®¾ç½®i2c-1ä¸Š0x20å™¨ä»¶çš„0x77å¯„å­˜å™¨å€¼ä¸º0x3fï¼‰&lt;/p>
&lt;p>&lt;code>i2cget -f -y 1 0x20 0x77 &lt;/code> ï¼ˆè¯»å–i2c-1ä¸Š0x20å™¨ä»¶çš„0x77å¯„å­˜å™¨å€¼ï¼‰&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>jetson-nanoå¼€å‘æ¿æä¾›äº†6æ¡I2Cä¸»çº¿,ä»¥åŠå…¶ä»–ä¸°å¯Œçš„æŽ¥å£ã€‚ç†è§£è¿™äº›æŽ¥å£æ˜¯æ‹“å±•å„ç§è®¾å¤‡çš„å‰æã€‚&lt;/p>
&lt;h3 id="è½¯ä»¶è¿žæŽ¥sshè¿œç¨‹æ¡Œé¢">è½¯ä»¶è¿žæŽ¥:sshè¿œç¨‹æ¡Œé¢&lt;/h3>
&lt;p>ä»Žå¤´å¼€å§‹çš„è¯ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¾€sdå¡é‡Œçƒ§å†™ç³»ç»Ÿé•œåƒï¼Œä¸è¿‡æˆ‘æ‹¿åˆ°çš„å·²ç»å®Œæˆäº†è¿™ä¸€æ­¥éª¤ï¼Œæ•…ä¸å†èµ˜è¿°ã€‚&lt;/p>
&lt;p>åœ¨å®˜æ–¹æ•™ç¨‹ä¸­,éœ€è¦hdmiçº¿è¿žæŽ¥æ˜¾ç¤ºå±,usbè¿žæŽ¥é¼ æ ‡é”®ç›˜,æ¥è¿›å…¥jetson-nanoçš„Ubuntuç³»ç»Ÿ.å…¶ç›®çš„åœ¨äºŽé¦–æ¬¡è¿žæŽ¥ä¸€ä¸ªæ— çº¿ç½‘ç»œ(æ‰‹æœºçƒ­ç‚¹),ä¹‹åŽåªè¦ç”µè„‘å’Œnanoåœ¨åŒä¸€ç½‘ç»œ,å³å¯ç”¨ç”µè„‘è®¿é—®nanoçš„IP(8888ç«¯å£),ç›´æŽ¥æ“çºµjetbot.&lt;/p>
&lt;p>ç”±äºŽæˆ‘å¹¶æ²¡æœ‰hdmiçº¿,åªæœ‰ä¸€æ ¹ç½‘çº¿,åæ­£éƒ½èƒ½æ’,æ’è°ä¸ä¸€æ ·?æ‰€ä»¥ç”¨ç½‘çº¿æŠŠå°è½¦å’Œç¬”è®°æœ¬è¿žæŽ¥èµ·æ¥ç»„æˆå±€åŸŸç½‘.ç”¨sshçš„æ–¹å¼è¿›å…¥nanoçš„ç³»ç»Ÿ.å…·ä½“æ­¥éª¤å¦‚ä¸‹:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>ipå‘çŽ°:åœ¨æ’å…¥ç½‘çº¿å‰åŽæ‰§è¡Œä¸¤æ¬¡:&lt;code>arp -a&lt;/code>,æ¯”è¾ƒä¸åŒ,ä¼šå‘çŽ°å¤šå‡ºä¸€ä¸ªåœ°å€,ç±»åž‹ä¸ºåŠ¨æ€,æ­¤å³ä¸ºå°è½¦çš„å†…ç½‘IP.å°è½¦çš„ledå±ä¹Ÿä¼šè‡ªåŠ¨æ˜¾ç¤ºå…¶ip.å¦‚&lt;code>eth0:192.168.x.x&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>(å¦‚æ­¤,æˆ‘ä»¬å¯ä»¥ç›´æŽ¥ä»Žæµè§ˆå™¨è®¿é—®è¿™ä¸ªipçš„8888ç«¯å£,å¹¶èƒ½è¿è¡Œjupyter notebookäº†.ä½†æˆ‘ä»¬ä¸èƒ½è®©å°è½¦æ‹–ç€ç½‘çº¿è·‘å•Š,æ‰€ä»¥è¿˜æ˜¯è¦é…ç½®æ— çº¿ç½‘ç»œ.)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å°†ç¬”è®°æœ¬çš„wifiè¿žæŽ¥è®¾ä¸ºå¯¹ä»¥å¤ªç½‘å¯å…±äº«,è¿™ä¸€æ­¥æ˜¯ä¸ºäº†è®©å°è½¦èƒ½é€šè¿‡ç¬”è®°æœ¬è”ç½‘&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç«¯å£æ‰«æ:&lt;code>nmap -sT 192.168.x.x&lt;/code>å‘çŽ°22ç«¯å£å¼€æ”¾,æ•…è¿žæŽ¥ä¹‹:&lt;code>ssh jetbot@192.168.x.x&lt;/code>,å°±ç”¨å®˜æ–¹æ•™ç¨‹ç»™çš„è´¦æˆ·å¯†ç .&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¿žæŽ¥æˆåŠŸåŽ,å°±å¯ä»¥ç”¨å‘½ä»¤è¡Œå·¥å…·è¿žæŽ¥WiFiäº†,ä½†è¿˜æ˜¯å®‰è£…ä¸€ä¸‹è¿œç¨‹æ¡Œé¢å§.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é…ç½®è¿œç¨‹æ¡Œé¢:æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">sudo apt-get install tightvncserver
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get install xrdp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt-get install vnc4server tightvncserver
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;li>
&lt;p>ä¹‹åŽåœ¨ä½ çš„ä¸»æœºwin+Rï¼Œè¾“å…¥mstsc,è¿›å…¥è¿œç¨‹ç™»å½•æ¡Œé¢ï¼Œè¾“å…¥å°è½¦çš„ipåœ°å€ï¼Œç‚¹å‡»è¿žæŽ¥&lt;/p>
&lt;/li>
&lt;li>
&lt;p>åœ¨xrdpçš„ç™»é™†ç•Œé¢è¾“å…¥ç”¨æˆ·åå¯†ç å³å¯æ‰“å¼€è¿œç¨‹æ¡Œé¢&lt;/p>
&lt;p>(è¿™é‡Œæˆ‘ç”¨jetbotç”¨æˆ·ç™»é™†é­é‡é—ªé€€,ç”¨rootå°±å¯ä»¥,ä¸æ¸…æ¥šåŽŸå› )(å¦å¤–å¼€äº†è¿œç¨‹æ¡Œé¢å†…å­˜ç–¯æ¶¨,å°±å¾ˆç¦»è°±)&lt;/p>
&lt;/li>
&lt;li>
&lt;p>è¿žæŽ¥ä¸ŠwifiåŽ,ä½ èƒ½åœ¨å°è½¦çš„ledæ¿ä¸Šçœ‹åˆ°å¦ä¸€ä¸ªip:&lt;code>wlan0:192.168.x.x&lt;/code>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>ä¸ç®¡æ€Žæ ·,è¿žæŽ¥ä¸Šwifiä¹‹åŽçš„æ“ä½œå°±å¾ˆç®€å•äº†.è·Ÿç€æ•™ç¨‹,è·‘ä¸€è·‘demo,è¿˜æ˜¯å¾ˆæœ‰æˆå°±æ„Ÿçš„.&lt;/p>
&lt;h3 id="æŽ’æŸ¥bug">æŽ’æŸ¥bug&lt;/h3>
&lt;p>ç„¶è€Œdemoå¹¶æ²¡æœ‰è®©æˆ‘è·‘å‡ºæ¥,ä¸”æŒ‡å‘åŒä¸€ä¸ªé”™è¯¯:&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl">OSError: [Errno 121] Remote I/O error
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>æ²¿ç€jupyter notebookçš„æŠ¥é”™ä¸€ç›´èµ°,ä¸€ç›´åˆ°äº†æœ€åº•å±‚,å‘è®¾å¤‡å†™å…¥æ•°æ®æŠ¥é”™,&lt;code>remote IO error&lt;/code>.&lt;/p>
&lt;p>çœ‹èµ·æ¥åƒæ˜¯ç¡¬ä»¶çš„é—®é¢˜ã€‚ä¸€æ­¥ä¸€æ­¥æŽ’æŸ¥å‘—&lt;/p>
&lt;ul>
&lt;li>
&lt;p>æ€€ç–‘è·³çº¿é”™è¯¯&lt;/p>
&lt;ul>
&lt;li>æ›´æ¢è·³çº¿â€”â€”æ— æžœ&lt;/li>
&lt;li>ç”¨ä¸‡ç”¨è¡¨æµ‹é‡çº¿ä¸¤ç«¯çš„ä¿¡å·â€”â€”æ­£å¸¸ï¼ŒæŽ’é™¤è¿žæŽ¥é—®é¢˜
&lt;ul>
&lt;li>æ—¶é’Ÿçº¿ä¿æŒ3.3væ¯éš”å‡ ç§’è·³åˆ°2.2våˆå›žæ¥ï¼Œç»“åˆi2cçš„åŽŸç†åº”è¯¥æ˜¯æ­£å¸¸çŽ°è±¡ï¼Ÿ&lt;/li>
&lt;li>æ•°æ®çº¿åŒæ ·ä¿æŒ3.3vï¼Œé—´æ–­è·³è‡³2.3ï¼Œ2.0&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>è½¯ä»¶æ–¹æ³•æ£€éªŒè®¾å¤‡è¿žæŽ¥æ€§&lt;/p>
&lt;ul>
&lt;li>ç”¨i2ctoolså¯ä»¥æ£€æµ‹åˆ°è®¾å¤‡ï¼Œæ‹”ä¸‹4æ ¹æŽ¥çº¿ï¼Œåœ¨0x60,0x70å¤„çš„è®¾å¤‡æ¶ˆå¤±ï¼ˆä¸€ä¸ªæ˜¯i2cçº¿ï¼Œä¸€ä¸ªæ˜¯é€»è¾‘ä¾›ç”µï¼Ÿï¼‰&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">&lt;span class="line">&lt;span class="cl"> 0 1 2 3 4 5 6 7 8 9 a b c d e f
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">00: -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">30: -- -- -- -- -- -- -- -- -- -- -- -- 3c -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">70: -- -- -- -- -- -- -- --
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;/li>
&lt;/ul>
&lt;p>ç„¶è€Œï¼Œåœ¨é€šç”µçŠ¶æ€ä¸‹ï¼ŒæŠŠè¿žçº¿æ‹”ä¸‹åˆæ’ä¸Šä¹‹åŽï¼Œi2cåˆèƒ½æ£€æµ‹åˆ°è®¾å¤‡ï¼Œç„¶åŽç¤ºä¾‹ä»£ç å°±èƒ½è¿è¡Œäº†ï¼Ÿï¼Ÿï¼Ÿ&lt;/p>
&lt;p>è¿·æƒ‘ã€‚æ‰€ä»¥å¼€æœºæ—¶æœºå™¨å¹¶æ²¡èƒ½æ­£ç¡®è½½å…¥è®¾å¤‡ï¼Œåå€’æ˜¯é‡æ–°è¿žæŽ¥åŽèƒ½è¯†åˆ«äº†ï¼Ÿï¼Ÿï¼Ÿæœ¬æ¥æˆ‘éƒ½è¦æ¢é©±åŠ¨æ¿äº†ï¼Œorzã€‚&lt;/p>
&lt;p>åˆæˆ–è€…æ˜¯å’Œé©±åŠ¨æ¿ä¸Šçš„resetæŒ‰é’®æœ‰å…³ï¼Ÿç­‰ä¸‹æ¬¡é‡åˆ°é—®é¢˜å†è¯´å§ã€‚&lt;/p>
&lt;h3 id="æ‹¾é—">æ‹¾é—&lt;/h3>
&lt;h4 id="linuxå†…å­˜å ç”¨">linuxå†…å­˜å ç”¨&lt;/h4>
&lt;p>ledå±ä¼šæ˜¾ç¤ºå†…å­˜å ç”¨ï¼Œç„¶é¹…æ—¶é—´é•¿äº†æ€»ä¼šåˆ°90%ä»¥ä¸Šï¼Œå¯æˆ‘å¹¶æ²¡æœ‰è¿è¡Œä»€ä¹ˆç¨‹åºã€‚&lt;/p>
&lt;p>ç»æŸ¥é˜…æ­¤å¤„æ˜¾ç¤ºçš„æ˜¯å®žé™…å æœ‰çš„åŠ ä¸Šbufferå’Œcached meméƒ¨åˆ†ï¼Œå¯ä»¥ç†è§£ä¸ºç¼“å­˜çš„ï¼Œéšæ—¶æ¸…ç†ï¼Œå¹¶ä¸å ç”¨å®žé™…å†…å­˜ã€‚&lt;/p>
&lt;p>å¯ç”¨topå‘½ä»¤æŸ¥çœ‹å†…å­˜è¯¦æƒ…ã€‚&lt;/p>
&lt;h4 id="ä¾›ç”µé—®é¢˜">ä¾›ç”µé—®é¢˜&lt;/h4>
&lt;p>ç”¨å……ç”µå®ä¾›ç”µæ–¹ä¾¿ï¼Œä½†æ˜¯åªè¦ä¸€æ–­ç”µç³»ç»Ÿå°±ä¼šé‡å¯ï¼Œè¿™å¯¹linuxç³»ç»Ÿè€Œè¨€ä¼¤å®³å¾ˆå¤§ã€‚&lt;/p>
&lt;p>è€Œåœ¨å……ç”µå®ç”µé‡ä¸æ»¡æ—¶ï¼Œç»å¸¸å‘ç”Ÿå¼€ä¸äº†æœºçš„é—®é¢˜ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºç”µé‡ä¸è¶³å¯¼è‡´ç”µåŽ‹ä¸ç¨³ã€‚&lt;/p>
&lt;h5 id="å…³æœºå‘½ä»¤">å…³æœºå‘½ä»¤ï¼š&lt;/h5>
&lt;p>&lt;code>sudo shutdown -h now&lt;/code>&lt;/p>
&lt;h5 id="é‡å¯">é‡å¯ï¼š&lt;/h5>
&lt;p>&lt;code>shutdown -h now -r&lt;/code>&lt;/p>
&lt;p>&lt;em>ä¸‹ä¸€ç¯‡ï¼šæ“çºµå°è½¦å’ŒAIåˆæŽ¢&lt;/em>&lt;/p>
&lt;h3 id="å‚è€ƒé“¾æŽ¥">å‚è€ƒé“¾æŽ¥&lt;/h3>
&lt;p>&lt;a class="link" href="https://github.com/NVIDIA-AI-IOT/jetbot/wiki/Hardware-Setup" target="_blank" rel="noopener"
>https://github.com/NVIDIA-AI-IOT/jetbot/wiki/Hardware-Setup&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://robocarstore.cn/" target="_blank" rel="noopener"
>https://robocarstore.cn/&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="http://www.gpus.cn/gpus_list_page_techno_support_content?id=50" target="_blank" rel="noopener"
>http://www.gpus.cn/gpus_list_page_techno_support_content?id=50&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://www.jianshu.com/p/789944463fd7" target="_blank" rel="noopener"
>https://www.jianshu.com/p/789944463fd7&lt;/a>&lt;/p></description></item></channel></rss>